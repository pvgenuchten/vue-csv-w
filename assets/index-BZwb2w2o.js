(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Wu(r){const e=Object.create(null);for(const t of r.split(","))e[t]=1;return t=>t in e}const lt={},Ls=[],Ii=()=>{},Xg=()=>!1,Qc=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),Vu=r=>r.startsWith("onUpdate:"),cr=Object.assign,ju=(r,e)=>{const t=r.indexOf(e);t>-1&&r.splice(t,1)},Zw=Object.prototype.hasOwnProperty,st=(r,e)=>Zw.call(r,e),Ue=Array.isArray,Bs=r=>No(r)==="[object Map]",ca=r=>No(r)==="[object Set]",dd=r=>No(r)==="[object Date]",je=r=>typeof r=="function",Dt=r=>typeof r=="string",Li=r=>typeof r=="symbol",ft=r=>r!==null&&typeof r=="object",qg=r=>(ft(r)||je(r))&&je(r.then)&&je(r.catch),Yg=Object.prototype.toString,No=r=>Yg.call(r),Qw=r=>No(r).slice(8,-1),Jg=r=>No(r)==="[object Object]",$u=r=>Dt(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,La=Wu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ef=r=>{const e=Object.create(null);return t=>e[t]||(e[t]=r(t))},ek=/-\w/g,ei=ef(r=>r.replace(ek,e=>e.slice(1).toUpperCase())),tk=/\B([A-Z])/g,ms=ef(r=>r.replace(tk,"-$1").toLowerCase()),tf=ef(r=>r.charAt(0).toUpperCase()+r.slice(1)),Of=ef(r=>r?`on${tf(r)}`:""),Cn=(r,e)=>!Object.is(r,e),$l=(r,...e)=>{for(let t=0;t<r.length;t++)r[t](...e)},Zg=(r,e,t,i=!1)=>{Object.defineProperty(r,e,{configurable:!0,enumerable:!1,writable:i,value:t})},sc=r=>{const e=parseFloat(r);return isNaN(e)?r:e};let pd;const rf=()=>pd||(pd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Gu(r){if(Ue(r)){const e={};for(let t=0;t<r.length;t++){const i=r[t],n=Dt(i)?sk(i):Gu(i);if(n)for(const s in n)e[s]=n[s]}return e}else if(Dt(r)||ft(r))return r}const rk=/;(?![^(]*\))/g,ik=/:([^]+)/,nk=/\/\*[^]*?\*\//g;function sk(r){const e={};return r.replace(nk,"").split(rk).forEach(t=>{if(t){const i=t.split(ik);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function nf(r){let e="";if(Dt(r))e=r;else if(Ue(r))for(let t=0;t<r.length;t++){const i=nf(r[t]);i&&(e+=i+" ")}else if(ft(r))for(const t in r)r[t]&&(e+=t+" ");return e.trim()}const ak="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ok=Wu(ak);function Qg(r){return!!r||r===""}function lk(r,e){if(r.length!==e.length)return!1;let t=!0;for(let i=0;t&&i<r.length;i++)t=Uo(r[i],e[i]);return t}function Uo(r,e){if(r===e)return!0;let t=dd(r),i=dd(e);if(t||i)return t&&i?r.getTime()===e.getTime():!1;if(t=Li(r),i=Li(e),t||i)return r===e;if(t=Ue(r),i=Ue(e),t||i)return t&&i?lk(r,e):!1;if(t=ft(r),i=ft(e),t||i){if(!t||!i)return!1;const n=Object.keys(r).length,s=Object.keys(e).length;if(n!==s)return!1;for(const a in r){const o=r.hasOwnProperty(a),l=e.hasOwnProperty(a);if(o&&!l||!o&&l||!Uo(r[a],e[a]))return!1}}return String(r)===String(e)}function Ku(r,e){return r.findIndex(t=>Uo(t,e))}const e1=r=>!!(r&&r.__v_isRef===!0),Qt=r=>Dt(r)?r:r==null?"":Ue(r)||ft(r)&&(r.toString===Yg||!je(r.toString))?e1(r)?Qt(r.value):JSON.stringify(r,t1,2):String(r),t1=(r,e)=>e1(e)?t1(r,e.value):Bs(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[i,n],s)=>(t[Ff(i,s)+" =>"]=n,t),{})}:ca(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Ff(t))}:Li(e)?Ff(e):ft(e)&&!Ue(e)&&!Jg(e)?String(e):e,Ff=(r,e="")=>{var t;return Li(r)?`Symbol(${(t=r.description)!=null?t:e})`:r};/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Er;class ck{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Er,!e&&Er&&(this.index=(Er.scopes||(Er.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Er;try{return Er=this,e()}finally{Er=t}}}on(){++this._on===1&&(this.prevScope=Er,Er=this)}off(){this._on>0&&--this._on===0&&(Er=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,i;for(t=0,i=this.effects.length;t<i;t++)this.effects[t].stop();for(this.effects.length=0,t=0,i=this.cleanups.length;t<i;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function fk(){return Er}let ht;const Df=new WeakSet;class r1{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Er&&Er.active&&Er.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Df.has(this)&&(Df.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||n1(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,md(this),s1(this);const e=ht,t=ui;ht=this,ui=!0;try{return this.fn()}finally{a1(this),ht=e,ui=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Yu(e);this.deps=this.depsTail=void 0,md(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Df.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Sh(this)&&this.run()}get dirty(){return Sh(this)}}let i1=0,Ba,Na;function n1(r,e=!1){if(r.flags|=8,e){r.next=Na,Na=r;return}r.next=Ba,Ba=r}function Xu(){i1++}function qu(){if(--i1>0)return;if(Na){let e=Na;for(Na=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let r;for(;Ba;){let e=Ba;for(Ba=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){r||(r=i)}e=t}}if(r)throw r}function s1(r){for(let e=r.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function a1(r){let e,t=r.depsTail,i=t;for(;i;){const n=i.prevDep;i.version===-1?(i===t&&(t=n),Yu(i),hk(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=n}r.deps=e,r.depsTail=t}function Sh(r){for(let e=r.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(o1(e.dep.computed)||e.dep.version!==e.version))return!0;return!!r._dirty}function o1(r){if(r.flags&4&&!(r.flags&16)||(r.flags&=-17,r.globalVersion===oo)||(r.globalVersion=oo,!r.isSSR&&r.flags&128&&(!r.deps&&!r._dirty||!Sh(r))))return;r.flags|=2;const e=r.dep,t=ht,i=ui;ht=r,ui=!0;try{s1(r);const n=r.fn(r._value);(e.version===0||Cn(n,r._value))&&(r.flags|=128,r._value=n,e.version++)}catch(n){throw e.version++,n}finally{ht=t,ui=i,a1(r),r.flags&=-3}}function Yu(r,e=!1){const{dep:t,prevSub:i,nextSub:n}=r;if(i&&(i.nextSub=n,r.prevSub=void 0),n&&(n.prevSub=i,r.nextSub=void 0),t.subs===r&&(t.subs=i,!i&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)Yu(s,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function hk(r){const{prevDep:e,nextDep:t}=r;e&&(e.nextDep=t,r.prevDep=void 0),t&&(t.prevDep=e,r.nextDep=void 0)}let ui=!0;const l1=[];function rn(){l1.push(ui),ui=!1}function nn(){const r=l1.pop();ui=r===void 0?!0:r}function md(r){const{cleanup:e}=r;if(r.cleanup=void 0,e){const t=ht;ht=void 0;try{e()}finally{ht=t}}}let oo=0;class uk{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ju{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!ht||!ui||ht===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==ht)t=this.activeLink=new uk(ht,this),ht.deps?(t.prevDep=ht.depsTail,ht.depsTail.nextDep=t,ht.depsTail=t):ht.deps=ht.depsTail=t,c1(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const i=t.nextDep;i.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=i),t.prevDep=ht.depsTail,t.nextDep=void 0,ht.depsTail.nextDep=t,ht.depsTail=t,ht.deps===t&&(ht.deps=i)}return t}trigger(e){this.version++,oo++,this.notify(e)}notify(e){Xu();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{qu()}}}function c1(r){if(r.dep.sc++,r.sub.flags&4){const e=r.dep.computed;if(e&&!r.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)c1(i)}const t=r.dep.subs;t!==r&&(r.prevSub=t,t&&(t.nextSub=r)),r.dep.subs=r}}const Th=new WeakMap,rs=Symbol(""),Eh=Symbol(""),lo=Symbol("");function rr(r,e,t){if(ui&&ht){let i=Th.get(r);i||Th.set(r,i=new Map);let n=i.get(t);n||(i.set(t,n=new Ju),n.map=i,n.key=t),n.track()}}function Xi(r,e,t,i,n,s){const a=Th.get(r);if(!a){oo++;return}const o=l=>{l&&l.trigger()};if(Xu(),e==="clear")a.forEach(o);else{const l=Ue(r),c=l&&$u(t);if(l&&t==="length"){const f=Number(i);a.forEach((h,u)=>{(u==="length"||u===lo||!Li(u)&&u>=f)&&o(h)})}else switch((t!==void 0||a.has(void 0))&&o(a.get(t)),c&&o(a.get(lo)),e){case"add":l?c&&o(a.get("length")):(o(a.get(rs)),Bs(r)&&o(a.get(Eh)));break;case"delete":l||(o(a.get(rs)),Bs(r)&&o(a.get(Eh)));break;case"set":Bs(r)&&o(a.get(rs));break}}qu()}function _s(r){const e=nt(r);return e===r?e:(rr(e,"iterate",lo),Jr(r)?e:e.map($t))}function sf(r){return rr(r=nt(r),"iterate",lo),r}const dk={__proto__:null,[Symbol.iterator](){return Rf(this,Symbol.iterator,$t)},concat(...r){return _s(this).concat(...r.map(e=>Ue(e)?_s(e):e))},entries(){return Rf(this,"entries",r=>(r[1]=$t(r[1]),r))},every(r,e){return $i(this,"every",r,e,void 0,arguments)},filter(r,e){return $i(this,"filter",r,e,t=>t.map($t),arguments)},find(r,e){return $i(this,"find",r,e,$t,arguments)},findIndex(r,e){return $i(this,"findIndex",r,e,void 0,arguments)},findLast(r,e){return $i(this,"findLast",r,e,$t,arguments)},findLastIndex(r,e){return $i(this,"findLastIndex",r,e,void 0,arguments)},forEach(r,e){return $i(this,"forEach",r,e,void 0,arguments)},includes(...r){return Mf(this,"includes",r)},indexOf(...r){return Mf(this,"indexOf",r)},join(r){return _s(this).join(r)},lastIndexOf(...r){return Mf(this,"lastIndexOf",r)},map(r,e){return $i(this,"map",r,e,void 0,arguments)},pop(){return ya(this,"pop")},push(...r){return ya(this,"push",r)},reduce(r,...e){return gd(this,"reduce",r,e)},reduceRight(r,...e){return gd(this,"reduceRight",r,e)},shift(){return ya(this,"shift")},some(r,e){return $i(this,"some",r,e,void 0,arguments)},splice(...r){return ya(this,"splice",r)},toReversed(){return _s(this).toReversed()},toSorted(r){return _s(this).toSorted(r)},toSpliced(...r){return _s(this).toSpliced(...r)},unshift(...r){return ya(this,"unshift",r)},values(){return Rf(this,"values",$t)}};function Rf(r,e,t){const i=sf(r),n=i[e]();return i!==r&&!Jr(r)&&(n._next=n.next,n.next=()=>{const s=n._next();return s.done||(s.value=t(s.value)),s}),n}const pk=Array.prototype;function $i(r,e,t,i,n,s){const a=sf(r),o=a!==r&&!Jr(r),l=a[e];if(l!==pk[e]){const h=l.apply(r,s);return o?$t(h):h}let c=t;a!==r&&(o?c=function(h,u){return t.call(this,$t(h),u,r)}:t.length>2&&(c=function(h,u){return t.call(this,h,u,r)}));const f=l.call(a,c,i);return o&&n?n(f):f}function gd(r,e,t,i){const n=sf(r);let s=t;return n!==r&&(Jr(r)?t.length>3&&(s=function(a,o,l){return t.call(this,a,o,l,r)}):s=function(a,o,l){return t.call(this,a,$t(o),l,r)}),n[e](s,...i)}function Mf(r,e,t){const i=nt(r);rr(i,"iterate",lo);const n=i[e](...t);return(n===-1||n===!1)&&t0(t[0])?(t[0]=nt(t[0]),i[e](...t)):n}function ya(r,e,t=[]){rn(),Xu();const i=nt(r)[e].apply(r,t);return qu(),nn(),i}const mk=Wu("__proto__,__v_isRef,__isVue"),f1=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(Li));function gk(r){Li(r)||(r=String(r));const e=nt(this);return rr(e,"has",r),e.hasOwnProperty(r)}class h1{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,i){if(t==="__v_skip")return e.__v_skip;const n=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!n;if(t==="__v_isReadonly")return n;if(t==="__v_isShallow")return s;if(t==="__v_raw")return i===(n?s?Ek:m1:s?p1:d1).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const a=Ue(e);if(!n){let l;if(a&&(l=dk[t]))return l;if(t==="hasOwnProperty")return gk}const o=Reflect.get(e,t,or(e)?e:i);if((Li(t)?f1.has(t):mk(t))||(n||rr(e,"get",t),s))return o;if(or(o)){const l=a&&$u(t)?o:o.value;return n&&ft(l)?Ah(l):l}return ft(o)?n?Ah(o):Qu(o):o}}class u1 extends h1{constructor(e=!1){super(!1,e)}set(e,t,i,n){let s=e[t];if(!this._isShallow){const l=Fn(s);if(!Jr(i)&&!Fn(i)&&(s=nt(s),i=nt(i)),!Ue(e)&&or(s)&&!or(i))return l||(s.value=i),!0}const a=Ue(e)&&$u(t)?Number(t)<e.length:st(e,t),o=Reflect.set(e,t,i,or(e)?e:n);return e===nt(n)&&(a?Cn(i,s)&&Xi(e,"set",t,i):Xi(e,"add",t,i)),o}deleteProperty(e,t){const i=st(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&i&&Xi(e,"delete",t,void 0),n}has(e,t){const i=Reflect.has(e,t);return(!Li(t)||!f1.has(t))&&rr(e,"has",t),i}ownKeys(e){return rr(e,"iterate",Ue(e)?"length":rs),Reflect.ownKeys(e)}}class xk extends h1{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const vk=new u1,yk=new xk,wk=new u1(!0);const Ch=r=>r,ol=r=>Reflect.getPrototypeOf(r);function kk(r,e,t){return function(...i){const n=this.__v_raw,s=nt(n),a=Bs(s),o=r==="entries"||r===Symbol.iterator&&a,l=r==="keys"&&a,c=n[r](...i),f=t?Ch:e?ac:$t;return!e&&rr(s,"iterate",l?Eh:rs),{next(){const{value:h,done:u}=c.next();return u?{value:h,done:u}:{value:o?[f(h[0]),f(h[1])]:f(h),done:u}},[Symbol.iterator](){return this}}}}function ll(r){return function(...e){return r==="delete"?!1:r==="clear"?void 0:this}}function bk(r,e){const t={get(n){const s=this.__v_raw,a=nt(s),o=nt(n);r||(Cn(n,o)&&rr(a,"get",n),rr(a,"get",o));const{has:l}=ol(a),c=e?Ch:r?ac:$t;if(l.call(a,n))return c(s.get(n));if(l.call(a,o))return c(s.get(o));s!==a&&s.get(n)},get size(){const n=this.__v_raw;return!r&&rr(nt(n),"iterate",rs),n.size},has(n){const s=this.__v_raw,a=nt(s),o=nt(n);return r||(Cn(n,o)&&rr(a,"has",n),rr(a,"has",o)),n===o?s.has(n):s.has(n)||s.has(o)},forEach(n,s){const a=this,o=a.__v_raw,l=nt(o),c=e?Ch:r?ac:$t;return!r&&rr(l,"iterate",rs),o.forEach((f,h)=>n.call(s,c(f),c(h),a))}};return cr(t,r?{add:ll("add"),set:ll("set"),delete:ll("delete"),clear:ll("clear")}:{add(n){!e&&!Jr(n)&&!Fn(n)&&(n=nt(n));const s=nt(this);return ol(s).has.call(s,n)||(s.add(n),Xi(s,"add",n,n)),this},set(n,s){!e&&!Jr(s)&&!Fn(s)&&(s=nt(s));const a=nt(this),{has:o,get:l}=ol(a);let c=o.call(a,n);c||(n=nt(n),c=o.call(a,n));const f=l.call(a,n);return a.set(n,s),c?Cn(s,f)&&Xi(a,"set",n,s):Xi(a,"add",n,s),this},delete(n){const s=nt(this),{has:a,get:o}=ol(s);let l=a.call(s,n);l||(n=nt(n),l=a.call(s,n)),o&&o.call(s,n);const c=s.delete(n);return l&&Xi(s,"delete",n,void 0),c},clear(){const n=nt(this),s=n.size!==0,a=n.clear();return s&&Xi(n,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(n=>{t[n]=kk(n,r,e)}),t}function Zu(r,e){const t=bk(r,e);return(i,n,s)=>n==="__v_isReactive"?!r:n==="__v_isReadonly"?r:n==="__v_raw"?i:Reflect.get(st(t,n)&&n in i?t:i,n,s)}const _k={get:Zu(!1,!1)},Sk={get:Zu(!1,!0)},Tk={get:Zu(!0,!1)};const d1=new WeakMap,p1=new WeakMap,m1=new WeakMap,Ek=new WeakMap;function Ck(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ak(r){return r.__v_skip||!Object.isExtensible(r)?0:Ck(Qw(r))}function Qu(r){return Fn(r)?r:e0(r,!1,vk,_k,d1)}function Ok(r){return e0(r,!1,wk,Sk,p1)}function Ah(r){return e0(r,!0,yk,Tk,m1)}function e0(r,e,t,i,n){if(!ft(r)||r.__v_raw&&!(e&&r.__v_isReactive))return r;const s=Ak(r);if(s===0)return r;const a=n.get(r);if(a)return a;const o=new Proxy(r,s===2?i:t);return n.set(r,o),o}function Ns(r){return Fn(r)?Ns(r.__v_raw):!!(r&&r.__v_isReactive)}function Fn(r){return!!(r&&r.__v_isReadonly)}function Jr(r){return!!(r&&r.__v_isShallow)}function t0(r){return r?!!r.__v_raw:!1}function nt(r){const e=r&&r.__v_raw;return e?nt(e):r}function Fk(r){return!st(r,"__v_skip")&&Object.isExtensible(r)&&Zg(r,"__v_skip",!0),r}const $t=r=>ft(r)?Qu(r):r,ac=r=>ft(r)?Ah(r):r;function or(r){return r?r.__v_isRef===!0:!1}function If(r){return Dk(r,!0)}function Dk(r,e){return or(r)?r:new Rk(r,e)}class Rk{constructor(e,t){this.dep=new Ju,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:nt(e),this._value=t?e:$t(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,i=this.__v_isShallow||Jr(e)||Fn(e);e=i?e:nt(e),Cn(e,t)&&(this._rawValue=e,this._value=i?e:$t(e),this.dep.trigger())}}function Mk(r){return or(r)?r.value:r}const Ik={get:(r,e,t)=>e==="__v_raw"?r:Mk(Reflect.get(r,e,t)),set:(r,e,t,i)=>{const n=r[e];return or(n)&&!or(t)?(n.value=t,!0):Reflect.set(r,e,t,i)}};function g1(r){return Ns(r)?r:new Proxy(r,Ik)}class Pk{constructor(e,t,i){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Ju(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=oo-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&ht!==this)return n1(this,!0),!0}get value(){const e=this.dep.track();return o1(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Lk(r,e,t=!1){let i,n;return je(r)?i=r:(i=r.get,n=r.set),new Pk(i,n,t)}const cl={},oc=new WeakMap;let Xn;function Bk(r,e=!1,t=Xn){if(t){let i=oc.get(t);i||oc.set(t,i=[]),i.push(r)}}function Nk(r,e,t=lt){const{immediate:i,deep:n,once:s,scheduler:a,augmentJob:o,call:l}=t,c=T=>n?T:Jr(T)||n===!1||n===0?qi(T,1):qi(T);let f,h,u,d,m=!1,p=!1;if(or(r)?(h=()=>r.value,m=Jr(r)):Ns(r)?(h=()=>c(r),m=!0):Ue(r)?(p=!0,m=r.some(T=>Ns(T)||Jr(T)),h=()=>r.map(T=>{if(or(T))return T.value;if(Ns(T))return c(T);if(je(T))return l?l(T,2):T()})):je(r)?e?h=l?()=>l(r,2):r:h=()=>{if(u){rn();try{u()}finally{nn()}}const T=Xn;Xn=f;try{return l?l(r,3,[d]):r(d)}finally{Xn=T}}:h=Ii,e&&n){const T=h,C=n===!0?1/0:n;h=()=>qi(T(),C)}const g=fk(),x=()=>{f.stop(),g&&g.active&&ju(g.effects,f)};if(s&&e){const T=e;e=(...C)=>{T(...C),x()}}let y=p?new Array(r.length).fill(cl):cl;const w=T=>{if(!(!(f.flags&1)||!f.dirty&&!T))if(e){const C=f.run();if(n||m||(p?C.some((R,_)=>Cn(R,y[_])):Cn(C,y))){u&&u();const R=Xn;Xn=f;try{const _=[C,y===cl?void 0:p&&y[0]===cl?[]:y,d];y=C,l?l(e,3,_):e(..._)}finally{Xn=R}}}else f.run()};return o&&o(w),f=new r1(h),f.scheduler=a?()=>a(w,!1):w,d=T=>Bk(T,!1,f),u=f.onStop=()=>{const T=oc.get(f);if(T){if(l)l(T,4);else for(const C of T)C();oc.delete(f)}},e?i?w(!0):y=f.run():a?a(w.bind(null,!0),!0):f.run(),x.pause=f.pause.bind(f),x.resume=f.resume.bind(f),x.stop=x,x}function qi(r,e=1/0,t){if(e<=0||!ft(r)||r.__v_skip||(t=t||new Map,(t.get(r)||0)>=e))return r;if(t.set(r,e),e--,or(r))qi(r.value,e,t);else if(Ue(r))for(let i=0;i<r.length;i++)qi(r[i],e,t);else if(ca(r)||Bs(r))r.forEach(i=>{qi(i,e,t)});else if(Jg(r)){for(const i in r)qi(r[i],e,t);for(const i of Object.getOwnPropertySymbols(r))Object.prototype.propertyIsEnumerable.call(r,i)&&qi(r[i],e,t)}return r}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ho(r,e,t,i){try{return i?r(...i):r()}catch(n){af(n,e,t)}}function Bi(r,e,t,i){if(je(r)){const n=Ho(r,e,t,i);return n&&qg(n)&&n.catch(s=>{af(s,e,t)}),n}if(Ue(r)){const n=[];for(let s=0;s<r.length;s++)n.push(Bi(r[s],e,t,i));return n}}function af(r,e,t,i=!0){const n=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:a}=e&&e.appContext.config||lt;if(e){let o=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;o;){const f=o.ec;if(f){for(let h=0;h<f.length;h++)if(f[h](r,l,c)===!1)return}o=o.parent}if(s){rn(),Ho(s,null,10,[r,l,c]),nn();return}}Uk(r,t,n,i,a)}function Uk(r,e,t,i=!0,n=!1){if(n)throw r;console.error(r)}const gr=[];let Ti=-1;const Us=[];let pn=null,Es=0;const x1=Promise.resolve();let lc=null;function v1(r){const e=lc||x1;return r?e.then(this?r.bind(this):r):e}function Hk(r){let e=Ti+1,t=gr.length;for(;e<t;){const i=e+t>>>1,n=gr[i],s=co(n);s<r||s===r&&n.flags&2?e=i+1:t=i}return e}function r0(r){if(!(r.flags&1)){const e=co(r),t=gr[gr.length-1];!t||!(r.flags&2)&&e>=co(t)?gr.push(r):gr.splice(Hk(e),0,r),r.flags|=1,y1()}}function y1(){lc||(lc=x1.then(k1))}function zk(r){Ue(r)?Us.push(...r):pn&&r.id===-1?pn.splice(Es+1,0,r):r.flags&1||(Us.push(r),r.flags|=1),y1()}function xd(r,e,t=Ti+1){for(;t<gr.length;t++){const i=gr[t];if(i&&i.flags&2){if(r&&i.id!==r.uid)continue;gr.splice(t,1),t--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function w1(r){if(Us.length){const e=[...new Set(Us)].sort((t,i)=>co(t)-co(i));if(Us.length=0,pn){pn.push(...e);return}for(pn=e,Es=0;Es<pn.length;Es++){const t=pn[Es];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}pn=null,Es=0}}const co=r=>r.id==null?r.flags&2?-1:1/0:r.id;function k1(r){try{for(Ti=0;Ti<gr.length;Ti++){const e=gr[Ti];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Ho(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Ti<gr.length;Ti++){const e=gr[Ti];e&&(e.flags&=-2)}Ti=-1,gr.length=0,w1(),lc=null,(gr.length||Us.length)&&k1()}}let zr=null,b1=null;function cc(r){const e=zr;return zr=r,b1=r&&r.type.__scopeId||null,e}function Wk(r,e=zr,t){if(!e||r._n)return r;const i=(...n)=>{i._d&&uc(-1);const s=cc(e);let a;try{a=r(...n)}finally{cc(s),i._d&&uc(1)}return a};return i._n=!0,i._c=!0,i._d=!0,i}function Ua(r,e){if(zr===null)return r;const t=ff(zr),i=r.dirs||(r.dirs=[]);for(let n=0;n<e.length;n++){let[s,a,o,l=lt]=e[n];s&&(je(s)&&(s={mounted:s,updated:s}),s.deep&&qi(a),i.push({dir:s,instance:t,value:a,oldValue:void 0,arg:o,modifiers:l}))}return r}function $n(r,e,t,i){const n=r.dirs,s=e&&e.dirs;for(let a=0;a<n.length;a++){const o=n[a];s&&(o.oldValue=s[a].value);let l=o.dir[i];l&&(rn(),Bi(l,t,8,[r.el,o,r,e]),nn())}}const Vk=Symbol("_vte"),jk=r=>r.__isTeleport,$k=Symbol("_leaveCb");function i0(r,e){r.shapeFlag&6&&r.component?(r.transition=e,i0(r.component.subTree,e)):r.shapeFlag&128?(r.ssContent.transition=e.clone(r.ssContent),r.ssFallback.transition=e.clone(r.ssFallback)):r.transition=e}function _1(r,e){return je(r)?cr({name:r.name},e,{setup:r}):r}function S1(r){r.ids=[r.ids[0]+r.ids[2]+++"-",0,0]}const fc=new WeakMap;function Ha(r,e,t,i,n=!1){if(Ue(r)){r.forEach((m,p)=>Ha(m,e&&(Ue(e)?e[p]:e),t,i,n));return}if(za(i)&&!n){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&Ha(r,e,t,i.component.subTree);return}const s=i.shapeFlag&4?ff(i.component):i.el,a=n?null:s,{i:o,r:l}=r,c=e&&e.r,f=o.refs===lt?o.refs={}:o.refs,h=o.setupState,u=nt(h),d=h===lt?Xg:m=>st(u,m);if(c!=null&&c!==l){if(vd(e),Dt(c))f[c]=null,d(c)&&(h[c]=null);else if(or(c)){c.value=null;const m=e;m.k&&(f[m.k]=null)}}if(je(l))Ho(l,o,12,[a,f]);else{const m=Dt(l),p=or(l);if(m||p){const g=()=>{if(r.f){const x=m?d(l)?h[l]:f[l]:l.value;if(n)Ue(x)&&ju(x,s);else if(Ue(x))x.includes(s)||x.push(s);else if(m)f[l]=[s],d(l)&&(h[l]=f[l]);else{const y=[s];l.value=y,r.k&&(f[r.k]=y)}}else m?(f[l]=a,d(l)&&(h[l]=a)):p&&(l.value=a,r.k&&(f[r.k]=a))};if(a){const x=()=>{g(),fc.delete(r)};x.id=-1,fc.set(r,x),Br(x,t)}else vd(r),g()}}}function vd(r){const e=fc.get(r);e&&(e.flags|=8,fc.delete(r))}rf().requestIdleCallback;rf().cancelIdleCallback;const za=r=>!!r.type.__asyncLoader,T1=r=>r.type.__isKeepAlive;function Gk(r,e){E1(r,"a",e)}function Kk(r,e){E1(r,"da",e)}function E1(r,e,t=ir){const i=r.__wdc||(r.__wdc=()=>{let n=t;for(;n;){if(n.isDeactivated)return;n=n.parent}return r()});if(of(e,i,t),t){let n=t.parent;for(;n&&n.parent;)T1(n.parent.vnode)&&Xk(i,e,t,n),n=n.parent}}function Xk(r,e,t,i){const n=of(e,r,i,!0);O1(()=>{ju(i[e],n)},t)}function of(r,e,t=ir,i=!1){if(t){const n=t[r]||(t[r]=[]),s=e.__weh||(e.__weh=(...a)=>{rn();const o=zo(t),l=Bi(e,t,r,a);return o(),nn(),l});return i?n.unshift(s):n.push(s),s}}const cn=r=>(e,t=ir)=>{(!ho||r==="sp")&&of(r,(...i)=>e(...i),t)},qk=cn("bm"),C1=cn("m"),Yk=cn("bu"),Jk=cn("u"),A1=cn("bum"),O1=cn("um"),Zk=cn("sp"),Qk=cn("rtg"),eb=cn("rtc");function tb(r,e=ir){of("ec",r,e)}const rb="components";function Oh(r,e){return nb(rb,r,!0,e)||r}const ib=Symbol.for("v-ndc");function nb(r,e,t=!0,i=!1){const n=zr||ir;if(n){const s=n.type;{const o=Kb(s,!1);if(o&&(o===e||o===ei(e)||o===tf(ei(e))))return s}const a=yd(n[r]||s[r],e)||yd(n.appContext[r],e);return!a&&i?s:a}}function yd(r,e){return r&&(r[e]||r[ei(e)]||r[tf(ei(e))])}function Ei(r,e,t,i){let n;const s=t,a=Ue(r);if(a||Dt(r)){const o=a&&Ns(r);let l=!1,c=!1;o&&(l=!Jr(r),c=Fn(r),r=sf(r)),n=new Array(r.length);for(let f=0,h=r.length;f<h;f++)n[f]=e(l?c?ac($t(r[f])):$t(r[f]):r[f],f,void 0,s)}else if(typeof r=="number"){n=new Array(r);for(let o=0;o<r;o++)n[o]=e(o+1,o,void 0,s)}else if(ft(r))if(r[Symbol.iterator])n=Array.from(r,(o,l)=>e(o,l,void 0,s));else{const o=Object.keys(r);n=new Array(o.length);for(let l=0,c=o.length;l<c;l++){const f=o[l];n[l]=e(r[f],f,l,s)}}else n=[];return n}const Fh=r=>r?Y1(r)?ff(r):Fh(r.parent):null,Wa=cr(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>Fh(r.parent),$root:r=>Fh(r.root),$host:r=>r.ce,$emit:r=>r.emit,$options:r=>D1(r),$forceUpdate:r=>r.f||(r.f=()=>{r0(r.update)}),$nextTick:r=>r.n||(r.n=v1.bind(r.proxy)),$watch:r=>Eb.bind(r)}),Pf=(r,e)=>r!==lt&&!r.__isScriptSetup&&st(r,e),sb={get({_:r},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:i,data:n,props:s,accessCache:a,type:o,appContext:l}=r;let c;if(e[0]!=="$"){const d=a[e];if(d!==void 0)switch(d){case 1:return i[e];case 2:return n[e];case 4:return t[e];case 3:return s[e]}else{if(Pf(i,e))return a[e]=1,i[e];if(n!==lt&&st(n,e))return a[e]=2,n[e];if((c=r.propsOptions[0])&&st(c,e))return a[e]=3,s[e];if(t!==lt&&st(t,e))return a[e]=4,t[e];Dh&&(a[e]=0)}}const f=Wa[e];let h,u;if(f)return e==="$attrs"&&rr(r.attrs,"get",""),f(r);if((h=o.__cssModules)&&(h=h[e]))return h;if(t!==lt&&st(t,e))return a[e]=4,t[e];if(u=l.config.globalProperties,st(u,e))return u[e]},set({_:r},e,t){const{data:i,setupState:n,ctx:s}=r;return Pf(n,e)?(n[e]=t,!0):i!==lt&&st(i,e)?(i[e]=t,!0):st(r.props,e)||e[0]==="$"&&e.slice(1)in r?!1:(s[e]=t,!0)},has({_:{data:r,setupState:e,accessCache:t,ctx:i,appContext:n,propsOptions:s,type:a}},o){let l,c;return!!(t[o]||r!==lt&&o[0]!=="$"&&st(r,o)||Pf(e,o)||(l=s[0])&&st(l,o)||st(i,o)||st(Wa,o)||st(n.config.globalProperties,o)||(c=a.__cssModules)&&c[o])},defineProperty(r,e,t){return t.get!=null?r._.accessCache[e]=0:st(t,"value")&&this.set(r,e,t.value,null),Reflect.defineProperty(r,e,t)}};function wd(r){return Ue(r)?r.reduce((e,t)=>(e[t]=null,e),{}):r}let Dh=!0;function ab(r){const e=D1(r),t=r.proxy,i=r.ctx;Dh=!1,e.beforeCreate&&kd(e.beforeCreate,r,"bc");const{data:n,computed:s,methods:a,watch:o,provide:l,inject:c,created:f,beforeMount:h,mounted:u,beforeUpdate:d,updated:m,activated:p,deactivated:g,beforeDestroy:x,beforeUnmount:y,destroyed:w,unmounted:T,render:C,renderTracked:R,renderTriggered:_,errorCaptured:A,serverPrefetch:k,expose:I,inheritAttrs:N,components:S,directives:W,filters:E}=e;if(c&&ob(c,i,null),a)for(const Z in a){const xe=a[Z];je(xe)&&(i[Z]=xe.bind(t))}if(n){const Z=n.call(t,t);ft(Z)&&(r.data=Qu(Z))}if(Dh=!0,s)for(const Z in s){const xe=s[Z],L=je(xe)?xe.bind(t,t):je(xe.get)?xe.get.bind(t,t):Ii,ge=!je(xe)&&je(xe.set)?xe.set.bind(t):Ii,Y=Z1({get:L,set:ge});Object.defineProperty(i,Z,{enumerable:!0,configurable:!0,get:()=>Y.value,set:O=>Y.value=O})}if(o)for(const Z in o)F1(o[Z],i,t,Z);if(l){const Z=je(l)?l.call(t):l;Reflect.ownKeys(Z).forEach(xe=>{db(xe,Z[xe])})}f&&kd(f,r,"c");function ae(Z,xe){Ue(xe)?xe.forEach(L=>Z(L.bind(t))):xe&&Z(xe.bind(t))}if(ae(qk,h),ae(C1,u),ae(Yk,d),ae(Jk,m),ae(Gk,p),ae(Kk,g),ae(tb,A),ae(eb,R),ae(Qk,_),ae(A1,y),ae(O1,T),ae(Zk,k),Ue(I))if(I.length){const Z=r.exposed||(r.exposed={});I.forEach(xe=>{Object.defineProperty(Z,xe,{get:()=>t[xe],set:L=>t[xe]=L,enumerable:!0})})}else r.exposed||(r.exposed={});C&&r.render===Ii&&(r.render=C),N!=null&&(r.inheritAttrs=N),S&&(r.components=S),W&&(r.directives=W),k&&S1(r)}function ob(r,e,t=Ii){Ue(r)&&(r=Rh(r));for(const i in r){const n=r[i];let s;ft(n)?"default"in n?s=Va(n.from||i,n.default,!0):s=Va(n.from||i):s=Va(n),or(s)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:a=>s.value=a}):e[i]=s}}function kd(r,e,t){Bi(Ue(r)?r.map(i=>i.bind(e.proxy)):r.bind(e.proxy),e,t)}function F1(r,e,t,i){let n=i.includes(".")?j1(t,i):()=>t[i];if(Dt(r)){const s=e[r];je(s)&&oi(n,s)}else if(je(r))oi(n,r.bind(t));else if(ft(r))if(Ue(r))r.forEach(s=>F1(s,e,t,i));else{const s=je(r.handler)?r.handler.bind(t):e[r.handler];je(s)&&oi(n,s,r)}}function D1(r){const e=r.type,{mixins:t,extends:i}=e,{mixins:n,optionsCache:s,config:{optionMergeStrategies:a}}=r.appContext,o=s.get(e);let l;return o?l=o:!n.length&&!t&&!i?l=e:(l={},n.length&&n.forEach(c=>hc(l,c,a,!0)),hc(l,e,a)),ft(e)&&s.set(e,l),l}function hc(r,e,t,i=!1){const{mixins:n,extends:s}=e;s&&hc(r,s,t,!0),n&&n.forEach(a=>hc(r,a,t,!0));for(const a in e)if(!(i&&a==="expose")){const o=lb[a]||t&&t[a];r[a]=o?o(r[a],e[a]):e[a]}return r}const lb={data:bd,props:_d,emits:_d,methods:Ca,computed:Ca,beforeCreate:pr,created:pr,beforeMount:pr,mounted:pr,beforeUpdate:pr,updated:pr,beforeDestroy:pr,beforeUnmount:pr,destroyed:pr,unmounted:pr,activated:pr,deactivated:pr,errorCaptured:pr,serverPrefetch:pr,components:Ca,directives:Ca,watch:fb,provide:bd,inject:cb};function bd(r,e){return e?r?function(){return cr(je(r)?r.call(this,this):r,je(e)?e.call(this,this):e)}:e:r}function cb(r,e){return Ca(Rh(r),Rh(e))}function Rh(r){if(Ue(r)){const e={};for(let t=0;t<r.length;t++)e[r[t]]=r[t];return e}return r}function pr(r,e){return r?[...new Set([].concat(r,e))]:e}function Ca(r,e){return r?cr(Object.create(null),r,e):e}function _d(r,e){return r?Ue(r)&&Ue(e)?[...new Set([...r,...e])]:cr(Object.create(null),wd(r),wd(e??{})):e}function fb(r,e){if(!r)return e;if(!e)return r;const t=cr(Object.create(null),r);for(const i in e)t[i]=pr(r[i],e[i]);return t}function R1(){return{app:null,config:{isNativeTag:Xg,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let hb=0;function ub(r,e){return function(i,n=null){je(i)||(i=cr({},i)),n!=null&&!ft(n)&&(n=null);const s=R1(),a=new WeakSet,o=[];let l=!1;const c=s.app={_uid:hb++,_component:i,_props:n,_container:null,_context:s,_instance:null,version:Yb,get config(){return s.config},set config(f){},use(f,...h){return a.has(f)||(f&&je(f.install)?(a.add(f),f.install(c,...h)):je(f)&&(a.add(f),f(c,...h))),c},mixin(f){return s.mixins.includes(f)||s.mixins.push(f),c},component(f,h){return h?(s.components[f]=h,c):s.components[f]},directive(f,h){return h?(s.directives[f]=h,c):s.directives[f]},mount(f,h,u){if(!l){const d=c._ceVNode||wr(i,n);return d.appContext=s,u===!0?u="svg":u===!1&&(u=void 0),r(d,f,u),l=!0,c._container=f,f.__vue_app__=c,ff(d.component)}},onUnmount(f){o.push(f)},unmount(){l&&(Bi(o,c._instance,16),r(null,c._container),delete c._container.__vue_app__)},provide(f,h){return s.provides[f]=h,c},runWithContext(f){const h=Hs;Hs=c;try{return f()}finally{Hs=h}}};return c}}let Hs=null;function db(r,e){if(ir){let t=ir.provides;const i=ir.parent&&ir.parent.provides;i===t&&(t=ir.provides=Object.create(i)),t[r]=e}}function Va(r,e,t=!1){const i=Wb();if(i||Hs){let n=Hs?Hs._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(n&&r in n)return n[r];if(arguments.length>1)return t&&je(e)?e.call(i&&i.proxy):e}}const M1={},I1=()=>Object.create(M1),P1=r=>Object.getPrototypeOf(r)===M1;function pb(r,e,t,i=!1){const n={},s=I1();r.propsDefaults=Object.create(null),L1(r,e,n,s);for(const a in r.propsOptions[0])a in n||(n[a]=void 0);t?r.props=i?n:Ok(n):r.type.props?r.props=n:r.props=s,r.attrs=s}function mb(r,e,t,i){const{props:n,attrs:s,vnode:{patchFlag:a}}=r,o=nt(n),[l]=r.propsOptions;let c=!1;if((i||a>0)&&!(a&16)){if(a&8){const f=r.vnode.dynamicProps;for(let h=0;h<f.length;h++){let u=f[h];if(lf(r.emitsOptions,u))continue;const d=e[u];if(l)if(st(s,u))d!==s[u]&&(s[u]=d,c=!0);else{const m=ei(u);n[m]=Mh(l,o,m,d,r,!1)}else d!==s[u]&&(s[u]=d,c=!0)}}}else{L1(r,e,n,s)&&(c=!0);let f;for(const h in o)(!e||!st(e,h)&&((f=ms(h))===h||!st(e,f)))&&(l?t&&(t[h]!==void 0||t[f]!==void 0)&&(n[h]=Mh(l,o,h,void 0,r,!0)):delete n[h]);if(s!==o)for(const h in s)(!e||!st(e,h))&&(delete s[h],c=!0)}c&&Xi(r.attrs,"set","")}function L1(r,e,t,i){const[n,s]=r.propsOptions;let a=!1,o;if(e)for(let l in e){if(La(l))continue;const c=e[l];let f;n&&st(n,f=ei(l))?!s||!s.includes(f)?t[f]=c:(o||(o={}))[f]=c:lf(r.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,a=!0)}if(s){const l=nt(t),c=o||lt;for(let f=0;f<s.length;f++){const h=s[f];t[h]=Mh(n,l,h,c[h],r,!st(c,h))}}return a}function Mh(r,e,t,i,n,s){const a=r[t];if(a!=null){const o=st(a,"default");if(o&&i===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&je(l)){const{propsDefaults:c}=n;if(t in c)i=c[t];else{const f=zo(n);i=c[t]=l.call(null,e),f()}}else i=l;n.ce&&n.ce._setProp(t,i)}a[0]&&(s&&!o?i=!1:a[1]&&(i===""||i===ms(t))&&(i=!0))}return i}const gb=new WeakMap;function B1(r,e,t=!1){const i=t?gb:e.propsCache,n=i.get(r);if(n)return n;const s=r.props,a={},o=[];let l=!1;if(!je(r)){const f=h=>{l=!0;const[u,d]=B1(h,e,!0);cr(a,u),d&&o.push(...d)};!t&&e.mixins.length&&e.mixins.forEach(f),r.extends&&f(r.extends),r.mixins&&r.mixins.forEach(f)}if(!s&&!l)return ft(r)&&i.set(r,Ls),Ls;if(Ue(s))for(let f=0;f<s.length;f++){const h=ei(s[f]);Sd(h)&&(a[h]=lt)}else if(s)for(const f in s){const h=ei(f);if(Sd(h)){const u=s[f],d=a[h]=Ue(u)||je(u)?{type:u}:cr({},u),m=d.type;let p=!1,g=!0;if(Ue(m))for(let x=0;x<m.length;++x){const y=m[x],w=je(y)&&y.name;if(w==="Boolean"){p=!0;break}else w==="String"&&(g=!1)}else p=je(m)&&m.name==="Boolean";d[0]=p,d[1]=g,(p||st(d,"default"))&&o.push(h)}}const c=[a,o];return ft(r)&&i.set(r,c),c}function Sd(r){return r[0]!=="$"&&!La(r)}const n0=r=>r==="_"||r==="_ctx"||r==="$stable",s0=r=>Ue(r)?r.map(Ci):[Ci(r)],xb=(r,e,t)=>{if(e._n)return e;const i=Wk((...n)=>s0(e(...n)),t);return i._c=!1,i},N1=(r,e,t)=>{const i=r._ctx;for(const n in r){if(n0(n))continue;const s=r[n];if(je(s))e[n]=xb(n,s,i);else if(s!=null){const a=s0(s);e[n]=()=>a}}},U1=(r,e)=>{const t=s0(e);r.slots.default=()=>t},H1=(r,e,t)=>{for(const i in e)(t||!n0(i))&&(r[i]=e[i])},vb=(r,e,t)=>{const i=r.slots=I1();if(r.vnode.shapeFlag&32){const n=e._;n?(H1(i,e,t),t&&Zg(i,"_",n,!0)):N1(e,i)}else e&&U1(r,e)},yb=(r,e,t)=>{const{vnode:i,slots:n}=r;let s=!0,a=lt;if(i.shapeFlag&32){const o=e._;o?t&&o===1?s=!1:H1(n,e,t):(s=!e.$stable,N1(e,n)),a=e}else e&&(U1(r,e),a={default:1});if(s)for(const o in n)!n0(o)&&a[o]==null&&delete n[o]},Br=Ib;function wb(r){return kb(r)}function kb(r,e){const t=rf();t.__VUE__=!0;const{insert:i,remove:n,patchProp:s,createElement:a,createText:o,createComment:l,setText:c,setElementText:f,parentNode:h,nextSibling:u,setScopeId:d=Ii,insertStaticContent:m}=r,p=(b,J,v,K=null,P=null,F=null,D=void 0,U=null,te=!!J.dynamicChildren)=>{if(b===J)return;b&&!wa(b,J)&&(K=ye(b),O(b,P,F,!0),b=null),J.patchFlag===-2&&(te=!1,J.dynamicChildren=null);const{type:re,ref:ee,shapeFlag:ie}=J;switch(re){case cf:g(b,J,v,K);break;case Dn:x(b,J,v,K);break;case Bf:b==null&&y(J,v,K,D);break;case It:S(b,J,v,K,P,F,D,U,te);break;default:ie&1?C(b,J,v,K,P,F,D,U,te):ie&6?W(b,J,v,K,P,F,D,U,te):(ie&64||ie&128)&&re.process(b,J,v,K,P,F,D,U,te,pe)}ee!=null&&P?Ha(ee,b&&b.ref,F,J||b,!J):ee==null&&b&&b.ref!=null&&Ha(b.ref,null,F,b,!0)},g=(b,J,v,K)=>{if(b==null)i(J.el=o(J.children),v,K);else{const P=J.el=b.el;J.children!==b.children&&c(P,J.children)}},x=(b,J,v,K)=>{b==null?i(J.el=l(J.children||""),v,K):J.el=b.el},y=(b,J,v,K)=>{[b.el,b.anchor]=m(b.children,J,v,K,b.el,b.anchor)},w=({el:b,anchor:J},v,K)=>{let P;for(;b&&b!==J;)P=u(b),i(b,v,K),b=P;i(J,v,K)},T=({el:b,anchor:J})=>{let v;for(;b&&b!==J;)v=u(b),n(b),b=v;n(J)},C=(b,J,v,K,P,F,D,U,te)=>{J.type==="svg"?D="svg":J.type==="math"&&(D="mathml"),b==null?R(J,v,K,P,F,D,U,te):k(b,J,P,F,D,U,te)},R=(b,J,v,K,P,F,D,U)=>{let te,re;const{props:ee,shapeFlag:ie,transition:le,dirs:ce}=b;if(te=b.el=a(b.type,F,ee&&ee.is,ee),ie&8?f(te,b.children):ie&16&&A(b.children,te,null,K,P,Lf(b,F),D,U),ce&&$n(b,null,K,"created"),_(te,b,b.scopeId,D,K),ee){for(const Ae in ee)Ae!=="value"&&!La(Ae)&&s(te,Ae,null,ee[Ae],F,K);"value"in ee&&s(te,"value",null,ee.value,F),(re=ee.onVnodeBeforeMount)&&vi(re,K,b)}ce&&$n(b,null,K,"beforeMount");const we=bb(P,le);we&&le.beforeEnter(te),i(te,J,v),((re=ee&&ee.onVnodeMounted)||we||ce)&&Br(()=>{re&&vi(re,K,b),we&&le.enter(te),ce&&$n(b,null,K,"mounted")},P)},_=(b,J,v,K,P)=>{if(v&&d(b,v),K)for(let F=0;F<K.length;F++)d(b,K[F]);if(P){let F=P.subTree;if(J===F||G1(F.type)&&(F.ssContent===J||F.ssFallback===J)){const D=P.vnode;_(b,D,D.scopeId,D.slotScopeIds,P.parent)}}},A=(b,J,v,K,P,F,D,U,te=0)=>{for(let re=te;re<b.length;re++){const ee=b[re]=U?mn(b[re]):Ci(b[re]);p(null,ee,J,v,K,P,F,D,U)}},k=(b,J,v,K,P,F,D)=>{const U=J.el=b.el;let{patchFlag:te,dynamicChildren:re,dirs:ee}=J;te|=b.patchFlag&16;const ie=b.props||lt,le=J.props||lt;let ce;if(v&&Gn(v,!1),(ce=le.onVnodeBeforeUpdate)&&vi(ce,v,J,b),ee&&$n(J,b,v,"beforeUpdate"),v&&Gn(v,!0),(ie.innerHTML&&le.innerHTML==null||ie.textContent&&le.textContent==null)&&f(U,""),re?I(b.dynamicChildren,re,U,v,K,Lf(J,P),F):D||xe(b,J,U,null,v,K,Lf(J,P),F,!1),te>0){if(te&16)N(U,ie,le,v,P);else if(te&2&&ie.class!==le.class&&s(U,"class",null,le.class,P),te&4&&s(U,"style",ie.style,le.style,P),te&8){const we=J.dynamicProps;for(let Ae=0;Ae<we.length;Ae++){const Se=we[Ae],$e=ie[Se],Ie=le[Se];(Ie!==$e||Se==="value")&&s(U,Se,$e,Ie,P,v)}}te&1&&b.children!==J.children&&f(U,J.children)}else!D&&re==null&&N(U,ie,le,v,P);((ce=le.onVnodeUpdated)||ee)&&Br(()=>{ce&&vi(ce,v,J,b),ee&&$n(J,b,v,"updated")},K)},I=(b,J,v,K,P,F,D)=>{for(let U=0;U<J.length;U++){const te=b[U],re=J[U],ee=te.el&&(te.type===It||!wa(te,re)||te.shapeFlag&198)?h(te.el):v;p(te,re,ee,null,K,P,F,D,!0)}},N=(b,J,v,K,P)=>{if(J!==v){if(J!==lt)for(const F in J)!La(F)&&!(F in v)&&s(b,F,J[F],null,P,K);for(const F in v){if(La(F))continue;const D=v[F],U=J[F];D!==U&&F!=="value"&&s(b,F,U,D,P,K)}"value"in v&&s(b,"value",J.value,v.value,P)}},S=(b,J,v,K,P,F,D,U,te)=>{const re=J.el=b?b.el:o(""),ee=J.anchor=b?b.anchor:o("");let{patchFlag:ie,dynamicChildren:le,slotScopeIds:ce}=J;ce&&(U=U?U.concat(ce):ce),b==null?(i(re,v,K),i(ee,v,K),A(J.children||[],v,ee,P,F,D,U,te)):ie>0&&ie&64&&le&&b.dynamicChildren?(I(b.dynamicChildren,le,v,P,F,D,U),(J.key!=null||P&&J===P.subTree)&&z1(b,J,!0)):xe(b,J,v,ee,P,F,D,U,te)},W=(b,J,v,K,P,F,D,U,te)=>{J.slotScopeIds=U,b==null?J.shapeFlag&512?P.ctx.activate(J,v,K,D,te):E(J,v,K,P,F,D,te):Q(b,J,te)},E=(b,J,v,K,P,F,D)=>{const U=b.component=zb(b,K,P);if(T1(b)&&(U.ctx.renderer=pe),Vb(U,!1,D),U.asyncDep){if(P&&P.registerDep(U,ae,D),!b.el){const te=U.subTree=wr(Dn);x(null,te,J,v),b.placeholder=te.el}}else ae(U,b,J,v,P,F,D)},Q=(b,J,v)=>{const K=J.component=b.component;if(Rb(b,J,v))if(K.asyncDep&&!K.asyncResolved){Z(K,J,v);return}else K.next=J,K.update();else J.el=b.el,K.vnode=J},ae=(b,J,v,K,P,F,D)=>{const U=()=>{if(b.isMounted){let{next:ie,bu:le,u:ce,parent:we,vnode:Ae}=b;{const qe=W1(b);if(qe){ie&&(ie.el=Ae.el,Z(b,ie,D)),qe.asyncDep.then(()=>{b.isUnmounted||U()});return}}let Se=ie,$e;Gn(b,!1),ie?(ie.el=Ae.el,Z(b,ie,D)):ie=Ae,le&&$l(le),($e=ie.props&&ie.props.onVnodeBeforeUpdate)&&vi($e,we,ie,Ae),Gn(b,!0);const Ie=Ed(b),Ne=b.subTree;b.subTree=Ie,p(Ne,Ie,h(Ne.el),ye(Ne),b,P,F),ie.el=Ie.el,Se===null&&Mb(b,Ie.el),ce&&Br(ce,P),($e=ie.props&&ie.props.onVnodeUpdated)&&Br(()=>vi($e,we,ie,Ae),P)}else{let ie;const{el:le,props:ce}=J,{bm:we,m:Ae,parent:Se,root:$e,type:Ie}=b,Ne=za(J);Gn(b,!1),we&&$l(we),!Ne&&(ie=ce&&ce.onVnodeBeforeMount)&&vi(ie,Se,J),Gn(b,!0);{$e.ce&&$e.ce._def.shadowRoot!==!1&&$e.ce._injectChildStyle(Ie);const qe=b.subTree=Ed(b);p(null,qe,v,K,b,P,F),J.el=qe.el}if(Ae&&Br(Ae,P),!Ne&&(ie=ce&&ce.onVnodeMounted)){const qe=J;Br(()=>vi(ie,Se,qe),P)}(J.shapeFlag&256||Se&&za(Se.vnode)&&Se.vnode.shapeFlag&256)&&b.a&&Br(b.a,P),b.isMounted=!0,J=v=K=null}};b.scope.on();const te=b.effect=new r1(U);b.scope.off();const re=b.update=te.run.bind(te),ee=b.job=te.runIfDirty.bind(te);ee.i=b,ee.id=b.uid,te.scheduler=()=>r0(ee),Gn(b,!0),re()},Z=(b,J,v)=>{J.component=b;const K=b.vnode.props;b.vnode=J,b.next=null,mb(b,J.props,K,v),yb(b,J.children,v),rn(),xd(b),nn()},xe=(b,J,v,K,P,F,D,U,te=!1)=>{const re=b&&b.children,ee=b?b.shapeFlag:0,ie=J.children,{patchFlag:le,shapeFlag:ce}=J;if(le>0){if(le&128){ge(re,ie,v,K,P,F,D,U,te);return}else if(le&256){L(re,ie,v,K,P,F,D,U,te);return}}ce&8?(ee&16&&ne(re,P,F),ie!==re&&f(v,ie)):ee&16?ce&16?ge(re,ie,v,K,P,F,D,U,te):ne(re,P,F,!0):(ee&8&&f(v,""),ce&16&&A(ie,v,K,P,F,D,U,te))},L=(b,J,v,K,P,F,D,U,te)=>{b=b||Ls,J=J||Ls;const re=b.length,ee=J.length,ie=Math.min(re,ee);let le;for(le=0;le<ie;le++){const ce=J[le]=te?mn(J[le]):Ci(J[le]);p(b[le],ce,v,null,P,F,D,U,te)}re>ee?ne(b,P,F,!0,!1,ie):A(J,v,K,P,F,D,U,te,ie)},ge=(b,J,v,K,P,F,D,U,te)=>{let re=0;const ee=J.length;let ie=b.length-1,le=ee-1;for(;re<=ie&&re<=le;){const ce=b[re],we=J[re]=te?mn(J[re]):Ci(J[re]);if(wa(ce,we))p(ce,we,v,null,P,F,D,U,te);else break;re++}for(;re<=ie&&re<=le;){const ce=b[ie],we=J[le]=te?mn(J[le]):Ci(J[le]);if(wa(ce,we))p(ce,we,v,null,P,F,D,U,te);else break;ie--,le--}if(re>ie){if(re<=le){const ce=le+1,we=ce<ee?J[ce].el:K;for(;re<=le;)p(null,J[re]=te?mn(J[re]):Ci(J[re]),v,we,P,F,D,U,te),re++}}else if(re>le)for(;re<=ie;)O(b[re],P,F,!0),re++;else{const ce=re,we=re,Ae=new Map;for(re=we;re<=le;re++){const Tt=J[re]=te?mn(J[re]):Ci(J[re]);Tt.key!=null&&Ae.set(Tt.key,re)}let Se,$e=0;const Ie=le-we+1;let Ne=!1,qe=0;const Le=new Array(Ie);for(re=0;re<Ie;re++)Le[re]=0;for(re=ce;re<=ie;re++){const Tt=b[re];if($e>=Ie){O(Tt,P,F,!0);continue}let yt;if(Tt.key!=null)yt=Ae.get(Tt.key);else for(Se=we;Se<=le;Se++)if(Le[Se-we]===0&&wa(Tt,J[Se])){yt=Se;break}yt===void 0?O(Tt,P,F,!0):(Le[yt-we]=re+1,yt>=qe?qe=yt:Ne=!0,p(Tt,J[yt],v,null,P,F,D,U,te),$e++)}const Nt=Ne?_b(Le):Ls;for(Se=Nt.length-1,re=Ie-1;re>=0;re--){const Tt=we+re,yt=J[Tt],zn=J[Tt+1],Wn=Tt+1<ee?zn.el||zn.placeholder:K;Le[re]===0?p(null,yt,v,Wn,P,F,D,U,te):Ne&&(Se<0||re!==Nt[Se]?Y(yt,v,Wn,2):Se--)}}},Y=(b,J,v,K,P=null)=>{const{el:F,type:D,transition:U,children:te,shapeFlag:re}=b;if(re&6){Y(b.component.subTree,J,v,K);return}if(re&128){b.suspense.move(J,v,K);return}if(re&64){D.move(b,J,v,pe);return}if(D===It){i(F,J,v);for(let ie=0;ie<te.length;ie++)Y(te[ie],J,v,K);i(b.anchor,J,v);return}if(D===Bf){w(b,J,v);return}if(K!==2&&re&1&&U)if(K===0)U.beforeEnter(F),i(F,J,v),Br(()=>U.enter(F),P);else{const{leave:ie,delayLeave:le,afterLeave:ce}=U,we=()=>{b.ctx.isUnmounted?n(F):i(F,J,v)},Ae=()=>{F._isLeaving&&F[$k](!0),ie(F,()=>{we(),ce&&ce()})};le?le(F,we,Ae):Ae()}else i(F,J,v)},O=(b,J,v,K=!1,P=!1)=>{const{type:F,props:D,ref:U,children:te,dynamicChildren:re,shapeFlag:ee,patchFlag:ie,dirs:le,cacheIndex:ce}=b;if(ie===-2&&(P=!1),U!=null&&(rn(),Ha(U,null,v,b,!0),nn()),ce!=null&&(J.renderCache[ce]=void 0),ee&256){J.ctx.deactivate(b);return}const we=ee&1&&le,Ae=!za(b);let Se;if(Ae&&(Se=D&&D.onVnodeBeforeUnmount)&&vi(Se,J,b),ee&6)H(b.component,v,K);else{if(ee&128){b.suspense.unmount(v,K);return}we&&$n(b,null,J,"beforeUnmount"),ee&64?b.type.remove(b,J,v,pe,K):re&&!re.hasOnce&&(F!==It||ie>0&&ie&64)?ne(re,J,v,!1,!0):(F===It&&ie&384||!P&&ee&16)&&ne(te,J,v),K&&j(b)}(Ae&&(Se=D&&D.onVnodeUnmounted)||we)&&Br(()=>{Se&&vi(Se,J,b),we&&$n(b,null,J,"unmounted")},v)},j=b=>{const{type:J,el:v,anchor:K,transition:P}=b;if(J===It){V(v,K);return}if(J===Bf){T(b);return}const F=()=>{n(v),P&&!P.persisted&&P.afterLeave&&P.afterLeave()};if(b.shapeFlag&1&&P&&!P.persisted){const{leave:D,delayLeave:U}=P,te=()=>D(v,F);U?U(b.el,F,te):te()}else F()},V=(b,J)=>{let v;for(;b!==J;)v=u(b),n(b),b=v;n(J)},H=(b,J,v)=>{const{bum:K,scope:P,job:F,subTree:D,um:U,m:te,a:re}=b;Td(te),Td(re),K&&$l(K),P.stop(),F&&(F.flags|=8,O(D,b,J,v)),U&&Br(U,J),Br(()=>{b.isUnmounted=!0},J)},ne=(b,J,v,K=!1,P=!1,F=0)=>{for(let D=F;D<b.length;D++)O(b[D],J,v,K,P)},ye=b=>{if(b.shapeFlag&6)return ye(b.component.subTree);if(b.shapeFlag&128)return b.suspense.next();const J=u(b.anchor||b.el),v=J&&J[Vk];return v?u(v):J};let de=!1;const ue=(b,J,v)=>{b==null?J._vnode&&O(J._vnode,null,null,!0):p(J._vnode||null,b,J,null,null,null,v),J._vnode=b,de||(de=!0,xd(),w1(),de=!1)},pe={p,um:O,m:Y,r:j,mt:E,mc:A,pc:xe,pbc:I,n:ye,o:r};return{render:ue,hydrate:void 0,createApp:ub(ue)}}function Lf({type:r,props:e},t){return t==="svg"&&r==="foreignObject"||t==="mathml"&&r==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Gn({effect:r,job:e},t){t?(r.flags|=32,e.flags|=4):(r.flags&=-33,e.flags&=-5)}function bb(r,e){return(!r||r&&!r.pendingBranch)&&e&&!e.persisted}function z1(r,e,t=!1){const i=r.children,n=e.children;if(Ue(i)&&Ue(n))for(let s=0;s<i.length;s++){const a=i[s];let o=n[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=n[s]=mn(n[s]),o.el=a.el),!t&&o.patchFlag!==-2&&z1(a,o)),o.type===cf&&o.patchFlag!==-1&&(o.el=a.el),o.type===Dn&&!o.el&&(o.el=a.el)}}function _b(r){const e=r.slice(),t=[0];let i,n,s,a,o;const l=r.length;for(i=0;i<l;i++){const c=r[i];if(c!==0){if(n=t[t.length-1],r[n]<c){e[i]=n,t.push(i);continue}for(s=0,a=t.length-1;s<a;)o=s+a>>1,r[t[o]]<c?s=o+1:a=o;c<r[t[s]]&&(s>0&&(e[i]=t[s-1]),t[s]=i)}}for(s=t.length,a=t[s-1];s-- >0;)t[s]=a,a=e[a];return t}function W1(r){const e=r.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:W1(e)}function Td(r){if(r)for(let e=0;e<r.length;e++)r[e].flags|=8}const Sb=Symbol.for("v-scx"),Tb=()=>Va(Sb);function oi(r,e,t){return V1(r,e,t)}function V1(r,e,t=lt){const{immediate:i,deep:n,flush:s,once:a}=t,o=cr({},t),l=e&&i||!e&&s!=="post";let c;if(ho){if(s==="sync"){const d=Tb();c=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=Ii,d.resume=Ii,d.pause=Ii,d}}const f=ir;o.call=(d,m,p)=>Bi(d,f,m,p);let h=!1;s==="post"?o.scheduler=d=>{Br(d,f&&f.suspense)}:s!=="sync"&&(h=!0,o.scheduler=(d,m)=>{m?d():r0(d)}),o.augmentJob=d=>{e&&(d.flags|=4),h&&(d.flags|=2,f&&(d.id=f.uid,d.i=f))};const u=Nk(r,e,o);return ho&&(c?c.push(u):l&&u()),u}function Eb(r,e,t){const i=this.proxy,n=Dt(r)?r.includes(".")?j1(i,r):()=>i[r]:r.bind(i,i);let s;je(e)?s=e:(s=e.handler,t=e);const a=zo(this),o=V1(n,s.bind(i),t);return a(),o}function j1(r,e){const t=e.split(".");return()=>{let i=r;for(let n=0;n<t.length&&i;n++)i=i[t[n]];return i}}const Cb=(r,e)=>e==="modelValue"||e==="model-value"?r.modelModifiers:r[`${e}Modifiers`]||r[`${ei(e)}Modifiers`]||r[`${ms(e)}Modifiers`];function Ab(r,e,...t){if(r.isUnmounted)return;const i=r.vnode.props||lt;let n=t;const s=e.startsWith("update:"),a=s&&Cb(i,e.slice(7));a&&(a.trim&&(n=t.map(f=>Dt(f)?f.trim():f)),a.number&&(n=t.map(sc)));let o,l=i[o=Of(e)]||i[o=Of(ei(e))];!l&&s&&(l=i[o=Of(ms(e))]),l&&Bi(l,r,6,n);const c=i[o+"Once"];if(c){if(!r.emitted)r.emitted={};else if(r.emitted[o])return;r.emitted[o]=!0,Bi(c,r,6,n)}}const Ob=new WeakMap;function $1(r,e,t=!1){const i=t?Ob:e.emitsCache,n=i.get(r);if(n!==void 0)return n;const s=r.emits;let a={},o=!1;if(!je(r)){const l=c=>{const f=$1(c,e,!0);f&&(o=!0,cr(a,f))};!t&&e.mixins.length&&e.mixins.forEach(l),r.extends&&l(r.extends),r.mixins&&r.mixins.forEach(l)}return!s&&!o?(ft(r)&&i.set(r,null),null):(Ue(s)?s.forEach(l=>a[l]=null):cr(a,s),ft(r)&&i.set(r,a),a)}function lf(r,e){return!r||!Qc(e)?!1:(e=e.slice(2).replace(/Once$/,""),st(r,e[0].toLowerCase()+e.slice(1))||st(r,ms(e))||st(r,e))}function Ed(r){const{type:e,vnode:t,proxy:i,withProxy:n,propsOptions:[s],slots:a,attrs:o,emit:l,render:c,renderCache:f,props:h,data:u,setupState:d,ctx:m,inheritAttrs:p}=r,g=cc(r);let x,y;try{if(t.shapeFlag&4){const T=n||i,C=T;x=Ci(c.call(C,T,f,h,d,u,m)),y=o}else{const T=e;x=Ci(T.length>1?T(h,{attrs:o,slots:a,emit:l}):T(h,null)),y=e.props?o:Fb(o)}}catch(T){ja.length=0,af(T,r,1),x=wr(Dn)}let w=x;if(y&&p!==!1){const T=Object.keys(y),{shapeFlag:C}=w;T.length&&C&7&&(s&&T.some(Vu)&&(y=Db(y,s)),w=Js(w,y,!1,!0))}return t.dirs&&(w=Js(w,null,!1,!0),w.dirs=w.dirs?w.dirs.concat(t.dirs):t.dirs),t.transition&&i0(w,t.transition),x=w,cc(g),x}const Fb=r=>{let e;for(const t in r)(t==="class"||t==="style"||Qc(t))&&((e||(e={}))[t]=r[t]);return e},Db=(r,e)=>{const t={};for(const i in r)(!Vu(i)||!(i.slice(9)in e))&&(t[i]=r[i]);return t};function Rb(r,e,t){const{props:i,children:n,component:s}=r,{props:a,children:o,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return i?Cd(i,a,c):!!a;if(l&8){const f=e.dynamicProps;for(let h=0;h<f.length;h++){const u=f[h];if(a[u]!==i[u]&&!lf(c,u))return!0}}}else return(n||o)&&(!o||!o.$stable)?!0:i===a?!1:i?a?Cd(i,a,c):!0:!!a;return!1}function Cd(r,e,t){const i=Object.keys(e);if(i.length!==Object.keys(r).length)return!0;for(let n=0;n<i.length;n++){const s=i[n];if(e[s]!==r[s]&&!lf(t,s))return!0}return!1}function Mb({vnode:r,parent:e},t){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===r&&(i.el=r.el),i===r)(r=e.vnode).el=t,e=e.parent;else break}}const G1=r=>r.__isSuspense;function Ib(r,e){e&&e.pendingBranch?Ue(r)?e.effects.push(...r):e.effects.push(r):zk(r)}const It=Symbol.for("v-fgt"),cf=Symbol.for("v-txt"),Dn=Symbol.for("v-cmt"),Bf=Symbol.for("v-stc"),ja=[];let Wr=null;function ze(r=!1){ja.push(Wr=r?null:[])}function Pb(){ja.pop(),Wr=ja[ja.length-1]||null}let fo=1;function uc(r,e=!1){fo+=r,r<0&&Wr&&e&&(Wr.hasOnce=!0)}function K1(r){return r.dynamicChildren=fo>0?Wr||Ls:null,Pb(),fo>0&&Wr&&Wr.push(r),r}function Ge(r,e,t,i,n,s){return K1(Pe(r,e,t,i,n,s,!0))}function X1(r,e,t,i,n){return K1(wr(r,e,t,i,n,!0))}function dc(r){return r?r.__v_isVNode===!0:!1}function wa(r,e){return r.type===e.type&&r.key===e.key}const q1=({key:r})=>r??null,Gl=({ref:r,ref_key:e,ref_for:t})=>(typeof r=="number"&&(r=""+r),r!=null?Dt(r)||or(r)||je(r)?{i:zr,r,k:e,f:!!t}:r:null);function Pe(r,e=null,t=null,i=0,n=null,s=r===It?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:r,props:e,key:e&&q1(e),ref:e&&Gl(e),scopeId:b1,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:zr};return o?(a0(l,t),s&128&&r.normalize(l)):t&&(l.shapeFlag|=Dt(t)?8:16),fo>0&&!a&&Wr&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Wr.push(l),l}const wr=Lb;function Lb(r,e=null,t=null,i=0,n=null,s=!1){if((!r||r===ib)&&(r=Dn),dc(r)){const o=Js(r,e,!0);return t&&a0(o,t),fo>0&&!s&&Wr&&(o.shapeFlag&6?Wr[Wr.indexOf(r)]=o:Wr.push(o)),o.patchFlag=-2,o}if(Xb(r)&&(r=r.__vccOpts),e){e=Bb(e);let{class:o,style:l}=e;o&&!Dt(o)&&(e.class=nf(o)),ft(l)&&(t0(l)&&!Ue(l)&&(l=cr({},l)),e.style=Gu(l))}const a=Dt(r)?1:G1(r)?128:jk(r)?64:ft(r)?4:je(r)?2:0;return Pe(r,e,t,i,n,a,s,!0)}function Bb(r){return r?t0(r)||P1(r)?cr({},r):r:null}function Js(r,e,t=!1,i=!1){const{props:n,ref:s,patchFlag:a,children:o,transition:l}=r,c=e?Nb(n||{},e):n,f={__v_isVNode:!0,__v_skip:!0,type:r.type,props:c,key:c&&q1(c),ref:e&&e.ref?t&&s?Ue(s)?s.concat(Gl(e)):[s,Gl(e)]:Gl(e):s,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:o,target:r.target,targetStart:r.targetStart,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:e&&r.type!==It?a===-1?16:a|16:a,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:l,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Js(r.ssContent),ssFallback:r.ssFallback&&Js(r.ssFallback),placeholder:r.placeholder,el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return l&&i&&i0(f,l.clone(f)),f}function zs(r=" ",e=0){return wr(cf,null,r,e)}function Ar(r="",e=!1){return e?(ze(),X1(Dn,null,r)):wr(Dn,null,r)}function Ci(r){return r==null||typeof r=="boolean"?wr(Dn):Ue(r)?wr(It,null,r.slice()):dc(r)?mn(r):wr(cf,null,String(r))}function mn(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:Js(r)}function a0(r,e){let t=0;const{shapeFlag:i}=r;if(e==null)e=null;else if(Ue(e))t=16;else if(typeof e=="object")if(i&65){const n=e.default;n&&(n._c&&(n._d=!1),a0(r,n()),n._c&&(n._d=!0));return}else{t=32;const n=e._;!n&&!P1(e)?e._ctx=zr:n===3&&zr&&(zr.slots._===1?e._=1:(e._=2,r.patchFlag|=1024))}else je(e)?(e={default:e,_ctx:zr},t=32):(e=String(e),i&64?(t=16,e=[zs(e)]):t=8);r.children=e,r.shapeFlag|=t}function Nb(...r){const e={};for(let t=0;t<r.length;t++){const i=r[t];for(const n in i)if(n==="class")e.class!==i.class&&(e.class=nf([e.class,i.class]));else if(n==="style")e.style=Gu([e.style,i.style]);else if(Qc(n)){const s=e[n],a=i[n];a&&s!==a&&!(Ue(s)&&s.includes(a))&&(e[n]=s?[].concat(s,a):a)}else n!==""&&(e[n]=i[n])}return e}function vi(r,e,t,i=null){Bi(r,e,7,[t,i])}const Ub=R1();let Hb=0;function zb(r,e,t){const i=r.type,n=(e?e.appContext:r.appContext)||Ub,s={uid:Hb++,vnode:r,type:i,parent:e,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ck(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(n.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:B1(i,n),emitsOptions:$1(i,n),emit:null,emitted:null,propsDefaults:lt,inheritAttrs:i.inheritAttrs,ctx:lt,data:lt,props:lt,attrs:lt,slots:lt,refs:lt,setupState:lt,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=Ab.bind(null,s),r.ce&&r.ce(s),s}let ir=null;const Wb=()=>ir||zr;let pc,Ih;{const r=rf(),e=(t,i)=>{let n;return(n=r[t])||(n=r[t]=[]),n.push(i),s=>{n.length>1?n.forEach(a=>a(s)):n[0](s)}};pc=e("__VUE_INSTANCE_SETTERS__",t=>ir=t),Ih=e("__VUE_SSR_SETTERS__",t=>ho=t)}const zo=r=>{const e=ir;return pc(r),r.scope.on(),()=>{r.scope.off(),pc(e)}},Ad=()=>{ir&&ir.scope.off(),pc(null)};function Y1(r){return r.vnode.shapeFlag&4}let ho=!1;function Vb(r,e=!1,t=!1){e&&Ih(e);const{props:i,children:n}=r.vnode,s=Y1(r);pb(r,i,s,e),vb(r,n,t||e);const a=s?jb(r,e):void 0;return e&&Ih(!1),a}function jb(r,e){const t=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,sb);const{setup:i}=t;if(i){rn();const n=r.setupContext=i.length>1?Gb(r):null,s=zo(r),a=Ho(i,r,0,[r.props,n]),o=qg(a);if(nn(),s(),(o||r.sp)&&!za(r)&&S1(r),o){if(a.then(Ad,Ad),e)return a.then(l=>{Od(r,l)}).catch(l=>{af(l,r,0)});r.asyncDep=a}else Od(r,a)}else J1(r)}function Od(r,e,t){je(e)?r.type.__ssrInlineRender?r.ssrRender=e:r.render=e:ft(e)&&(r.setupState=g1(e)),J1(r)}function J1(r,e,t){const i=r.type;r.render||(r.render=i.render||Ii);{const n=zo(r);rn();try{ab(r)}finally{nn(),n()}}}const $b={get(r,e){return rr(r,"get",""),r[e]}};function Gb(r){const e=t=>{r.exposed=t||{}};return{attrs:new Proxy(r.attrs,$b),slots:r.slots,emit:r.emit,expose:e}}function ff(r){return r.exposed?r.exposeProxy||(r.exposeProxy=new Proxy(g1(Fk(r.exposed)),{get(e,t){if(t in e)return e[t];if(t in Wa)return Wa[t](r)},has(e,t){return t in e||t in Wa}})):r.proxy}function Kb(r,e=!0){return je(r)?r.displayName||r.name:r.name||e&&r.__name}function Xb(r){return je(r)&&"__vccOpts"in r}const Z1=(r,e)=>Lk(r,e,ho);function qb(r,e,t){try{uc(-1);const i=arguments.length;return i===2?ft(e)&&!Ue(e)?dc(e)?wr(r,null,[e]):wr(r,e):wr(r,null,e):(i>3?t=Array.prototype.slice.call(arguments,2):i===3&&dc(t)&&(t=[t]),wr(r,e,t))}finally{uc(1)}}const Yb="3.5.22";/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ph;const Fd=typeof window<"u"&&window.trustedTypes;if(Fd)try{Ph=Fd.createPolicy("vue",{createHTML:r=>r})}catch{}const Q1=Ph?r=>Ph.createHTML(r):r=>r,Jb="http://www.w3.org/2000/svg",Zb="http://www.w3.org/1998/Math/MathML",Gi=typeof document<"u"?document:null,Dd=Gi&&Gi.createElement("template"),Qb={insert:(r,e,t)=>{e.insertBefore(r,t||null)},remove:r=>{const e=r.parentNode;e&&e.removeChild(r)},createElement:(r,e,t,i)=>{const n=e==="svg"?Gi.createElementNS(Jb,r):e==="mathml"?Gi.createElementNS(Zb,r):t?Gi.createElement(r,{is:t}):Gi.createElement(r);return r==="select"&&i&&i.multiple!=null&&n.setAttribute("multiple",i.multiple),n},createText:r=>Gi.createTextNode(r),createComment:r=>Gi.createComment(r),setText:(r,e)=>{r.nodeValue=e},setElementText:(r,e)=>{r.textContent=e},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>Gi.querySelector(r),setScopeId(r,e){r.setAttribute(e,"")},insertStaticContent(r,e,t,i,n,s){const a=t?t.previousSibling:e.lastChild;if(n&&(n===s||n.nextSibling))for(;e.insertBefore(n.cloneNode(!0),t),!(n===s||!(n=n.nextSibling)););else{Dd.innerHTML=Q1(i==="svg"?`<svg>${r}</svg>`:i==="mathml"?`<math>${r}</math>`:r);const o=Dd.content;if(i==="svg"||i==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}e.insertBefore(o,t)}return[a?a.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},e_=Symbol("_vtc");function t_(r,e,t){const i=r[e_];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?r.removeAttribute("class"):t?r.setAttribute("class",e):r.className=e}const Rd=Symbol("_vod"),r_=Symbol("_vsh"),i_=Symbol(""),n_=/(?:^|;)\s*display\s*:/;function s_(r,e,t){const i=r.style,n=Dt(t);let s=!1;if(t&&!n){if(e)if(Dt(e))for(const a of e.split(";")){const o=a.slice(0,a.indexOf(":")).trim();t[o]==null&&Kl(i,o,"")}else for(const a in e)t[a]==null&&Kl(i,a,"");for(const a in t)a==="display"&&(s=!0),Kl(i,a,t[a])}else if(n){if(e!==t){const a=i[i_];a&&(t+=";"+a),i.cssText=t,s=n_.test(t)}}else e&&r.removeAttribute("style");Rd in r&&(r[Rd]=s?i.display:"",r[r_]&&(i.display="none"))}const Md=/\s*!important$/;function Kl(r,e,t){if(Ue(t))t.forEach(i=>Kl(r,e,i));else if(t==null&&(t=""),e.startsWith("--"))r.setProperty(e,t);else{const i=a_(r,e);Md.test(t)?r.setProperty(ms(i),t.replace(Md,""),"important"):r[i]=t}}const Id=["Webkit","Moz","ms"],Nf={};function a_(r,e){const t=Nf[e];if(t)return t;let i=ei(e);if(i!=="filter"&&i in r)return Nf[e]=i;i=tf(i);for(let n=0;n<Id.length;n++){const s=Id[n]+i;if(s in r)return Nf[e]=s}return e}const Pd="http://www.w3.org/1999/xlink";function Ld(r,e,t,i,n,s=ok(e)){i&&e.startsWith("xlink:")?t==null?r.removeAttributeNS(Pd,e.slice(6,e.length)):r.setAttributeNS(Pd,e,t):t==null||s&&!Qg(t)?r.removeAttribute(e):r.setAttribute(e,s?"":Li(t)?String(t):t)}function Bd(r,e,t,i,n){if(e==="innerHTML"||e==="textContent"){t!=null&&(r[e]=e==="innerHTML"?Q1(t):t);return}const s=r.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?r.getAttribute("value")||"":r.value,l=t==null?r.type==="checkbox"?"on":"":String(t);(o!==l||!("_value"in r))&&(r.value=l),t==null&&r.removeAttribute(e),r._value=t;return}let a=!1;if(t===""||t==null){const o=typeof r[e];o==="boolean"?t=Qg(t):t==null&&o==="string"?(t="",a=!0):o==="number"&&(t=0,a=!0)}try{r[e]=t}catch{}a&&r.removeAttribute(n||e)}function vn(r,e,t,i){r.addEventListener(e,t,i)}function o_(r,e,t,i){r.removeEventListener(e,t,i)}const Nd=Symbol("_vei");function l_(r,e,t,i,n=null){const s=r[Nd]||(r[Nd]={}),a=s[e];if(i&&a)a.value=i;else{const[o,l]=c_(e);if(i){const c=s[e]=u_(i,n);vn(r,o,c,l)}else a&&(o_(r,o,a,l),s[e]=void 0)}}const Ud=/(?:Once|Passive|Capture)$/;function c_(r){let e;if(Ud.test(r)){e={};let i;for(;i=r.match(Ud);)r=r.slice(0,r.length-i[0].length),e[i[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):ms(r.slice(2)),e]}let Uf=0;const f_=Promise.resolve(),h_=()=>Uf||(f_.then(()=>Uf=0),Uf=Date.now());function u_(r,e){const t=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=t.attached)return;Bi(d_(i,t.value),e,5,[i])};return t.value=r,t.attached=h_(),t}function d_(r,e){if(Ue(e)){const t=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{t.call(r),r._stopped=!0},e.map(i=>n=>!n._stopped&&i&&i(n))}else return e}const Hd=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)>96&&r.charCodeAt(2)<123,p_=(r,e,t,i,n,s)=>{const a=n==="svg";e==="class"?t_(r,i,a):e==="style"?s_(r,t,i):Qc(e)?Vu(e)||l_(r,e,t,i,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):m_(r,e,i,a))?(Bd(r,e,i),!r.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ld(r,e,i,a,s,e!=="value")):r._isVueCE&&(/[A-Z]/.test(e)||!Dt(i))?Bd(r,ei(e),i,s,e):(e==="true-value"?r._trueValue=i:e==="false-value"&&(r._falseValue=i),Ld(r,e,i,a))};function m_(r,e,t,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in r&&Hd(e)&&je(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&r.tagName==="INPUT"||e==="type"&&r.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const n=r.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return Hd(e)&&Dt(t)?!1:e in r}const Zs=r=>{const e=r.props["onUpdate:modelValue"]||!1;return Ue(e)?t=>$l(e,t):e};function g_(r){r.target.composing=!0}function zd(r){const e=r.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Zi=Symbol("_assign"),ex={created(r,{modifiers:{lazy:e,trim:t,number:i}},n){r[Zi]=Zs(n);const s=i||n.props&&n.props.type==="number";vn(r,e?"change":"input",a=>{if(a.target.composing)return;let o=r.value;t&&(o=o.trim()),s&&(o=sc(o)),r[Zi](o)}),t&&vn(r,"change",()=>{r.value=r.value.trim()}),e||(vn(r,"compositionstart",g_),vn(r,"compositionend",zd),vn(r,"change",zd))},mounted(r,{value:e}){r.value=e??""},beforeUpdate(r,{value:e,oldValue:t,modifiers:{lazy:i,trim:n,number:s}},a){if(r[Zi]=Zs(a),r.composing)return;const o=(s||r.type==="number")&&!/^0\d/.test(r.value)?sc(r.value):r.value,l=e??"";o!==l&&(document.activeElement===r&&r.type!=="range"&&(i&&e===t||n&&r.value.trim()===l)||(r.value=l))}},x_={deep:!0,created(r,e,t){r[Zi]=Zs(t),vn(r,"change",()=>{const i=r._modelValue,n=uo(r),s=r.checked,a=r[Zi];if(Ue(i)){const o=Ku(i,n),l=o!==-1;if(s&&!l)a(i.concat(n));else if(!s&&l){const c=[...i];c.splice(o,1),a(c)}}else if(ca(i)){const o=new Set(i);s?o.add(n):o.delete(n),a(o)}else a(tx(r,s))})},mounted:Wd,beforeUpdate(r,e,t){r[Zi]=Zs(t),Wd(r,e,t)}};function Wd(r,{value:e,oldValue:t},i){r._modelValue=e;let n;if(Ue(e))n=Ku(e,i.props.value)>-1;else if(ca(e))n=e.has(i.props.value);else{if(e===t)return;n=Uo(e,tx(r,!0))}r.checked!==n&&(r.checked=n)}const Vd={deep:!0,created(r,{value:e,modifiers:{number:t}},i){const n=ca(e);vn(r,"change",()=>{const s=Array.prototype.filter.call(r.options,a=>a.selected).map(a=>t?sc(uo(a)):uo(a));r[Zi](r.multiple?n?new Set(s):s:s[0]),r._assigning=!0,v1(()=>{r._assigning=!1})}),r[Zi]=Zs(i)},mounted(r,{value:e}){jd(r,e)},beforeUpdate(r,e,t){r[Zi]=Zs(t)},updated(r,{value:e}){r._assigning||jd(r,e)}};function jd(r,e){const t=r.multiple,i=Ue(e);if(!(t&&!i&&!ca(e))){for(let n=0,s=r.options.length;n<s;n++){const a=r.options[n],o=uo(a);if(t)if(i){const l=typeof o;l==="string"||l==="number"?a.selected=e.some(c=>String(c)===String(o)):a.selected=Ku(e,o)>-1}else a.selected=e.has(o);else if(Uo(uo(a),e)){r.selectedIndex!==n&&(r.selectedIndex=n);return}}!t&&r.selectedIndex!==-1&&(r.selectedIndex=-1)}}function uo(r){return"_value"in r?r._value:r.value}function tx(r,e){const t=e?"_trueValue":"_falseValue";return t in r?r[t]:e}const v_=cr({patchProp:p_},Qb);let $d;function y_(){return $d||($d=wb(v_))}const w_=(...r)=>{const e=y_().createApp(...r),{mount:t}=e;return e.mount=i=>{const n=b_(i);if(!n)return;const s=e._component;!je(s)&&!s.render&&!s.template&&(s.template=n.innerHTML),n.nodeType===1&&(n.textContent="");const a=t(n,!1,k_(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),a},e};function k_(r){if(r instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&r instanceof MathMLElement)return"mathml"}function b_(r){return Dt(r)?document.querySelector(r):r}var Ai=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rx(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ix={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(r,e){((t,i)=>{r.exports=i()})(Ai,function t(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},n,s=!i.document&&!!i.postMessage,a=i.IS_PAPA_WORKER||!1,o={},l=0,c={};function f(A){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(k){var I=C(k);I.chunkSize=parseInt(I.chunkSize),k.step||k.chunk||(I.chunkSize=null),this._handle=new p(I),(this._handle.streamer=this)._config=I}).call(this,A),this.parseChunk=function(k,I){var N=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<N){let W=this._config.newline;W||(S=this._config.quoteChar||'"',W=this._handle.guessLineEndings(k,S)),k=[...k.split(W).slice(N)].join(W)}this.isFirstChunk&&_(this._config.beforeFirstChunk)&&(S=this._config.beforeFirstChunk(k))!==void 0&&(k=S),this.isFirstChunk=!1,this._halted=!1;var N=this._partialLine+k,S=(this._partialLine="",this._handle.parse(N,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(k=S.meta.cursor,N=(this._finished||(this._partialLine=N.substring(k-this._baseIndex),this._baseIndex=k),S&&S.data&&(this._rowCount+=S.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),a)i.postMessage({results:S,workerId:c.WORKER_ID,finished:N});else if(_(this._config.chunk)&&!I){if(this._config.chunk(S,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=S=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(S.data),this._completeResults.errors=this._completeResults.errors.concat(S.errors),this._completeResults.meta=S.meta),this._completed||!N||!_(this._config.complete)||S&&S.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),N||S&&S.meta.paused||this._nextChunk(),S}this._halted=!0},this._sendError=function(k){_(this._config.error)?this._config.error(k):a&&this._config.error&&i.postMessage({workerId:c.WORKER_ID,error:k,finished:!1})}}function h(A){var k;(A=A||{}).chunkSize||(A.chunkSize=c.RemoteChunkSize),f.call(this,A),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(I){this._input=I,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(k=new XMLHttpRequest,this._config.withCredentials&&(k.withCredentials=this._config.withCredentials),s||(k.onload=R(this._chunkLoaded,this),k.onerror=R(this._chunkError,this)),k.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var I,N=this._config.downloadRequestHeaders;for(I in N)k.setRequestHeader(I,N[I])}var S;this._config.chunkSize&&(S=this._start+this._config.chunkSize-1,k.setRequestHeader("Range","bytes="+this._start+"-"+S));try{k.send(this._config.downloadRequestBody)}catch(W){this._chunkError(W.message)}s&&k.status===0&&this._chunkError()}},this._chunkLoaded=function(){k.readyState===4&&(k.status<200||400<=k.status?this._chunkError():(this._start+=this._config.chunkSize||k.responseText.length,this._finished=!this._config.chunkSize||this._start>=(I=>(I=I.getResponseHeader("Content-Range"))!==null?parseInt(I.substring(I.lastIndexOf("/")+1)):-1)(k),this.parseChunk(k.responseText)))},this._chunkError=function(I){I=k.statusText||I,this._sendError(new Error(I))}}function u(A){(A=A||{}).chunkSize||(A.chunkSize=c.LocalChunkSize),f.call(this,A);var k,I,N=typeof FileReader<"u";this.stream=function(S){this._input=S,I=S.slice||S.webkitSlice||S.mozSlice,N?((k=new FileReader).onload=R(this._chunkLoaded,this),k.onerror=R(this._chunkError,this)):k=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var S=this._input,W=(this._config.chunkSize&&(W=Math.min(this._start+this._config.chunkSize,this._input.size),S=I.call(S,this._start,W)),k.readAsText(S,this._config.encoding));N||this._chunkLoaded({target:{result:W}})},this._chunkLoaded=function(S){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(S.target.result)},this._chunkError=function(){this._sendError(k.error)}}function d(A){var k;f.call(this,A=A||{}),this.stream=function(I){return k=I,this._nextChunk()},this._nextChunk=function(){var I,N;if(!this._finished)return I=this._config.chunkSize,k=I?(N=k.substring(0,I),k.substring(I)):(N=k,""),this._finished=!k,this.parseChunk(N)}}function m(A){f.call(this,A=A||{});var k=[],I=!0,N=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(S){this._input=S,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){N&&k.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),k.length?this.parseChunk(k.shift()):I=!0},this._streamData=R(function(S){try{k.push(typeof S=="string"?S:S.toString(this._config.encoding)),I&&(I=!1,this._checkIsFinished(),this.parseChunk(k.shift()))}catch(W){this._streamError(W)}},this),this._streamError=R(function(S){this._streamCleanUp(),this._sendError(S)},this),this._streamEnd=R(function(){this._streamCleanUp(),N=!0,this._streamData("")},this),this._streamCleanUp=R(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(A){var k,I,N,S,W=Math.pow(2,53),E=-W,Q=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ae=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Z=this,xe=0,L=0,ge=!1,Y=!1,O=[],j={data:[],errors:[],meta:{}};function V(de){return A.skipEmptyLines==="greedy"?de.join("").trim()==="":de.length===1&&de[0].length===0}function H(){if(j&&N&&(ye("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),N=!1),A.skipEmptyLines&&(j.data=j.data.filter(function(b){return!V(b)})),ne()){let b=function(J,v){_(A.transformHeader)&&(J=A.transformHeader(J,v)),O.push(J)};var be=b;if(j)if(Array.isArray(j.data[0])){for(var de=0;ne()&&de<j.data.length;de++)j.data[de].forEach(b);j.data.splice(0,1)}else j.data.forEach(b)}function ue(b,J){for(var v=A.header?{}:[],K=0;K<b.length;K++){var P=K,F=b[K],F=((D,U)=>(te=>(A.dynamicTypingFunction&&A.dynamicTyping[te]===void 0&&(A.dynamicTyping[te]=A.dynamicTypingFunction(te)),(A.dynamicTyping[te]||A.dynamicTyping)===!0))(D)?U==="true"||U==="TRUE"||U!=="false"&&U!=="FALSE"&&((te=>{if(Q.test(te)&&(te=parseFloat(te),E<te&&te<W))return 1})(U)?parseFloat(U):ae.test(U)?new Date(U):U===""?null:U):U)(P=A.header?K>=O.length?"__parsed_extra":O[K]:P,F=A.transform?A.transform(F,P):F);P==="__parsed_extra"?(v[P]=v[P]||[],v[P].push(F)):v[P]=F}return A.header&&(K>O.length?ye("FieldMismatch","TooManyFields","Too many fields: expected "+O.length+" fields but parsed "+K,L+J):K<O.length&&ye("FieldMismatch","TooFewFields","Too few fields: expected "+O.length+" fields but parsed "+K,L+J)),v}var pe;j&&(A.header||A.dynamicTyping||A.transform)&&(pe=1,!j.data.length||Array.isArray(j.data[0])?(j.data=j.data.map(ue),pe=j.data.length):j.data=ue(j.data,0),A.header&&j.meta&&(j.meta.fields=O),L+=pe)}function ne(){return A.header&&O.length===0}function ye(de,ue,pe,be){de={type:de,code:ue,message:pe},be!==void 0&&(de.row=be),j.errors.push(de)}_(A.step)&&(S=A.step,A.step=function(de){j=de,ne()?H():(H(),j.data.length!==0&&(xe+=de.data.length,A.preview&&xe>A.preview?I.abort():(j.data=j.data[0],S(j,Z))))}),this.parse=function(de,ue,pe){var be=A.quoteChar||'"',be=(A.newline||(A.newline=this.guessLineEndings(de,be)),N=!1,A.delimiter?_(A.delimiter)&&(A.delimiter=A.delimiter(de),j.meta.delimiter=A.delimiter):((be=((b,J,v,K,P)=>{var F,D,U,te;P=P||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var re=0;re<P.length;re++){for(var ee,ie=P[re],le=0,ce=0,we=0,Ae=(U=void 0,new x({comments:K,delimiter:ie,newline:J,preview:10}).parse(b)),Se=0;Se<Ae.data.length;Se++)v&&V(Ae.data[Se])?we++:(ee=Ae.data[Se].length,ce+=ee,U===void 0?U=ee:0<ee&&(le+=Math.abs(ee-U),U=ee));0<Ae.data.length&&(ce/=Ae.data.length-we),(D===void 0||le<=D)&&(te===void 0||te<ce)&&1.99<ce&&(D=le,F=ie,te=ce)}return{successful:!!(A.delimiter=F),bestDelimiter:F}})(de,A.newline,A.skipEmptyLines,A.comments,A.delimitersToGuess)).successful?A.delimiter=be.bestDelimiter:(N=!0,A.delimiter=c.DefaultDelimiter),j.meta.delimiter=A.delimiter),C(A));return A.preview&&A.header&&be.preview++,k=de,I=new x(be),j=I.parse(k,ue,pe),H(),ge?{meta:{paused:!0}}:j||{meta:{paused:!1}}},this.paused=function(){return ge},this.pause=function(){ge=!0,I.abort(),k=_(A.chunk)?"":k.substring(I.getCharIndex())},this.resume=function(){Z.streamer._halted?(ge=!1,Z.streamer.parseChunk(k,!0)):setTimeout(Z.resume,3)},this.aborted=function(){return Y},this.abort=function(){Y=!0,I.abort(),j.meta.aborted=!0,_(A.complete)&&A.complete(j),k=""},this.guessLineEndings=function(b,be){b=b.substring(0,1048576);var be=new RegExp(g(be)+"([^]*?)"+g(be),"gm"),pe=(b=b.replace(be,"")).split("\r"),be=b.split(`
`),b=1<be.length&&be[0].length<pe[0].length;if(pe.length===1||b)return`
`;for(var J=0,v=0;v<pe.length;v++)pe[v][0]===`
`&&J++;return J>=pe.length/2?`\r
`:"\r"}}function g(A){return A.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function x(A){var k=(A=A||{}).delimiter,I=A.newline,N=A.comments,S=A.step,W=A.preview,E=A.fastMode,Q=null,ae=!1,Z=A.quoteChar==null?'"':A.quoteChar,xe=Z;if(A.escapeChar!==void 0&&(xe=A.escapeChar),(typeof k!="string"||-1<c.BAD_DELIMITERS.indexOf(k))&&(k=","),N===k)throw new Error("Comment character same as delimiter");N===!0?N="#":(typeof N!="string"||-1<c.BAD_DELIMITERS.indexOf(N))&&(N=!1),I!==`
`&&I!=="\r"&&I!==`\r
`&&(I=`
`);var L=0,ge=!1;this.parse=function(Y,O,j){if(typeof Y!="string")throw new Error("Input must be a string");var V=Y.length,H=k.length,ne=I.length,ye=N.length,de=_(S),ue=[],pe=[],be=[],b=L=0;if(!Y)return le();if(E||E!==!1&&Y.indexOf(Z)===-1){for(var J=Y.split(I),v=0;v<J.length;v++){if(be=J[v],L+=be.length,v!==J.length-1)L+=I.length;else if(j)return le();if(!N||be.substring(0,ye)!==N){if(de){if(ue=[],te(be.split(k)),ce(),ge)return le()}else te(be.split(k));if(W&&W<=v)return ue=ue.slice(0,W),le(!0)}}return le()}for(var K=Y.indexOf(k,L),P=Y.indexOf(I,L),F=new RegExp(g(xe)+g(Z),"g"),D=Y.indexOf(Z,L);;)if(Y[L]===Z)for(D=L,L++;;){if((D=Y.indexOf(Z,D+1))===-1)return j||pe.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ue.length,index:L}),ee();if(D===V-1)return ee(Y.substring(L,D).replace(F,Z));if(Z===xe&&Y[D+1]===xe)D++;else if(Z===xe||D===0||Y[D-1]!==xe){K!==-1&&K<D+1&&(K=Y.indexOf(k,D+1));var U=re((P=P!==-1&&P<D+1?Y.indexOf(I,D+1):P)===-1?K:Math.min(K,P));if(Y.substr(D+1+U,H)===k){be.push(Y.substring(L,D).replace(F,Z)),Y[L=D+1+U+H]!==Z&&(D=Y.indexOf(Z,L)),K=Y.indexOf(k,L),P=Y.indexOf(I,L);break}if(U=re(P),Y.substring(D+1+U,D+1+U+ne)===I){if(be.push(Y.substring(L,D).replace(F,Z)),ie(D+1+U+ne),K=Y.indexOf(k,L),D=Y.indexOf(Z,L),de&&(ce(),ge))return le();if(W&&ue.length>=W)return le(!0);break}pe.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ue.length,index:L}),D++}}else if(N&&be.length===0&&Y.substring(L,L+ye)===N){if(P===-1)return le();L=P+ne,P=Y.indexOf(I,L),K=Y.indexOf(k,L)}else if(K!==-1&&(K<P||P===-1))be.push(Y.substring(L,K)),L=K+H,K=Y.indexOf(k,L);else{if(P===-1)break;if(be.push(Y.substring(L,P)),ie(P+ne),de&&(ce(),ge))return le();if(W&&ue.length>=W)return le(!0)}return ee();function te(we){ue.push(we),b=L}function re(we){var Ae=0;return Ae=we!==-1&&(we=Y.substring(D+1,we))&&we.trim()===""?we.length:Ae}function ee(we){return j||(we===void 0&&(we=Y.substring(L)),be.push(we),L=V,te(be),de&&ce()),le()}function ie(we){L=we,te(be),be=[],P=Y.indexOf(I,L)}function le(we){if(A.header&&!O&&ue.length&&!ae){var Ae=ue[0],Se=Object.create(null),$e=new Set(Ae);let Ie=!1;for(let Ne=0;Ne<Ae.length;Ne++){let qe=Ae[Ne];if(Se[qe=_(A.transformHeader)?A.transformHeader(qe,Ne):qe]){let Le,Nt=Se[qe];for(;Le=qe+"_"+Nt,Nt++,$e.has(Le););$e.add(Le),Ae[Ne]=Le,Se[qe]++,Ie=!0,(Q=Q===null?{}:Q)[Le]=qe}else Se[qe]=1,Ae[Ne]=qe;$e.add(qe)}Ie&&console.warn("Duplicate headers found and renamed."),ae=!0}return{data:ue,errors:pe,meta:{delimiter:k,linebreak:I,aborted:ge,truncated:!!we,cursor:b+(O||0),renamedHeaders:Q}}}function ce(){S(le()),ue=[],pe=[]}},this.abort=function(){ge=!0},this.getCharIndex=function(){return L}}function y(A){var k=A.data,I=o[k.workerId],N=!1;if(k.error)I.userError(k.error,k.file);else if(k.results&&k.results.data){var S={abort:function(){N=!0,w(k.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:T,resume:T};if(_(I.userStep)){for(var W=0;W<k.results.data.length&&(I.userStep({data:k.results.data[W],errors:k.results.errors,meta:k.results.meta},S),!N);W++);delete k.results}else _(I.userChunk)&&(I.userChunk(k.results,S,k.file),delete k.results)}k.finished&&!N&&w(k.workerId,k.results)}function w(A,k){var I=o[A];_(I.userComplete)&&I.userComplete(k),I.terminate(),delete o[A]}function T(){throw new Error("Not implemented.")}function C(A){if(typeof A!="object"||A===null)return A;var k,I=Array.isArray(A)?[]:{};for(k in A)I[k]=C(A[k]);return I}function R(A,k){return function(){A.apply(k,arguments)}}function _(A){return typeof A=="function"}return c.parse=function(A,k){var I=(k=k||{}).dynamicTyping||!1;if(_(I)&&(k.dynamicTypingFunction=I,I={}),k.dynamicTyping=I,k.transform=!!_(k.transform)&&k.transform,!k.worker||!c.WORKERS_SUPPORTED)return I=null,c.NODE_STREAM_INPUT,typeof A=="string"?(A=(N=>N.charCodeAt(0)!==65279?N:N.slice(1))(A),I=new(k.download?h:d)(k)):A.readable===!0&&_(A.read)&&_(A.on)?I=new m(k):(i.File&&A instanceof File||A instanceof Object)&&(I=new u(k)),I.stream(A);(I=(()=>{var N;return!!c.WORKERS_SUPPORTED&&(N=(()=>{var S=i.URL||i.webkitURL||null,W=t.toString();return c.BLOB_URL||(c.BLOB_URL=S.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",W,")();"],{type:"text/javascript"})))})(),(N=new i.Worker(N)).onmessage=y,N.id=l++,o[N.id]=N)})()).userStep=k.step,I.userChunk=k.chunk,I.userComplete=k.complete,I.userError=k.error,k.step=_(k.step),k.chunk=_(k.chunk),k.complete=_(k.complete),k.error=_(k.error),delete k.worker,I.postMessage({input:A,config:k,workerId:I.id})},c.unparse=function(A,k){var I=!1,N=!0,S=",",W=`\r
`,E='"',Q=E+E,ae=!1,Z=null,xe=!1,L=((()=>{if(typeof k=="object"){if(typeof k.delimiter!="string"||c.BAD_DELIMITERS.filter(function(O){return k.delimiter.indexOf(O)!==-1}).length||(S=k.delimiter),typeof k.quotes!="boolean"&&typeof k.quotes!="function"&&!Array.isArray(k.quotes)||(I=k.quotes),typeof k.skipEmptyLines!="boolean"&&typeof k.skipEmptyLines!="string"||(ae=k.skipEmptyLines),typeof k.newline=="string"&&(W=k.newline),typeof k.quoteChar=="string"&&(E=k.quoteChar),typeof k.header=="boolean"&&(N=k.header),Array.isArray(k.columns)){if(k.columns.length===0)throw new Error("Option columns is empty");Z=k.columns}k.escapeChar!==void 0&&(Q=k.escapeChar+E),k.escapeFormulae instanceof RegExp?xe=k.escapeFormulae:typeof k.escapeFormulae=="boolean"&&k.escapeFormulae&&(xe=/^[=+\-@\t\r].*$/)}})(),new RegExp(g(E),"g"));if(typeof A=="string"&&(A=JSON.parse(A)),Array.isArray(A)){if(!A.length||Array.isArray(A[0]))return ge(null,A,ae);if(typeof A[0]=="object")return ge(Z||Object.keys(A[0]),A,ae)}else if(typeof A=="object")return typeof A.data=="string"&&(A.data=JSON.parse(A.data)),Array.isArray(A.data)&&(A.fields||(A.fields=A.meta&&A.meta.fields||Z),A.fields||(A.fields=Array.isArray(A.data[0])?A.fields:typeof A.data[0]=="object"?Object.keys(A.data[0]):[]),Array.isArray(A.data[0])||typeof A.data[0]=="object"||(A.data=[A.data])),ge(A.fields||[],A.data||[],ae);throw new Error("Unable to serialize unrecognized input");function ge(O,j,V){var H="",ne=(typeof O=="string"&&(O=JSON.parse(O)),typeof j=="string"&&(j=JSON.parse(j)),Array.isArray(O)&&0<O.length),ye=!Array.isArray(j[0]);if(ne&&N){for(var de=0;de<O.length;de++)0<de&&(H+=S),H+=Y(O[de],de);0<j.length&&(H+=W)}for(var ue=0;ue<j.length;ue++){var pe=(ne?O:j[ue]).length,be=!1,b=ne?Object.keys(j[ue]).length===0:j[ue].length===0;if(V&&!ne&&(be=V==="greedy"?j[ue].join("").trim()==="":j[ue].length===1&&j[ue][0].length===0),V==="greedy"&&ne){for(var J=[],v=0;v<pe;v++){var K=ye?O[v]:v;J.push(j[ue][K])}be=J.join("").trim()===""}if(!be){for(var P=0;P<pe;P++){0<P&&!b&&(H+=S);var F=ne&&ye?O[P]:P;H+=Y(j[ue][F],P)}ue<j.length-1&&(!V||0<pe&&!b)&&(H+=W)}}return H}function Y(O,j){var V,H;return O==null?"":O.constructor===Date?JSON.stringify(O).slice(1,25):(H=!1,xe&&typeof O=="string"&&xe.test(O)&&(O="'"+O,H=!0),V=O.toString().replace(L,Q),(H=H||I===!0||typeof I=="function"&&I(O,j)||Array.isArray(I)&&I[j]||((ne,ye)=>{for(var de=0;de<ye.length;de++)if(-1<ne.indexOf(ye[de]))return!0;return!1})(V,c.BAD_DELIMITERS)||-1<V.indexOf(S)||V.charAt(0)===" "||V.charAt(V.length-1)===" ")?E+V+E:V)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!s&&!!i.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=x,c.ParserHandle=p,c.NetworkStreamer=h,c.FileStreamer=u,c.StringStreamer=d,c.ReadableStreamStreamer=m,i.jQuery&&((n=i.jQuery).fn.parse=function(A){var k=A.config||{},I=[];return this.each(function(W){if(!(n(this).prop("tagName").toUpperCase()==="INPUT"&&n(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var E=0;E<this.files.length;E++)I.push({file:this.files[E],inputElem:this,instanceConfig:n.extend({},k)})}),N(),this;function N(){if(I.length===0)_(A.complete)&&A.complete();else{var W,E,Q,ae,Z=I[0];if(_(A.before)){var xe=A.before(Z.file,Z.inputElem);if(typeof xe=="object"){if(xe.action==="abort")return W="AbortError",E=Z.file,Q=Z.inputElem,ae=xe.reason,void(_(A.error)&&A.error({name:W},E,Q,ae));if(xe.action==="skip")return void S();typeof xe.config=="object"&&(Z.instanceConfig=n.extend(Z.instanceConfig,xe.config))}else if(xe==="skip")return void S()}var L=Z.instanceConfig.complete;Z.instanceConfig.complete=function(ge){_(L)&&L(ge,Z.file,Z.inputElem),S()},c.parse(Z.file,Z.instanceConfig)}}function S(){I.splice(0,1),N()}}),a&&(i.onmessage=function(A){A=A.data,c.WORKER_ID===void 0&&A&&(c.WORKER_ID=A.workerId),typeof A.input=="string"?i.postMessage({workerId:c.WORKER_ID,results:c.parse(A.input,A.config),finished:!0}):(i.File&&A.input instanceof File||A.input instanceof Object)&&(A=c.parse(A.input,A.config))&&i.postMessage({workerId:c.WORKER_ID,results:A,finished:!0})}),(h.prototype=Object.create(f.prototype)).constructor=h,(u.prototype=Object.create(f.prototype)).constructor=u,(d.prototype=Object.create(d.prototype)).constructor=d,(m.prototype=Object.create(f.prototype)).constructor=m,c})})(ix);var __=ix.exports;const S_=rx(__);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var nx=1252,T_=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],o0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},l0=function(r){T_.indexOf(r)!=-1&&(nx=o0[0]=r)};function E_(){l0(1252)}var ci=function(r){l0(r)};function sx(){ci(1200),E_()}function Gd(r){for(var e=[],t=0,i=r.length;t<i;++t)e[t]=r.charCodeAt(t);return e}function C_(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function ax(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var Aa=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?C_(r.slice(2)):e==254&&t==255?ax(r.slice(2)):e==65279?r.slice(1):r},fl=function(e){return String.fromCharCode(e)},Kd=function(e){return String.fromCharCode(e)},po,kn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xd(r){for(var e="",t=0,i=0,n=0,s=0,a=0,o=0,l=0,c=0;c<r.length;)t=r.charCodeAt(c++),s=t>>2,i=r.charCodeAt(c++),a=(t&3)<<4|i>>4,n=r.charCodeAt(c++),o=(i&15)<<2|n>>6,l=n&63,isNaN(i)?o=l=64:isNaN(n)&&(l=64),e+=kn.charAt(s)+kn.charAt(a)+kn.charAt(o)+kn.charAt(l);return e}function jr(r){var e="",t=0,i=0,n=0,s=0,a=0,o=0,l=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<r.length;)s=kn.indexOf(r.charAt(c++)),a=kn.indexOf(r.charAt(c++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=kn.indexOf(r.charAt(c++)),i=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(i)),l=kn.indexOf(r.charAt(c++)),n=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(n));return e}var Ze=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),gs=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Rn(r){return Ze?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function qd(r){return Ze?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var li=function(e){return Ze?gs(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function xs(r){if(Array.isArray(r))return r.map(function(i){return String.fromCharCode(i)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function c0(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return c0(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var yn=Ze?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:gs(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var i=new Uint8Array(t),n=0;for(e=0,t=0;e<r.length;t+=n,++e)if(n=r[e].length,r[e]instanceof Uint8Array)i.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";i.set(new Uint8Array(r[e]),t)}return i}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function A_(r){for(var e=[],t=0,i=r.length+250,n=Rn(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)n[t++]=a;else if(a<2048)n[t++]=192|a>>6&31,n[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++s)&1023;n[t++]=240|a>>8&7,n[t++]=128|a>>2&63,n[t++]=128|o>>6&15|(a&3)<<4,n[t++]=128|o&63}else n[t++]=224|a>>12&15,n[t++]=128|a>>6&63,n[t++]=128|a&63;t>i&&(e.push(n.slice(0,t)),t=0,n=Rn(65535),i=65530)}return e.push(n.slice(0,t)),yn(e)}var br=/\u0000/g,Oa=/[\u0001-\u0006]/g;function Ws(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function fi(r,e){var t=""+r;return t.length>=e?t:wt("0",e-t.length)+t}function f0(r,e){var t=""+r;return t.length>=e?t:wt(" ",e-t.length)+t}function mc(r,e){var t=""+r;return t.length>=e?t:t+wt(" ",e-t.length)}function O_(r,e){var t=""+Math.round(r);return t.length>=e?t:wt("0",e-t.length)+t}function F_(r,e){var t=""+r;return t.length>=e?t:wt("0",e-t.length)+t}var Yd=Math.pow(2,32);function Ss(r,e){if(r>Yd||r<-Yd)return O_(r,e);var t=Math.round(r);return F_(t,e)}function gc(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Jd=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Hf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function D_(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var Ke={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Zd={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},R_={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xc(r,e,t){for(var i=r<0?-1:1,n=r*i,s=0,a=1,o=0,l=1,c=0,f=0,h=Math.floor(n);c<e&&(h=Math.floor(n),o=h*a+s,f=h*c+l,!(n-h<5e-8));)n=1/(n-h),s=a,a=o,l=c,c=f;if(f>e&&(c>e?(f=l,o=s):(f=c,o=a)),!t)return[0,i*o,f];var u=Math.floor(i*o/f);return[u,i*o-u*f,f]}function Qn(r,e,t){if(r>2958465||r<0)return null;var i=r|0,n=Math.floor(86400*(r-i)),s=0,a=[],o={D:i,T:n,u:86400*(r-i)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(i+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++i,++o.D)),i===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(i===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{i>60&&--i;var l=new Date(1900,0,1);l.setDate(l.getDate()+i-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),i<60&&(s=(s+6)%7),t&&(s=N_(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}var ox=new Date(1899,11,31,0,0,0),M_=ox.getTime(),I_=new Date(1900,2,1,0,0,0);function lx(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=I_&&(t+=24*60*60*1e3),(t-(M_+(r.getTimezoneOffset()-ox.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function h0(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function P_(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function L_(r){var e=r<0?12:11,t=h0(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function B_(r){var e=h0(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function mo(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=L_(r):e===10?t=r.toFixed(10).substr(0,12):t=B_(r),h0(P_(t.toUpperCase()))}function os(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):mo(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return ti(14,lx(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function N_(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function U_(r,e,t,i){var n="",s=0,a=0,o=t.y,l,c=0;switch(r){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,c=e.length;break;case 3:return Hf[t.m-1][1];case 5:return Hf[t.m-1][0];default:return Hf[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,c=e.length;break;case 3:return Jd[t.q][0];default:return Jd[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?fi(t.S,e.length):(i>=2?a=i===3?1e3:100:a=i===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(n=fi(s,2+i),e==="ss"?n.substr(0,2):"."+n.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?fi(l,c):"";return f}function bn(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,i=r.substr(0,t);t!=r.length;t+=e)i+=(i.length>0?",":"")+r.substr(t,e);return i}var cx=/%/g;function H_(r,e,t){var i=e.replace(cx,""),n=e.length-i.length;return Qi(r,i,t*Math.pow(10,2*n))+wt("%",n)}function z_(r,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return Qi(r,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function fx(r,e){var t,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+fx(r,-e);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(e/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else t=e.toExponential(i);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var hx=/# (\?+)( ?)\/( ?)(\d+)/;function W_(r,e,t){var i=parseInt(r[4],10),n=Math.round(e*i),s=Math.floor(n/i),a=n-s*i,o=i;return t+(s===0?"":""+s)+" "+(a===0?wt(" ",r[1].length+1+r[4].length):f0(a,r[1].length)+r[2]+"/"+r[3]+fi(o,r[4].length))}function V_(r,e,t){return t+(e===0?"":""+e)+wt(" ",r[1].length+2+r[4].length)}var ux=/^#*0*\.([0#]+)/,dx=/\).*[0#]/,px=/\(###\) ###\\?-####/;function mr(r){for(var e="",t,i=0;i!=r.length;++i)switch(t=r.charCodeAt(i)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Qd(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function ep(r,e){var t=r-Math.floor(r),i=Math.pow(10,e);return e<(""+Math.round(t*i)).length?0:Math.round(t*i)}function j_(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function $_(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Gr(r,e,t){if(r.charCodeAt(0)===40&&!e.match(dx)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Gr("n",i,t):"("+Gr("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return z_(r,e,t);if(e.indexOf("%")!==-1)return H_(r,e,t);if(e.indexOf("E")!==-1)return fx(e,t);if(e.charCodeAt(0)===36)return"$"+Gr(r,e.substr(e.charAt(1)==" "?2:1),t);var n,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+Ss(l,e.length);if(e.match(/^[#?]+$/))return n=Ss(t,0),n==="0"&&(n=""),n.length>e.length?n:mr(e.substr(0,e.length-n.length))+n;if(s=e.match(hx))return W_(s,l,c);if(e.match(/^#+0+$/))return c+Ss(l,e.length-e.indexOf("0"));if(s=e.match(ux))return n=Qd(t,s[1].length).replace(/^([^\.]+)$/,"$1."+mr(s[1])).replace(/\.$/,"."+mr(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+wt("0",mr(s[1]).length-p.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+Qd(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+bn(Ss(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Gr(r,e,-t):bn(""+(Math.floor(t)+j_(t,s[1].length)))+"."+fi(ep(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Gr(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ws(Gr(r,e.replace(/[\\-]/g,""),t)),a=0,Ws(Ws(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<n.length?n.charAt(a++):m==="0"?"0":""}));if(e.match(px))return n=Gr(r,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=xc(l,Math.pow(10,a)-1,!1),n=""+c,f=Qi("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=mc(o[2],a),f.length<s[4].length&&(f=mr(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=xc(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?f0(o[1],a)+s[2]+"/"+s[3]+mc(o[2],a):wt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=Ss(t,0),e.length<=n.length?n:mr(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var h=e.indexOf(".")-a,u=e.length-n.length-h;return mr(e.substr(0,h)+n+e.substr(e.length-u))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=ep(t,s[1].length),t<0?"-"+Gr(r,e,-t):bn($_(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?fi(0,3-m.length):"")+m})+"."+fi(a,s[1].length);switch(e){case"###,##0.00":return Gr(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var d=bn(Ss(l,0));return d!=="0"?c+d:"";case"###,###.00":return Gr(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Gr(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function G_(r,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return Qi(r,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function K_(r,e,t){var i=e.replace(cx,""),n=e.length-i.length;return Qi(r,i,t*Math.pow(10,2*n))+wt("%",n)}function mx(r,e){var t,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+mx(r,-e);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(e/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else t=e.toExponential(i);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function _i(r,e,t){if(r.charCodeAt(0)===40&&!e.match(dx)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?_i("n",i,t):"("+_i("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return G_(r,e,t);if(e.indexOf("%")!==-1)return K_(r,e,t);if(e.indexOf("E")!==-1)return mx(e,t);if(e.charCodeAt(0)===36)return"$"+_i(r,e.substr(e.charAt(1)==" "?2:1),t);var n,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+fi(l,e.length);if(e.match(/^[#?]+$/))return n=""+t,t===0&&(n=""),n.length>e.length?n:mr(e.substr(0,e.length-n.length))+n;if(s=e.match(hx))return V_(s,l,c);if(e.match(/^#+0+$/))return c+fi(l,e.length-e.indexOf("0"));if(s=e.match(ux))return n=(""+t).replace(/^([^\.]+)$/,"$1."+mr(s[1])).replace(/\.$/,"."+mr(s[1])),n=n.replace(/\.(\d*)$/,function(m,p){return"."+p+wt("0",mr(s[1]).length-p.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+bn(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+_i(r,e,-t):bn(""+t)+"."+wt("0",s[1].length);if(s=e.match(/^#,#*,#0/))return _i(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ws(_i(r,e.replace(/[\\-]/g,""),t)),a=0,Ws(Ws(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<n.length?n.charAt(a++):m==="0"?"0":""}));if(e.match(px))return n=_i(r,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=xc(l,Math.pow(10,a)-1,!1),n=""+c,f=Qi("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=mc(o[2],a),f.length<s[4].length&&(f=mr(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=xc(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?f0(o[1],a)+s[2]+"/"+s[3]+mc(o[2],a):wt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=""+t,e.length<=n.length?n:mr(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var h=e.indexOf(".")-a,u=e.length-n.length-h;return mr(e.substr(0,h)+n+e.substr(e.length-u))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+_i(r,e,-t):bn(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?fi(0,3-m.length):"")+m})+"."+fi(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var d=bn(""+l);return d!=="0"?c+d:"";default:if(e.match(/\.[0#?]*$/))return _i(r,e.slice(0,e.lastIndexOf(".")),t)+mr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Qi(r,e,t){return(t|0)===t?_i(r,e,t):Gr(r,e,t)}function X_(r){for(var e=[],t=!1,i=0,n=0;i<r.length;++i)switch(r.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=r.substr(n,i-n),n=i+1}if(e[e.length]=r.substr(n),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var gx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fa(r){for(var e=0,t="",i="";e<r.length;)switch(t=r.charAt(e)){case"G":gc(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(i=t;r.charAt(e++)!=="]"&&e<r.length;)i+=r.charAt(e);if(i.match(gx))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function q_(r,e,t,i){for(var n=[],s="",a=0,o="",l="t",c,f,h,u="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!gc(r,a))throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(h);n[n.length]={t:"t",v:s},++a;break;case"\\":var d=r.charAt(++a),m=d==="("||d===")"?d:"t";n[n.length]={t:m,v:d},++a;break;case"_":n[n.length]={t:"t",v:" "},a+=2;break;case"@":n[n.length]={t:"T",v:e},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(c==null&&(c=Qn(e,t,r.charAt(a+1)==="2"),c==null))return"";n[n.length]={t:"X",v:r.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Qn(e,t),c==null))return"";for(s=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=u),n[n.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var p={t:o,v:o};if(c==null&&(c=Qn(e,t)),r.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",u="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",a+=5,u="h"):r.substr(a,5).toUpperCase()==="/"?(c!=null&&(p.v=c.H>=12?"":""),p.t="T",a+=5,u="h"):(p.t="t",++a),c==null&&p.t==="T")return"";n[n.length]=p,l=o;break;case"[":for(s=o;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(gx)){if(c==null&&(c=Qn(e,t),c==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",fa(r)||(n[n.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<r.length&&(o=r.charAt(a))==="0";)s+=o;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)s+=o;n[n.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++a)===o;)s+=o;n[n.length]={t:o,v:s},l=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":n[n.length]={t:i===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:o,v:o},++a;break;case"$":n[n.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"t",v:o},++a;break}var g=0,x=0,y;for(a=n.length-1,l="t";a>=0;--a)switch(n[a].t){case"h":case"H":n[a].t=u,l="h",g<1&&(g=1);break;case"s":(y=n[a].v.match(/\.0+$/))&&(x=Math.max(x,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=n[a].t;break;case"m":l==="s"&&(n[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[a].v.match(/[Hh]/)&&(g=1),g<2&&n[a].v.match(/[Mm]/)&&(g=2),g<3&&n[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",T;for(a=0;a<n.length;++a)switch(n[a].t){case"t":case"T":case" ":case"D":break;case"X":n[a].v="",n[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[a].v=U_(n[a].t.charCodeAt(0),n[a].v,c,x),n[a].t="t";break;case"n":case"?":for(T=a+1;n[T]!=null&&((o=n[T].t)==="?"||o==="D"||(o===" "||o==="t")&&n[T+1]!=null&&(n[T+1].t==="?"||n[T+1].t==="t"&&n[T+1].v==="/")||n[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[T].v==="/"||n[T].v===" "&&n[T+1]!=null&&n[T+1].t=="?"));)n[a].v+=n[T].v,n[T]={v:"",t:";"},++T;w+=n[a].v,a=T-1;break;case"G":n[a].t="t",n[a].v=os(e,t);break}var C="",R,_;if(w.length>0){w.charCodeAt(0)==40?(R=e<0&&w.charCodeAt(0)===45?-e:e,_=Qi("n",w,R)):(R=e<0&&i>1?-e:e,_=Qi("n",w,R),R<0&&n[0]&&n[0].t=="t"&&(_=_.substr(1),n[0].v="-"+n[0].v)),T=_.length-1;var A=n.length;for(a=0;a<n.length;++a)if(n[a]!=null&&n[a].t!="t"&&n[a].v.indexOf(".")>-1){A=a;break}var k=n.length;if(A===n.length&&_.indexOf("E")===-1){for(a=n.length-1;a>=0;--a)n[a]==null||"n?".indexOf(n[a].t)===-1||(T>=n[a].v.length-1?(T-=n[a].v.length,n[a].v=_.substr(T+1,n[a].v.length)):T<0?n[a].v="":(n[a].v=_.substr(0,T+1),T=-1),n[a].t="t",k=a);T>=0&&k<n.length&&(n[k].v=_.substr(0,T+1)+n[k].v)}else if(A!==n.length&&_.indexOf("E")===-1){for(T=_.indexOf(".")-1,a=A;a>=0;--a)if(!(n[a]==null||"n?".indexOf(n[a].t)===-1)){for(f=n[a].v.indexOf(".")>-1&&a===A?n[a].v.indexOf(".")-1:n[a].v.length-1,C=n[a].v.substr(f+1);f>=0;--f)T>=0&&(n[a].v.charAt(f)==="0"||n[a].v.charAt(f)==="#")&&(C=_.charAt(T--)+C);n[a].v=C,n[a].t="t",k=a}for(T>=0&&k<n.length&&(n[k].v=_.substr(0,T+1)+n[k].v),T=_.indexOf(".")+1,a=A;a<n.length;++a)if(!(n[a]==null||"n?(".indexOf(n[a].t)===-1&&a!==A)){for(f=n[a].v.indexOf(".")>-1&&a===A?n[a].v.indexOf(".")+1:0,C=n[a].v.substr(0,f);f<n[a].v.length;++f)T<_.length&&(C+=_.charAt(T++));n[a].v=C,n[a].t="t",k=a}}}for(a=0;a<n.length;++a)n[a]!=null&&"n?".indexOf(n[a].t)>-1&&(R=i>1&&e<0&&a>0&&n[a-1].v==="-"?-e:e,n[a].v=Qi(n[a].t,n[a].v,R),n[a].t="t");var I="";for(a=0;a!==n.length;++a)n[a]!=null&&(I+=n[a].v);return I}var tp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function rp(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function Y_(r,e){var t=X_(r),i=t.length,n=t[i-1].indexOf("@");if(i<4&&n>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(tp),o=t[1].match(tp);return rp(e,a)?[i,t[0]]:rp(e,o)?[i,t[1]]:[i,t[a!=null&&o!=null?2:1]]}return[i,s]}function ti(r,e,t){t==null&&(t={});var i="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?i=t.dateNF:i=r;break;case"number":r==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:Ke)[r],i==null&&(i=t.table&&t.table[Zd[r]]||Ke[Zd[r]]),i==null&&(i=R_[r]||"General");break}if(gc(i,0))return os(e,t);e instanceof Date&&(e=lx(e,t.date1904));var n=Y_(i,e);if(gc(n[1]))return os(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return q_(n[1],e,t,n[0])}function is(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Ke[t]==null){e<0&&(e=t);continue}if(Ke[t]==r){e=t;break}}e<0&&(e=391)}return Ke[e]=r,e}function xx(){Ke=D_()}var J_={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Z_(r){var e=typeof r=="number"?Ke[r]:r;return e=e.replace(vx,"(\\d+)"),new RegExp("^"+e+"$")}function Q_(r,e,t){var i=-1,n=-1,s=-1,a=-1,o=-1,l=-1;(e.match(vx)||[]).forEach(function(h,u){var d=parseInt(t[u+1],10);switch(h.toLowerCase().charAt(0)){case"y":i=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:n=d;break}}),l>=0&&o==-1&&n>=0&&(o=n,n=-1);var c=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:i==-1&&n==-1&&s==-1?f:c+"T"+f}var eS=function(){var r={};r.version="1.2.0";function e(){for(var _=0,A=new Array(256),k=0;k!=256;++k)_=k,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,A[k]=_;return typeof Int32Array<"u"?new Int32Array(A):A}var t=e();function i(_){var A=0,k=0,I=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)N[I]=_[I];for(I=0;I!=256;++I)for(k=_[I],A=256+I;A<4096;A+=256)k=N[A]=k>>>8^_[k&255];var S=[];for(I=1;I!=16;++I)S[I-1]=typeof Int32Array<"u"?N.subarray(I*256,I*256+256):N.slice(I*256,I*256+256);return S}var n=i(t),s=n[0],a=n[1],o=n[2],l=n[3],c=n[4],f=n[5],h=n[6],u=n[7],d=n[8],m=n[9],p=n[10],g=n[11],x=n[12],y=n[13],w=n[14];function T(_,A){for(var k=A^-1,I=0,N=_.length;I<N;)k=k>>>8^t[(k^_.charCodeAt(I++))&255];return~k}function C(_,A){for(var k=A^-1,I=_.length-15,N=0;N<I;)k=w[_[N++]^k&255]^y[_[N++]^k>>8&255]^x[_[N++]^k>>16&255]^g[_[N++]^k>>>24]^p[_[N++]]^m[_[N++]]^d[_[N++]]^u[_[N++]]^h[_[N++]]^f[_[N++]]^c[_[N++]]^l[_[N++]]^o[_[N++]]^a[_[N++]]^s[_[N++]]^t[_[N++]];for(I+=15;N<I;)k=k>>>8^t[(k^_[N++])&255];return~k}function R(_,A){for(var k=A^-1,I=0,N=_.length,S=0,W=0;I<N;)S=_.charCodeAt(I++),S<128?k=k>>>8^t[(k^S)&255]:S<2048?(k=k>>>8^t[(k^(192|S>>6&31))&255],k=k>>>8^t[(k^(128|S&63))&255]):S>=55296&&S<57344?(S=(S&1023)+64,W=_.charCodeAt(I++)&1023,k=k>>>8^t[(k^(240|S>>8&7))&255],k=k>>>8^t[(k^(128|S>>2&63))&255],k=k>>>8^t[(k^(128|W>>6&15|(S&3)<<4))&255],k=k>>>8^t[(k^(128|W&63))&255]):(k=k>>>8^t[(k^(224|S>>12&15))&255],k=k>>>8^t[(k^(128|S>>6&63))&255],k=k>>>8^t[(k^(128|S&63))&255]);return~k}return r.table=t,r.bstr=T,r.buf=C,r.str=R,r}(),Qe=function(){var e={};e.version="1.2.1";function t(M,G){for(var B=M.split("/"),z=G.split("/"),X=0,q=0,oe=Math.min(B.length,z.length);X<oe;++X){if(q=B[X].length-z[X].length)return q;if(B[X]!=z[X])return B[X]<z[X]?-1:1}return B.length-z.length}function i(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:i(M.slice(0,-1));var G=M.lastIndexOf("/");return G===-1?M:M.slice(0,G+1)}function n(M){if(M.charAt(M.length-1)=="/")return n(M.slice(0,-1));var G=M.lastIndexOf("/");return G===-1?M:M.slice(G+1)}function s(M,G){typeof G=="string"&&(G=new Date(G));var B=G.getHours();B=B<<6|G.getMinutes(),B=B<<5|G.getSeconds()>>>1,M.write_shift(2,B);var z=G.getFullYear()-1980;z=z<<4|G.getMonth()+1,z=z<<5|G.getDate(),M.write_shift(2,z)}function a(M){var G=M.read_shift(2)&65535,B=M.read_shift(2)&65535,z=new Date,X=B&31;B>>>=5;var q=B&15;B>>>=4,z.setMilliseconds(0),z.setFullYear(B+1980),z.setMonth(q-1),z.setDate(X);var oe=G&31;G>>>=5;var ve=G&63;return G>>>=6,z.setHours(G),z.setMinutes(ve),z.setSeconds(oe<<1),z}function o(M){jt(M,0);for(var G={},B=0;M.l<=M.length-4;){var z=M.read_shift(2),X=M.read_shift(2),q=M.l+X,oe={};switch(z){case 21589:B=M.read_shift(1),B&1&&(oe.mtime=M.read_shift(4)),X>5&&(B&2&&(oe.atime=M.read_shift(4)),B&4&&(oe.ctime=M.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}M.l=q,G[z]=oe}return G}var l;function c(){return l||(l={})}function f(M,G){if(M[0]==80&&M[1]==75)return sl(M,G);if((M[0]|32)==109&&(M[1]|32)==105)return Gw(M,G);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var B=3,z=512,X=0,q=0,oe=0,ve=0,se=0,fe=[],he=M.slice(0,512);jt(he,0);var _e=h(he);switch(B=_e[0],B){case 3:z=512;break;case 4:z=4096;break;case 0:if(_e[1]==0)return sl(M,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}z!==512&&(he=M.slice(0,z),jt(he,28));var Ee=M.slice(0,z);u(he,B);var Me=he.read_shift(4,"i");if(B===3&&Me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Me);he.l+=4,oe=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),ve=he.read_shift(4,"i"),X=he.read_shift(4,"i"),se=he.read_shift(4,"i"),q=he.read_shift(4,"i");for(var Te=-1,Fe=0;Fe<109&&(Te=he.read_shift(4,"i"),!(Te<0));++Fe)fe[Fe]=Te;var Ve=d(M,z);g(se,q,Ve,z,fe);var xt=y(Ve,oe,fe,z);xt[oe].name="!Directory",X>0&&ve!==W&&(xt[ve].name="!MiniFAT"),xt[fe[0]].name="!FAT",xt.fat_addrs=fe,xt.ssz=z;var vt={},Jt=[],ga=[],xa=[];w(oe,xt,Ve,Jt,X,vt,ga,ve),m(ga,xa,Jt),Jt.shift();var va={FileIndex:ga,FullPaths:xa};return G&&G.raw&&(va.raw={header:Ee,sectors:Ve}),va}function h(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(E,"Header Signature: "),M.l+=16;var G=M.read_shift(2,"u");return[M.read_shift(2,"u"),G]}function u(M,G){var B=9;switch(M.l+=2,B=M.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function d(M,G){for(var B=Math.ceil(M.length/G)-1,z=[],X=1;X<B;++X)z[X-1]=M.slice(X*G,(X+1)*G);return z[B-1]=M.slice(B*G),z}function m(M,G,B){for(var z=0,X=0,q=0,oe=0,ve=0,se=B.length,fe=[],he=[];z<se;++z)fe[z]=he[z]=z,G[z]=B[z];for(;ve<he.length;++ve)z=he[ve],X=M[z].L,q=M[z].R,oe=M[z].C,fe[z]===z&&(X!==-1&&fe[X]!==X&&(fe[z]=fe[X]),q!==-1&&fe[q]!==q&&(fe[z]=fe[q])),oe!==-1&&(fe[oe]=z),X!==-1&&z!=fe[z]&&(fe[X]=fe[z],he.lastIndexOf(X)<ve&&he.push(X)),q!==-1&&z!=fe[z]&&(fe[q]=fe[z],he.lastIndexOf(q)<ve&&he.push(q));for(z=1;z<se;++z)fe[z]===z&&(q!==-1&&fe[q]!==q?fe[z]=fe[q]:X!==-1&&fe[X]!==X&&(fe[z]=fe[X]));for(z=1;z<se;++z)if(M[z].type!==0){if(ve=z,ve!=fe[ve])do ve=fe[ve],G[z]=G[ve]+"/"+G[z];while(ve!==0&&fe[ve]!==-1&&ve!=fe[ve]);fe[z]=-1}for(G[0]+="/",z=1;z<se;++z)M[z].type!==2&&(G[z]+="/")}function p(M,G,B){for(var z=M.start,X=M.size,q=[],oe=z;B&&X>0&&oe>=0;)q.push(G.slice(oe*S,oe*S+S)),X-=S,oe=qn(B,oe*4);return q.length===0?Rt(0):yn(q).slice(0,M.size)}function g(M,G,B,z,X){var q=W;if(M===W){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var oe=B[M],ve=(z>>>2)-1;if(!oe)return;for(var se=0;se<ve&&(q=qn(oe,se*4))!==W;++se)X.push(q);g(qn(oe,z-4),G-1,B,z,X)}}function x(M,G,B,z,X){var q=[],oe=[];X||(X=[]);var ve=z-1,se=0,fe=0;for(se=G;se>=0;){X[se]=!0,q[q.length]=se,oe.push(M[se]);var he=B[Math.floor(se*4/z)];if(fe=se*4&ve,z<4+fe)throw new Error("FAT boundary crossed: "+se+" 4 "+z);if(!M[he])break;se=qn(M[he],fe)}return{nodes:q,data:up([oe])}}function y(M,G,B,z){var X=M.length,q=[],oe=[],ve=[],se=[],fe=z-1,he=0,_e=0,Ee=0,Me=0;for(he=0;he<X;++he)if(ve=[],Ee=he+G,Ee>=X&&(Ee-=X),!oe[Ee]){se=[];var Te=[];for(_e=Ee;_e>=0;){Te[_e]=!0,oe[_e]=!0,ve[ve.length]=_e,se.push(M[_e]);var Fe=B[Math.floor(_e*4/z)];if(Me=_e*4&fe,z<4+Me)throw new Error("FAT boundary crossed: "+_e+" 4 "+z);if(!M[Fe]||(_e=qn(M[Fe],Me),Te[_e]))break}q[Ee]={nodes:ve,data:up([se])}}return q}function w(M,G,B,z,X,q,oe,ve){for(var se=0,fe=z.length?2:0,he=G[M].data,_e=0,Ee=0,Me;_e<he.length;_e+=128){var Te=he.slice(_e,_e+128);jt(Te,64),Ee=Te.read_shift(2),Me=g0(Te,0,Ee-fe),z.push(Me);var Fe={name:Me,type:Te.read_shift(1),color:Te.read_shift(1),L:Te.read_shift(4,"i"),R:Te.read_shift(4,"i"),C:Te.read_shift(4,"i"),clsid:Te.read_shift(16),state:Te.read_shift(4,"i"),start:0,size:0},Ve=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);Ve!==0&&(Fe.ct=T(Te,Te.l-8));var xt=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);xt!==0&&(Fe.mt=T(Te,Te.l-8)),Fe.start=Te.read_shift(4,"i"),Fe.size=Te.read_shift(4,"i"),Fe.size<0&&Fe.start<0&&(Fe.size=Fe.type=0,Fe.start=W,Fe.name=""),Fe.type===5?(se=Fe.start,X>0&&se!==W&&(G[se].name="!StreamData")):Fe.size>=4096?(Fe.storage="fat",G[Fe.start]===void 0&&(G[Fe.start]=x(B,Fe.start,G.fat_addrs,G.ssz)),G[Fe.start].name=Fe.name,Fe.content=G[Fe.start].data.slice(0,Fe.size)):(Fe.storage="minifat",Fe.size<0?Fe.size=0:se!==W&&Fe.start!==W&&G[se]&&(Fe.content=p(Fe,G[se].data,(G[ve]||{}).data))),Fe.content&&jt(Fe.content,0),q[Me]=Fe,oe.push(Fe)}}function T(M,G){return new Date((Ur(M,G+4)/1e7*Math.pow(2,32)+Ur(M,G)/1e7-11644473600)*1e3)}function C(M,G){return c(),f(l.readFileSync(M),G)}function R(M,G){var B=G&&G.type;switch(B||Ze&&Buffer.isBuffer(M)&&(B="buffer"),B||"base64"){case"file":return C(M,G);case"base64":return f(li(jr(M)),G);case"binary":return f(li(M),G)}return f(M,G)}function _(M,G){var B=G||{},z=B.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=z+"/",M.FileIndex[0]={name:z,type:5}),B.CLSID&&(M.FileIndex[0].clsid=B.CLSID),A(M)}function A(M){var G="Sh33tJ5";if(!Qe.find(M,"/"+G)){var B=Rt(4);B[0]=55,B[1]=B[3]=50,B[2]=54,M.FileIndex.push({name:G,type:2,content:B,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+G),k(M)}}function k(M,G){_(M);for(var B=!1,z=!1,X=M.FullPaths.length-1;X>=0;--X){var q=M.FileIndex[X];switch(q.type){case 0:z?B=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:z=!0,isNaN(q.R*q.L*q.C)&&(B=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!G)){var oe=new Date(1987,1,19),ve=0,se=Object.create?Object.create(null):{},fe=[];for(X=0;X<M.FullPaths.length;++X)se[M.FullPaths[X]]=!0,M.FileIndex[X].type!==0&&fe.push([M.FullPaths[X],M.FileIndex[X]]);for(X=0;X<fe.length;++X){var he=i(fe[X][0]);z=se[he],z||(fe.push([he,{name:n(he).replace("/",""),type:1,clsid:ae,ct:oe,mt:oe,content:null}]),se[he]=!0)}for(fe.sort(function(Me,Te){return t(Me[0],Te[0])}),M.FullPaths=[],M.FileIndex=[],X=0;X<fe.length;++X)M.FullPaths[X]=fe[X][0],M.FileIndex[X]=fe[X][1];for(X=0;X<fe.length;++X){var _e=M.FileIndex[X],Ee=M.FullPaths[X];if(_e.name=n(Ee).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||ae,X===0)_e.C=fe.length>1?1:-1,_e.size=0,_e.type=5;else if(Ee.slice(-1)=="/"){for(ve=X+1;ve<fe.length&&i(M.FullPaths[ve])!=Ee;++ve);for(_e.C=ve>=fe.length?-1:ve,ve=X+1;ve<fe.length&&i(M.FullPaths[ve])!=i(Ee);++ve);_e.R=ve>=fe.length?-1:ve,_e.type=1}else i(M.FullPaths[X+1]||"")==i(Ee)&&(_e.R=X+1),_e.type=2}}}function I(M,G){var B=G||{};if(B.fileType=="mad")return Kw(M,B);switch(k(M),B.fileType){case"zip":return Vn(M,B)}var z=function(Me){for(var Te=0,Fe=0,Ve=0;Ve<Me.FileIndex.length;++Ve){var xt=Me.FileIndex[Ve];if(xt.content){var vt=xt.content.length;vt>0&&(vt<4096?Te+=vt+63>>6:Fe+=vt+511>>9)}}for(var Jt=Me.FullPaths.length+3>>2,ga=Te+7>>3,xa=Te+127>>7,va=ga+Fe+Jt+xa,jn=va+127>>7,Af=jn<=109?0:Math.ceil((jn-109)/127);va+jn+Af+127>>7>jn;)Af=++jn<=109?0:Math.ceil((jn-109)/127);var ji=[1,Af,jn,xa,Jt,Fe,Te,0];return Me.FileIndex[0].size=Te<<6,ji[7]=(Me.FileIndex[0].start=ji[0]+ji[1]+ji[2]+ji[3]+ji[4]+ji[5])+(ji[6]+7>>3),ji}(M),X=Rt(z[7]<<9),q=0,oe=0;{for(q=0;q<8;++q)X.write_shift(1,Q[q]);for(q=0;q<8;++q)X.write_shift(2,0);for(X.write_shift(2,62),X.write_shift(2,3),X.write_shift(2,65534),X.write_shift(2,9),X.write_shift(2,6),q=0;q<3;++q)X.write_shift(2,0);for(X.write_shift(4,0),X.write_shift(4,z[2]),X.write_shift(4,z[0]+z[1]+z[2]+z[3]-1),X.write_shift(4,0),X.write_shift(4,4096),X.write_shift(4,z[3]?z[0]+z[1]+z[2]-1:W),X.write_shift(4,z[3]),X.write_shift(-4,z[1]?z[0]-1:W),X.write_shift(4,z[1]),q=0;q<109;++q)X.write_shift(-4,q<z[2]?z[1]+q:-1)}if(z[1])for(oe=0;oe<z[1];++oe){for(;q<236+oe*127;++q)X.write_shift(-4,q<z[2]?z[1]+q:-1);X.write_shift(-4,oe===z[1]-1?W:oe+1)}var ve=function(Me){for(oe+=Me;q<oe-1;++q)X.write_shift(-4,q+1);Me&&(++q,X.write_shift(-4,W))};for(oe=q=0,oe+=z[1];q<oe;++q)X.write_shift(-4,Z.DIFSECT);for(oe+=z[2];q<oe;++q)X.write_shift(-4,Z.FATSECT);ve(z[3]),ve(z[4]);for(var se=0,fe=0,he=M.FileIndex[0];se<M.FileIndex.length;++se)he=M.FileIndex[se],he.content&&(fe=he.content.length,!(fe<4096)&&(he.start=oe,ve(fe+511>>9)));for(ve(z[6]+7>>3);X.l&511;)X.write_shift(-4,Z.ENDOFCHAIN);for(oe=q=0,se=0;se<M.FileIndex.length;++se)he=M.FileIndex[se],he.content&&(fe=he.content.length,!(!fe||fe>=4096)&&(he.start=oe,ve(fe+63>>6)));for(;X.l&511;)X.write_shift(-4,Z.ENDOFCHAIN);for(q=0;q<z[4]<<2;++q){var _e=M.FullPaths[q];if(!_e||_e.length===0){for(se=0;se<17;++se)X.write_shift(4,0);for(se=0;se<3;++se)X.write_shift(4,-1);for(se=0;se<12;++se)X.write_shift(4,0);continue}he=M.FileIndex[q],q===0&&(he.start=he.size?he.start-1:W);var Ee=q===0&&B.root||he.name;if(fe=2*(Ee.length+1),X.write_shift(64,Ee,"utf16le"),X.write_shift(2,fe),X.write_shift(1,he.type),X.write_shift(1,he.color),X.write_shift(-4,he.L),X.write_shift(-4,he.R),X.write_shift(-4,he.C),he.clsid)X.write_shift(16,he.clsid,"hex");else for(se=0;se<4;++se)X.write_shift(4,0);X.write_shift(4,he.state||0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,he.start),X.write_shift(4,he.size),X.write_shift(4,0)}for(q=1;q<M.FileIndex.length;++q)if(he=M.FileIndex[q],he.size>=4096)if(X.l=he.start+1<<9,Ze&&Buffer.isBuffer(he.content))he.content.copy(X,X.l,0,he.size),X.l+=he.size+511&-512;else{for(se=0;se<he.size;++se)X.write_shift(1,he.content[se]);for(;se&511;++se)X.write_shift(1,0)}for(q=1;q<M.FileIndex.length;++q)if(he=M.FileIndex[q],he.size>0&&he.size<4096)if(Ze&&Buffer.isBuffer(he.content))he.content.copy(X,X.l,0,he.size),X.l+=he.size+63&-64;else{for(se=0;se<he.size;++se)X.write_shift(1,he.content[se]);for(;se&63;++se)X.write_shift(1,0)}if(Ze)X.l=X.length;else for(;X.l<X.length;)X.write_shift(1,0);return X}function N(M,G){var B=M.FullPaths.map(function(se){return se.toUpperCase()}),z=B.map(function(se){var fe=se.split("/");return fe[fe.length-(se.slice(-1)=="/"?2:1)]}),X=!1;G.charCodeAt(0)===47?(X=!0,G=B[0].slice(0,-1)+G):X=G.indexOf("/")!==-1;var q=G.toUpperCase(),oe=X===!0?B.indexOf(q):z.indexOf(q);if(oe!==-1)return M.FileIndex[oe];var ve=!q.match(Oa);for(q=q.replace(br,""),ve&&(q=q.replace(Oa,"!")),oe=0;oe<B.length;++oe)if((ve?B[oe].replace(Oa,"!"):B[oe]).replace(br,"")==q||(ve?z[oe].replace(Oa,"!"):z[oe]).replace(br,"")==q)return M.FileIndex[oe];return null}var S=64,W=-2,E="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:W,FREESECT:-1,HEADER_SIGNATURE:E,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(M,G,B){c();var z=I(M,B);l.writeFileSync(G,z)}function L(M){for(var G=new Array(M.length),B=0;B<M.length;++B)G[B]=String.fromCharCode(M[B]);return G.join("")}function ge(M,G){var B=I(M,G);switch(G&&G.type||"buffer"){case"file":return c(),l.writeFileSync(G.filename,B),B;case"binary":return typeof B=="string"?B:L(B);case"base64":return Xd(typeof B=="string"?B:L(B));case"buffer":if(Ze)return Buffer.isBuffer(B)?B:gs(B);case"array":return typeof B=="string"?li(B):B}return B}var Y;function O(M){try{var G=M.InflateRaw,B=new G;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)Y=M;else throw new Error("zlib does not expose bytesRead")}catch(z){console.error("cannot use native zlib: "+(z.message||z))}}function j(M,G){if(!Y)return Wn(M,G);var B=Y.InflateRaw,z=new B,X=z._processChunk(M.slice(M.l),z._finishFlushFlag);return M.l+=z.bytesRead,X}function V(M){return Y?Y.deflateRawSync(M):Ie(M)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(M){var G=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(G>>16|G>>8|G)&255}for(var ue=typeof Uint8Array<"u",pe=ue?new Uint8Array(256):[],be=0;be<256;++be)pe[be]=de(be);function b(M,G){var B=pe[M&255];return G<=8?B>>>8-G:(B=B<<8|pe[M>>8&255],G<=16?B>>>16-G:(B=B<<8|pe[M>>16&255],B>>>24-G))}function J(M,G){var B=G&7,z=G>>>3;return(M[z]|(B<=6?0:M[z+1]<<8))>>>B&3}function v(M,G){var B=G&7,z=G>>>3;return(M[z]|(B<=5?0:M[z+1]<<8))>>>B&7}function K(M,G){var B=G&7,z=G>>>3;return(M[z]|(B<=4?0:M[z+1]<<8))>>>B&15}function P(M,G){var B=G&7,z=G>>>3;return(M[z]|(B<=3?0:M[z+1]<<8))>>>B&31}function F(M,G){var B=G&7,z=G>>>3;return(M[z]|(B<=1?0:M[z+1]<<8))>>>B&127}function D(M,G,B){var z=G&7,X=G>>>3,q=(1<<B)-1,oe=M[X]>>>z;return B<8-z||(oe|=M[X+1]<<8-z,B<16-z)||(oe|=M[X+2]<<16-z,B<24-z)||(oe|=M[X+3]<<24-z),oe&q}function U(M,G,B){var z=G&7,X=G>>>3;return z<=5?M[X]|=(B&7)<<z:(M[X]|=B<<z&255,M[X+1]=(B&7)>>8-z),G+3}function te(M,G,B){var z=G&7,X=G>>>3;return B=(B&1)<<z,M[X]|=B,G+1}function re(M,G,B){var z=G&7,X=G>>>3;return B<<=z,M[X]|=B&255,B>>>=8,M[X+1]=B,G+8}function ee(M,G,B){var z=G&7,X=G>>>3;return B<<=z,M[X]|=B&255,B>>>=8,M[X+1]=B&255,M[X+2]=B>>>8,G+16}function ie(M,G){var B=M.length,z=2*B>G?2*B:G+5,X=0;if(B>=G)return M;if(Ze){var q=qd(z);if(M.copy)M.copy(q);else for(;X<M.length;++X)q[X]=M[X];return q}else if(ue){var oe=new Uint8Array(z);if(oe.set)oe.set(M);else for(;X<B;++X)oe[X]=M[X];return oe}return M.length=z,M}function le(M){for(var G=new Array(M),B=0;B<M;++B)G[B]=0;return G}function ce(M,G,B){var z=1,X=0,q=0,oe=0,ve=0,se=M.length,fe=ue?new Uint16Array(32):le(32);for(q=0;q<32;++q)fe[q]=0;for(q=se;q<B;++q)M[q]=0;se=M.length;var he=ue?new Uint16Array(se):le(se);for(q=0;q<se;++q)fe[X=M[q]]++,z<X&&(z=X),he[q]=0;for(fe[0]=0,q=1;q<=z;++q)fe[q+16]=ve=ve+fe[q-1]<<1;for(q=0;q<se;++q)ve=M[q],ve!=0&&(he[q]=fe[ve+16]++);var _e=0;for(q=0;q<se;++q)if(_e=M[q],_e!=0)for(ve=b(he[q],z)>>z-_e,oe=(1<<z+4-_e)-1;oe>=0;--oe)G[ve|oe<<_e]=_e&15|q<<4;return z}var we=ue?new Uint16Array(512):le(512),Ae=ue?new Uint16Array(32):le(32);if(!ue){for(var Se=0;Se<512;++Se)we[Se]=0;for(Se=0;Se<32;++Se)Ae[Se]=0}(function(){for(var M=[],G=0;G<32;G++)M.push(5);ce(M,Ae,32);var B=[];for(G=0;G<=143;G++)B.push(8);for(;G<=255;G++)B.push(9);for(;G<=279;G++)B.push(7);for(;G<=287;G++)B.push(8);ce(B,we,288)})();var $e=function(){for(var G=ue?new Uint8Array(32768):[],B=0,z=0;B<ye.length-1;++B)for(;z<ye[B+1];++z)G[z]=B;for(;z<32768;++z)G[z]=29;var X=ue?new Uint8Array(259):[];for(B=0,z=0;B<ne.length-1;++B)for(;z<ne[B+1];++z)X[z]=B;function q(ve,se){for(var fe=0;fe<ve.length;){var he=Math.min(65535,ve.length-fe),_e=fe+he==ve.length;for(se.write_shift(1,+_e),se.write_shift(2,he),se.write_shift(2,~he&65535);he-- >0;)se[se.l++]=ve[fe++]}return se.l}function oe(ve,se){for(var fe=0,he=0,_e=ue?new Uint16Array(32768):[];he<ve.length;){var Ee=Math.min(65535,ve.length-he);if(Ee<10){for(fe=U(se,fe,+(he+Ee==ve.length)),fe&7&&(fe+=8-(fe&7)),se.l=fe/8|0,se.write_shift(2,Ee),se.write_shift(2,~Ee&65535);Ee-- >0;)se[se.l++]=ve[he++];fe=se.l*8;continue}fe=U(se,fe,+(he+Ee==ve.length)+2);for(var Me=0;Ee-- >0;){var Te=ve[he];Me=(Me<<5^Te)&32767;var Fe=-1,Ve=0;if((Fe=_e[Me])&&(Fe|=he&-32768,Fe>he&&(Fe-=32768),Fe<he))for(;ve[Fe+Ve]==ve[he+Ve]&&Ve<250;)++Ve;if(Ve>2){Te=X[Ve],Te<=22?fe=re(se,fe,pe[Te+1]>>1)-1:(re(se,fe,3),fe+=5,re(se,fe,pe[Te-23]>>5),fe+=3);var xt=Te<8?0:Te-4>>2;xt>0&&(ee(se,fe,Ve-ne[Te]),fe+=xt),Te=G[he-Fe],fe=re(se,fe,pe[Te]>>3),fe-=3;var vt=Te<4?0:Te-2>>1;vt>0&&(ee(se,fe,he-Fe-ye[Te]),fe+=vt);for(var Jt=0;Jt<Ve;++Jt)_e[Me]=he&32767,Me=(Me<<5^ve[he])&32767,++he;Ee-=Ve-1}else Te<=143?Te=Te+48:fe=te(se,fe,1),fe=re(se,fe,pe[Te]),_e[Me]=he&32767,++he}fe=re(se,fe,0)-1}return se.l=(fe+7)/8|0,se.l}return function(se,fe){return se.length<8?q(se,fe):oe(se,fe)}}();function Ie(M){var G=Rt(50+Math.floor(M.length*1.1)),B=$e(M,G);return G.slice(0,B)}var Ne=ue?new Uint16Array(32768):le(32768),qe=ue?new Uint16Array(32768):le(32768),Le=ue?new Uint16Array(128):le(128),Nt=1,Tt=1;function yt(M,G){var B=P(M,G)+257;G+=5;var z=P(M,G)+1;G+=5;var X=K(M,G)+4;G+=4;for(var q=0,oe=ue?new Uint8Array(19):le(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,fe=ue?new Uint8Array(8):le(8),he=ue?new Uint8Array(8):le(8),_e=oe.length,Ee=0;Ee<X;++Ee)oe[H[Ee]]=q=v(M,G),se<q&&(se=q),fe[q]++,G+=3;var Me=0;for(fe[0]=0,Ee=1;Ee<=se;++Ee)he[Ee]=Me=Me+fe[Ee-1]<<1;for(Ee=0;Ee<_e;++Ee)(Me=oe[Ee])!=0&&(ve[Ee]=he[Me]++);var Te=0;for(Ee=0;Ee<_e;++Ee)if(Te=oe[Ee],Te!=0){Me=pe[ve[Ee]]>>8-Te;for(var Fe=(1<<7-Te)-1;Fe>=0;--Fe)Le[Me|Fe<<Te]=Te&7|Ee<<3}var Ve=[];for(se=1;Ve.length<B+z;)switch(Me=Le[F(M,G)],G+=Me&7,Me>>>=3){case 16:for(q=3+J(M,G),G+=2,Me=Ve[Ve.length-1];q-- >0;)Ve.push(Me);break;case 17:for(q=3+v(M,G),G+=3;q-- >0;)Ve.push(0);break;case 18:for(q=11+F(M,G),G+=7;q-- >0;)Ve.push(0);break;default:Ve.push(Me),se<Me&&(se=Me);break}var xt=Ve.slice(0,B),vt=Ve.slice(B);for(Ee=B;Ee<286;++Ee)xt[Ee]=0;for(Ee=z;Ee<30;++Ee)vt[Ee]=0;return Nt=ce(xt,Ne,286),Tt=ce(vt,qe,30),G}function zn(M,G){if(M[0]==3&&!(M[1]&3))return[Rn(G),2];for(var B=0,z=0,X=qd(G||1<<18),q=0,oe=X.length>>>0,ve=0,se=0;!(z&1);){if(z=v(M,B),B+=3,z>>>1)z>>1==1?(ve=9,se=5):(B=yt(M,B),ve=Nt,se=Tt);else{B&7&&(B+=8-(B&7));var fe=M[B>>>3]|M[(B>>>3)+1]<<8;if(B+=32,fe>0)for(!G&&oe<q+fe&&(X=ie(X,q+fe),oe=X.length);fe-- >0;)X[q++]=M[B>>>3],B+=8;continue}for(;;){!G&&oe<q+32767&&(X=ie(X,q+32767),oe=X.length);var he=D(M,B,ve),_e=z>>>1==1?we[he]:Ne[he];if(B+=_e&15,_e>>>=4,!(_e>>>8&255))X[q++]=_e;else{if(_e==256)break;_e-=257;var Ee=_e<8?0:_e-4>>2;Ee>5&&(Ee=0);var Me=q+ne[_e];Ee>0&&(Me+=D(M,B,Ee),B+=Ee),he=D(M,B,se),_e=z>>>1==1?Ae[he]:qe[he],B+=_e&15,_e>>>=4;var Te=_e<4?0:_e-2>>1,Fe=ye[_e];for(Te>0&&(Fe+=D(M,B,Te),B+=Te),!G&&oe<Me&&(X=ie(X,Me+100),oe=X.length);q<Me;)X[q]=X[q-Fe],++q}}}return G?[X,B+7>>>3]:[X.slice(0,q),B+7>>>3]}function Wn(M,G){var B=M.slice(M.l||0),z=zn(B,G);return M.l+=z[1],z[0]}function nl(M,G){if(M)typeof console<"u"&&console.error(G);else throw new Error(G)}function sl(M,G){var B=M;jt(B,0);var z=[],X=[],q={FileIndex:z,FullPaths:X};_(q,{root:G.root});for(var oe=B.length-4;(B[oe]!=80||B[oe+1]!=75||B[oe+2]!=5||B[oe+3]!=6)&&oe>=0;)--oe;B.l=oe+4,B.l+=4;var ve=B.read_shift(2);B.l+=6;var se=B.read_shift(4);for(B.l=se,oe=0;oe<ve;++oe){B.l+=20;var fe=B.read_shift(4),he=B.read_shift(4),_e=B.read_shift(2),Ee=B.read_shift(2),Me=B.read_shift(2);B.l+=8;var Te=B.read_shift(4),Fe=o(B.slice(B.l+_e,B.l+_e+Ee));B.l+=_e+Ee+Me;var Ve=B.l;B.l=Te+4,al(B,fe,he,q,Fe),B.l=Ve}return q}function al(M,G,B,z,X){M.l+=2;var q=M.read_shift(2),oe=M.read_shift(2),ve=a(M);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var se=M.read_shift(4),fe=M.read_shift(4),he=M.read_shift(4),_e=M.read_shift(2),Ee=M.read_shift(2),Me="",Te=0;Te<_e;++Te)Me+=String.fromCharCode(M[M.l++]);if(Ee){var Fe=o(M.slice(M.l,M.l+Ee));(Fe[21589]||{}).mt&&(ve=Fe[21589].mt),((X||{})[21589]||{}).mt&&(ve=X[21589].mt)}M.l+=Ee;var Ve=M.slice(M.l,M.l+fe);switch(oe){case 8:Ve=j(M,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var xt=!1;q&8&&(se=M.read_shift(4),se==134695760&&(se=M.read_shift(4),xt=!0),fe=M.read_shift(4),he=M.read_shift(4)),fe!=G&&nl(xt,"Bad compressed size: "+G+" != "+fe),he!=B&&nl(xt,"Bad uncompressed size: "+B+" != "+he),Cf(z,Me,Ve,{unsafe:!0,mt:ve})}function Vn(M,G){var B=G||{},z=[],X=[],q=Rt(1),oe=B.compression?8:0,ve=0,se=0,fe=0,he=0,_e=0,Ee=M.FullPaths[0],Me=Ee,Te=M.FileIndex[0],Fe=[],Ve=0;for(se=1;se<M.FullPaths.length;++se)if(Me=M.FullPaths[se].slice(Ee.length),Te=M.FileIndex[se],!(!Te.size||!Te.content||Me=="Sh33tJ5")){var xt=he,vt=Rt(Me.length);for(fe=0;fe<Me.length;++fe)vt.write_shift(1,Me.charCodeAt(fe)&127);vt=vt.slice(0,vt.l),Fe[_e]=eS.buf(Te.content,0);var Jt=Te.content;oe==8&&(Jt=V(Jt)),q=Rt(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,ve),q.write_shift(2,oe),Te.mt?s(q,Te.mt):q.write_shift(4,0),q.write_shift(-4,Fe[_e]),q.write_shift(4,Jt.length),q.write_shift(4,Te.content.length),q.write_shift(2,vt.length),q.write_shift(2,0),he+=q.length,z.push(q),he+=vt.length,z.push(vt),he+=Jt.length,z.push(Jt),q=Rt(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,ve),q.write_shift(2,oe),q.write_shift(4,0),q.write_shift(-4,Fe[_e]),q.write_shift(4,Jt.length),q.write_shift(4,Te.content.length),q.write_shift(2,vt.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,xt),Ve+=q.l,X.push(q),Ve+=vt.length,X.push(vt),++_e}return q=Rt(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,_e),q.write_shift(2,_e),q.write_shift(4,Ve),q.write_shift(4,he),q.write_shift(2,0),yn([yn(z),yn(X),q])}var Vi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zw(M,G){if(M.ctype)return M.ctype;var B=M.name||"",z=B.match(/\.([^\.]+)$/);return z&&Vi[z[1]]||G&&(z=(B=G).match(/[\.\\]([^\.\\])+$/),z&&Vi[z[1]])?Vi[z[1]]:"application/octet-stream"}function Ww(M){for(var G=Xd(M),B=[],z=0;z<G.length;z+=76)B.push(G.slice(z,z+76));return B.join(`\r
`)+`\r
`}function Vw(M){var G=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var he=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],z=G.split(`\r
`),X=0;X<z.length;++X){var q=z[X];if(q.length==0){B.push("");continue}for(var oe=0;oe<q.length;){var ve=76,se=q.slice(oe,oe+ve);se.charAt(ve-1)=="="?ve--:se.charAt(ve-2)=="="?ve-=2:se.charAt(ve-3)=="="&&(ve-=3),se=q.slice(oe,oe+ve),oe+=ve,oe<q.length&&(se+="="),B.push(se)}}return B.join(`\r
`)}function jw(M){for(var G=[],B=0;B<M.length;++B){for(var z=M[B];B<=M.length&&z.charAt(z.length-1)=="=";)z=z.slice(0,z.length-1)+M[++B];G.push(z)}for(var X=0;X<G.length;++X)G[X]=G[X].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return li(G.join(`\r
`))}function $w(M,G,B){for(var z="",X="",q="",oe,ve=0;ve<10;++ve){var se=G[ve];if(!se||se.match(/^\s*$/))break;var fe=se.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":z=fe[2].trim();break;case"content-type":q=fe[2].trim();break;case"content-transfer-encoding":X=fe[2].trim();break}}switch(++ve,X.toLowerCase()){case"base64":oe=li(jr(G.slice(ve).join("")));break;case"quoted-printable":oe=jw(G.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+X)}var he=Cf(M,z.slice(B.length),oe,{unsafe:!0});q&&(he.ctype=q)}function Gw(M,G){if(L(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=G&&G.root||"",z=(Ze&&Buffer.isBuffer(M)?M.toString("binary"):L(M)).split(`\r
`),X=0,q="";for(X=0;X<z.length;++X)if(q=z[X],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),B||(B=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),q.slice(0,B.length)!=B););var oe=(z[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var ve="--"+(oe[1]||""),se=[],fe=[],he={FileIndex:se,FullPaths:fe};_(he);var _e,Ee=0;for(X=0;X<z.length;++X){var Me=z[X];Me!==ve&&Me!==ve+"--"||(Ee++&&$w(he,z.slice(_e,X),B),_e=X)}return he}function Kw(M,G){var B=G||{},z=B.boundary||"SheetJS";z="------="+z;for(var X=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+z.slice(2)+'"',"","",""],q=M.FullPaths[0],oe=q,ve=M.FileIndex[0],se=1;se<M.FullPaths.length;++se)if(oe=M.FullPaths[se].slice(q.length),ve=M.FileIndex[se],!(!ve.size||!ve.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ve){return"_x"+Ve.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ve){return"_u"+Ve.charCodeAt(0).toString(16)+"_"});for(var fe=ve.content,he=Ze&&Buffer.isBuffer(fe)?fe.toString("binary"):L(fe),_e=0,Ee=Math.min(1024,he.length),Me=0,Te=0;Te<=Ee;++Te)(Me=he.charCodeAt(Te))>=32&&Me<128&&++_e;var Fe=_e>=Ee*4/5;X.push(z),X.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+oe),X.push("Content-Transfer-Encoding: "+(Fe?"quoted-printable":"base64")),X.push("Content-Type: "+zw(ve,oe)),X.push(""),X.push(Fe?Vw(he):Ww(he))}return X.push(z+`--\r
`),X.join(`\r
`)}function Xw(M){var G={};return _(G,M),G}function Cf(M,G,B,z){var X=z&&z.unsafe;X||_(M);var q=!X&&Qe.find(M,G);if(!q){var oe=M.FullPaths[0];G.slice(0,oe.length)==oe?oe=G:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+G).replace("//","/")),q={name:n(G),type:2},M.FileIndex.push(q),M.FullPaths.push(oe),X||Qe.utils.cfb_gc(M)}return q.content=B,q.size=B?B.length:0,z&&(z.CLSID&&(q.clsid=z.CLSID),z.mt&&(q.mt=z.mt),z.ct&&(q.ct=z.ct)),q}function qw(M,G){_(M);var B=Qe.find(M,G);if(B){for(var z=0;z<M.FileIndex.length;++z)if(M.FileIndex[z]==B)return M.FileIndex.splice(z,1),M.FullPaths.splice(z,1),!0}return!1}function Yw(M,G,B){_(M);var z=Qe.find(M,G);if(z){for(var X=0;X<M.FileIndex.length;++X)if(M.FileIndex[X]==z)return M.FileIndex[X].name=n(B),M.FullPaths[X]=B,!0}return!1}function Jw(M){k(M,!0)}return e.find=N,e.read=R,e.parse=f,e.write=ge,e.writeFile=xe,e.utils={cfb_new:Xw,cfb_add:Cf,cfb_del:qw,cfb_mov:Yw,cfb_gc:Jw,ReadShift:$a,CheckField:Hx,prep_blob:jt,bconcat:yn,use_zlib:O,_deflateRaw:Ie,_inflateRaw:Wn,consts:Z},e}();function tS(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+r)}function Ni(r){for(var e=Object.keys(r),t=[],i=0;i<e.length;++i)Object.prototype.hasOwnProperty.call(r,e[i])&&t.push(e[i]);return t}function u0(r){for(var e=[],t=Ni(r),i=0;i!==t.length;++i)e[r[t[i]]]=t[i];return e}var vc=new Date(1899,11,30,0,0,0);function Tr(r,e){var t=r.getTime(),i=vc.getTime()+(r.getTimezoneOffset()-vc.getTimezoneOffset())*6e4;return(t-i)/(24*60*60*1e3)}var yx=new Date,rS=vc.getTime()+(yx.getTimezoneOffset()-vc.getTimezoneOffset())*6e4,ip=yx.getTimezoneOffset();function hf(r){var e=new Date;return e.setTime(r*24*60*60*1e3+rS),e.getTimezoneOffset()!==ip&&e.setTime(e.getTime()+(e.getTimezoneOffset()-ip)*6e4),e}function iS(r){var e=0,t=0,i=!1,n=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(t=1,s>3&&(i=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(i)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(n[s],10)}return e}var np=new Date("2017-02-19T19:06:09.000Z"),wx=isNaN(np.getFullYear())?new Date("2/19/17"):np,nS=wx.getFullYear()==2017;function Wt(r,e){var t=new Date(r);if(nS)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(wx.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return r.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var n=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ls(r,e){if(Ze&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return Da(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return Da(ax(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return Da(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return Da(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var i=[],n=0;n!=r.length;++n)i.push(String.fromCharCode(r[n]));return i.join("")}function Xt(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=Xt(r[t]));return e}function wt(r,e){for(var t="";t.length<e;)t+=r;return t}function di(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,i=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(i))||(i=i.replace(/[(](.*)[)]/,function(n,s){return t=-t,s}),!isNaN(e=Number(i)))?e/t:e}var sS=["january","february","march","april","may","june","july","august","september","october","november","december"];function Qs(r){var e=new Date(r),t=new Date(NaN),i=e.getYear(),n=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&sS.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return i<0||i>8099?t:(n>0||s>1)&&i!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var aS=function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,i,n){if(r||typeof i=="string")return t.split(i);for(var s=t.split(i),a=[s[0]],o=1;o<s.length;++o)a.push(n),a.push(s[o]);return a}}();function kx(r){return r?r.content&&r.type?ls(r.content,!0):r.data?Aa(r.data):r.asNodeBuffer&&Ze?Aa(r.asNodeBuffer().toString("binary")):r.asBinary?Aa(r.asBinary()):r._data&&r._data.getContent?Aa(ls(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function bx(r){if(!r)return null;if(r.data)return Gd(r.data);if(r.asNodeBuffer&&Ze)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?Gd(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function oS(r){return r&&r.name.slice(-4)===".bin"?bx(r):kx(r)}function Kr(r,e){for(var t=r.FullPaths||Ni(r.files),i=e.toLowerCase().replace(/[\/]/g,"\\"),n=i.replace(/\\/g,"/"),s=0;s<t.length;++s){var a=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==a||n==a)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function d0(r,e){var t=Kr(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Ct(r,e,t){if(!t)return oS(d0(r,e));if(!e)return null;try{return Ct(r,e)}catch{return null}}function Hr(r,e,t){if(!t)return kx(d0(r,e));if(!e)return null;try{return Hr(r,e)}catch{return null}}function lS(r,e,t){return bx(d0(r,e))}function sp(r){for(var e=r.FullPaths||Ni(r.files),t=[],i=0;i<e.length;++i)e[i].slice(-1)!="/"&&t.push(e[i].replace(/^Root Entry[\/]/,""));return t.sort()}function cS(r,e,t){if(r.FullPaths){if(typeof t=="string"){var i;return Ze?i=gs(t):i=A_(t),Qe.utils.cfb_add(r,e,i)}Qe.utils.cfb_add(r,e,t)}else r.file(e,t)}function _x(r,e){switch(e.type){case"base64":return Qe.read(r,{type:"base64"});case"binary":return Qe.read(r,{type:"binary"});case"buffer":case"array":return Qe.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Fa(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var i=r.split("/");i.length!==0;){var n=i.shift();n===".."?t.pop():n!=="."&&t.push(n)}return t.join("/")}var Sx=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,fS=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ap=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,hS=/<[^>]*>/g,ur=Sx.match(ap)?ap:hS,uS=/<\w*:/,dS=/<(\/?)\w+:/;function He(r,e,t){for(var i={},n=0,s=0;n!==r.length&&!((s=r.charCodeAt(n))===32||s===10||s===13);++n);if(e||(i[0]=r.slice(0,n)),n===r.length)return i;var a=r.match(fS),o=0,l="",c=0,f="",h="",u=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(f=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(u=(n=h.charCodeAt(s+1))==34||n==39?1:0,l=h.slice(s+1+u,h.length-u),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),i[f]=l,i[f.toLowerCase()]=l;else{var d=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(i[d]&&f.slice(o-3,o)=="ext")continue;i[d]=l,i[d.toLowerCase()]=l}}return i}function Hi(r){return r.replace(dS,"<$1")}var Tx={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},pS=u0(Tx),it=function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(i){var n=i+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(r,function(o,l){return Tx[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=n.indexOf("]]>");return t(n.slice(0,s))+n.slice(s+9,a)+t(n.slice(a+3))}}(),mS=/[&<>'"]/g,gS=/[\u0000-\u001f]/g;function p0(r){var e=r+"";return e.replace(mS,function(t){return pS[t]}).replace(/\n/g,"<br/>").replace(gS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var op=function(){var r=/&#(\d+);/g;function e(t,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(r,e)}}();function mt(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function zf(r){for(var e="",t=0,i=0,n=0,s=0,a=0,o=0;t<r.length;){if(i=r.charCodeAt(t++),i<128){e+=String.fromCharCode(i);continue}if(n=r.charCodeAt(t++),i>191&&i<224){a=(i&31)<<6,a|=n&63,e+=String.fromCharCode(a);continue}if(s=r.charCodeAt(t++),i<240){e+=String.fromCharCode((i&15)<<12|(n&63)<<6|s&63);continue}a=r.charCodeAt(t++),o=((i&7)<<18|(n&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function lp(r){var e=Rn(2*r.length),t,i,n=1,s=0,a=0,o;for(i=0;i<r.length;i+=n)n=1,(o=r.charCodeAt(i))<128?t=o:o<224?(t=(o&31)*64+(r.charCodeAt(i+1)&63),n=2):o<240?(t=(o&15)*4096+(r.charCodeAt(i+1)&63)*64+(r.charCodeAt(i+2)&63),n=3):(n=4,t=(o&7)*262144+(r.charCodeAt(i+1)&63)*4096+(r.charCodeAt(i+2)&63)*64+(r.charCodeAt(i+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function cp(r){return gs(r,"binary").toString("utf8")}var hl="foo bar baz",ut=Ze&&(cp(hl)==zf(hl)&&cp||lp(hl)==zf(hl)&&lp)||zf,Da=Ze?function(r){return gs(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,i=0,n=0;t<r.length;)switch(i=r.charCodeAt(t++),!0){case i<128:e.push(String.fromCharCode(i));break;case i<2048:e.push(String.fromCharCode(192+(i>>6))),e.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,n=r.charCodeAt(t++)-56320+(i<<10),e.push(String.fromCharCode(240+(n>>18&7))),e.push(String.fromCharCode(144+(n>>12&63))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)));break;default:e.push(String.fromCharCode(224+(i>>12))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)))}return e.join("")},go=function(){var r={};return function(t,i){var n=t+"|"+(i||"");return r[n]?r[n]:r[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",i||"")}}(),Ex=function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<r.length;++n)i=i.replace(r[n][0],r[n][1]);return i}}(),xS=function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),vS=/<\/?(?:vt:)?variant>/g,yS=/<(?:vt:)([^>]*)>([\s\S]*)</;function fp(r,e){var t=He(r),i=r.match(xS(t.baseType))||[],n=[];if(i.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+i.length+" != "+t.size);return n}return i.forEach(function(s){var a=s.replace(vS,"").match(yS);a&&n.push({v:ut(a[2]),t:a[1]})}),n}var wS=/(^\s|\s$|\n)/;function kS(r){return Ni(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function bS(r,e,t){return"<"+r+(t!=null?kS(t):"")+(e!=null?(e.match(wS)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function m0(r){if(Ze&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return ut(xs(c0(r)));throw new Error("Bad input format: expected Buffer or string")}var xo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,_S={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},SS=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function TS(r,e){for(var t=1-2*(r[e+7]>>>7),i=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),n=r[e+6]&15,s=5;s>=0;--s)n=n*256+r[e+s];return i==2047?n==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,n+=Math.pow(2,52)),t*Math.pow(2,i-52)*n)}function ES(r,e,t){var i=(e<0||1/e==-1/0?1:0)<<7,n=0,s=0,a=i?-e:e;isFinite(a)?a==0?n=s=0:(n=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)r[t+o]=s&255;r[t+6]=(n&15)<<4|s&15,r[t+7]=n>>4|i}var hp=function(r){for(var e=[],t=10240,i=0;i<r[0].length;++i)if(r[0][i])for(var n=0,s=r[0][i].length;n<s;n+=t)e.push.apply(e,r[0][i].slice(n,n+t));return e},up=Ze?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:gs(e)})):hp(r)}:hp,dp=function(r,e,t){for(var i=[],n=e;n<t;n+=2)i.push(String.fromCharCode(Ji(r,n)));return i.join("").replace(br,"")},g0=Ze?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(br,""):dp(r,e,t)}:dp,pp=function(r,e,t){for(var i=[],n=e;n<e+t;++n)i.push(("0"+r[n].toString(16)).slice(-2));return i.join("")},Cx=Ze?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):pp(r,e,t)}:pp,mp=function(r,e,t){for(var i=[],n=e;n<t;n++)i.push(String.fromCharCode(Cs(r,n)));return i.join("")},Wo=Ze?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf8",t,i):mp(e,t,i)}:mp,Ax=function(r,e){var t=Ur(r,e);return t>0?Wo(r,e+4,e+4+t-1):""},Ox=Ax,Fx=function(r,e){var t=Ur(r,e);return t>0?Wo(r,e+4,e+4+t-1):""},Dx=Fx,Rx=function(r,e){var t=2*Ur(r,e);return t>0?Wo(r,e+4,e+4+t-1):""},Mx=Rx,Ix=function(e,t){var i=Ur(e,t);return i>0?g0(e,t+4,t+4+i):""},Px=Ix,Lx=function(r,e){var t=Ur(r,e);return t>0?Wo(r,e+4,e+4+t):""},Bx=Lx,Nx=function(r,e){return TS(r,e)},yc=Nx,Ux=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ze&&(Ox=function(e,t){if(!Buffer.isBuffer(e))return Ax(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},Dx=function(e,t){if(!Buffer.isBuffer(e))return Fx(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},Mx=function(e,t){if(!Buffer.isBuffer(e))return Rx(e,t);var i=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i-1)},Px=function(e,t){if(!Buffer.isBuffer(e))return Ix(e,t);var i=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i)},Bx=function(e,t){if(!Buffer.isBuffer(e))return Lx(e,t);var i=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+i)},yc=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Nx(e,t)},Ux=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Cs=function(r,e){return r[e]},Ji=function(r,e){return r[e+1]*256+r[e]},CS=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},Ur=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},qn=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},AS=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function $a(r,e){var t="",i,n,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Ze&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(l=0;l<r;++l)t+=String.fromCharCode(Ji(this,c)),c+=2;r*=2;break;case"utf8":t=Wo(this,this.l,this.l+r);break;case"utf16le":r*=2,t=g0(this,this.l,this.l+r);break;case"wstr":return $a.call(this,r,"dbcs");case"lpstr-ansi":t=Ox(this,this.l),r=4+Ur(this,this.l);break;case"lpstr-cp":t=Dx(this,this.l),r=4+Ur(this,this.l);break;case"lpwstr":t=Mx(this,this.l),r=4+2*Ur(this,this.l);break;case"lpp4":r=4+Ur(this,this.l),t=Px(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+Ur(this,this.l),t=Bx(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(a=Cs(this,this.l+r++))!==0;)s.push(fl(a));t=s.join("");break;case"_wstr":for(r=0,t="";(a=Ji(this,this.l+r))!==0;)s.push(fl(a)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<r;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Cs(this,c),this.l=c+1,o=$a.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(fl(Ji(this,c))),c+=2}t=s.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,l=0;l!=r;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Cs(this,c),this.l=c+1,o=$a.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(fl(Cs(this,c))),c+=1}t=s.join("");break;default:switch(r){case 1:return i=Cs(this,this.l),this.l++,i;case 2:return i=(e==="i"?CS:Ji)(this,this.l),this.l+=2,i;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(i=(r>0?qn:AS)(this,this.l),this.l+=4,i):(n=Ur(this,this.l),this.l+=4,n);case 8:case-8:if(e==="f")return r==8?n=yc(this,this.l):n=yc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;r=8;case 16:t=Cx(this,this.l,r);break}}return this.l+=r,t}var OS=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},FS=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},DS=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function RS(r,e,t){var i=0,n=0;if(t==="dbcs"){for(n=0;n!=e.length;++n)DS(this,e.charCodeAt(n),this.l+2*n);i=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=e.length;++n)this[this.l+n]=e.charCodeAt(n)&255;i=e.length}else if(t==="hex"){for(;n<r;++n)this[this.l++]=parseInt(e.slice(2*n,2*n+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+r,this.length);for(n=0;n<Math.min(e.length,r);++n){var a=e.charCodeAt(n);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(r){case 1:i=1,this[this.l]=e&255;break;case 2:i=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:i=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:i=4,OS(this,e,this.l);break;case 8:if(i=8,t==="f"){ES(this,e,this.l);break}case 16:break;case-4:i=4,FS(this,e,this.l);break}return this.l+=i,this}function Hx(r,e){var t=Cx(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function jt(r,e){r.l=e,r.read_shift=$a,r.chk=Hx,r.write_shift=RS}function fr(r,e){r.l+=e}function Rt(r){var e=Rn(r);return jt(e,0),e}function fn(r,e,t){if(r){var i,n,s;jt(r,r.l||0);for(var a=r.length,o=0,l=0;r.l<a;){o=r.read_shift(1),o&128&&(o=(o&127)+((r.read_shift(1)&127)<<7));var c=Tc[o]||Tc[65535];for(i=r.read_shift(1),s=i&127,n=1;n<4&&i&128;++n)s+=((i=r.read_shift(1))&127)<<7*n;l=r.l+s;var f=c.f&&c.f(r,s,t);if(r.l=l,e(f,c,o))return}}}function Lh(){var r=[],e=Ze?256:2048,t=function(c){var f=Rt(c);return jt(f,0),f},i=t(e),n=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&r.push(i),i=null)},s=function(c){return i&&c<i.length-i.l?i:(n(),i=t(Math.max(c+1,e)))},a=function(){return n(),yn(r)},o=function(c){n(),i=c,i.l==null&&(i.l=i.length),s(e)};return{next:s,push:o,end:a,_bufs:r}}function Ga(r,e,t){var i=Xt(r);if(e.s?(i.cRel&&(i.c+=e.s.c),i.rRel&&(i.r+=e.s.r)):(i.cRel&&(i.c+=e.c),i.rRel&&(i.r+=e.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function gp(r,e,t){var i=Xt(r);return i.s=Ga(i.s,e.s,t),i.e=Ga(i.e,e.s,t),i}function Ka(r,e){if(r.cRel&&r.c<0)for(r=Xt(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=Xt(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=We(r);return!r.cRel&&r.cRel!=null&&(t=PS(t)),!r.rRel&&r.rRel!=null&&(t=MS(t)),t}function Wf(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Pt(r.s.c)+":"+(r.e.cRel?"":"$")+Pt(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+qt(r.s.r)+":"+(r.e.rRel?"":"$")+qt(r.e.r):Ka(r.s,e.biff)+":"+Ka(r.e,e.biff)}function x0(r){return parseInt(IS(r),10)-1}function qt(r){return""+(r+1)}function MS(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function IS(r){return r.replace(/\$(\d+)$/,"$1")}function v0(r){for(var e=LS(r),t=0,i=0;i!==e.length;++i)t=26*t+e.charCodeAt(i)-64;return t-1}function Pt(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function PS(r){return r.replace(/^([A-Z])/,"$$$1")}function LS(r){return r.replace(/^\$([A-Z])/,"$1")}function BS(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function kr(r){for(var e=0,t=0,i=0;i<r.length;++i){var n=r.charCodeAt(i);n>=48&&n<=57?e=10*e+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:e-1}}function We(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function ha(r){var e=r.indexOf(":");return e==-1?{s:kr(r),e:kr(r)}:{s:kr(r.slice(0,e)),e:kr(r.slice(e+1))}}function et(r,e){return typeof e>"u"||typeof e=="number"?et(r.s,r.e):(typeof r!="string"&&(r=We(r)),typeof e!="string"&&(e=We(e)),r==e?r:r+":"+e)}function kt(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,n=0,s=r.length;for(t=0;i<s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)t=26*t+n;for(e.s.c=--t,t=0;i<s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)t=10*t+n;if(e.s.r=--t,i===s||n!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++i,t=0;i!=s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)t=26*t+n;for(e.e.c=--t,t=0;i!=s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)t=10*t+n;return e.e.r=--t,e}function xp(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=ti(r.z,t?Tr(e):e)}catch{}try{return r.w=ti((r.XF||{}).numFmtId||(t?14:0),t?Tr(e):e)}catch{return""+e}}function sn(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?ws[r.v]||r.v:e==null?xp(r,r.v):xp(r,e))}function Un(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",i={};return i[t]=r,{SheetNames:[t],Sheets:i}}function zx(r,e,t){var i=t||{},n=r?Array.isArray(r):i.dense,s=r||(n?[]:{}),a=0,o=0;if(s&&i.origin!=null){if(typeof i.origin=="number")a=i.origin;else{var l=typeof i.origin=="string"?kr(i.origin):i.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=kt(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),a==-1&&(c.e.r=a=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=e[h].length;++u)if(!(typeof e[h][u]>"u")){var d={v:e[h][u]},m=a+h,p=o+u;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),e[h][u]&&typeof e[h][u]=="object"&&!Array.isArray(e[h][u])&&!(e[h][u]instanceof Date))d=e[h][u];else if(Array.isArray(d.v)&&(d.f=e[h][u][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(i.nullError)d.t="e",d.v=0;else if(i.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=i.dateNF||Ke[14],i.cellDates?(d.t="d",d.w=ti(d.z,Tr(d.v))):(d.t="n",d.v=Tr(d.v),d.w=ti(d.z,d.v))):d.t="s";if(n)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(d.z=s[m][p].z),s[m][p]=d;else{var g=We({c:p,r:m});s[g]&&s[g].z&&(d.z=s[g].z),s[g]=d}}}return c.s.c<1e7&&(s["!ref"]=et(c)),s}function ua(r,e){return zx(null,r,e)}function NS(r){return r.read_shift(4,"i")}function lr(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function US(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function y0(r,e){var t=r.l,i=r.read_shift(1),n=lr(r),s=[],a={t:n,h:n};if(i&1){for(var o=r.read_shift(4),l=0;l!=o;++l)s.push(US(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=t+e,a}var HS=y0;function ii(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function vs(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}var zS=lr;function w0(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}var WS=lr,Bh=w0;function k0(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,i=e[0]&2;r.l+=4;var n=i===0?yc([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):qn(e,0)>>2;return t?n/100:n}function Wx(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}var ys=Wx;function nr(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function VS(r){var e={},t=r.read_shift(1),i=t>>>1,n=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),l=r.read_shift(1);switch(r.l++,i){case 0:e.auto=1;break;case 1:e.index=n;var c=ns[n];c&&(e.rgb=yo(c));break;case 2:e.rgb=yo([a,o,l]);break;case 3:e.theme=n;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function jS(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function Vx(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=r.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function $S(r){return Vx(r,1)}function GS(r){return Vx(r,2)}var b0=2,Cr=3,ul=11,vp=12,wc=19,dl=64,KS=65,XS=71,qS=4108,YS=4126,Ut=80,jx=81,JS=[Ut,jx],ZS={1:{n:"CodePage",t:b0},2:{n:"Category",t:Ut},3:{n:"PresentationFormat",t:Ut},4:{n:"ByteCount",t:Cr},5:{n:"LineCount",t:Cr},6:{n:"ParagraphCount",t:Cr},7:{n:"SlideCount",t:Cr},8:{n:"NoteCount",t:Cr},9:{n:"HiddenCount",t:Cr},10:{n:"MultimediaClipCount",t:Cr},11:{n:"ScaleCrop",t:ul},12:{n:"HeadingPairs",t:qS},13:{n:"TitlesOfParts",t:YS},14:{n:"Manager",t:Ut},15:{n:"Company",t:Ut},16:{n:"LinksUpToDate",t:ul},17:{n:"CharacterCount",t:Cr},19:{n:"SharedDoc",t:ul},22:{n:"HyperlinksChanged",t:ul},23:{n:"AppVersion",t:Cr,p:"version"},24:{n:"DigSig",t:KS},26:{n:"ContentType",t:Ut},27:{n:"ContentStatus",t:Ut},28:{n:"Language",t:Ut},29:{n:"Version",t:Ut},255:{},2147483648:{n:"Locale",t:wc},2147483651:{n:"Behavior",t:wc},1919054434:{}},QS={1:{n:"CodePage",t:b0},2:{n:"Title",t:Ut},3:{n:"Subject",t:Ut},4:{n:"Author",t:Ut},5:{n:"Keywords",t:Ut},6:{n:"Comments",t:Ut},7:{n:"Template",t:Ut},8:{n:"LastAuthor",t:Ut},9:{n:"RevNumber",t:Ut},10:{n:"EditTime",t:dl},11:{n:"LastPrinted",t:dl},12:{n:"CreatedDate",t:dl},13:{n:"ModifiedDate",t:dl},14:{n:"PageCount",t:Cr},15:{n:"WordCount",t:Cr},16:{n:"CharCount",t:Cr},17:{n:"Thumbnail",t:XS},18:{n:"Application",t:Ut},19:{n:"DocSecurity",t:Cr},255:{},2147483648:{n:"Locale",t:wc},2147483651:{n:"Behavior",t:wc},1919054434:{}},yp={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},eT=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function tT(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var rT=tT([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ns=Xt(rT),ws={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$x={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},wp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function iT(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function nT(r){var e=iT();if(!r||!r.match)return e;var t={};if((r.match(ur)||[]).forEach(function(i){var n=He(i);switch(n[0].replace(uS,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[n.Extension]=n.ContentType;break;case"<Override":e[wp[n.ContentType]]!==void 0&&e[wp[n.ContentType]].push(n.PartName);break}}),e.xmlns!==_S.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}var Ds={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Nh(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function Xa(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var i={};return(r.match(ur)||[]).forEach(function(n){var s=He(n);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Fa(s.Target,e);t[o]=a,i[s.Id]=a}}),t["!id"]=i,t}var sT="application/vnd.oasis.opendocument.spreadsheet";function aT(r,e){for(var t=m0(r),i,n;i=xo.exec(t);)switch(i[3]){case"manifest":break;case"file-entry":if(n=He(i[0],!1),n.path=="/"&&n.type!==sT)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw i}}var qa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],oT=function(){for(var r=new Array(qa.length),e=0;e<qa.length;++e){var t=qa[e],i="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return r}();function Gx(r){var e={};r=ut(r);for(var t=0;t<qa.length;++t){var i=qa[t],n=r.match(oT[t]);n!=null&&n.length>0&&(e[i[1]]=it(n[1])),i[2]==="date"&&e[i[1]]&&(e[i[1]]=Wt(e[i[1]]))}return e}var lT=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Kx(r,e,t,i){var n=[];if(typeof r=="string")n=fp(r,i);else for(var s=0;s<r.length;++s)n=n.concat(r[s].map(function(f){return{v:f}}));var a=typeof e=="string"?fp(e,i).map(function(f){return f.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==n.length;c+=2){switch(l=+n[c+1].v,n[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=l,t.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=a.slice(o,o+l);break}o+=l}}function cT(r,e,t){var i={};return e||(e={}),r=ut(r),lT.forEach(function(n){var s=(r.match(go(n[0]))||[])[1];switch(n[2]){case"string":s&&(e[n[1]]=it(s));break;case"bool":e[n[1]]=s==="true";break;case"raw":var a=r.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));a&&a.length>0&&(i[n[1]]=a[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&Kx(i.HeadingPairs,i.TitlesOfParts,e,t),e}var fT=/<[^>]+>[^<]*/g;function hT(r,e){var t={},i="",n=r.match(fT);if(n)for(var s=0;s!=n.length;++s){var a=n[s],o=He(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":i=it(o.name);break;case"</property>":i=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":t[i]=it(f);break;case"bool":t[i]=mt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[i]=parseInt(f,10);break;case"r4":case"r8":case"decimal":t[i]=parseFloat(f);break;case"filetime":case"date":t[i]=Wt(f);break;case"cy":case"error":t[i]=it(f);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return t}var uT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Vf;function dT(r,e,t){Vf||(Vf=u0(uT)),e=Vf[e]||e,r[e]=t}function _0(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Xx(r,e,t){var i=r.l,n=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-i&3;)++r.l;return n}function qx(r,e,t){var i=r.read_shift(0,"lpwstr");return i}function Yx(r,e,t){return e===31?qx(r):Xx(r,e,t)}function Uh(r,e,t){return Yx(r,e,t===!1?0:4)}function pT(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Yx(r,e,0)}function mT(r){for(var e=r.read_shift(4),t=[],i=0;i!=e;++i){var n=r.l;t[i]=r.read_shift(0,"lpwstr").replace(br,""),r.l-n&2&&(r.l+=2)}return t}function gT(r){for(var e=r.read_shift(4),t=[],i=0;i!=e;++i)t[i]=r.read_shift(0,"lpstr-cp").replace(br,"");return t}function xT(r){var e=r.l,t=kc(r,jx);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var i=kc(r,Cr);return[t,i]}function vT(r){for(var e=r.read_shift(4),t=[],i=0;i<e/2;++i)t.push(xT(r));return t}function kp(r,e){for(var t=r.read_shift(4),i={},n=0;n!=t;++n){var s=r.read_shift(4),a=r.read_shift(4);i[s]=r.read_shift(a,e===1200?"utf16le":"utf8").replace(br,"").replace(Oa,"!"),e===1200&&a%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),i}function Jx(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function yT(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function kc(r,e,t){var i=r.read_shift(2),n,s=t||{};if(r.l+=2,e!==vp&&i!==e&&JS.indexOf(e)===-1&&!((e&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+e+" saw "+i);switch(e===vp?i:e){case 2:return n=r.read_shift(2,"i"),s.raw||(r.l+=2),n;case 3:return n=r.read_shift(4,"i"),n;case 11:return r.read_shift(4)!==0;case 19:return n=r.read_shift(4),n;case 30:return Xx(r,i,4).replace(br,"");case 31:return qx(r);case 64:return _0(r);case 65:return Jx(r);case 71:return yT(r);case 80:return Uh(r,i,!s.raw).replace(br,"");case 81:return pT(r,i).replace(br,"");case 4108:return vT(r);case 4126:case 4127:return i==4127?mT(r):gT(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+i)}}function bp(r,e){var t=r.l,i=r.read_shift(4),n=r.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=n;++a){var f=r.read_shift(4),h=r.read_shift(4);s[a]=[f,h+t]}s.sort(function(y,w){return y[1]-w[1]});var u={};for(a=0;a!=n;++a){if(r.l!==s[a][1]){var d=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:r.l+2===s[a][1]&&(r.l+=2,d=!1);break;case 80:r.l<=s[a][1]&&(r.l=s[a][1],d=!1);break;case 4108:r.l<=s[a][1]&&(r.l=s[a][1],d=!1);break}if((!e||a==0)&&r.l<=s[a][1]&&(d=!1,r.l=s[a][1]),d)throw new Error("Read Error: Expected address "+s[a][1]+" at "+r.l+" :"+a)}if(e){var m=e[s[a][0]];if(u[m.n]=kc(r,m.t,{raw:!0}),m.p==="version"&&(u[m.n]=String(u[m.n]>>16)+"."+("0000"+String(u[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(u[m.n]){case 0:u[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ci(o=u[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+u[m.n])}}else if(s[a][0]===1){if(o=u.CodePage=kc(r,b0),ci(o),l!==-1){var p=r.l;r.l=s[l][1],c=kp(r,o),r.l=p}}else if(s[a][0]===0){if(o===0){l=a,r.l=s[a+1][1];continue}c=kp(r,o)}else{var g=c[s[a][0]],x;switch(r[r.l]){case 65:r.l+=4,x=Jx(r);break;case 30:r.l+=4,x=Uh(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,x=Uh(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,x=r.read_shift(4,"i");break;case 19:r.l+=4,x=r.read_shift(4);break;case 5:r.l+=4,x=r.read_shift(8,"f");break;case 11:r.l+=4,x=bt(r,4);break;case 64:r.l+=4,x=Wt(_0(r));break;default:throw new Error("unparsed value: "+r[r.l])}u[g]=x}}return r.l=t+i,u}function _p(r,e,t){var i=r.content;if(!i)return{};jt(i,0);var n,s,a,o,l=0;i.chk("feff","Byte Order: "),i.read_shift(2);var c=i.read_shift(4),f=i.read_shift(16);if(f!==Qe.utils.consts.HEADER_CLSID&&f!==t)throw new Error("Bad PropertySet CLSID "+f);if(n=i.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=i.read_shift(16),o=i.read_shift(4),n===1&&o!==i.l)throw new Error("Length mismatch: "+o+" !== "+i.l);n===2&&(a=i.read_shift(16),l=i.read_shift(4));var h=bp(i,e),u={SystemIdentifier:c};for(var d in h)u[d]=h[d];if(u.FMTID=s,n===1)return u;if(l-i.l==2&&(i.l+=2),i.l!==l)throw new Error("Length mismatch 2: "+i.l+" !== "+l);var m;try{m=bp(i,null)}catch{}for(d in m)u[d]=m[d];return u.FMTID=[s,a],u}function dn(r,e){return r.read_shift(e),null}function wT(r,e,t){for(var i=[],n=r.l+e;r.l<n;)i.push(t(r,n-r.l));if(n!==r.l)throw new Error("Slurp error");return i}function bt(r,e){return r.read_shift(e)===1}function At(r){return r.read_shift(2,"u")}function Zx(r,e){return wT(r,e,At)}function kT(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function Vo(r,e,t){var i=r.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=r.read_shift(1);s&&(n="dbcs-cont")}else t.biff==12&&(n="wstr");t.biff>=2&&t.biff<=5&&(n="cpstr");var a=i?r.read_shift(i,n):"";return a}function bT(r){var e=r.read_shift(2),t=r.read_shift(1),i=t&4,n=t&8,s=1+(t&1),a=0,o,l={};n&&(a=r.read_shift(2)),i&&(o=r.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":r.read_shift(e,c);return n&&(r.l+=4*a),i&&(r.l+=o),l.t=f,n||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function cs(r,e,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var n=r.read_shift(1);return n===0?i=r.read_shift(e,"sbcs-cont"):i=r.read_shift(e,"dbcs-cont"),i}function jo(r,e,t){var i=r.read_shift(t&&t.biff==2?1:2);return i===0?(r.l++,""):cs(r,i,t)}function ks(r,e,t){if(t.biff>5)return jo(r,e,t);var i=r.read_shift(1);return i===0?(r.l++,""):r.read_shift(i,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function _T(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function ST(r){var e=r.read_shift(4),t=r.l,i=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),r.l=t);var n=r.read_shift((i?e-24:e)>>1,"utf16le").replace(br,"");return i&&(r.l+=24),n}function TT(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var i=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=r.read_shift(4);if(n===0)return t+i.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=r.read_shift(s>>1,"utf16le").replace(br,"");return t+a}function ET(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return ST(r);case"0303000000000000c000000000000046":return TT(r);default:throw new Error("Unsupported Moniker "+t)}}function pl(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(br,""):"";return t}function CT(r,e){var t=r.l+e,i=r.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var n=r.read_shift(2);r.l+=2;var s,a,o,l,c="",f,h;n&16&&(s=pl(r,t-r.l)),n&128&&(a=pl(r,t-r.l)),(n&257)===257&&(o=pl(r,t-r.l)),(n&257)===1&&(l=ET(r,t-r.l)),n&8&&(c=pl(r,t-r.l)),n&32&&(f=r.read_shift(16)),n&64&&(h=_0(r)),r.l=t;var u=a||o||l||"";u&&c&&(u+="#"+c),u||(u="#"+c),n&2&&u.charAt(0)=="/"&&u.charAt(1)!="/"&&(u="file://"+u);var d={Target:u};return f&&(d.guid=f),h&&(d.time=h),s&&(d.Tooltip=s),d}function Qx(r){var e=r.read_shift(1),t=r.read_shift(1),i=r.read_shift(1),n=r.read_shift(1);return[e,t,i,n]}function ev(r,e){var t=Qx(r);return t[3]=0,t}function zi(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2);return{r:e,c:t,ixfe:i}}function AT(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function OT(r,e,t){return e===0?"":ks(r,e,t)}function FT(r,e,t){var i=t.biff>8?4:2,n=r.read_shift(i),s=r.read_shift(i,"i"),a=r.read_shift(i,"i");return[n,s,a]}function tv(r){var e=r.read_shift(2),t=k0(r);return[e,t]}function DT(r,e,t){r.l+=4,e-=4;var i=r.l+e,n=Vo(r,e,t),s=r.read_shift(2);if(i-=r.l,s!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+s);return r.l+=s,n}function uf(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2),n=r.read_shift(2);return{s:{c:i,r:e},e:{c:n,r:t}}}function rv(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(1),n=r.read_shift(1);return{s:{c:i,r:e},e:{c:n,r:t}}}var RT=rv;function iv(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2);return r.l+=12,[t,e,i]}function MT(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function IT(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function Zt(r){r.l+=2,r.l+=r.read_shift(2)}var PT={0:Zt,4:Zt,5:Zt,6:Zt,7:IT,8:Zt,9:Zt,10:Zt,11:Zt,12:Zt,13:MT,14:Zt,15:Zt,16:Zt,17:Zt,18:Zt,19:Zt,20:Zt,21:iv};function LT(r,e){for(var t=r.l+e,i=[];r.l<t;){var n=r.read_shift(2);r.l-=2;try{i.push(PT[n](r,t-r.l))}catch{return r.l=t,i}}return r.l!=t&&(r.l=t),i}function ml(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function BT(r,e){return e===0||r.read_shift(2),1200}function NT(r,e,t){if(t.enc)return r.l+=e,"";var i=r.l,n=ks(r,0,t);return r.read_shift(e+i-r.l),n}function UT(r,e,t){var i=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function HT(r,e,t){var i=r.read_shift(4),n=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Vo(r,0,t);return a.length===0&&(a="Sheet1"),{pos:i,hs:n,dt:s,name:a}}function zT(r,e){for(var t=r.l+e,i=r.read_shift(4),n=r.read_shift(4),s=[],a=0;a!=n&&r.l<t;++a)s.push(bT(r));return s.Count=i,s.Unique=n,s}function WT(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function VT(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var i=r.read_shift(1);return r.l+=3,i&7&&(e.level=i&7),i&32&&(e.hidden=!0),i&64&&(e.hpt=t/20),e}function jT(r){var e=AT(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function $T(r){return r.read_shift(2),r.read_shift(4)}function Sp(r,e,t){var i=0;t&&t.biff==2||(i=r.read_shift(2));var n=r.read_shift(2);t&&t.biff==2&&(i=1-(n>>15),n&=32767);var s={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[s,n]}function GT(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2),n=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=r.read_shift(2),l=r.read_shift(2),c=r.read_shift(2);return{Pos:[e,t],Dim:[i,n],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function KT(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var i=r.read_shift(2);return{RTL:i&64}}function XT(){}function qT(r,e,t){var i={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return i.name=Vo(r,0,t),i}function YT(r){var e=zi(r);return e.isst=r.read_shift(4),e}function JT(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=r.l+e,n=zi(r);t.biff==2&&r.l++;var s=jo(r,i-r.l,t);return n.val=s,n}function ZT(r,e,t){var i=r.read_shift(2),n=ks(r,0,t);return[i,n]}var QT=ks;function Tp(r,e,t){var i=r.l+e,n=t.biff==8||!t.biff?4:2,s=r.read_shift(n),a=r.read_shift(n),o=r.read_shift(2),l=r.read_shift(2);return r.l=i,{s:{r:s,c:o},e:{r:a,c:l}}}function eE(r){var e=r.read_shift(2),t=r.read_shift(2),i=tv(r);return{r:e,c:t,ixfe:i[0],rknum:i[1]}}function tE(r,e){for(var t=r.l+e-2,i=r.read_shift(2),n=r.read_shift(2),s=[];r.l<t;)s.push(tv(r));if(r.l!==t)throw new Error("MulRK read error");var a=r.read_shift(2);if(s.length!=a-n+1)throw new Error("MulRK length mismatch");return{r:i,c:n,C:a,rkrec:s}}function rE(r,e){for(var t=r.l+e-2,i=r.read_shift(2),n=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var a=r.read_shift(2);if(s.length!=a-n+1)throw new Error("MulBlank length mismatch");return{r:i,c:n,C:a,ixfe:s}}function iE(r,e,t,i){var n={},s=r.read_shift(4),a=r.read_shift(4),o=r.read_shift(4),l=r.read_shift(2);return n.patternType=eT[o>>26],i.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=a&15,n.dgRight=a>>4&15,n.dgTop=a>>8&15,n.dgBottom=a>>12&15,n.icvLeft=a>>16&127,n.icvRight=a>>23&127,n.grbitDiag=a>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=l&127,n.icvBack=l>>7&127,n.fsxButton=l>>14&1),n}function nE(r,e,t){var i={};return i.ifnt=r.read_shift(2),i.numFmtId=r.read_shift(2),i.flags=r.read_shift(2),i.fStyle=i.flags>>2&1,e-=6,i.data=iE(r,e,i.fStyle,t),i}function sE(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Ep(r,e,t){var i=zi(r);(t.biff==2||e==9)&&++r.l;var n=kT(r);return i.val=n,i.t=n===!0||n===!1?"b":"e",i}function aE(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=zi(r),n=nr(r);return i.val=n,i}var Cp=OT;function oE(r,e,t){var i=r.l+e,n=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=cs(r,s),o=[];i>r.l;)o.push(jo(r));return[s,n,a,o]}function Ap(r,e,t){var i=r.read_shift(2),n,s={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return t.sbcch===14849&&(n=DT(r,e-2,t)),s.body=n||r.read_shift(e-2),typeof n=="string"&&(s.Name=n),s}var lE=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Op(r,e,t){var i=r.l+e,n=r.read_shift(2),s=r.read_shift(1),a=r.read_shift(1),o=r.read_shift(t&&t.biff==2?1:2),l=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),l=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var c=cs(r,a,t);n&32&&(c=lE[c.charCodeAt(0)]);var f=i-r.l;t&&t.biff==2&&--f;var h=i==r.l||o===0||!(f>0)?[]:V4(r,f,t,o);return{chKey:s,Name:c,itab:l,rgce:h}}function nv(r,e,t){if(t.biff<8)return cE(r,e,t);for(var i=[],n=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)i.push(FT(r,t.biff>8?12:6,t));if(r.l!=n)throw new Error("Bad ExternSheet: "+r.l+" != "+n);return i}function cE(r,e,t){r[r.l+1]==3&&r[r.l]++;var i=Vo(r,e,t);return i.charCodeAt(0)==3?i.slice(1):i}function fE(r,e,t){if(t.biff<8){r.l+=e;return}var i=r.read_shift(2),n=r.read_shift(2),s=cs(r,i,t),a=cs(r,n,t);return[s,a]}function hE(r,e,t){var i=rv(r);r.l++;var n=r.read_shift(1);return e-=8,[j4(r,e,t),n,i]}function Fp(r,e,t){var i=RT(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[i,z4(r,e,t)]}function uE(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,i=r.read_shift(4);return[e,t,i]}function dE(r,e,t){if(!(t.biff<8)){var i=r.read_shift(2),n=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=ks(r,0,t);return t.biff<8&&r.read_shift(1),[{r:i,c:n},o,a,s]}}function pE(r,e,t){return dE(r,e,t)}function mE(r,e){for(var t=[],i=r.read_shift(2);i--;)t.push(uf(r));return t}function gE(r,e,t){if(t&&t.biff<8)return vE(r,e,t);var i=iv(r),n=LT(r,e-22,i[1]);return{cmo:i,ft:n}}var xE={8:function(r,e){var t=r.l+e;r.l+=10;var i=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var n=r.read_shift(1);return r.l+=n,r.l=t,{fmt:i}}};function vE(r,e,t){r.l+=4;var i=r.read_shift(2),n=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var a=[];return a.push((xE[i]||fr)(r,e,t)),{cmo:[n,i,s],ft:a}}function yE(r,e,t){var i=r.l,n="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:a=_T(r,6,t);var o=r.read_shift(2);r.read_shift(2),At(r,2);var l=r.read_shift(2);r.l+=l;for(var c=1;c<r.lens.length-1;++c){if(r.l-i!=r.lens[c])throw new Error("TxO: bad continue record");var f=r[r.l],h=cs(r,r.lens[c+1]-r.lens[c]-1);if(n+=h,n.length>=(f?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return r.l=i+e,{t:n}}catch{return r.l=i+e,{t:n}}}function wE(r,e){var t=uf(r);r.l+=16;var i=CT(r,e-24);return[t,i]}function kE(r,e){r.read_shift(2);var t=uf(r),i=r.read_shift((e-10)/2,"dbcs-cont");return i=i.replace(br,""),[t,i]}function bE(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=yp[t]||t,t=r.read_shift(2),e[1]=yp[t]||t,e}function _E(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(ev(r));return t}function SE(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(ev(r));return t}function TE(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function sv(r,e,t){if(!t.cellStyles)return fr(r,e);var i=t&&t.biff>=12?4:2,n=r.read_shift(i),s=r.read_shift(i),a=r.read_shift(i),o=r.read_shift(i),l=r.read_shift(2);i==2&&(r.l+=2);var c={s:n,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function EE(r,e){var t={};return e<32||(r.l+=16,t.header=nr(r),t.footer=nr(r),r.l+=2),t}function CE(r,e,t){var i={area:!1};if(t.biff!=5)return r.l+=e,i;var n=r.read_shift(1);return r.l+=3,n&16&&(i.area=!0),i}var AE=zi,OE=Zx,FE=jo;function DE(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(4),n={fmt:e,env:t,len:i,data:r.slice(r.l,r.l+i)};return r.l+=i,n}function RE(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var i=zi(r);++r.l;var n=ks(r,e-7,t);return i.t="str",i.val=n,i}function ME(r){var e=zi(r);++r.l;var t=nr(r);return e.t="n",e.val=t,e}function IE(r){var e=zi(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function PE(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function LE(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function BE(r,e,t){var i=r.l+e,n=zi(r),s=r.read_shift(2),a=cs(r,s,t);return r.l=i,n.t="str",n.val=a,n}var NE=[2,3,48,49,131,139,140,245],Dp=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=u0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var c=[],f=Rn(1);switch(l.type){case"base64":f=li(jr(o));break;case"binary":f=li(o);break;case"buffer":case"array":f=o;break}jt(f,0);var h=f.read_shift(1),u=!!(h&136),d=!1,m=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,u=!0;break;case 49:d=!0,u=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var p=0,g=521;h==2&&(p=f.read_shift(2)),f.l+=3,h!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),h!=2&&(g=f.read_shift(2));var x=f.read_shift(2),y=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=r[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var w=[],T={},C=Math.min(f.length,h==2?521:g-10-(d?264:0)),R=m?32:11;f.l<C&&f[f.l]!=13;)switch(T={},T.name=po.utils.decode(y,f.slice(f.l,f.l+R)).replace(/[\u0000\r\n].*$/g,""),f.l+=R,T.type=String.fromCharCode(f.read_shift(1)),h!=2&&!m&&(T.offset=f.read_shift(4)),T.len=f.read_shift(1),h==2&&(T.offset=f.read_shift(2)),T.dec=f.read_shift(1),T.name.length&&w.push(T),h!=2&&(f.l+=m?13:14),T.type){case"B":(!d||T.len!=8)&&l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var _=0,A=0;for(c[0]=[],A=0;A!=w.length;++A)c[0][A]=w[A].name;for(;p-- >0;){if(f[f.l]===42){f.l+=x;continue}for(++f.l,c[++_]=[],A=0,A=0;A!=w.length;++A){var k=f.slice(f.l,f.l+w[A].len);f.l+=w[A].len,jt(k,0);var I=po.utils.decode(y,k);switch(w[A].type){case"C":I.trim().length&&(c[_][A]=I.replace(/\s+$/,""));break;case"D":I.length===8?c[_][A]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):c[_][A]=I;break;case"F":c[_][A]=parseFloat(I.trim());break;case"+":case"I":c[_][A]=m?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":c[_][A]=!0;break;case"N":case"F":c[_][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[_][A]="##MEMO##"+(m?parseInt(I.trim(),10):k.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(c[_][A]=+I||0);break;case"@":c[_][A]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":c[_][A]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":c[_][A]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[_][A]=-k.read_shift(-8,"f");break;case"B":if(d&&w[A].len==8){c[_][A]=k.read_shift(8,"f");break}case"G":case"P":k.l+=w[A].len;break;case"0":if(w[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[A].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function i(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=ua(t(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function n(o,l){try{return Un(i(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&ci(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Lh(),h=Gh(o,{header:1,raw:!0,cellDates:!0}),u=h[0],d=h.slice(1),m=o["!cols"]||[],p=0,g=0,x=0,y=1;for(p=0;p<u.length;++p){if(((m[p]||{}).DBF||{}).name){u[p]=m[p].DBF.name,++x;continue}if(u[p]!=null){if(++x,typeof u[p]=="number"&&(u[p]=u[p].toString(10)),typeof u[p]!="string")throw new Error("DBF Invalid column name "+u[p]+" |"+typeof u[p]+"|");if(u.indexOf(u[p])!==p){for(g=0;g<1024;++g)if(u.indexOf(u[p]+"_"+g)==-1){u[p]+="_"+g;break}}}}var w=kt(o["!ref"]),T=[],C=[],R=[];for(p=0;p<=w.e.c-w.s.c;++p){var _="",A="",k=0,I=[];for(g=0;g<d.length;++g)d[g][p]!=null&&I.push(d[g][p]);if(I.length==0||u[p]==null){T[p]="?";continue}for(g=0;g<I.length;++g){switch(typeof I[g]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=I[g]instanceof Date?"D":"C";break;default:A="C"}k=Math.max(k,String(I[g]).length),_=_&&_!=A?"C":A}k>250&&(k=250),A=((m[p]||{}).DBF||{}).type,A=="C"&&m[p].DBF.len>k&&(k=m[p].DBF.len),_=="B"&&A=="N"&&(_="N",R[p]=m[p].DBF.dec,k=m[p].DBF.len),C[p]=_=="C"||A=="N"?k:s[_]||0,y+=C[p],T[p]=_}var N=f.next(32);for(N.write_shift(4,318902576),N.write_shift(4,d.length),N.write_shift(2,296+32*x),N.write_shift(2,y),p=0;p<4;++p)N.write_shift(4,0);for(N.write_shift(4,0|(+e[nx]||3)<<8),p=0,g=0;p<u.length;++p)if(u[p]!=null){var S=f.next(32),W=(u[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);S.write_shift(1,W,"sbcs"),S.write_shift(1,T[p]=="?"?"C":T[p],"sbcs"),S.write_shift(4,g),S.write_shift(1,C[p]||s[T[p]]||0),S.write_shift(1,R[p]||0),S.write_shift(1,2),S.write_shift(4,0),S.write_shift(1,0),S.write_shift(4,0),S.write_shift(4,0),g+=C[p]||s[T[p]]||0}var E=f.next(264);for(E.write_shift(4,13),p=0;p<65;++p)E.write_shift(4,0);for(p=0;p<d.length;++p){var Q=f.next(y);for(Q.write_shift(1,0),g=0;g<u.length;++g)if(u[g]!=null)switch(T[g]){case"L":Q.write_shift(1,d[p][g]==null?63:d[p][g]?84:70);break;case"B":Q.write_shift(8,d[p][g]||0,"f");break;case"N":var ae="0";for(typeof d[p][g]=="number"&&(ae=d[p][g].toFixed(R[g]||0)),x=0;x<C[g]-ae.length;++x)Q.write_shift(1,32);Q.write_shift(1,ae,"sbcs");break;case"D":d[p][g]?(Q.write_shift(4,("0000"+d[p][g].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(d[p][g].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+d[p][g].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(d[p][g]!=null?d[p][g]:"").slice(0,C[g]);for(Q.write_shift(1,Z,"sbcs"),x=0;x<C[g]-Z.length;++x)Q.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:i,from_sheet:a}}(),UE=function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ni(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(u,d){var m=r[d];return typeof m=="number"?Kd(m):m},i=function(u,d,m){var p=d.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?u:Kd(p)};r["|"]=254;function n(u,d){switch(d.type){case"base64":return s(jr(u),d);case"binary":return s(u,d);case"buffer":return s(Ze&&Buffer.isBuffer(u)?u.toString("binary"):xs(u),d);case"array":return s(ls(u),d)}throw new Error("Unrecognized type "+d.type)}function s(u,d){var m=u.split(/[\n\r]+/),p=-1,g=-1,x=0,y=0,w=[],T=[],C=null,R={},_=[],A=[],k=[],I=0,N;for(+d.codepage>=0&&ci(+d.codepage);x!==m.length;++x){I=0;var S=m[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(e,t),W=S.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),E=W[0],Q;if(S.length>0)switch(E){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":W[1].charAt(0)=="P"&&T.push(S.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,Z=!1,xe=!1,L=!1,ge=-1,Y=-1;for(y=1;y<W.length;++y)switch(W[y].charAt(0)){case"A":break;case"X":g=parseInt(W[y].slice(1))-1,Z=!0;break;case"Y":for(p=parseInt(W[y].slice(1))-1,Z||(g=0),N=w.length;N<=p;++N)w[N]=[];break;case"K":Q=W[y].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(di(Q))?isNaN(Qs(Q).getDate())||(Q=Wt(Q)):(Q=di(Q),C!==null&&fa(C)&&(Q=hf(Q))),ae=!0;break;case"E":L=!0;var O=Vs(W[y].slice(1),{r:p,c:g});w[p][g]=[w[p][g],O];break;case"S":xe=!0,w[p][g]=[w[p][g],"S5S"];break;case"G":break;case"R":ge=parseInt(W[y].slice(1))-1;break;case"C":Y=parseInt(W[y].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+S)}if(ae&&(w[p][g]&&w[p][g].length==2?w[p][g][0]=Q:w[p][g]=Q,C=null),xe){if(L)throw new Error("SYLK shared formula cannot have own formula");var j=ge>-1&&w[ge][Y];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");w[p][g][1]=mv(j[1],{r:p-ge,c:g-Y})}break;case"F":var V=0;for(y=1;y<W.length;++y)switch(W[y].charAt(0)){case"X":g=parseInt(W[y].slice(1))-1,++V;break;case"Y":for(p=parseInt(W[y].slice(1))-1,N=w.length;N<=p;++N)w[N]=[];break;case"M":I=parseInt(W[y].slice(1))/20;break;case"F":break;case"G":break;case"P":C=T[parseInt(W[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=W[y].slice(1).split(" "),N=parseInt(k[0],10);N<=parseInt(k[1],10);++N)I=parseInt(k[2],10),A[N-1]=I===0?{hidden:!0}:{wch:I},ea(A[N-1]);break;case"C":g=parseInt(W[y].slice(1))-1,A[g]||(A[g]={});break;case"R":p=parseInt(W[y].slice(1))-1,_[p]||(_[p]={}),I>0?(_[p].hpt=I,_[p].hpx=wo(I)):I===0&&(_[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+S)}V<1&&(C=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+S)}}return _.length>0&&(R["!rows"]=_),A.length>0&&(R["!cols"]=A),d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),[w,R]}function a(u,d){var m=n(u,d),p=m[0],g=m[1],x=ua(p,d);return Ni(g).forEach(function(y){x[y]=g[y]}),x}function o(u,d){return Un(a(u,d),d)}function l(u,d,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(u.t){case"n":g+=u.v||0,u.f&&!u.F&&(g+=";E"+TA(u.f,{r:m,c:p}));break;case"b":g+=u.v?"TRUE":"FALSE";break;case"e":g+=u.w||u.v;break;case"d":g+='"'+(u.w||u.v)+'"';break;case"s":g+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(u,d){d.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=_c(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Sc(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&u.push(g)})}function f(u,d){d.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*uv(m.hpx)+";"),g.length>2&&u.push(g+"R"+(p+1))})}function h(u,d){var m=["ID;PWXL;N;E"],p=[],g=kt(u["!ref"]),x,y=Array.isArray(u),w=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),u["!cols"]&&c(m,u["!cols"]),u["!rows"]&&f(m,u["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var T=g.s.r;T<=g.e.r;++T)for(var C=g.s.c;C<=g.e.c;++C){var R=We({r:T,c:C});x=y?(u[T]||[])[C]:u[R],!(!x||x.v==null&&(!x.f||x.F))&&p.push(l(x,u,T,C))}return m.join(w)+w+p.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),HE=function(){function r(s,a){switch(a.type){case"base64":return e(jr(s),a);case"binary":return e(s,a);case"buffer":return e(Ze&&Buffer.isBuffer(s)?s.toString("binary"):xs(s),a);case"array":return e(ls(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var u=o[f].trim().split(","),d=u[0],m=u[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+d){case-1:if(p==="BOT"){h[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?h[l][c]=!0:p==="FALSE"?h[l][c]=!1:isNaN(di(m))?isNaN(Qs(m).getDate())?h[l][c]=m:h[l][c]=Wt(m):h[l][c]=di(m),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),h[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function t(s,a){return ua(r(s,a),a)}function i(s,a){return Un(t(s,a),a)}var n=function(){var s=function(l,c,f,h,u){l.push(c),l.push(f+","+h),l.push('"'+u.replace(/"/g,'""')+'"')},a=function(l,c,f,h){l.push(c+","+f),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],f=kt(l["!ref"]),h,u=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var d=f.s.r;d<=f.e.r;++d){a(c,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var p=We({r:d,c:m});if(h=u?(l[d]||[])[m]:l[p],!h){a(c,1,0,"");continue}switch(h.t){case"n":var g=h.w;!g&&h.v!=null&&(g=h.v),g==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,g,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ti(h.z||Ke[14],Tr(Wt(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var x=`\r
`,y=c.join(x);return y}}();return{to_workbook:i,to_sheet:t,from_sheet:n}}(),zE=function(){function r(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(h,u){for(var d=h.split(`
`),m=-1,p=-1,g=0,x=[];g!==d.length;++g){var y=d[g].trim().split(":");if(y[0]==="cell"){var w=kr(y[1]);if(x.length<=w.r)for(m=x.length;m<=w.r;++m)x[m]||(x[m]=[]);switch(m=w.r,p=w.c,y[2]){case"t":x[m][p]=r(y[3]);break;case"v":x[m][p]=+y[3];break;case"vtf":var T=y[y.length-1];case"vtc":switch(y[3]){case"nl":x[m][p]=!!+y[4];break;default:x[m][p]=+y[4];break}y[2]=="vtf"&&(x[m][p]=[x[m][p],T])}}}return u&&u.sheetRows&&(x=x.slice(0,u.sheetRows)),x}function i(h,u){return ua(t(h,u),u)}function n(h,u){return Un(i(h,u),u)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var u=[],d=[],m,p="",g=ha(h["!ref"]),x=Array.isArray(h),y=g.s.r;y<=g.e.r;++y)for(var w=g.s.c;w<=g.e.c;++w)if(p=We({r:y,c:w}),m=x?(h[y]||[])[w]:h[p],!(!m||m.v==null||m.t==="z")){switch(d=["cell",p,"t"],m.t){case"s":case"str":d.push(e(m.v));break;case"n":m.f?(d[2]="vtf",d[3]="n",d[4]=m.v,d[5]=e(m.f)):(d[2]="v",d[3]=m.v);break;case"b":d[2]="vt"+(m.f?"f":"c"),d[3]="nl",d[4]=m.v?"1":"0",d[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var T=Tr(Wt(m.v));d[2]="vtc",d[3]="nd",d[4]=""+T,d[5]=m.w||ti(m.z||Ke[14],T);break;case"e":continue}u.push(d.join(":"))}return u.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function f(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:n,to_sheet:i,from_sheet:f}}(),vo=function(){function r(f,h,u,d,m){m.raw?h[u][d]=f:f===""||(f==="TRUE"?h[u][d]=!0:f==="FALSE"?h[u][d]=!1:isNaN(di(f))?isNaN(Qs(f).getDate())?h[u][d]=f:h[u][d]=Wt(f):h[u][d]=di(f))}function e(f,h){var u=h||{},d=[];if(!f||f.length===0)return d;for(var m=f.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,x=0,y=0;y<=p;++y)x=m[y].indexOf(" "),x==-1?x=m[y].length:x++,g=Math.max(g,x);for(y=0;y<=p;++y){d[y]=[];var w=0;for(r(m[y].slice(0,g).trim(),d,y,w,u),w=1;w<=(m[y].length-g)/10+1;++w)r(m[y].slice(g+(w-1)*10,g+w*10).trim(),d,y,w,u)}return u.sheetRows&&(d=d.slice(0,u.sheetRows)),d}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function n(f){for(var h={},u=!1,d=0,m=0;d<f.length;++d)(m=f.charCodeAt(d))==34?u=!u:!u&&m in t&&(h[m]=(h[m]||0)+1);m=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&m.push([h[d],d]);if(!m.length){h=i;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&m.push([h[d],d])}return m.sort(function(p,g){return p[0]-g[0]||i[p[1]]-i[g[1]]}),t[m.pop()[1]]||44}function s(f,h){var u=h||{},d="",m=u.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=n(f.slice(0,1024)):u&&u.FS?d=u.FS:d=n(f.slice(0,1024));var g=0,x=0,y=0,w=0,T=0,C=d.charCodeAt(0),R=!1,_=0,A=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var k=u.dateNF!=null?Z_(u.dateNF):null;function I(){var N=f.slice(w,T),S={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)S.t="z";else if(u.raw)S.t="s",S.v=N;else if(N.trim().length===0)S.t="s",S.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(S.t="s",S.v=N.slice(2,-1).replace(/""/g,'"')):CA(N)?(S.t="n",S.f=N.slice(1)):(S.t="s",S.v=N);else if(N=="TRUE")S.t="b",S.v=!0;else if(N=="FALSE")S.t="b",S.v=!1;else if(!isNaN(y=di(N)))S.t="n",u.cellText!==!1&&(S.w=N),S.v=y;else if(!isNaN(Qs(N).getDate())||k&&N.match(k)){S.z=u.dateNF||Ke[14];var W=0;k&&N.match(k)&&(N=Q_(N,u.dateNF,N.match(k)||[]),W=1),u.cellDates?(S.t="d",S.v=Wt(N,W)):(S.t="n",S.v=Tr(Wt(N,W))),u.cellText!==!1&&(S.w=ti(S.z,S.v instanceof Date?Tr(S.v):S.v)),u.cellNF||delete S.z}else S.t="s",S.v=N;if(S.t=="z"||(u.dense?(m[g]||(m[g]=[]),m[g][x]=S):m[We({c:x,r:g})]=S),w=T+1,A=f.charCodeAt(w),p.e.c<x&&(p.e.c=x),p.e.r<g&&(p.e.r=g),_==C)++x;else if(x=0,++g,u.sheetRows&&u.sheetRows<=g)return!0}e:for(;T<f.length;++T)switch(_=f.charCodeAt(T)){case 34:A===34&&(R=!R);break;case C:case 10:case 13:if(!R&&I())break e;break}return T-w>0&&I(),m["!ref"]=et(p),m}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):ua(e(f,h),h)}function o(f,h){var u="",d=h.type=="string"?[0,0,0,0]:D0(f,h);switch(h.type){case"base64":u=jr(f);break;case"binary":u=f;break;case"buffer":h.codepage==65001?u=f.toString("utf8"):h.codepage&&typeof po<"u"||(u=Ze&&Buffer.isBuffer(f)?f.toString("binary"):xs(f));break;case"array":u=ls(f);break;case"string":u=f;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?u=ut(u.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?u=ut(u):h.type=="binary"&&typeof po<"u",u.slice(0,19)=="socialcalc:version:"?zE.to_sheet(h.type=="string"?u:ut(u),h):a(u,h)}function l(f,h){return Un(o(f,h),h)}function c(f){for(var h=[],u=kt(f["!ref"]),d,m=Array.isArray(f),p=u.s.r;p<=u.e.r;++p){for(var g=[],x=u.s.c;x<=u.e.c;++x){var y=We({r:p,c:x});if(d=m?(f[p]||[])[x]:f[y],!d||d.v==null){g.push("          ");continue}for(var w=(d.w||(sn(d),d.w)||"").slice(0,10);w.length<10;)w+=" ";g.push(w+(x===0?" ":""))}h.push(g.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function WE(r,e){var t=e||{},i=!!t.WTF;t.WTF=!0;try{var n=UE.to_workbook(r,t);return t.WTF=i,n}catch(s){if(t.WTF=i,!s.message.match(/SYLK bad record ID/)&&i)throw s;return vo.to_workbook(r,e)}}var Ya=function(){function r(O,j,V){if(O){jt(O,O.l||0);for(var H=V.Enum||ge;O.l<O.length;){var ne=O.read_shift(2),ye=H[ne]||H[65535],de=O.read_shift(2),ue=O.l+de,pe=ye.f&&ye.f(O,de,V);if(O.l=ue,j(pe,ye,ne))return}}}function e(O,j){switch(j.type){case"base64":return t(li(jr(O)),j);case"binary":return t(li(O),j);case"buffer":case"array":return t(O,j)}throw"Unsupported type "+j.type}function t(O,j){if(!O)return O;var V=j||{},H=V.dense?[]:{},ne="Sheet1",ye="",de=0,ue={},pe=[],be=[],b={s:{r:0,c:0},e:{r:0,c:0}},J=V.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)V.Enum=ge,r(O,function(F,D,U){switch(U){case 0:V.vers=F,F>=4096&&(V.qpro=!0);break;case 6:b=F;break;case 204:F&&(ye=F);break;case 222:ye=F;break;case 15:case 51:V.qpro||(F[1].v=F[1].v.slice(1));case 13:case 14:case 16:U==14&&(F[2]&112)==112&&(F[2]&15)>1&&(F[2]&15)<15&&(F[1].z=V.dateNF||Ke[14],V.cellDates&&(F[1].t="d",F[1].v=hf(F[1].v))),V.qpro&&F[3]>de&&(H["!ref"]=et(b),ue[ne]=H,pe.push(ne),H=V.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},de=F[3],ne=ye||"Sheet"+(de+1),ye="");var te=V.dense?(H[F[0].r]||[])[F[0].c]:H[We(F[0])];if(te){te.t=F[1].t,te.v=F[1].v,F[1].z!=null&&(te.z=F[1].z),F[1].f!=null&&(te.f=F[1].f);break}V.dense?(H[F[0].r]||(H[F[0].r]=[]),H[F[0].r][F[0].c]=F[1]):H[We(F[0])]=F[1];break}},V);else if(O[2]==26||O[2]==14)V.Enum=Y,O[2]==14&&(V.qpro=!0,O.l=0),r(O,function(F,D,U){switch(U){case 204:ne=F;break;case 22:F[1].v=F[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(F[3]>de&&(H["!ref"]=et(b),ue[ne]=H,pe.push(ne),H=V.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},de=F[3],ne="Sheet"+(de+1)),J>0&&F[0].r>=J)break;V.dense?(H[F[0].r]||(H[F[0].r]=[]),H[F[0].r][F[0].c]=F[1]):H[We(F[0])]=F[1],b.e.c<F[0].c&&(b.e.c=F[0].c),b.e.r<F[0].r&&(b.e.r=F[0].r);break;case 27:F[14e3]&&(be[F[14e3][0]]=F[14e3][1]);break;case 1537:be[F[0]]=F[1],F[0]==de&&(ne=F[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(H["!ref"]=et(b),ue[ye||ne]=H,pe.push(ye||ne),!be.length)return{SheetNames:pe,Sheets:ue};for(var v={},K=[],P=0;P<be.length;++P)ue[pe[P]]?(K.push(be[P]||pe[P]),v[be[P]]=ue[be[P]]||ue[pe[P]]):(K.push(be[P]),v[be[P]]={"!ref":"A1"});return{SheetNames:K,Sheets:v}}function i(O,j){var V=j||{};if(+V.codepage>=0&&ci(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Lh(),ne=kt(O["!ref"]),ye=Array.isArray(O),de=[];ai(H,0,s(1030)),ai(H,6,l(ne));for(var ue=Math.min(ne.e.r,8191),pe=ne.s.r;pe<=ue;++pe)for(var be=qt(pe),b=ne.s.c;b<=ne.e.c;++b){pe===ne.s.r&&(de[b]=Pt(b));var J=de[b]+be,v=ye?(O[pe]||[])[b]:O[J];if(!(!v||v.t=="z"))if(v.t=="n")(v.v|0)==v.v&&v.v>=-32768&&v.v<=32767?ai(H,13,d(pe,b,v.v)):ai(H,14,p(pe,b,v.v));else{var K=sn(v);ai(H,15,h(pe,b,K.slice(0,239)))}}return ai(H,1),H.end()}function n(O,j){var V=j||{};if(+V.codepage>=0&&ci(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Lh();ai(H,0,a(O));for(var ne=0,ye=0;ne<O.SheetNames.length;++ne)(O.Sheets[O.SheetNames[ne]]||{})["!ref"]&&ai(H,27,L(O.SheetNames[ne],ye++));var de=0;for(ne=0;ne<O.SheetNames.length;++ne){var ue=O.Sheets[O.SheetNames[ne]];if(!(!ue||!ue["!ref"])){for(var pe=kt(ue["!ref"]),be=Array.isArray(ue),b=[],J=Math.min(pe.e.r,8191),v=pe.s.r;v<=J;++v)for(var K=qt(v),P=pe.s.c;P<=pe.e.c;++P){v===pe.s.r&&(b[P]=Pt(P));var F=b[P]+K,D=be?(ue[v]||[])[P]:ue[F];if(!(!D||D.t=="z"))if(D.t=="n")ai(H,23,I(v,P,de,D.v));else{var U=sn(D);ai(H,22,_(v,P,de,U.slice(0,239)))}}++de}}return ai(H,1),H.end()}function s(O){var j=Rt(2);return j.write_shift(2,O),j}function a(O){var j=Rt(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var V=0,H=0,ne=0,ye=0;ye<O.SheetNames.length;++ye){var de=O.SheetNames[ye],ue=O.Sheets[de];if(!(!ue||!ue["!ref"])){++ne;var pe=ha(ue["!ref"]);V<pe.e.r&&(V=pe.e.r),H<pe.e.c&&(H=pe.e.c)}}return V>8191&&(V=8191),j.write_shift(2,V),j.write_shift(1,ne),j.write_shift(1,H),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function o(O,j,V){var H={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&V.qpro?(H.s.c=O.read_shift(1),O.l++,H.s.r=O.read_shift(2),H.e.c=O.read_shift(1),O.l++,H.e.r=O.read_shift(2),H):(H.s.c=O.read_shift(2),H.s.r=O.read_shift(2),j==12&&V.qpro&&(O.l+=2),H.e.c=O.read_shift(2),H.e.r=O.read_shift(2),j==12&&V.qpro&&(O.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function l(O){var j=Rt(8);return j.write_shift(2,O.s.c),j.write_shift(2,O.s.r),j.write_shift(2,O.e.c),j.write_shift(2,O.e.r),j}function c(O,j,V){var H=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(H[0].c=O.read_shift(1),H[3]=O.read_shift(1),H[0].r=O.read_shift(2),O.l+=2):(H[2]=O.read_shift(1),H[0].c=O.read_shift(2),H[0].r=O.read_shift(2)),H}function f(O,j,V){var H=O.l+j,ne=c(O,j,V);if(ne[1].t="s",V.vers==20768){O.l++;var ye=O.read_shift(1);return ne[1].v=O.read_shift(ye,"utf8"),ne}return V.qpro&&O.l++,ne[1].v=O.read_shift(H-O.l,"cstr"),ne}function h(O,j,V){var H=Rt(7+V.length);H.write_shift(1,255),H.write_shift(2,j),H.write_shift(2,O),H.write_shift(1,39);for(var ne=0;ne<H.length;++ne){var ye=V.charCodeAt(ne);H.write_shift(1,ye>=128?95:ye)}return H.write_shift(1,0),H}function u(O,j,V){var H=c(O,j,V);return H[1].v=O.read_shift(2,"i"),H}function d(O,j,V){var H=Rt(7);return H.write_shift(1,255),H.write_shift(2,j),H.write_shift(2,O),H.write_shift(2,V,"i"),H}function m(O,j,V){var H=c(O,j,V);return H[1].v=O.read_shift(8,"f"),H}function p(O,j,V){var H=Rt(13);return H.write_shift(1,255),H.write_shift(2,j),H.write_shift(2,O),H.write_shift(8,V,"f"),H}function g(O,j,V){var H=O.l+j,ne=c(O,j,V);if(ne[1].v=O.read_shift(8,"f"),V.qpro)O.l=H;else{var ye=O.read_shift(2);T(O.slice(O.l,O.l+ye),ne),O.l+=ye}return ne}function x(O,j,V){var H=j&32768;return j&=-32769,j=(H?O:0)+(j>=8192?j-16384:j),(H?"":"$")+(V?Pt(j):qt(j))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(O,j){jt(O,0);for(var V=[],H=0,ne="",ye="",de="",ue="";O.l<O.length;){var pe=O[O.l++];switch(pe){case 0:V.push(O.read_shift(8,"f"));break;case 1:ye=x(j[0].c,O.read_shift(2),!0),ne=x(j[0].r,O.read_shift(2),!1),V.push(ye+ne);break;case 2:{var be=x(j[0].c,O.read_shift(2),!0),b=x(j[0].r,O.read_shift(2),!1);ye=x(j[0].c,O.read_shift(2),!0),ne=x(j[0].r,O.read_shift(2),!1),V.push(be+b+":"+ye+ne)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(O.read_shift(2));break;case 6:{for(var J="";pe=O[O.l++];)J+=String.fromCharCode(pe);V.push('"'+J.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:ue=V.pop(),de=V.pop(),V.push(["AND","OR"][pe-20]+"("+de+","+ue+")");break;default:if(pe<32&&w[pe])ue=V.pop(),de=V.pop(),V.push(de+w[pe]+ue);else if(y[pe]){if(H=y[pe][1],H==69&&(H=O[O.l++]),H>V.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+V.join("|")+"|");return}var v=V.slice(-H);V.length-=H,V.push(y[pe][0]+"("+v.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}V.length==1?j[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function C(O){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=O.read_shift(2),j[3]=O[O.l++],j[0].c=O[O.l++],j}function R(O,j){var V=C(O);return V[1].t="s",V[1].v=O.read_shift(j-4,"cstr"),V}function _(O,j,V,H){var ne=Rt(6+H.length);ne.write_shift(2,O),ne.write_shift(1,V),ne.write_shift(1,j),ne.write_shift(1,39);for(var ye=0;ye<H.length;++ye){var de=H.charCodeAt(ye);ne.write_shift(1,de>=128?95:de)}return ne.write_shift(1,0),ne}function A(O,j){var V=C(O);V[1].v=O.read_shift(2);var H=V[1].v>>1;if(V[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return V[1].v=H,V}function k(O,j){var V=C(O),H=O.read_shift(4),ne=O.read_shift(4),ye=O.read_shift(2);if(ye==65535)return H===0&&ne===3221225472?(V[1].t="e",V[1].v=15):H===0&&ne===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var de=ye&32768;return ye=(ye&32767)-16446,V[1].v=(1-de*2)*(ne*Math.pow(2,ye+32)+H*Math.pow(2,ye)),V}function I(O,j,V,H){var ne=Rt(14);if(ne.write_shift(2,O),ne.write_shift(1,V),ne.write_shift(1,j),H==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var ye=0,de=0,ue=0,pe=0;return H<0&&(ye=1,H=-H),de=Math.log2(H)|0,H/=Math.pow(2,de-31),pe=H>>>0,pe&2147483648||(H/=2,++de,pe=H>>>0),H-=pe,pe|=2147483648,pe>>>=0,H*=Math.pow(2,32),ue=H>>>0,ne.write_shift(4,ue),ne.write_shift(4,pe),de+=16383+(ye?32768:0),ne.write_shift(2,de),ne}function N(O,j){var V=k(O);return O.l+=j-14,V}function S(O,j){var V=C(O),H=O.read_shift(4);return V[1].v=H>>6,V}function W(O,j){var V=C(O),H=O.read_shift(8,"f");return V[1].v=H,V}function E(O,j){var V=W(O);return O.l+=j-10,V}function Q(O,j){return O[O.l+j-1]==0?O.read_shift(j,"cstr"):""}function ae(O,j){var V=O[O.l++];V>j-1&&(V=j-1);for(var H="";H.length<V;)H+=String.fromCharCode(O[O.l++]);return H}function Z(O,j,V){if(!(!V.qpro||j<21)){var H=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var ne=O.read_shift(j-21,"cstr");return[H,ne]}}function xe(O,j){for(var V={},H=O.l+j;O.l<H;){var ne=O.read_shift(2);if(ne==14e3){for(V[ne]=[0,""],V[ne][0]=O.read_shift(2);O[O.l];)V[ne][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return V}function L(O,j){var V=Rt(5+O.length);V.write_shift(2,14e3),V.write_shift(2,j);for(var H=0;H<O.length;++H){var ne=O.charCodeAt(H);V[V.l++]=ne>127?95:ne}return V[V.l++]=0,V}var ge={0:{n:"BOF",f:At},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:S},38:{n:"??"},39:{n:"NUMBER27",f:W},40:{n:"FORMULA28",f:E},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:n,to_workbook:e}}();function VE(r){var e={},t=r.match(ur),i=0,n=!1;if(t)for(;i!=t.length;++i){var s=He(t[i]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=o0[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return e}var jE=function(){var r=go("t"),e=go("rPr");function t(s){var a=s.match(r);if(!a)return{t:"s",v:""};var o={t:"s",v:it(a[1])},l=s.match(e);return l&&(o.s=VE(l[1])),o}var i=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(a){return a.replace(i,"").split(n).map(t).filter(function(o){return o.v})}}(),$E=function(){var e=/(\r\n|\n)/g;function t(n,s,a){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),n.b&&(s.push("<b>"),a.push("</b>")),n.i&&(s.push("<i>"),a.push("</i>")),n.strike&&(s.push("<s>"),a.push("</s>"));var l=n.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),n}function i(n){var s=[[],n.v,[]];return n.v?(n.s&&t(n.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(i).join("")}}(),GE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,KE=/<(?:\w+:)?r>/,XE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function S0(r,e){var t=e?e.cellHTML:!0,i={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=it(ut(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=ut(r),t&&(i.h=p0(i.t))):r.match(KE)&&(i.r=ut(r),i.t=it(ut((r.replace(XE,"").match(GE)||[]).join("").replace(ur,""))),t&&(i.h=$E(jE(i.r)))),i):{t:""}}var qE=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,YE=/<(?:\w+:)?(?:si|sstItem)>/g,JE=/<\/(?:\w+:)?(?:si|sstItem)>/;function ZE(r,e){var t=[],i="";if(!r)return t;var n=r.match(qE);if(n){i=n[2].replace(YE,"").split(JE);for(var s=0;s!=i.length;++s){var a=S0(i[s].trim(),e);a!=null&&(t[t.length]=a)}n=He(n[1]),t.Count=n.count,t.Unique=n.uniqueCount}return t}function QE(r){return[r.read_shift(4),r.read_shift(4)]}function eC(r,e){var t=[],i=!1;return fn(r,function(s,a,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(a.T,!i||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function av(r){for(var e=[],t=r.split(""),i=0;i<t.length;++i)e[i]=t[i].charCodeAt(0);return e}function en(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function tC(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=en(r,4),e.U=en(r,4),e.W=en(r,4),e}function rC(r){for(var e=r.read_shift(4),t=r.l+e-4,i={},n=r.read_shift(4),s=[];n-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(i.name=r.read_shift(0,"lpp4"),i.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return i}function iC(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(rC(r));return e}function nC(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function sC(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=en(r,4),e.U=en(r,4),e.W=en(r,4),e}function aC(r){var e=sC(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function ov(r,e){var t=r.l+e,i={};i.Flags=r.read_shift(4)&63,r.l+=4,i.AlgID=r.read_shift(4);var n=!1;switch(i.AlgID){case 26126:case 26127:case 26128:n=i.Flags==36;break;case 26625:n=i.Flags==4;break;case 0:n=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=r.read_shift(4),i.KeySize=r.read_shift(4),i.ProviderType=r.read_shift(4),r.l+=8,i.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,i}function lv(r,e){var t={},i=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,i),r.l=i,t}function oC(r){var e=en(r);switch(e.Minor){case 2:return[e.Minor,lC(r)];case 3:return[e.Minor,cC()];case 4:return[e.Minor,fC(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function lC(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),i=ov(r,t),n=lv(r,r.length-r.l);return{t:"Std",h:i,v:n}}function cC(){throw new Error("File is password-protected: ECMA-376 Extensible")}function fC(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),i={};return t.replace(ur,function(s){var a=He(s);switch(Hi(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){i[o]=a[o]});break;case"<dataIntegrity":i.encryptedHmacKey=a.encryptedHmacKey,i.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(a);break;default:throw a[0]}}),i}function hC(r,e){var t={},i=t.EncryptionVersionInfo=en(r,4);if(e-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);t.Flags=r.read_shift(4),e-=4;var n=r.read_shift(4);return e-=4,t.EncryptionHeader=ov(r,n),e-=n,t.EncryptionVerifier=lv(r,e),t}function uC(r){var e={},t=e.EncryptionVersionInfo=en(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function dC(r){var e=0,t,i=av(r),n=i.length+1,s,a,o,l,c;for(t=Rn(n),t[0]=i.length,s=1;s!=n;++s)t[s]=i[s-1];for(s=n-1;s>=0;--s)a=t[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var cv=function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(a){return(a/2|a*128)&255},n=function(a,o){return i(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var f=a[c],h=0;h!=7;++h)f&64&&(o^=t[l]),f*=2,--l;return o};return function(a){for(var o=av(a),l=s(o),c=o.length,f=Rn(16),h=0;h!=16;++h)f[h]=0;var u,d,m;for((c&1)===1&&(u=l>>8,f[c]=n(r[0],u),--c,u=l&255,d=o[o.length-1],f[c]=n(d,u));c>0;)--c,u=l>>8,f[c]=n(o[c],u),--c,u=l&255,f[c]=n(o[c],u);for(c=15,m=15-o.length;m>0;)u=l>>8,f[c]=n(r[m],u),--c,--m,u=l&255,f[c]=n(o[c],u),--c,--m;return f}}(),pC=function(r,e,t,i,n){n||(n=e),i||(i=cv(r));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=i[t],a=(a>>5|a<<3)&255,n[s]=a,++t;return[n,t,i]},mC=function(r){var e=0,t=cv(r);return function(i){var n=pC("",i,e,t);return e=n[1],n[0]}};function gC(r,e,t,i){var n={key:At(r),verificationBytes:At(r)};return t.password&&(n.verifier=dC(t.password)),i.valid=n.verificationBytes===n.verifier,i.valid&&(i.insitu=mC(t.password)),n}function xC(r,e,t){var i=t||{};return i.Info=r.read_shift(2),r.l-=2,i.Info===1?i.Data=uC(r):i.Data=hC(r,e),i}function vC(r,e,t){var i={Type:t.biff>=8?r.read_shift(2):0};return i.Type?xC(r,e-2,i):gC(r,t.biff>=8?e:e-2,t,i),i}var yC=function(){function r(n,s){switch(s.type){case"base64":return e(jr(n),s);case"binary":return e(n,s);case"buffer":return e(Ze&&Buffer.isBuffer(n)?n.toString("binary"):xs(n),s);case"array":return e(ls(n),s)}throw new Error("Unrecognized type "+s.type)}function e(n,s){var a=s||{},o=a.dense?[]:{},l=n.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var u=/\\\w+\b/g,d=0,m,p=-1;m=u.exec(f);){switch(m[0]){case"\\cell":var g=f.slice(d,u.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var x={v:g,t:"s"};Array.isArray(o)?o[h][p]=x:o[We({r:h,c:p})]=x}break}d=u.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=et(c),o}function t(n,s){return Un(r(n,s),s)}function i(n){for(var s=["{\\rtf1\\ansi"],a=kt(n["!ref"]),o,l=Array.isArray(n),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=We({r:c,c:f});o=l?(n[c]||[])[f]:n[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(sn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:i}}();function wC(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function yo(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function kC(r){var e=r[0]/255,t=r[1]/255,i=r[2]/255,n=Math.max(e,t,i),s=Math.min(e,t,i),a=n-s;if(a===0)return[0,0,e];var o=0,l=0,c=n+s;switch(l=a/(c>1?2-c:c),n){case e:o=((t-i)/a+6)%6;break;case t:o=(i-e)/a+2;break;case i:o=(e-t)/a+4;break}return[o/6,l,c/2]}function bC(r){var e=r[0],t=r[1],i=r[2],n=t*2*(i<.5?i:1-i),s=i-n/2,a=[s,s,s],o=6*e,l;if(t!==0)switch(o|0){case 0:case 6:l=n*o,a[0]+=n,a[1]+=l;break;case 1:l=n*(2-o),a[0]+=l,a[1]+=n;break;case 2:l=n*(o-2),a[1]+=n,a[2]+=l;break;case 3:l=n*(4-o),a[1]+=l,a[2]+=n;break;case 4:l=n*(o-4),a[2]+=n,a[0]+=l;break;case 5:l=n*(6-o),a[2]+=l,a[0]+=n;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function bc(r,e){if(e===0)return r;var t=kC(wC(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),yo(bC(t))}var fv=6,_C=15,SC=1,xr=fv;function _c(r){return Math.floor((r+Math.round(128/xr)/256)*xr)}function Sc(r){return Math.floor((r-5)/xr*100+.5)/100}function Hh(r){return Math.round((r*xr+5)/xr*256)/256}function jf(r){return Hh(Sc(_c(r)))}function T0(r){var e=Math.abs(r-jf(r)),t=xr;if(e>.005)for(xr=SC;xr<_C;++xr)Math.abs(r-jf(r))<=e&&(e=Math.abs(r-jf(r)),t=xr);xr=t}function ea(r){r.width?(r.wpx=_c(r.width),r.wch=Sc(r.wpx),r.MDW=xr):r.wpx?(r.wch=Sc(r.wpx),r.width=Hh(r.wch),r.MDW=xr):typeof r.wch=="number"&&(r.width=Hh(r.wch),r.wpx=_c(r.width),r.MDW=xr),r.customWidth&&delete r.customWidth}var TC=96,hv=TC;function uv(r){return r*96/hv}function wo(r){return r*hv/96}var EC={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function CC(r,e,t,i){e.Borders=[];var n={},s=!1;(r[0].match(ur)||[]).forEach(function(a){var o=He(a);switch(Hi(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=mt(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=mt(o.diagonalDown)),e.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i&&i.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function AC(r,e,t,i){e.Fills=[];var n={},s=!1;(r[0].match(ur)||[]).forEach(function(a){var o=He(a);switch(Hi(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},e.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i&&i.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function OC(r,e,t,i){e.Fonts=[];var n={},s=!1;(r[0].match(ur)||[]).forEach(function(a){var o=He(a);switch(Hi(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=ut(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?mt(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?mt(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?mt(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?mt(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?mt(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?mt(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?mt(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=o0[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=mt(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var l=ns[n.color.index];n.color.index==81&&(l=ns[1]),l||(l=ns[1]),n.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=bc(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i&&i.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function FC(r,e,t){e.NumberFmt=[];for(var i=Ni(Ke),n=0;n<i.length;++n)e.NumberFmt[i[n]]=Ke[i[n]];var s=r[0].match(ur);if(s)for(n=0;n<s.length;++n){var a=He(s[n]);switch(Hi(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=it(ut(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}is(o,l)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var gl=["numFmtId","fillId","fontId","borderId","xfId"],xl=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function DC(r,e,t){e.CellXf=[];var i,n=!1;(r[0].match(ur)||[]).forEach(function(s){var a=He(s),o=0;switch(Hi(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=a,delete i[0],o=0;o<gl.length;++o)i[gl[o]]&&(i[gl[o]]=parseInt(i[gl[o]],10));for(o=0;o<xl.length;++o)i[xl[o]]&&(i[xl[o]]=mt(i[xl[o]]));if(e.NumberFmt&&i.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[i.numFmtId]==e.NumberFmt[o]){i.numFmtId=o;break}}e.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=mt(a.wrapText)),i.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(t&&t.WTF&&!n)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var RC=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&FC(h,f,c),(h=o.match(n))&&OC(h,f,l,c),(h=o.match(i))&&AC(h,f,l,c),(h=o.match(s))&&CC(h,f,l,c),(h=o.match(t))&&DC(h,f,c),f}}();function MC(r,e){var t=r.read_shift(2),i=lr(r);return[t,i]}function IC(r,e,t){var i={};i.sz=r.read_shift(2)/20;var n=jS(r);n.fItalic&&(i.italic=1),n.fCondense&&(i.condense=1),n.fExtend&&(i.extend=1),n.fShadow&&(i.shadow=1),n.fOutline&&(i.outline=1),n.fStrikeout&&(i.strike=1);var s=r.read_shift(2);switch(s===700&&(i.bold=1),r.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(i.underline=a);var o=r.read_shift(1);o>0&&(i.family=o);var l=r.read_shift(1);switch(l>0&&(i.charset=l),r.l++,i.color=VS(r),r.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=lr(r),i}var PC=fr;function LC(r,e){var t=r.l+e,i=r.read_shift(2),n=r.read_shift(2);return r.l=t,{ixfe:i,numFmtId:n}}var BC=fr;function NC(r,e,t){var i={};i.NumberFmt=[];for(var n in Ke)i.NumberFmt[n]=Ke[n];i.CellXf=[],i.Fonts=[];var s=[],a=!1;return fn(r,function(l,c,f){switch(f){case 44:i.NumberFmt[l[0]]=l[1],is(l[1],l[0]);break;case 43:i.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=bc(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&i.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!a||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),i}var UC=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function HC(r,e,t){e.themeElements.clrScheme=[];var i={};(r[0].match(ur)||[]).forEach(function(n){var s=He(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=s.val;break;case"<a:sysClr":i.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[UC.indexOf(s[0])]=i,i={}):i.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function zC(){}function WC(){}var VC=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,jC=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,$C=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function GC(r,e,t){e.themeElements={};var i;[["clrScheme",VC,HC],["fontScheme",jC,zC],["fmtScheme",$C,WC]].forEach(function(n){if(!(i=r.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](i,e,t)})}var KC=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function dv(r,e){(!r||r.length===0)&&(r=XC());var t,i={};if(!(t=r.match(KC)))throw new Error("themeElements not found in theme");return GC(t[0],i,e),i.raw=r,i}function XC(r,e){var t=[Sx];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function qC(r,e,t){var i=r.l+e,n=r.read_shift(4);if(n!==124226){if(!t.cellStyles){r.l=i;return}var s=r.slice(r.l);r.l=i;var a;try{a=_x(s,{type:"array"})}catch{return}var o=Hr(a,"theme/theme/theme1.xml",!0);if(o)return dv(o,t)}}function YC(r){return r.read_shift(4)}function JC(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=ZC(r,4);break;case 2:e.xclrValue=Qx(r);break;case 3:e.xclrValue=YC(r);break;case 4:r.l+=4;break}return r.l+=8,e}function ZC(r,e){return fr(r,e)}function QC(r,e){return fr(r,e)}function eA(r){var e=r.read_shift(2),t=r.read_shift(2)-4,i=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=JC(r);break;case 6:i[1]=QC(r,t);break;case 14:case 15:i[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return i}function tA(r,e){var t=r.l+e;r.l+=2;var i=r.read_shift(2);r.l+=2;for(var n=r.read_shift(2),s=[];n-- >0;)s.push(eA(r,t-r.l));return{ixfe:i,ext:s}}function rA(r,e){e.forEach(function(t){switch(t[0]){}})}function iA(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:lr(r)}}function nA(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function sA(r){return r.l+=4,r.read_shift(4)!=0}function aA(r,e,t){var i={Types:[],Cell:[],Value:[]},n=t||{},s=[],a=!1,o=2;return fn(r,function(l,c,f){switch(f){case 335:i.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?i.Cell.push({type:i.Types[h[0]-1].name,index:h[1]}):o==0&&i.Value.push({type:i.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),i}function oA(r,e,t){var i={Types:[],Cell:[],Value:[]};if(!r)return i;var n=!1,s=2,a;return r.replace(ur,function(o){var l=He(o);switch(Hi(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<i.Types.length;++c)i.Types[c].name==l.name&&(a=i.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?i.Cell.push({type:i.Types[l.t-1].name,index:+l.v}):s==0&&i.Value.push({type:i.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),i}function lA(r){var e=[];if(!r)return e;var t=1;return(r.match(ur)||[]).forEach(function(i){var n=He(i);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?t=n.i:n.i=t,e.push(n);break}}),e}function cA(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=We(t);var i=r.read_shift(1);return i&2&&(e.l="1"),i&8&&(e.a="1"),e}function fA(r,e,t){var i=[];return fn(r,function(s,a,o){switch(o){case 63:i.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),i}function hA(r,e,t,i){if(!r)return r;var n=i||{},s=!1;fn(r,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},n)}function uA(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}function Rp(r,e,t,i){var n=Array.isArray(r),s;e.forEach(function(a){var o=kr(a.ref);if(n?(r[o.r]||(r[o.r]=[]),s=r[o.r][o.c]):s=r[a.ref],!s){s={t:"z"},n?r[o.r][o.c]=s:r[a.ref]=s;var l=kt(r["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=et(l);c!==r["!ref"]&&(r["!ref"]=c)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:t};a.h&&(f.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!t&&s.c[h].T)return;t&&!s.c[h].T&&s.c.splice(h,1)}if(t&&i){for(h=0;h<i.length;++h)if(f.a==i[h].id){f.a=i[h].name||f.a;break}}s.c.push(f)})}function dA(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],i=[],n=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=He(o[0]),c={author:l.authorId&&t[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=kr(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),u=!!h&&!!h[1]&&S0(h[1])||{r:"",t:"",h:""};c.r=u.r,u.r=="<t></t>"&&(u.t=u.h=""),c.t=(u.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=u.h),i.push(c)}}}}),i}function pA(r,e){var t=[],i=!1,n={},s=0;return r.replace(ur,function(o,l){var c=He(o);switch(Hi(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":n.t!=null&&t.push(n);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":n.t=r.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),t}function mA(r,e){var t=[],i=!1;return r.replace(ur,function(s){var a=He(s);switch(Hi(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),t}function gA(r){var e={};e.iauthor=r.read_shift(4);var t=ys(r);return e.rfx=t.s,e.ref=We(t.s),r.l+=16,e}var xA=lr;function vA(r,e){var t=[],i=[],n={},s=!1;return fn(r,function(o,l,c){switch(c){case 632:i.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=i[n.iauthor],delete n.iauthor,e.sheetRows&&n.rfx&&e.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,t.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),t}var yA="application/vnd.ms-office.vbaProject";function wA(r){var e=Qe.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,i){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var n=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Qe.utils.cfb_add(e,n,r.FileIndex[i].content)}}),Qe.write(e)}function kA(){return{"!type":"dialog"}}function bA(){return{"!type":"dialog"}}function _A(){return{"!type":"macro"}}function SA(){return{"!type":"macro"}}var Vs=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(i,n,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?c+=e.r:--c,n+(o?"":"$")+Pt(f)+(l?"":"$")+qt(c)}return function(n,s){return e=s,n.replace(r,t)}}(),pv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,TA=function(){return function(e,t){return e.replace(pv,function(i,n,s,a,o,l){var c=v0(a)-(s?0:t.c),f=x0(l)-(o?0:t.r),h=f==0?"":o?f+1:"["+f+"]",u=c==0?"":s?c+1:"["+c+"]";return n+"R"+h+"C"+u})}}();function mv(r,e){return r.replace(pv,function(t,i,n,s,a,o){return i+(n=="$"?n+s:Pt(v0(s)+e.c))+(a=="$"?a+o:qt(x0(o)+e.r))})}function EA(r,e,t){var i=ha(e),n=i.s,s=kr(t),a={r:s.r-n.r,c:s.c-n.c};return mv(r,a)}function CA(r){return r.length!=1}function Mp(r){return r.replace(/_xlfn\./g,"")}function Et(r){r.l+=1}function Mn(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function gv(r,e,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return xv(r);t.biff==12&&(i=4)}var n=r.read_shift(i),s=r.read_shift(i),a=Mn(r),o=Mn(r);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function xv(r){var e=Mn(r),t=Mn(r),i=r.read_shift(1),n=r.read_shift(1);return{s:{r:e[0],c:i,cRel:e[1],rRel:e[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function AA(r,e,t){if(t.biff<8)return xv(r);var i=r.read_shift(t.biff==12?4:2),n=r.read_shift(t.biff==12?4:2),s=Mn(r),a=Mn(r);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}function vv(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return OA(r);var i=r.read_shift(t&&t.biff==12?4:2),n=Mn(r);return{r:i,c:n[0],cRel:n[1],rRel:n[2]}}function OA(r){var e=Mn(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function FA(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function DA(r,e,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return RA(r);var n=r.read_shift(i>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;n>524287;)n-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:a,rRel:o}}function RA(r){var e=r.read_shift(2),t=r.read_shift(1),i=(e&32768)>>15,n=(e&16384)>>14;return e&=16383,i==1&&e>=8192&&(e=e-16384),n==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:n,rRel:i}}function MA(r,e,t){var i=(r[r.l++]&96)>>5,n=gv(r,t.biff>=2&&t.biff<=5?6:8,t);return[i,n]}function IA(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=gv(r,s,t);return[i,n,a]}function PA(r,e,t){var i=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function LA(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[i,n]}function BA(r,e,t){var i=(r[r.l++]&96)>>5,n=AA(r,e-1,t);return[i,n]}function NA(r,e,t){var i=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[i]}function Ip(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function UA(r,e,t){r.l+=2;for(var i=r.read_shift(t&&t.biff==2?1:2),n=[],s=0;s<=i;++s)n.push(r.read_shift(t&&t.biff==2?1:2));return n}function HA(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(t&&t.biff==2?1:2)]}function zA(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(t&&t.biff==2?1:2)]}function WA(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function VA(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[i]}function yv(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function jA(r){return r.read_shift(2),yv(r)}function $A(r){return r.read_shift(2),yv(r)}function GA(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=vv(r,0,t);return[i,n]}function KA(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=DA(r,0,t);return[i,n]}function XA(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=vv(r,0,t);return[i,n,s]}function qA(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(t&&t.biff<=3?1:2);return[Y4[n],bv[n],i]}function YA(r,e,t){var i=r[r.l++],n=r.read_shift(1),s=t&&t.biff<=3?[i==88?-1:0,r.read_shift(1)]:JA(r);return[n,(s[0]===0?bv:q4)[s[1]]]}function JA(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function ZA(r,e,t){r.l+=t&&t.biff==2?3:4}function QA(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var i=r.read_shift(2),n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function e4(r){return r.l++,ws[r.read_shift(1)]}function t4(r){return r.l++,r.read_shift(2)}function r4(r){return r.l++,r.read_shift(1)!==0}function i4(r){return r.l++,nr(r)}function n4(r,e,t){return r.l++,Vo(r,e-1,t)}function s4(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=bt(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=ws[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=nr(r);break;case 2:t[1]=ks(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function a4(r,e,t){for(var i=r.read_shift(t.biff==12?4:2),n=[],s=0;s!=i;++s)n.push((t.biff==12?ys:uf)(r));return n}function o4(r,e,t){var i=0,n=0;t.biff==12?(i=r.read_shift(4),n=r.read_shift(4)):(n=1+r.read_shift(1),i=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--n==0&&(n=256));for(var s=0,a=[];s!=i&&(a[s]=[]);++s)for(var o=0;o!=n;++o)a[s][o]=s4(r,t.biff);return a}function l4(r,e,t){var i=r.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,s=r.read_shift(n);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[i,0,s]}function c4(r,e,t){if(t.biff==5)return f4(r);var i=r.read_shift(1)>>>5&3,n=r.read_shift(2),s=r.read_shift(4);return[i,n,s]}function f4(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var i=r.read_shift(2);return r.l+=12,[e,t,i]}function h4(r,e,t){var i=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function u4(r,e,t){var i=r.read_shift(1)>>>5&3,n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function d4(r,e,t){var i=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[i]}function p4(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[i,n]}var m4=fr,g4=fr,x4=fr;function $o(r,e,t){return r.l+=2,[FA(r)]}function E0(r){return r.l+=6,[]}var v4=$o,y4=E0,w4=E0,k4=$o;function wv(r){return r.l+=2,[At(r),r.read_shift(2)&1]}var b4=$o,_4=wv,S4=E0,T4=$o,E4=$o,C4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function A4(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(4),n=r.read_shift(2),s=r.read_shift(2),a=C4[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:i,c:n,C:s}}function O4(r){return r.l+=2,[r.read_shift(4)]}function F4(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function D4(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function R4(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function M4(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function I4(r){return r.l+=4,[0,0]}var Pp={1:{n:"PtgExp",f:QA},2:{n:"PtgTbl",f:x4},3:{n:"PtgAdd",f:Et},4:{n:"PtgSub",f:Et},5:{n:"PtgMul",f:Et},6:{n:"PtgDiv",f:Et},7:{n:"PtgPower",f:Et},8:{n:"PtgConcat",f:Et},9:{n:"PtgLt",f:Et},10:{n:"PtgLe",f:Et},11:{n:"PtgEq",f:Et},12:{n:"PtgGe",f:Et},13:{n:"PtgGt",f:Et},14:{n:"PtgNe",f:Et},15:{n:"PtgIsect",f:Et},16:{n:"PtgUnion",f:Et},17:{n:"PtgRange",f:Et},18:{n:"PtgUplus",f:Et},19:{n:"PtgUminus",f:Et},20:{n:"PtgPercent",f:Et},21:{n:"PtgParen",f:Et},22:{n:"PtgMissArg",f:Et},23:{n:"PtgStr",f:n4},26:{n:"PtgSheet",f:F4},27:{n:"PtgEndSheet",f:D4},28:{n:"PtgErr",f:e4},29:{n:"PtgBool",f:r4},30:{n:"PtgInt",f:t4},31:{n:"PtgNum",f:i4},32:{n:"PtgArray",f:NA},33:{n:"PtgFunc",f:qA},34:{n:"PtgFuncVar",f:YA},35:{n:"PtgName",f:l4},36:{n:"PtgRef",f:GA},37:{n:"PtgArea",f:MA},38:{n:"PtgMemArea",f:h4},39:{n:"PtgMemErr",f:m4},40:{n:"PtgMemNoMem",f:g4},41:{n:"PtgMemFunc",f:u4},42:{n:"PtgRefErr",f:d4},43:{n:"PtgAreaErr",f:PA},44:{n:"PtgRefN",f:KA},45:{n:"PtgAreaN",f:BA},46:{n:"PtgMemAreaN",f:R4},47:{n:"PtgMemNoMemN",f:M4},57:{n:"PtgNameX",f:c4},58:{n:"PtgRef3d",f:XA},59:{n:"PtgArea3d",f:IA},60:{n:"PtgRefErr3d",f:p4},61:{n:"PtgAreaErr3d",f:LA},255:{}},P4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},L4={1:{n:"PtgElfLel",f:wv},2:{n:"PtgElfRw",f:T4},3:{n:"PtgElfCol",f:v4},6:{n:"PtgElfRwV",f:E4},7:{n:"PtgElfColV",f:k4},10:{n:"PtgElfRadical",f:b4},11:{n:"PtgElfRadicalS",f:S4},13:{n:"PtgElfColS",f:y4},15:{n:"PtgElfColSV",f:w4},16:{n:"PtgElfRadicalLel",f:_4},25:{n:"PtgList",f:A4},29:{n:"PtgSxName",f:O4},255:{}},B4={0:{n:"PtgAttrNoop",f:I4},1:{n:"PtgAttrSemi",f:VA},2:{n:"PtgAttrIf",f:zA},4:{n:"PtgAttrChoose",f:UA},8:{n:"PtgAttrGoto",f:HA},16:{n:"PtgAttrSum",f:ZA},32:{n:"PtgAttrBaxcel",f:Ip},33:{n:"PtgAttrBaxcel",f:Ip},64:{n:"PtgAttrSpace",f:jA},65:{n:"PtgAttrSpaceSemi",f:$A},128:{n:"PtgAttrIfError",f:WA},255:{}};function Go(r,e,t,i){if(i.biff<8)return fr(r,e);for(var n=r.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=o4(r,0,i),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=a4(r,t[a][1],i),s.push(t[a][2]);break;case"PtgExp":i&&i.biff==12&&(t[a][1][1]=r.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=n-r.l,e!==0&&s.push(fr(r,e)),s}function Ko(r,e,t){for(var i=r.l+e,n,s,a=[];i!=r.l;)e=i-r.l,s=r[r.l],n=Pp[s]||Pp[P4[s]],(s===24||s===25)&&(n=(s===24?L4:B4)[r[r.l+1]]),!n||!n.f?fr(r,e):a.push([n.n,n.f(r,e,t)]);return a}function N4(r){for(var e=[],t=0;t<r.length;++t){for(var i=r[t],n=[],s=0;s<i.length;++s){var a=i[s];if(a)switch(a[0]){case 2:n.push('"'+a[1].replace(/"/g,'""')+'"');break;default:n.push(a[1])}else n.push("")}e.push(n.join(","))}return e.join(";")}var U4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function H4(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function kv(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var i=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!i)return"SH33TJSERR1";var n="";if(t.biff>8)switch(r[i[0]][0]){case 357:return n=i[1]==-1?"#REF":r.SheetNames[i[1]],i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[i[0]][0];case 355:default:return"SH33TJSSRC"+r[i[0]][0]}switch(r[i[0]][0][0]){case 1025:return n=i[1]==-1?"#REF":r.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 14849:return r[i[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[i[0]][0][3]?(n=i[1]==-1?"#REF":r[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?n:n+":"+r[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function Lp(r,e,t){var i=kv(r,e,t);return i=="#REF"?i:H4(i,t)}function er(r,e,t,i,n){var s=n&&n.biff||8,a={s:{c:0,r:0}},o=[],l,c,f,h=0,u=0,d,m="";if(!r[0]||!r[0][0])return"";for(var p=-1,g="",x=0,y=r[0].length;x<y;++x){var w=r[0][x];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(r[0][p][1][0]){case 0:g=wt(" ",r[0][p][1][1]);break;case 1:g=wt("\r",r[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}c=c+g,p=-1}o.push(c+U4[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Ga(w[1][1],a,n),o.push(Ka(f,s));break;case"PtgRefN":f=t?Ga(w[1][1],t,n):w[1][1],o.push(Ka(f,s));break;case"PtgRef3d":h=w[1][1],f=Ga(w[1][2],a,n),m=Lp(i,h,n),o.push(m+"!"+Ka(f,s));break;case"PtgFunc":case"PtgFuncVar":var T=w[1][0],C=w[1][1];T||(T=0),T&=127;var R=T==0?[]:o.slice(-T);o.length-=T,C==="User"&&(C=R.shift()),o.push(C+"("+R.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":d=gp(w[1][1],t?{s:t}:a,n),o.push(Wf(d,n));break;case"PtgArea":d=gp(w[1][1],a,n),o.push(Wf(d,n));break;case"PtgArea3d":h=w[1][1],d=w[1][2],m=Lp(i,h,n),o.push(m+"!"+Wf(d,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=w[1][2];var _=(i.names||[])[u-1]||(i[0]||[])[u],A=_?_.Name:"SH33TJSNAME"+String(u);A&&A.slice(0,6)=="_xlfn."&&!n.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var k=w[1][1];u=w[1][2];var I;if(n.biff<=5)k<0&&(k=-k),i[k]&&(I=i[k][u]);else{var N="";if(((i[k]||[])[0]||[])[0]==14849||(((i[k]||[])[0]||[])[0]==1025?i[k][u]&&i[k][u].itab>0&&(N=i.SheetNames[i[k][u].itab-1]+"!"):N=i.SheetNames[u-1]+"!"),i[k]&&i[k][u])N+=i[k][u].Name;else if(i[0]&&i[0][u])N+=i[0][u].Name;else{var S=(kv(i,k,n)||"").split(";;");S[u-1]?N=S[u-1]:N+="SH33TJSERRX"}o.push(N);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var W="(",E=")";if(p>=0){switch(g="",r[0][p][1][0]){case 2:W=wt(" ",r[0][p][1][1])+W;break;case 3:W=wt("\r",r[0][p][1][1])+W;break;case 4:E=wt(" ",r[0][p][1][1])+E;break;case 5:E=wt("\r",r[0][p][1][1])+E;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}p=-1}o.push(W+o.pop()+E);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:w[1][1],r:w[1][0]};var Q={c:t.c,r:t.r};if(i.sharedf[We(f)]){var ae=i.sharedf[We(f)];o.push(er(ae,a,Q,i,n))}else{var Z=!1;for(l=0;l!=i.arrayf.length;++l)if(c=i.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(er(c[1],a,Q,i,n)),Z=!0;break}Z||o.push(w[1])}break;case"PtgArray":o.push("{"+N4(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var xe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&xe.indexOf(r[0][x][0])==-1){w=r[0][p];var L=!0;switch(w[1][0]){case 4:L=!1;case 0:g=wt(" ",w[1][1]);break;case 5:L=!1;case 1:g=wt("\r",w[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((L?g:"")+o.pop()+(L?"":g)),p=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function z4(r,e,t){var i=r.l+e,n=t.biff==2?1:2,s,a=r.read_shift(n);if(a==65535)return[[],fr(r,e-2)];var o=Ko(r,a,t);return e!==a+n&&(s=Go(r,e-a-n,o,t)),r.l=i,[o,s]}function W4(r,e,t){var i=r.l+e,n=t.biff==2?1:2,s,a=r.read_shift(n);if(a==65535)return[[],fr(r,e-2)];var o=Ko(r,a,t);return e!==a+n&&(s=Go(r,e-a-n,o,t)),r.l=i,[o,s]}function V4(r,e,t,i){var n=r.l+e,s=Ko(r,i,t),a;return n!==r.l&&(a=Go(r,n-r.l,s,t)),[s,a]}function j4(r,e,t){var i=r.l+e,n,s=r.read_shift(2),a=Ko(r,s,t);return s==65535?[[],fr(r,e-2)]:(e!==s+2&&(n=Go(r,i-s-2,a,t)),[a,n])}function $4(r){var e;if(Ji(r,r.l+6)!==65535)return[nr(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function $f(r,e,t){var i=r.l+e,n=zi(r);t.biff==2&&++r.l;var s=$4(r),a=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var o=W4(r,i-r.l,t);return{cell:n,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function df(r,e,t){var i=r.read_shift(4),n=Ko(r,i,t),s=r.read_shift(4),a=s>0?Go(r,s,n,t):null;return[n,a]}var G4=df,pf=df,K4=df,X4=df,q4={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},bv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Y4={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Bp(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function Gf(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Ja={},js={};function Za(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function _v(r,e,t,i,n,s){try{i.cellNF&&(r.z=Ke[e])}catch(o){if(i.WTF)throw o}if(!(r.t==="z"&&!i.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Wt(r.v)),(!i||i.cellText!==!1)&&r.t!=="z")try{if(Ke[e]==null&&is(J_[e]||"General",e),r.t==="e")r.w=r.w||ws[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=mo(r.v);else if(r.t==="d"){var a=Tr(r.v);(a|0)===a?r.w=a.toString(10):r.w=mo(a)}else{if(r.v===void 0)return"";r.w=os(r.v,js)}else r.t==="d"?r.w=ti(e,Tr(r.v),js):r.w=ti(e,r.v,js)}catch(o){if(i.WTF)throw o}if(i.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=bc(n.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),i.WTF&&(r.s.fgColor.raw_rgb=n.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=bc(n.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),i.WTF&&(r.s.bgColor.raw_rgb=n.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(o){if(i.WTF&&s.Fills)throw o}}}function J4(r,e){var t=kt(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=et(t))}var Z4=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Q4=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,e3=/<(?:\w:)?hyperlink [^>]*>/mg,t3=/"(\w*:\w*)"/,r3=/<(?:\w:)?col\b[^>]*[\/]?>/g,i3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,n3=/<(?:\w:)?pageMargins[^>]*\/>/g,Sv=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,s3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,a3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function o3(r,e,t,i,n,s,a){if(!r)return r;i||(i={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",h=r.match(Q4);h?(c=r.slice(0,h.index),f=r.slice(h.index+h[0].length)):c=f=r;var u=c.match(Sv);u?C0(u[0],o,n,t):(u=c.match(s3))&&l3(u[0],u[1]||"",o,n,t);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var m=c.slice(d,d+50).match(t3);m&&J4(o,m[1])}var p=c.match(a3);p&&p[1]&&p3(p[1],n);var g=[];if(e.cellStyles){var x=c.match(r3);x&&h3(g,x)}h&&m3(h[1],o,e,l,s,a);var y=f.match(i3);y&&(o["!autofilter"]=u3(y[0]));var w=[],T=f.match(Z4);if(T)for(d=0;d!=T.length;++d)w[d]=kt(T[d].slice(T[d].indexOf('"')+1));var C=f.match(e3);C&&c3(o,C,i);var R=f.match(n3);if(R&&(o["!margins"]=f3(He(R[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=et(l)),e.sheetRows>0&&o["!ref"]){var _=kt(o["!ref"]);e.sheetRows<=+_.e.r&&(_.e.r=e.sheetRows-1,_.e.r>l.e.r&&(_.e.r=l.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>l.e.c&&(_.e.c=l.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),o["!fullref"]=o["!ref"],o["!ref"]=et(_))}return g.length>0&&(o["!cols"]=g),w.length>0&&(o["!merges"]=w),o}function C0(r,e,t,i){var n=He(r);t.Sheets[i]||(t.Sheets[i]={}),n.codeName&&(t.Sheets[i].CodeName=it(ut(n.codeName)))}function l3(r,e,t,i,n){C0(r.slice(0,r.indexOf(">")),t,i,n)}function c3(r,e,t){for(var i=Array.isArray(r),n=0;n!=e.length;++n){var s=He(ut(e[n]),!0);if(!s.ref)return;var a=((t||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+it(s.location))):(s.Target="#"+it(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=kt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=We({c,r:l});i?(r[l]||(r[l]=[]),r[l][c]||(r[l][c]={t:"z",v:void 0}),r[l][c].l=s):(r[f]||(r[f]={t:"z",v:void 0}),r[f].l=s)}}}function f3(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function h3(r,e){for(var t=!1,i=0;i!=e.length;++i){var n=He(e[i],!0);n.hidden&&(n.hidden=mt(n.hidden));var s=parseInt(n.min,10)-1,a=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!t&&n.width&&(t=!0,T0(n.width)),ea(n);s<=a;)r[s++]=Xt(n)}}function u3(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}var d3=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function p3(r,e){e.Views||(e.Views=[{}]),(r.match(d3)||[]).forEach(function(t,i){var n=He(t);e.Views[i]||(e.Views[i]={}),+n.zoomScale&&(e.Views[i].zoom=+n.zoomScale),mt(n.rightToLeft)&&(e.Views[i].RTL=!0)})}var m3=function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=go("v"),a=go("f");return function(l,c,f,h,u,d){for(var m=0,p="",g=[],x=[],y=0,w=0,T=0,C="",R,_,A=0,k=0,I,N,S=0,W=0,E=Array.isArray(d.CellXf),Q,ae=[],Z=[],xe=Array.isArray(c),L=[],ge={},Y=!1,O=!!f.sheetStubs,j=l.split(e),V=0,H=j.length;V!=H;++V){p=j[V].trim();var ne=p.length;if(ne!==0){var ye=0;e:for(m=0;m<ne;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(f&&f.cellStyles){if(_=He(p.slice(ye,m),!0),A=_.r!=null?parseInt(_.r,10):A+1,k=-1,f.sheetRows&&f.sheetRows<A)continue;ge={},Y=!1,_.ht&&(Y=!0,ge.hpt=parseFloat(_.ht),ge.hpx=wo(ge.hpt)),_.hidden=="1"&&(Y=!0,ge.hidden=!0),_.outlineLevel!=null&&(Y=!0,ge.level=+_.outlineLevel),Y&&(L[A-1]=ge)}break;case"<":ye=m;break}if(ye>=m)break;if(_=He(p.slice(ye,m),!0),A=_.r!=null?parseInt(_.r,10):A+1,k=-1,!(f.sheetRows&&f.sheetRows<A)){h.s.r>A-1&&(h.s.r=A-1),h.e.r<A-1&&(h.e.r=A-1),f&&f.cellStyles&&(ge={},Y=!1,_.ht&&(Y=!0,ge.hpt=parseFloat(_.ht),ge.hpx=wo(ge.hpt)),_.hidden=="1"&&(Y=!0,ge.hidden=!0),_.outlineLevel!=null&&(Y=!0,ge.level=+_.outlineLevel),Y&&(L[A-1]=ge)),g=p.slice(m).split(r);for(var de=0;de!=g.length&&g[de].trim().charAt(0)=="<";++de);for(g=g.slice(de),m=0;m!=g.length;++m)if(p=g[m].trim(),p.length!==0){if(x=p.match(t),y=m,w=0,T=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,x!=null&&x.length===2){for(y=0,C=x[1],w=0;w!=C.length&&!((T=C.charCodeAt(w)-64)<1||T>26);++w)y=26*y+T;--y,k=y}else++k;for(w=0;w!=p.length&&p.charCodeAt(w)!==62;++w);if(++w,_=He(p.slice(0,w),!0),_.r||(_.r=We({r:A-1,c:k})),C=p.slice(w),R={t:""},(x=C.match(s))!=null&&x[1]!==""&&(R.v=it(x[1])),f.cellFormula){if((x=C.match(a))!=null&&x[1]!==""){if(R.f=it(ut(x[1])).replace(/\r\n/g,`
`),f.xlfn||(R.f=Mp(R.f)),x[0].indexOf('t="array"')>-1)R.F=(C.match(n)||[])[1],R.F.indexOf(":")>-1&&ae.push([kt(R.F),R.F]);else if(x[0].indexOf('t="shared"')>-1){N=He(x[0]);var ue=it(ut(x[1]));f.xlfn||(ue=Mp(ue)),Z[parseInt(N.si,10)]=[N,ue,_.r]}}else(x=C.match(/<f[^>]*\/>/))&&(N=He(x[0]),Z[N.si]&&(R.f=EA(Z[N.si][1],Z[N.si][2],_.r)));var pe=kr(_.r);for(w=0;w<ae.length;++w)pe.r>=ae[w][0].s.r&&pe.r<=ae[w][0].e.r&&pe.c>=ae[w][0].s.c&&pe.c<=ae[w][0].e.c&&(R.F=ae[w][1])}if(_.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(O)R.t="z";else continue;else R.t=_.t||"n";switch(h.s.c>k&&(h.s.c=k),h.e.c<k&&(h.e.c=k),R.t){case"n":if(R.v==""||R.v==null){if(!O)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!O)continue;R.t="z"}else I=Ja[parseInt(R.v,10)],R.v=I.t,R.r=I.r,f.cellHTML&&(R.h=I.h);break;case"str":R.t="s",R.v=R.v!=null?ut(R.v):"",f.cellHTML&&(R.h=p0(R.v));break;case"inlineStr":x=C.match(i),R.t="s",x!=null&&(I=S0(x[1]))?(R.v=I.t,f.cellHTML&&(R.h=I.h)):R.v="";break;case"b":R.v=mt(R.v);break;case"d":f.cellDates?R.v=Wt(R.v,1):(R.v=Tr(Wt(R.v,1)),R.t="n");break;case"e":(!f||f.cellText!==!1)&&(R.w=R.v),R.v=$x[R.v];break}if(S=W=0,Q=null,E&&_.s!==void 0&&(Q=d.CellXf[_.s],Q!=null&&(Q.numFmtId!=null&&(S=Q.numFmtId),f.cellStyles&&Q.fillId!=null&&(W=Q.fillId))),_v(R,S,W,f,u,d),f.cellDates&&E&&R.t=="n"&&fa(Ke[S])&&(R.t="d",R.v=hf(R.v)),_.cm&&f.xlmeta){var be=(f.xlmeta.Cell||[])[+_.cm-1];be&&be.type=="XLDAPR"&&(R.D=!0)}if(xe){var b=kr(_.r);c[b.r]||(c[b.r]=[]),c[b.r][b.c]=R}else c[_.r]=R}}}}L.length>0&&(c["!rows"]=L)}}();function g3(r,e){var t={},i=r.l+e;t.r=r.read_shift(4),r.l+=4;var n=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=i,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=n/20),t}var x3=ys;function v3(){}function y3(r,e){var t={},i=r[r.l];return++r.l,t.above=!(i&64),t.left=!(i&128),r.l+=18,t.name=zS(r),t}function w3(r){var e=ii(r);return[e]}function k3(r){var e=vs(r);return[e]}function b3(r){var e=ii(r),t=r.read_shift(1);return[e,t,"b"]}function _3(r){var e=vs(r),t=r.read_shift(1);return[e,t,"b"]}function S3(r){var e=ii(r),t=r.read_shift(1);return[e,t,"e"]}function T3(r){var e=vs(r),t=r.read_shift(1);return[e,t,"e"]}function E3(r){var e=ii(r),t=r.read_shift(4);return[e,t,"s"]}function C3(r){var e=vs(r),t=r.read_shift(4);return[e,t,"s"]}function A3(r){var e=ii(r),t=nr(r);return[e,t,"n"]}function Tv(r){var e=vs(r),t=nr(r);return[e,t,"n"]}function O3(r){var e=ii(r),t=k0(r);return[e,t,"n"]}function F3(r){var e=vs(r),t=k0(r);return[e,t,"n"]}function D3(r){var e=ii(r),t=y0(r);return[e,t,"is"]}function R3(r){var e=ii(r),t=lr(r);return[e,t,"str"]}function M3(r){var e=vs(r),t=lr(r);return[e,t,"str"]}function I3(r,e,t){var i=r.l+e,n=ii(r);n.r=t["!row"];var s=r.read_shift(1),a=[n,s,"b"];if(t.cellFormula){r.l+=2;var o=pf(r,i-r.l,t);a[3]=er(o,null,n,t.supbooks,t)}else r.l=i;return a}function P3(r,e,t){var i=r.l+e,n=ii(r);n.r=t["!row"];var s=r.read_shift(1),a=[n,s,"e"];if(t.cellFormula){r.l+=2;var o=pf(r,i-r.l,t);a[3]=er(o,null,n,t.supbooks,t)}else r.l=i;return a}function L3(r,e,t){var i=r.l+e,n=ii(r);n.r=t["!row"];var s=nr(r),a=[n,s,"n"];if(t.cellFormula){r.l+=2;var o=pf(r,i-r.l,t);a[3]=er(o,null,n,t.supbooks,t)}else r.l=i;return a}function B3(r,e,t){var i=r.l+e,n=ii(r);n.r=t["!row"];var s=lr(r),a=[n,s,"str"];if(t.cellFormula){r.l+=2;var o=pf(r,i-r.l,t);a[3]=er(o,null,n,t.supbooks,t)}else r.l=i;return a}var N3=ys;function U3(r,e){var t=r.l+e,i=ys(r),n=w0(r),s=lr(r),a=lr(r),o=lr(r);r.l=t;var l={rfx:i,relId:n,loc:s,display:o};return a&&(l.Tooltip=a),l}function H3(){}function z3(r,e,t){var i=r.l+e,n=Wx(r),s=r.read_shift(1),a=[n];if(a[2]=s,t.cellFormula){var o=G4(r,i-r.l,t);a[1]=o}else r.l=i;return a}function W3(r,e,t){var i=r.l+e,n=ys(r),s=[n];if(t.cellFormula){var a=X4(r,i-r.l,t);s[1]=a,r.l=i}else r.l=i;return s}var V3=["left","right","top","bottom","header","footer"];function j3(r){var e={};return V3.forEach(function(t){e[t]=nr(r)}),e}function $3(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function G3(){}function K3(){}function X3(r,e,t,i,n,s,a){if(!r)return r;var o=e||{};i||(i={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,u=!1,d,m,p,g,x,y,w,T,C,R=[];o.biff=12,o["!row"]=0;var _=0,A=!1,k=[],I={},N=o.supbooks||n.supbooks||[[]];if(N.sharedf=I,N.arrayf=k,N.SheetNames=n.SheetNames||n.Sheets.map(function(xe){return xe.name}),!o.supbooks&&(o.supbooks=N,n.Names))for(var S=0;S<n.Names.length;++S)N[0][S+1]=n.Names[S];var W=[],E=[],Q=!1;Tc[16]={n:"BrtShortReal",f:Tv};var ae;if(fn(r,function(L,ge,Y){if(!u)switch(Y){case 148:c=L;break;case 0:d=L,o.sheetRows&&o.sheetRows<=d.r&&(u=!0),T=qt(g=d.r),o["!row"]=d.r,(L.hidden||L.hpt||L.level!=null)&&(L.hpt&&(L.hpx=wo(L.hpt)),E[L.r]=L);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:L[2]},L[2]){case"n":m.v=L[1];break;case"s":w=Ja[L[1]],m.v=w.t,m.r=w.r;break;case"b":m.v=!!L[1];break;case"e":m.v=L[1],o.cellText!==!1&&(m.w=ws[m.v]);break;case"str":m.t="s",m.v=L[1];break;case"is":m.t="s",m.v=L[1].t;break}if((p=a.CellXf[L[0].iStyleRef])&&_v(m,p.numFmtId,null,o,s,a),x=L[0].c==-1?x+1:L[0].c,o.dense?(l[g]||(l[g]=[]),l[g][x]=m):l[Pt(x)+T]=m,o.cellFormula){for(A=!1,_=0;_<k.length;++_){var O=k[_];d.r>=O[0].s.r&&d.r<=O[0].e.r&&x>=O[0].s.c&&x<=O[0].e.c&&(m.F=et(O[0]),A=!0)}!A&&L.length>3&&(m.f=L[3])}if(f.s.r>d.r&&(f.s.r=d.r),f.s.c>x&&(f.s.c=x),f.e.r<d.r&&(f.e.r=d.r),f.e.c<x&&(f.e.c=x),o.cellDates&&p&&m.t=="n"&&fa(Ke[p.numFmtId])){var j=Qn(m.v);j&&(m.t="d",m.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;m={t:"z",v:void 0},x=L[0].c==-1?x+1:L[0].c,o.dense?(l[g]||(l[g]=[]),l[g][x]=m):l[Pt(x)+T]=m,f.s.r>d.r&&(f.s.r=d.r),f.s.c>x&&(f.s.c=x),f.e.r<d.r&&(f.e.r=d.r),f.e.c<x&&(f.e.c=x),ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 176:R.push(L);break;case 49:ae=((o.xlmeta||{}).Cell||[])[L-1];break;case 494:var V=i["!id"][L.relId];for(V?(L.Target=V.Target,L.loc&&(L.Target+="#"+L.loc),L.Rel=V):L.relId==""&&(L.Target="#"+L.loc),g=L.rfx.s.r;g<=L.rfx.e.r;++g)for(x=L.rfx.s.c;x<=L.rfx.e.c;++x)o.dense?(l[g]||(l[g]=[]),l[g][x]||(l[g][x]={t:"z",v:void 0}),l[g][x].l=L):(y=We({c:x,r:g}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=L);break;case 426:if(!o.cellFormula)break;k.push(L),C=o.dense?l[g][x]:l[Pt(x)+T],C.f=er(L[1],f,{r:d.r,c:x},N,o),C.F=et(L[0]);break;case 427:if(!o.cellFormula)break;I[We(L[0].s)]=L[1],C=o.dense?l[g][x]:l[Pt(x)+T],C.f=er(L[1],f,{r:d.r,c:x},N,o);break;case 60:if(!o.cellStyles)break;for(;L.e>=L.s;)W[L.e--]={width:L.w/256,hidden:!!(L.flags&1),level:L.level},Q||(Q=!0,T0(L.w/256)),ea(W[L.e+1]);break;case 161:l["!autofilter"]={ref:et(L)};break;case 476:l["!margins"]=L;break;case 147:n.Sheets[t]||(n.Sheets[t]={}),L.name&&(n.Sheets[t].CodeName=L.name),(L.above||L.left)&&(l["!outline"]={above:L.above,left:L.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),L.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ge.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=et(c||f)),o.sheetRows&&l["!ref"]){var Z=kt(l["!ref"]);o.sheetRows<=+Z.e.r&&(Z.e.r=o.sheetRows-1,Z.e.r>f.e.r&&(Z.e.r=f.e.r),Z.e.r<Z.s.r&&(Z.s.r=Z.e.r),Z.e.c>f.e.c&&(Z.e.c=f.e.c),Z.e.c<Z.s.c&&(Z.s.c=Z.e.c),l["!fullref"]=l["!ref"],l["!ref"]=et(Z))}return R.length>0&&(l["!merges"]=R),W.length>0&&(l["!cols"]=W),E.length>0&&(l["!rows"]=E),l}function q3(r){var e=[],t=r.match(/^<c:numCache>/),i;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=t?+a[2]:a[2])});var n=it((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){i=s.replace(/<.*?>/g,"")}),[e,n,i]}function Y3(r,e,t,i,n,s){var a=s||{"!type":"chart"};if(!r)return s;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var u=q3(h);f.s.r=f.s.c=0,f.e.c=o,c=Pt(o),u[0].forEach(function(d,m){a[c+qt(m)]={t:"n",v:d,z:u[1]},l=m}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(a["!ref"]=et(f)),a}function J3(r,e,t,i,n){if(!r)return r;i||(i={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=r.match(Sv);return o&&C0(o[0],s,n,t),(a=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),i["!id"][s["!rel"]]&&(s["!drawel"]=i["!id"][s["!rel"]]),s}function Z3(r,e){r.l+=10;var t=lr(r);return{name:t}}function Q3(r,e,t,i,n){if(!r)return r;i||(i={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return fn(r,function(l,c,f){switch(f){case 550:s["!rel"]=l;break;case 651:n.Sheets[t]||(n.Sheets[t]={}),l.name&&(n.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),i["!id"][s["!rel"]]&&(s["!drawel"]=i["!id"][s["!rel"]]),s}var Ev=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eO=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tO=[],rO=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Np(r,e){for(var t=0;t!=r.length;++t)for(var i=r[t],n=0;n!=e.length;++n){var s=e[n];if(i[s[0]]==null)i[s[0]]=s[1];else switch(s[2]){case"bool":typeof i[s[0]]=="string"&&(i[s[0]]=mt(i[s[0]]));break;case"int":typeof i[s[0]]=="string"&&(i[s[0]]=parseInt(i[s[0]],10));break}}}function Up(r,e){for(var t=0;t!=e.length;++t){var i=e[t];if(r[i[0]]==null)r[i[0]]=i[1];else switch(i[2]){case"bool":typeof r[i[0]]=="string"&&(r[i[0]]=mt(r[i[0]]));break;case"int":typeof r[i[0]]=="string"&&(r[i[0]]=parseInt(r[i[0]],10));break}}}function Cv(r){Up(r.WBProps,Ev),Up(r.CalcPr,rO),Np(r.WBView,eO),Np(r.Sheets,tO),js.date1904=mt(r.WBProps.date1904)}var iO="][*?/\\".split("");function nO(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return iO.forEach(function(i){if(r.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var sO=/<\w+:workbook/;function aO(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,n="xmlns",s={},a=0;if(r.replace(ur,function(l,c){var f=He(l);switch(Hi(f[0])){case"<?xml":break;case"<workbook":l.match(sO)&&(n="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=f[n];break;case"</workbook>":break;case"<fileVersion":delete f[0],t.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ev.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":t.WBProps[h[0]]=mt(f[h[0]]);break;case"int":t.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:t.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(t.WBProps.CodeName=ut(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],t.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=it(ut(f.name)),delete f[0],t.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":s={},s.Name=ut(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),mt(f.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=it(ut(r.slice(a,c))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],t.CalcPr=f;break;case"<calcPr/>":delete f[0],t.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),SS.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Cv(t),t}function oO(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=Bh(r),t.name=lr(r),t}function lO(r,e){var t={},i=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var n=e>8?lr(r):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function cO(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function fO(r,e,t){var i=r.l+e;r.l+=4,r.l+=1;var n=r.read_shift(4),s=WS(r),a=K4(r,0,t),o=w0(r);r.l=i;var l={Name:s,Ptg:a};return n<268435455&&(l.Sheet=n),o&&(l.Comment=o),l}function hO(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],n=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Tc[16]={n:"BrtFRTArchID$",f:cO},fn(r,function(l,c,f){switch(f){case 156:a.SheetNames.push(l.name),t.Sheets.push(l);break;case 153:t.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=er(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(f),n=!0;break;case 36:i.pop(),n=!1;break;case 37:i.push(f),n=!0;break;case 38:i.pop(),n=!1;break;case 16:break;default:if(!c.T){if(!n||e.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),Cv(t),t.Names=s,t.supbooks=a,t}function uO(r,e,t){return e.slice(-4)===".bin"?hO(r,t):aO(r,t)}function dO(r,e,t,i,n,s,a,o){return e.slice(-4)===".bin"?X3(r,i,t,n,s,a,o):o3(r,i,t,n,s,a,o)}function pO(r,e,t,i,n,s,a,o){return e.slice(-4)===".bin"?Q3(r,i,t,n,s):J3(r,i,t,n,s)}function mO(r,e,t,i,n,s,a,o){return e.slice(-4)===".bin"?_A():SA()}function gO(r,e,t,i,n,s,a,o){return e.slice(-4)===".bin"?kA():bA()}function xO(r,e,t,i){return e.slice(-4)===".bin"?NC(r,t,i):RC(r,t,i)}function vO(r,e,t){return dv(r,t)}function yO(r,e,t){return e.slice(-4)===".bin"?eC(r,t):ZE(r,t)}function wO(r,e,t){return e.slice(-4)===".bin"?vA(r,t):dA(r,t)}function kO(r,e,t){return e.slice(-4)===".bin"?fA(r):lA(r)}function bO(r,e,t,i){return t.slice(-4)===".bin"?hA(r,e,t,i):void 0}function _O(r,e,t){return e.slice(-4)===".bin"?aA(r,e,t):oA(r,e,t)}var Av=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ov=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function si(r,e){var t=r.split(/\s+/),i=[];if(i[0]=t[0],t.length===1)return i;var n=r.match(Av),s,a,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(Ov),(a=s[1].indexOf(":"))===-1?i[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),i[o]=s[2].slice(1,s[2].length-1));return i}function SO(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var i=r.match(Av),n,s,a,o;if(i)for(o=0;o!=i.length;++o)n=i[o].match(Ov),(s=n[1].indexOf(":"))===-1?t[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?a="xmlns"+n[1].slice(6):a=n[1].slice(s+1),t[a]=n[2].slice(1,n[2].length-1));return t}var Qa;function TO(r,e){var t=Qa[r]||it(r);return t==="General"?os(e):ti(t,e)}function EO(r,e,t,i){var n=i;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=mt(i);break;case"i2":case"int":n=parseInt(i,10);break;case"r4":case"float":n=parseFloat(i);break;case"date":case"dateTime.tz":n=Wt(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[it(e)]=n}function CO(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||ws[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=mo(r.v):r.w=os(r.v):r.w=TO(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var i=Qa[e]||e||"General";if(t.cellNF&&(r.z=i),t.cellDates&&r.t=="n"&&fa(i)){var n=Qn(r.v);n&&(r.t="d",r.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(t.WTF)throw s}}}function AO(r,e,t){if(t.cellStyles&&e.Interior){var i=e.Interior;i.Pattern&&(i.patternType=EC[i.Pattern]||i.Pattern)}r[e.ID]=e}function OO(r,e,t,i,n,s,a,o,l,c){var f="General",h=i.StyleID,u={};c=c||{};var d=[],m=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(f=s[h].nf),s[h].Interior&&d.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(t.Type){case"Boolean":i.t="b",i.v=mt(r);break;case"String":i.t="s",i.r=op(it(r)),i.v=r.indexOf("<")>-1?it(e||r).replace(/<.*?>/g,""):i.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),i.v=(Wt(r)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),i.v!==i.v?i.v=it(r):i.v<60&&(i.v=i.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+r),i.t||(i.t="n");break;case"Error":i.t="e",i.v=$x[r],c.cellText!==!1&&(i.w=r);break;default:r==""&&e==""?i.t="z":(i.t="s",i.v=op(e||r));break}if(CO(i,f,c),c.cellFormula!==!1)if(i.Formula){var p=it(i.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),i.f=Vs(p,n),delete i.Formula,i.ArrayRange=="RC"?i.F=Vs("RC:RC",n):i.ArrayRange&&(i.F=Vs(i.ArrayRange,n),l.push([kt(i.F),i.F]))}else for(m=0;m<l.length;++m)n.r>=l[m][0].s.r&&n.r<=l[m][0].e.r&&n.c>=l[m][0].s.c&&n.c<=l[m][0].e.c&&(i.F=l[m][1]);c.cellStyles&&(d.forEach(function(g){!u.patternType&&g.patternType&&(u.patternType=g.patternType)}),i.s=u),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function FO(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function Kf(r,e){var t=e||{};xx();var i=Aa(m0(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(i=ut(i));var n=i.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var a=Xt(t);return a.type="string",vo.to_workbook(i,a)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(D){n.indexOf("<"+D)>=0&&(s=!0)}),s)return UO(i,t);Qa={"General Number":"General","General Date":Ke[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ke[15],"Short Date":Ke[14],"Long Time":Ke[19],"Medium Time":Ke[18],"Short Time":Ke[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ke[2],Standard:Ke[4],Percent:Ke[10],Scientific:Ke[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},h=[],u=t.dense?[]:{},d="",m={},p={},g=si('<Data ss:Type="String">'),x=0,y=0,w=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},R={},_="",A=0,k=[],I={},N={},S=0,W=[],E=[],Q={},ae=[],Z,xe=!1,L=[],ge=[],Y={},O=0,j=0,V={Sheets:[],WBProps:{date1904:!1}},H={};xo.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";o=xo.exec(i);)switch(o[3]=(ne=o[3]).toLowerCase()){case"data":if(ne=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?OO(i.slice(x,o.index),_,g,l[l.length-1][0]=="comment"?Q:m,{c:y,r:w},C,ae[y],p,L,t):(_="",g=si(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(E.length>0&&(m.c=E),(!t.sheetRows||t.sheetRows>w)&&m.v!==void 0&&(t.dense?(u[w]||(u[w]=[]),u[w][y]=m):u[Pt(y)+qt(w)]=m),m.HRef&&(m.l={Target:it(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(O=y+(parseInt(m.MergeAcross,10)|0),j=w+(parseInt(m.MergeDown,10)|0),k.push({s:{c:y,r:w},e:{c:O,r:j}})),!t.sheetStubs)m.MergeAcross?y=O+1:++y;else if(m.MergeAcross||m.MergeDown){for(var ye=y;ye<=O;++ye)for(var de=w;de<=j;++de)(ye>y||de>w)&&(t.dense?(u[de]||(u[de]=[]),u[de][ye]={t:"z"}):u[Pt(ye)+qt(de)]={t:"z"});y=O+1}else++y;else m=SO(o[0]),m.Index&&(y=+m.Index-1),y<T.s.c&&(T.s.c=y),y>T.e.c&&(T.e.c=y),o[0].slice(-2)==="/>"&&++y,E=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<T.s.r&&(T.s.r=w),w>T.e.r&&(T.e.r=w),o[0].slice(-2)==="/>"&&(p=si(o[0]),p.Index&&(w=+p.Index-1)),y=0,++w):(p=si(o[0]),p.Index&&(w=+p.Index-1),Y={},(p.AutoFitHeight=="0"||p.Height)&&(Y.hpx=parseInt(p.Height,10),Y.hpt=uv(Y.hpx),ge[w]=Y),p.Hidden=="1"&&(Y.hidden=!0,ge[w]=Y));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(d),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(u["!ref"]=et(T),t.sheetRows&&t.sheetRows<=T.e.r&&(u["!fullref"]=u["!ref"],T.e.r=t.sheetRows-1,u["!ref"]=et(T))),k.length&&(u["!merges"]=k),ae.length>0&&(u["!cols"]=ae),ge.length>0&&(u["!rows"]=ge),f[d]=u}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=y=0,l.push([o[3],!1]),c=si(o[0]),d=it(c.Name),u=t.dense?[]:{},k=[],L=[],ge=[],H={name:d,Hidden:0},V.Sheets.push(H);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ae=[],xe=!1}break;case"style":o[1]==="/"?AO(C,R,t):R=si(o[0]);break;case"numberformat":R.nf=it(si(o[0]).Format||"General"),Qa[R.nf]&&(R.nf=Qa[R.nf]);for(var ue=0;ue!=392&&Ke[ue]!=R.nf;++ue);if(ue==392){for(ue=57;ue!=392;++ue)if(Ke[ue]==null){is(R.nf,ue);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Z=si(o[0]),Z.Hidden&&(Z.hidden=!0,delete Z.Hidden),Z.Width&&(Z.wpx=parseInt(Z.Width,10)),!xe&&Z.wpx>10){xe=!0,xr=fv;for(var pe=0;pe<ae.length;++pe)ae[pe]&&ea(ae[pe])}xe&&ea(Z),ae[Z.Index-1||ae.length]=Z;for(var be=0;be<+Z.Span;++be)ae[ae.length]=Xt(Z);break;case"namedrange":if(o[1]==="/")break;V.Names||(V.Names=[]);var b=He(o[0]),J={Name:b.Name,Ref:Vs(b.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(J.Sheet=V.Sheets.length-1),V.Names.push(J);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?_+=i.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;R.Interior=si(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?dT(I,ne,i.slice(S,o.index)):S=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));FO(Q),E.push(Q)}else l.push([o[3],!1]),c=si(o[0]),Q={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var v=si(o[0]);u["!autofilter"]={ref:Vs(v.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return $p(i,t);var K=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:K=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:K=!1}break;case"excelworkbook":switch(o[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:K=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:K=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(i.slice(S,o.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else S=o.index+o[0].length;break;case"header":u["!margins"]||Za(u["!margins"]={},"xlml"),isNaN(+He(o[0]).Margin)||(u["!margins"].header=+He(o[0]).Margin);break;case"footer":u["!margins"]||Za(u["!margins"]={},"xlml"),isNaN(+He(o[0]).Margin)||(u["!margins"].footer=+He(o[0]).Margin);break;case"pagemargins":var P=He(o[0]);u["!margins"]||Za(u["!margins"]={},"xlml"),isNaN(+P.Top)||(u["!margins"].top=+P.Top),isNaN(+P.Left)||(u["!margins"].left=+P.Left),isNaN(+P.Right)||(u["!margins"].right=+P.Right),isNaN(+P.Bottom)||(u["!margins"].bottom=+P.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:K=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:K=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:K=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:K=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:K=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:K=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:K=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:K=!1}break;case"smarttags":break;default:K=!1;break}if(K||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?EO(N,ne,W,i.slice(S,o.index)):(W=o,S=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var F={};return!t.bookSheets&&!t.bookProps&&(F.Sheets=f),F.SheetNames=h,F.Workbook=V,F.SSF=Xt(Ke),F.Props=I,F.Custprops=N,F}function zh(r,e){switch(F0(e=e||{}),e.type||"base64"){case"base64":return Kf(jr(r),e);case"binary":case"buffer":case"file":return Kf(r,e);case"array":return Kf(xs(r),e)}}function DO(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=$S(t),t.length-t.l<=4)return e;var i=t.read_shift(4);if(i==0||i>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(i=t.read_shift(4),i!==1907505652)||(e.UnicodeClipboardFormat=GS(t),i=t.read_shift(4),i==0||i>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var RO=[60,1084,2066,2165,2175];function MO(r,e,t,i,n){var s=i,a=[],o=t.slice(t.l,t.l+s);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}a.push(o),t.l+=s;for(var l=Ji(t,t.l),c=Wh[l],f=0;c!=null&&RO.indexOf(l)>-1;)s=Ji(t,t.l+2),f=t.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=t.slice(f,t.l+4+s),a.push(o),t.l+=4+s,c=Wh[l=Ji(t,t.l)];var h=yn(a);jt(h,0);var u=0;h.lens=[];for(var d=0;d<a.length;++d)h.lens.push(u),u+=a[d].length;if(h.length<i)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+h.length+" < "+i;return e.f(h,h.length,n)}function yi(r,e,t){if(r.t!=="z"&&r.XF){var i=0;try{i=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=Ke[i])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||ws[r.v]:i===0||i=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=mo(r.v):r.w=os(r.v):r.w=ti(i,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&i&&r.t=="n"&&fa(Ke[i]||String(i))){var n=Qn(r.v);n&&(r.t="d",r.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function vl(r,e,t){return{v:r,ixfe:e,t}}function IO(r,e){var t={opts:{}},i={},n=e.dense?[]:{},s={},a={},o=null,l=[],c="",f={},h,u="",d,m,p,g,x={},y=[],w,T,C=[],R=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},k=function(Ie){return Ie<8?ns[Ie]:Ie<64&&R[Ie-8]||ns[Ie]},I=function(Ie,Ne,qe){var Le=Ne.XF.data;if(!(!Le||!Le.patternType||!qe||!qe.cellStyles)){Ne.s={},Ne.s.patternType=Le.patternType;var Nt;(Nt=yo(k(Le.icvFore)))&&(Ne.s.fgColor={rgb:Nt}),(Nt=yo(k(Le.icvBack)))&&(Ne.s.bgColor={rgb:Nt})}},N=function(Ie,Ne,qe){if(!(Y>1)&&!(qe.sheetRows&&Ie.r>=qe.sheetRows)){if(qe.cellStyles&&Ne.XF&&Ne.XF.data&&I(Ie,Ne,qe),delete Ne.ixfe,delete Ne.XF,h=Ie,u=We(Ie),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ie.r<a.s.r&&(a.s.r=Ie.r),Ie.c<a.s.c&&(a.s.c=Ie.c),Ie.r+1>a.e.r&&(a.e.r=Ie.r+1),Ie.c+1>a.e.c&&(a.e.c=Ie.c+1),qe.cellFormula&&Ne.f){for(var Le=0;Le<y.length;++Le)if(!(y[Le][0].s.c>Ie.c||y[Le][0].s.r>Ie.r)&&!(y[Le][0].e.c<Ie.c||y[Le][0].e.r<Ie.r)){Ne.F=et(y[Le][0]),(y[Le][0].s.c!=Ie.c||y[Le][0].s.r!=Ie.r)&&delete Ne.f,Ne.f&&(Ne.f=""+er(y[Le][1],a,Ie,L,S));break}}qe.dense?(n[Ie.r]||(n[Ie.r]=[]),n[Ie.r][Ie.c]=Ne):n[u]=Ne}},S={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(S.password=e.password);var W,E=[],Q=[],ae=[],Z=[],xe=!1,L=[];L.SheetNames=S.snames,L.sharedf=S.sharedf,L.arrayf=S.arrayf,L.names=[],L.XTI=[];var ge=0,Y=0,O=0,j=[],V=[],H;S.codepage=1200,ci(1200);for(var ne=!1;r.l<r.length-1;){var ye=r.l,de=r.read_shift(2);if(de===0&&ge===10)break;var ue=r.l===r.length?0:r.read_shift(2),pe=Wh[de];if(pe&&pe.f){if(e.bookSheets&&ge===133&&de!==133)break;if(ge=de,pe.r===2||pe.r==12){var be=r.read_shift(2);if(ue-=2,!S.enc&&be!==de&&((be&255)<<8|be>>8)!==de)throw new Error("rt mismatch: "+be+"!="+de);pe.r==12&&(r.l+=10,ue-=10)}var b={};if(de===10?b=pe.f(r,ue,S):b=MO(de,pe,r,ue,S),Y==0&&[9,521,1033,2057].indexOf(ge)===-1)continue;switch(de){case 34:t.opts.Date1904=_.WBProps.date1904=b;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(S.enc||(r.l=0),S.enc=b,!e.password)throw new Error("File is password-protected");if(b.valid==null)throw new Error("Encryption scheme unsupported");if(!b.valid)throw new Error("Password is incorrect");break;case 92:S.lastuser=b;break;case 66:var J=Number(b);switch(J){case 21010:J=1200;break;case 32768:J=1e4;break;case 32769:J=1252;break}ci(S.codepage=J),ne=!0;break;case 317:S.rrtabid=b;break;case 25:S.winlocked=b;break;case 439:t.opts.RefreshAll=b;break;case 12:t.opts.CalcCount=b;break;case 16:t.opts.CalcDelta=b;break;case 17:t.opts.CalcIter=b;break;case 13:t.opts.CalcMode=b;break;case 14:t.opts.CalcPrecision=b;break;case 95:t.opts.CalcSaveRecalc=b;break;case 15:S.CalcRefMode=b;break;case 2211:t.opts.FullCalc=b;break;case 129:b.fDialog&&(n["!type"]="dialog"),b.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),b.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:C.push(b);break;case 430:L.push([b]),L[L.length-1].XTI=[];break;case 35:case 547:L[L.length-1].push(b);break;case 24:case 536:H={Name:b.Name,Ref:er(b.rgce,a,null,L,S)},b.itab>0&&(H.Sheet=b.itab-1),L.names.push(H),L[0]||(L[0]=[],L[0].XTI=[]),L[L.length-1].push(b),b.Name=="_xlnm._FilterDatabase"&&b.itab>0&&b.rgce&&b.rgce[0]&&b.rgce[0][0]&&b.rgce[0][0][0]=="PtgArea3d"&&(V[b.itab-1]={ref:et(b.rgce[0][0][1][2])});break;case 22:S.ExternCount=b;break;case 23:L.length==0&&(L[0]=[],L[0].XTI=[]),L[L.length-1].XTI=L[L.length-1].XTI.concat(b),L.XTI=L.XTI.concat(b);break;case 2196:if(S.biff<8)break;H!=null&&(H.Comment=b[1]);break;case 18:n["!protect"]=b;break;case 19:b!==0&&S.WTF&&console.error("Password verifier: "+b);break;case 133:s[b.pos]=b,S.snames.push(b.name);break;case 10:{if(--Y)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,n["!ref"]=et(a),e.sheetRows&&e.sheetRows<=a.e.r){var v=a.e.r;a.e.r=e.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=et(a),a.e.r=v}a.e.r++,a.e.c++}E.length>0&&(n["!merges"]=E),Q.length>0&&(n["!objects"]=Q),ae.length>0&&(n["!cols"]=ae),Z.length>0&&(n["!rows"]=Z),_.Sheets.push(A)}c===""?f=n:i[c]=n,n=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(S.biff===8&&(S.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[b.BIFFVer]||8),S.biffguess=b.BIFFVer==0,b.BIFFVer==0&&b.dt==4096&&(S.biff=5,ne=!0,ci(S.codepage=28591)),S.biff==8&&b.BIFFVer==0&&b.dt==16&&(S.biff=2),Y++)break;if(n=e.dense?[]:{},S.biff<8&&!ne&&(ne=!0,ci(S.codepage=e.codepage||1252)),S.biff<5||b.BIFFVer==0&&b.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var K={pos:r.l-ue,name:c};s[K.pos]=K,S.snames.push(c)}else c=(s[ye]||{name:""}).name;b.dt==32&&(n["!type"]="chart"),b.dt==64&&(n["!type"]="macro"),E=[],Q=[],S.arrayf=y=[],ae=[],Z=[],xe=!1,A={Hidden:(s[ye]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(e.dense?(n[b.r]||[])[b.c]:n[We({c:b.c,r:b.r})])&&++b.c,w={ixfe:b.ixfe,XF:C[b.ixfe]||{},v:b.val,t:"n"},O>0&&(w.z=j[w.ixfe>>8&63]),yi(w,e,t.opts.Date1904),N({c:b.c,r:b.r},w,e);break;case 5:case 517:w={ixfe:b.ixfe,XF:C[b.ixfe],v:b.val,t:b.t},O>0&&(w.z=j[w.ixfe>>8&63]),yi(w,e,t.opts.Date1904),N({c:b.c,r:b.r},w,e);break;case 638:w={ixfe:b.ixfe,XF:C[b.ixfe],v:b.rknum,t:"n"},O>0&&(w.z=j[w.ixfe>>8&63]),yi(w,e,t.opts.Date1904),N({c:b.c,r:b.r},w,e);break;case 189:for(var P=b.c;P<=b.C;++P){var F=b.rkrec[P-b.c][0];w={ixfe:F,XF:C[F],v:b.rkrec[P-b.c][1],t:"n"},O>0&&(w.z=j[w.ixfe>>8&63]),yi(w,e,t.opts.Date1904),N({c:P,r:b.r},w,e)}break;case 6:case 518:case 1030:{if(b.val=="String"){o=b;break}if(w=vl(b.val,b.cell.ixfe,b.tt),w.XF=C[w.ixfe],e.cellFormula){var D=b.formula;if(D&&D[0]&&D[0][0]&&D[0][0][0]=="PtgExp"){var U=D[0][0][1][0],te=D[0][0][1][1],re=We({r:U,c:te});x[re]?w.f=""+er(b.formula,a,b.cell,L,S):w.F=((e.dense?(n[U]||[])[te]:n[re])||{}).F}else w.f=""+er(b.formula,a,b.cell,L,S)}O>0&&(w.z=j[w.ixfe>>8&63]),yi(w,e,t.opts.Date1904),N(b.cell,w,e),o=b}break;case 7:case 519:if(o)o.val=b,w=vl(b,o.cell.ixfe,"s"),w.XF=C[w.ixfe],e.cellFormula&&(w.f=""+er(o.formula,a,o.cell,L,S)),O>0&&(w.z=j[w.ixfe>>8&63]),yi(w,e,t.opts.Date1904),N(o.cell,w,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(b);var ee=We(b[0].s);if(d=e.dense?(n[b[0].s.r]||[])[b[0].s.c]:n[ee],e.cellFormula&&d){if(!o||!ee||!d)break;d.f=""+er(b[1],a,b[0],L,S),d.F=et(b[0])}}break;case 1212:{if(!e.cellFormula)break;if(u){if(!o)break;x[We(o.cell)]=b[0],d=e.dense?(n[o.cell.r]||[])[o.cell.c]:n[We(o.cell)],(d||{}).f=""+er(b[0],a,h,L,S)}}break;case 253:w=vl(l[b.isst].t,b.ixfe,"s"),l[b.isst].h&&(w.h=l[b.isst].h),w.XF=C[w.ixfe],O>0&&(w.z=j[w.ixfe>>8&63]),yi(w,e,t.opts.Date1904),N({c:b.c,r:b.r},w,e);break;case 513:e.sheetStubs&&(w={ixfe:b.ixfe,XF:C[b.ixfe],t:"z"},O>0&&(w.z=j[w.ixfe>>8&63]),yi(w,e,t.opts.Date1904),N({c:b.c,r:b.r},w,e));break;case 190:if(e.sheetStubs)for(var ie=b.c;ie<=b.C;++ie){var le=b.ixfe[ie-b.c];w={ixfe:le,XF:C[le],t:"z"},O>0&&(w.z=j[w.ixfe>>8&63]),yi(w,e,t.opts.Date1904),N({c:ie,r:b.r},w,e)}break;case 214:case 516:case 4:w=vl(b.val,b.ixfe,"s"),w.XF=C[w.ixfe],O>0&&(w.z=j[w.ixfe>>8&63]),yi(w,e,t.opts.Date1904),N({c:b.c,r:b.r},w,e);break;case 0:case 512:Y===1&&(a=b);break;case 252:l=b;break;case 1054:if(S.biff==4){j[O++]=b[1];for(var ce=0;ce<O+163&&Ke[ce]!=b[1];++ce);ce>=163&&is(b[1],O+163)}else is(b[1],b[0]);break;case 30:{j[O++]=b;for(var we=0;we<O+163&&Ke[we]!=b;++we);we>=163&&is(b,O+163)}break;case 229:E=E.concat(b);break;case 93:Q[b.cmo[0]]=S.lastobj=b;break;case 438:S.lastobj.TxO=b;break;case 127:S.lastobj.ImData=b;break;case 440:for(g=b[0].s.r;g<=b[0].e.r;++g)for(p=b[0].s.c;p<=b[0].e.c;++p)d=e.dense?(n[g]||[])[p]:n[We({c:p,r:g})],d&&(d.l=b[1]);break;case 2048:for(g=b[0].s.r;g<=b[0].e.r;++g)for(p=b[0].s.c;p<=b[0].e.c;++p)d=e.dense?(n[g]||[])[p]:n[We({c:p,r:g})],d&&d.l&&(d.l.Tooltip=b[1]);break;case 28:{if(S.biff<=5&&S.biff>=2)break;d=e.dense?(n[b[0].r]||[])[b[0].c]:n[We(b[0])];var Ae=Q[b[2]];d||(e.dense?(n[b[0].r]||(n[b[0].r]=[]),d=n[b[0].r][b[0].c]={t:"z"}):d=n[We(b[0])]={t:"z"},a.e.r=Math.max(a.e.r,b[0].r),a.s.r=Math.min(a.s.r,b[0].r),a.e.c=Math.max(a.e.c,b[0].c),a.s.c=Math.min(a.s.c,b[0].c)),d.c||(d.c=[]),m={a:b[1],t:Ae.TxO.t},d.c.push(m)}break;case 2173:rA(C[b.ixfe],b.ext);break;case 125:{if(!S.cellStyles)break;for(;b.e>=b.s;)ae[b.e--]={width:b.w/256,level:b.level||0,hidden:!!(b.flags&1)},xe||(xe=!0,T0(b.w/256)),ea(ae[b.e+1])}break;case 520:{var Se={};b.level!=null&&(Z[b.r]=Se,Se.level=b.level),b.hidden&&(Z[b.r]=Se,Se.hidden=!0),b.hpt&&(Z[b.r]=Se,Se.hpt=b.hpt,Se.hpx=wo(b.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Za(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=b;break;case 161:n["!margins"]||Za(n["!margins"]={}),n["!margins"].header=b.header,n["!margins"].footer=b.footer;break;case 574:b.RTL&&(_.Views[0].RTL=!0);break;case 146:R=b;break;case 2198:W=b;break;case 140:T=b;break;case 442:c?A.CodeName=b||A.name:_.WBProps.CodeName=b||"ThisWorkbook";break}}else pe||console.error("Missing Info for XLS Record 0x"+de.toString(16)),r.l+=ue}return t.SheetNames=Ni(s).sort(function($e,Ie){return Number($e)-Number(Ie)}).map(function($e){return s[$e].name}),e.bookSheets||(t.Sheets=i),!t.SheetNames.length&&f["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=f)):t.Preamble=f,t.Sheets&&V.forEach(function($e,Ie){t.Sheets[t.SheetNames[Ie]]["!autofilter"]=$e}),t.Strings=l,t.SSF=Xt(Ke),S.enc&&(t.Encryption=S.enc),W&&(t.Themes=W),t.Metadata={},T!==void 0&&(t.Metadata.Country=T),L.names.length>0&&(_.Names=L.names),t.Workbook=_,t}var Hp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function PO(r,e,t){var i=Qe.find(r,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var n=_p(i,ZS,Hp.DSI);for(var s in n)e[s]=n[s]}catch(c){if(t.WTF)throw c}var a=Qe.find(r,"/!SummaryInformation");if(a&&a.size>0)try{var o=_p(a,QS,Hp.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(t.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(Kx(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function Fv(r,e){e||(e={}),F0(e),sx(),e.codepage&&l0(e.codepage);var t,i;if(r.FullPaths){if(Qe.find(r,"/encryption"))throw new Error("File is password-protected");t=Qe.find(r,"!CompObj"),i=Qe.find(r,"/Workbook")||Qe.find(r,"/Book")}else{switch(e.type){case"base64":r=li(jr(r));break;case"binary":r=li(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}jt(r,0),i={content:r}}var n,s;if(t&&DO(t),e.bookProps&&!e.bookSheets)n={};else{var a=Ze?"buffer":"array";if(i&&i.content)n=IO(i.content,e);else if((s=Qe.find(r,"PerfectOffice_MAIN"))&&s.content)n=Ya.to_workbook(s.content,(e.type=a,e));else if((s=Qe.find(r,"NativeContent_MAIN"))&&s.content)n=Ya.to_workbook(s.content,(e.type=a,e));else throw(s=Qe.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&Qe.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=wA(r))}var o={};return r.FullPaths&&PO(r,o,e),n.Props=n.Custprops=o,e.bookFiles&&(n.cfb=r),n}var Tc={0:{f:g3},1:{f:w3},2:{f:O3},3:{f:S3},4:{f:b3},5:{f:A3},6:{f:R3},7:{f:E3},8:{f:B3},9:{f:L3},10:{f:I3},11:{f:P3},12:{f:k3},13:{f:F3},14:{f:T3},15:{f:_3},16:{f:Tv},17:{f:M3},18:{f:C3},19:{f:y0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:fO},40:{},42:{},43:{f:IC},44:{f:MC},45:{f:PC},46:{f:BC},47:{f:LC},48:{},49:{f:NS},50:{},51:{f:nA},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:sv},62:{f:D3},63:{f:cA},64:{f:G3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:fr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:$3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:y3},148:{f:x3,p:16},151:{f:H3},152:{},153:{f:lO},154:{},155:{},156:{f:oO},157:{},158:{},159:{T:1,f:QE},160:{T:-1},161:{T:1,f:ys},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:N3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:iA},336:{T:-1},337:{f:sA,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:nv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:z3},427:{f:W3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:j3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:v3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:U3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:xA},633:{T:1},634:{T:-1},635:{T:1,f:gA},636:{T:-1},637:{f:HS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Z3},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:K3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Wh={6:{f:$f},10:{f:dn},12:{f:At},13:{f:At},14:{f:bt},15:{f:bt},16:{f:nr},17:{f:bt},18:{f:bt},19:{f:At},20:{f:Cp},21:{f:Cp},23:{f:nv},24:{f:Op},25:{f:bt},26:{},27:{},28:{f:pE},29:{},34:{f:bt},35:{f:Ap},38:{f:nr},39:{f:nr},40:{f:nr},41:{f:nr},42:{f:bt},43:{f:bt},47:{f:vC},49:{f:qT},51:{f:At},60:{},61:{f:GT},64:{f:bt},65:{f:XT},66:{f:At},77:{},80:{},81:{},82:{},85:{f:At},89:{},90:{},91:{},92:{f:NT},93:{f:gE},94:{},95:{f:bt},96:{},97:{},99:{f:bt},125:{f:sv},128:{f:sE},129:{f:UT},130:{f:At},131:{f:bt},132:{f:bt},133:{f:HT},134:{},140:{f:bE},141:{f:At},144:{},146:{f:SE},151:{},152:{},153:{},154:{},155:{},156:{f:At},157:{},158:{},160:{f:OE},161:{f:EE},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:tE},190:{f:rE},193:{f:dn},197:{},198:{},199:{},200:{},201:{},202:{f:bt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:At},220:{},221:{f:bt},222:{},224:{f:nE},225:{f:BT},226:{f:dn},227:{},229:{f:mE},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:zT},253:{f:YT},255:{f:WT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Zx},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:bt},353:{f:dn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:oE},431:{f:bt},432:{},433:{},434:{},437:{},438:{f:yE},439:{f:bt},440:{f:wE},441:{},442:{f:jo},443:{},444:{f:At},445:{},446:{},448:{f:dn},449:{f:$T,r:2},450:{f:dn},512:{f:Tp},513:{f:AE},515:{f:aE},516:{f:JT},517:{f:Ep},519:{f:FE},520:{f:VT},523:{},545:{f:Fp},549:{f:Sp},566:{},574:{f:KT},638:{f:eE},659:{},1048:{},1054:{f:ZT},1084:{},1212:{f:hE},2048:{f:kE},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ml},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:dn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:TE,r:12},2173:{f:tA,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:bt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:fE,r:12},2197:{},2198:{f:qC,r:12},2199:{},2200:{},2201:{},2202:{f:uE,r:12},2203:{f:dn},2204:{},2205:{},2206:{},2207:{},2211:{f:jT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:At},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:CE},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_E},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Tp},1:{},2:{f:IE},3:{f:ME},4:{f:RE},5:{f:Ep},7:{f:PE},8:{},9:{f:ml},11:{},22:{f:At},30:{f:QT},31:{},32:{},33:{f:Fp},36:{},37:{f:Sp},50:{f:LE},62:{},52:{},67:{},68:{f:At},69:{},86:{},126:{},127:{f:DE},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:BE},223:{},234:{},354:{},421:{},518:{f:$f},521:{f:ml},536:{f:Op},547:{f:Ap},561:{},579:{},1030:{f:$f},1033:{f:ml},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ai(r,e,t,i){var n=e;if(!isNaN(n)){var s=(t||[]).length||0,a=r.next(4);a.write_shift(2,n),a.write_shift(2,s),s>0&&Ux(t)&&r.push(t)}}function zp(r,e){var t=e||{},i=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var n=r.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),a=n.index,o=s&&s.index||r.length,l=aS(r.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,h=0,u=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(a=0;a<l.length;++a){var p=l[a].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,t.sheetRows&&t.sheetRows<=c){--c;break}f=0;continue}if(!(g!="<td"&&g!="<th")){var x=p.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var y=x[o].trim();if(y.match(/<t[dh]/i)){for(var w=y,T=0;w.charAt(0)=="<"&&(T=w.indexOf(">"))>-1;)w=w.slice(T+1);for(var C=0;C<m.length;++C){var R=m[C];R.s.c==f&&R.s.r<c&&c<=R.e.r&&(f=R.e.c+1,C=-1)}var _=He(y.slice(0,y.indexOf(">")));u=_.colspan?+_.colspan:1,((h=+_.rowspan)>1||u>1)&&m.push({s:{r:c,c:f},e:{r:c+(h||1)-1,c:f+u-1}});var A=_.t||_["data-t"]||"";if(!w.length){f+=u;continue}if(w=Ex(w),d.s.r>c&&(d.s.r=c),d.e.r<c&&(d.e.r=c),d.s.c>f&&(d.s.c=f),d.e.c<f&&(d.e.c=f),!w.length){f+=u;continue}var k={t:"s",v:w};t.raw||!w.trim().length||A=="s"||(w==="TRUE"?k={t:"b",v:!0}:w==="FALSE"?k={t:"b",v:!1}:isNaN(di(w))?isNaN(Qs(w).getDate())||(k={t:"d",v:Wt(w)},t.cellDates||(k={t:"n",v:Tr(k.v)}),k.z=t.dateNF||Ke[14]):k={t:"n",v:di(w)}),t.dense?(i[c]||(i[c]=[]),i[c][f]=k):i[We({r:c,c:f})]=k,f+=u}}}}return i["!ref"]=et(d),m.length&&(i["!merges"]=m),i}function LO(r,e,t,i){for(var n=r["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<n.length;++c)if(!(n[c].s.r>t||n[c].s.c>a)&&!(n[c].e.r<t||n[c].e.c<a)){if(n[c].s.r<t||n[c].s.c<a){o=-1;break}o=n[c].e.r-n[c].s.r+1,l=n[c].e.c-n[c].s.c+1;break}if(!(o<0)){var f=We({r:t,c:a}),h=i.dense?(r[t]||[])[a]:r[f],u=h&&h.v!=null&&(h.h||p0(h.w||(sn(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),i.editable?u='<span contenteditable="true">'+u+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+h.l.Target+'">'+u+"</a>")),d.id=(i.id||"sjs")+"-"+f,s.push(bS("td",u,d))}}var m="<tr>";return m+s.join("")+"</tr>"}var BO='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',NO="</body></html>";function UO(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Un(zp(t[0],e),e);var i=R0();return t.forEach(function(n,s){M0(i,zp(n,e),"Sheet"+(s+1))}),i}function HO(r,e,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function zO(r,e){var t=e||{},i=t.header!=null?t.header:BO,n=t.footer!=null?t.footer:NO,s=[i],a=ha(r["!ref"]);t.dense=Array.isArray(r),s.push(HO(r,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(LO(r,a,o,t));return s.push("</table>"+n),s.join("")}function Dv(r,e,t){var i=t||{},n=0,s=0;if(i.origin!=null)if(typeof i.origin=="number")n=i.origin;else{var a=typeof i.origin=="string"?kr(i.origin):i.origin;n=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(i.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:n,c:s}};if(r["!ref"]){var f=ha(r["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),n==-1&&(c.e.r=n=f.e.r+1)}var h=[],u=0,d=r["!rows"]||(r["!rows"]=[]),m=0,p=0,g=0,x=0,y=0,w=0;for(r["!cols"]||(r["!cols"]=[]);m<o.length&&p<l;++m){var T=o[m];if(Wp(T)){if(i.display)continue;d[p]={hidden:!0}}var C=T.children;for(g=x=0;g<C.length;++g){var R=C[g];if(!(i.display&&Wp(R))){var _=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):Ex(R.innerHTML),A=R.getAttribute("data-z")||R.getAttribute("z");for(u=0;u<h.length;++u){var k=h[u];k.s.c==x+s&&k.s.r<p+n&&p+n<=k.e.r&&(x=k.e.c+1-s,u=-1)}w=+R.getAttribute("colspan")||1,((y=+R.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:p+n,c:x+s},e:{r:p+n+(y||1)-1,c:x+s+(w||1)-1}});var I={t:"s",v:_},N=R.getAttribute("data-t")||R.getAttribute("t")||"";_!=null&&(_.length==0?I.t=N||"z":i.raw||_.trim().length==0||N=="s"||(_==="TRUE"?I={t:"b",v:!0}:_==="FALSE"?I={t:"b",v:!1}:isNaN(di(_))?isNaN(Qs(_).getDate())||(I={t:"d",v:Wt(_)},i.cellDates||(I={t:"n",v:Tr(I.v)}),I.z=i.dateNF||Ke[14]):I={t:"n",v:di(_)})),I.z===void 0&&A!=null&&(I.z=A);var S="",W=R.getElementsByTagName("A");if(W&&W.length)for(var E=0;E<W.length&&!(W[E].hasAttribute("href")&&(S=W[E].getAttribute("href"),S.charAt(0)!="#"));++E);S&&S.charAt(0)!="#"&&(I.l={Target:S}),i.dense?(r[p+n]||(r[p+n]=[]),r[p+n][x+s]=I):r[We({c:x+s,r:p+n})]=I,c.e.c<x+s&&(c.e.c=x+s),x+=w}}++p}return h.length&&(r["!merges"]=(r["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,p-1+n),r["!ref"]=et(c),p>=l&&(r["!fullref"]=et((c.e.r=o.length-m+p-1+n,c))),r}function Rv(r,e){var t=e||{},i=t.dense?[]:{};return Dv(i,r,e)}function WO(r,e){return Un(Rv(r,e),e)}function Wp(r){var e="",t=VO(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function VO(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function jO(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=it(e.replace(/<[^>]*>/g,""));return[t]}var Vp={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Mv(r,e){var t=e||{},i=m0(r),n=[],s,a,o={name:""},l="",c=0,f,h,u={},d=[],m=t.dense?[]:{},p,g,x={value:""},y="",w=0,T=[],C=-1,R=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,k={},I=[],N={},S=0,W=0,E=[],Q=1,ae=1,Z=[],xe={Names:[]},L={},ge=["",""],Y=[],O={},j="",V=0,H=!1,ne=!1,ye=0;for(xo.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=xo.exec(i);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?m["!ref"]=et(_):m["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=_.e.r&&(m["!fullref"]=m["!ref"],_.e.r=t.sheetRows-1,m["!ref"]=et(_)),I.length&&(m["!merges"]=I),E.length&&(m["!rows"]=E),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),d.push(f.name),u[f.name]=m,ne=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=He(p[0],!1),C=R=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,m=t.dense?[]:{},I=[],E=[],ne=!0);break;case"table-row-group":p[1]==="/"?--A:++A;break;case"table-row":case"":if(p[1]==="/"){C+=Q,Q=1;break}if(h=He(p[0],!1),h.?C=h.-1:C==-1&&(C=0),Q=+h["number-rows-repeated"]||1,Q<10)for(ye=0;ye<Q;++ye)A>0&&(E[C+ye]={level:A});R=-1;break;case"covered-table-cell":p[1]!=="/"&&++R,t.sheetStubs&&(t.dense?(m[C]||(m[C]=[]),m[C][R]={t:"z"}):m[We({r:C,c:R})]={t:"z"}),y="",T=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++R,x=He(p[0],!1),ae=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&t.cellFormula!=!1&&(g.f=Bp(it(x.formula))),(x.||x["value-type"])=="string"&&(g.t="s",g.v=it(x["string-value"]||""),t.dense?(m[C]||(m[C]=[]),m[C][R]=g):m[We({r:C,c:R})]=g),R+=ae-1;else if(p[1]!=="/"){++R,y="",w=0,T=[],ae=1;var de=Q?C+Q-1:C;if(R>_.e.c&&(_.e.c=R),R<_.s.c&&(_.s.c=R),C<_.s.r&&(_.s.r=C),de>_.e.r&&(_.e.r=de),x=He(p[0],!1),Y=[],O={},g={t:x.||x["value-type"],v:null},t.cellFormula)if(x.formula&&(x.formula=it(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(S=parseInt(x["number-matrix-rows-spanned"],10)||0,W=parseInt(x["number-matrix-columns-spanned"],10)||0,N={s:{r:C,c:R},e:{r:C+S-1,c:R+W-1}},g.F=et(N),Z.push([N,g.F])),x.formula)g.f=Bp(x.formula);else for(ye=0;ye<Z.length;++ye)C>=Z[ye][0].s.r&&C<=Z[ye][0].e.r&&R>=Z[ye][0].s.c&&R<=Z[ye][0].e.c&&(g.F=Z[ye][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(S=parseInt(x["number-rows-spanned"],10)||0,W=parseInt(x["number-columns-spanned"],10)||0,N={s:{r:C,c:R},e:{r:C+S-1,c:R+W-1}},I.push(N)),x["number-columns-repeated"]&&(ae=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=mt(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=Wt(x["date-value"]),t.cellDates||(g.t="n",g.v=Tr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=iS(x["time-value"])/86400,t.cellDates&&(g.t="d",g.v=hf(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(y=it(x["string-value"]),T=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(H=!1,g.t==="s"&&(g.v=y||"",T.length&&(g.R=T),H=w==0),L.Target&&(g.l=L),Y.length>0&&(g.c=Y,Y=[]),y&&t.cellText!==!1&&(g.w=y),H&&(g.t="z",delete g.v),(!H||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=C))for(var ue=0;ue<Q;++ue){if(ae=parseInt(x["number-columns-repeated"]||"1",10),t.dense)for(m[C+ue]||(m[C+ue]=[]),m[C+ue][R]=ue==0?g:Xt(g);--ae>0;)m[C+ue][R+ae]=Xt(g);else for(m[We({r:C+ue,c:R})]=g;--ae>0;)m[We({r:C+ue,c:R+ae})]=Xt(g);_.e.c<=R&&(_.e.c=R)}ae=parseInt(x["number-columns-repeated"]||"1",10),R+=ae-1,ae=0,g={},y="",T=[]}L={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s;O.t=y,T.length&&(O.R=T),O.a=j,Y.push(O)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);j="",V=0,y="",w=0,T=[];break;case"creator":p[1]==="/"?j=i.slice(V,p.index):V=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);y="",w=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(k[o.name]=l,(s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(l="",o=He(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":a=He(p[0],!1),l+=Vp[p[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":a=He(p[0],!1),l+=Vp[p[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":l+=i.slice(c,p.index);break}else c=p.index+p[0].length;break;case"named-range":a=He(p[0],!1),ge=Gf(a["cell-range-address"]);var pe={Name:a.name,Ref:ge[0]+"!"+ge[1]};ne&&(pe.Sheet=d.length),xe.Names.push(pe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!x||!x["string-value"])){var be=jO(i.slice(w,p.index));y=(y.length>0?y+`
`:"")+be[0]}else He(p[0],!1),w=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ge=Gf(He(p[0])["target-range-address"]),u[ge[0]]["!autofilter"]={ref:ge[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(L=He(p[0],!1),!L.href)break;L.Target=it(L.href),delete L.href,L.Target.charAt(0)=="#"&&L.Target.indexOf(".")>-1?(ge=Gf(L.Target.slice(1)),L.Target="#"+ge[0]+"!"+ge[1]):L.Target.match(/^\.\.[\\\/]/)&&(L.Target=L.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(p)}}var b={Sheets:u,SheetNames:d,Workbook:xe};return t.bookSheets&&delete b.Sheets,b}function jp(r,e){e=e||{},Kr(r,"META-INF/manifest.xml")&&aT(Ct(r,"META-INF/manifest.xml"),e);var t=Hr(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var i=Mv(ut(t),e);return Kr(r,"meta.xml")&&(i.Props=Gx(Ct(r,"meta.xml"))),i}function $p(r,e){return Mv(r,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function A0(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Vh(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):ut(xs(r))}function jh(r){var e=r.reduce(function(n,s){return n+s.length},0),t=new Uint8Array(e),i=0;return r.forEach(function(n){t.set(n,i),i+=n.length}),t}function Gp(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function $O(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,i=r[e+14]&1,n=e+13;n>=e;--n)i=i*256+r[n];return(r[e+15]&128?-i:i)*Math.pow(10,t-6176)}function ko(r,e){var t=e?e[0]:0,i=r[t]&127;e:if(r[t++]>=128&&(i|=(r[t]&127)<<7,r[t++]<128||(i|=(r[t]&127)<<14,r[t++]<128)||(i|=(r[t]&127)<<21,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),i}function Bt(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function ar(r){for(var e=[],t=[0];t[0]<r.length;){var i=t[0],n=ko(r,t),s=n&7;n=Math.floor(n/8);var a=0,o;if(n==0)break;switch(s){case 0:{for(var l=t[0];r[t[0]++]>=128;);o=r.slice(l,t[0])}break;case 5:a=4,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=ko(r,t),o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(i))}var c={data:o,type:s};e[n]==null?e[n]=[c]:e[n].push(c)}return e}function O0(r,e){return(r==null?void 0:r.map(function(t){return e(t.data)}))||[]}function GO(r){for(var e,t=[],i=[0];i[0]<r.length;){var n=ko(r,i),s=ar(r.slice(i[0],i[0]+n));i[0]+=n;var a={id:Bt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=ar(o.data),c=Bt(l[3][0].data);a.messages.push({meta:l,data:r.slice(i[0],i[0]+c)}),i[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=Bt(s[3][0].data)>>>0>0),t.push(a)}return t}function KO(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],i=ko(e,t),n=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}n.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(c=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),n=[jh(n)],l==0)throw new Error("Invalid offset 0");if(l>n[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(n.push(n[0].slice(-l)),c-=l;c>=n[n.length-1].length;)n.push(n[n.length-1]),c-=n[n.length-1].length;n.push(n[0].slice(-l,-l+c))}}var f=jh(n);if(f.length!=i)throw new Error("Unexpected length: ".concat(f.length," != ").concat(i));return f}function XO(r){for(var e=[],t=0;t<r.length;){var i=r[t++],n=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(KO(i,r.slice(t,t+n))),t+=n}if(t!==r.length)throw new Error("data is not a valid framed stream!");return jh(e)}function qO(r,e,t,i){var n=A0(r),s=n.getUint32(4,!0),a=(i>1?12:8)+Gp(s&(i>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=n.getUint32(a,!0),a+=4),a+=Gp(s&(i>1?12288:4096))*4,s&16&&(l=n.getUint32(a,!0),a+=4),s&32&&(c=n.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8);var h;switch(r[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:t[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return h}function YO(r,e,t){var i=A0(r),n=i.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);n&1&&(l=$O(r,s),s+=16),n&2&&(c=i.getFloat64(s,!0),s+=8),n&4&&(f.setTime(f.getTime()+i.getFloat64(s,!0)*1e3),s+=8),n&8&&(o=i.getUint32(s,!0),s+=4),n&16&&(a=i.getUint32(s,!0),s+=4);var h;switch(r[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:t[a]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(n&31," : ").concat(r.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(n&31," : ").concat(r.slice(0,4)))}return h}function JO(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return qO(r,e,t,r[0]);case 5:return YO(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function An(r){var e=ar(r);return ko(e[1][0].data)}function Kp(r,e){var t=ar(e.data),i=Bt(t[1][0].data),n=t[3],s=[];return(n||[]).forEach(function(a){var o=ar(a.data),l=Bt(o[1][0].data)>>>0;switch(i){case 1:s[l]=Vh(o[3][0].data);break;case 8:{var c=r[An(o[9][0].data)][0],f=ar(c.data),h=r[An(f[1][0].data)][0],u=Bt(h.meta[1][0].data);if(u!=2001)throw new Error("2000 unexpected reference to ".concat(u));var d=ar(h.data);s[l]=d[3].map(function(m){return Vh(m.data)}).join("")}break}}),s}function ZO(r,e){var t,i,n,s,a,o,l,c,f,h,u,d,m,p,g=ar(r),x=Bt(g[1][0].data)>>>0,y=Bt(g[2][0].data)>>>0,w=((i=(t=g[8])==null?void 0:t[0])==null?void 0:i.data)&&Bt(g[8][0].data)>0||!1,T,C;if((s=(n=g[7])==null?void 0:n[0])!=null&&s.data&&e!=0)T=(o=(a=g[7])==null?void 0:a[0])==null?void 0:o.data,C=(c=(l=g[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(f=g[4])==null?void 0:f[0])!=null&&h.data&&e!=1)T=(d=(u=g[4])==null?void 0:u[0])==null?void 0:d.data,C=(p=(m=g[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var R=w?4:1,_=A0(T),A=[],k=0;k<T.length/2;++k){var I=_.getUint16(k*2,!0);I<65535&&A.push([k,I])}if(A.length!=y)throw"Expected ".concat(y," cells, found ").concat(A.length);var N=[];for(k=0;k<A.length-1;++k)N[A[k][0]]=C.subarray(A[k][1]*R,A[k+1][1]*R);return A.length>=1&&(N[A[A.length-1][0]]=C.subarray(A[A.length-1][1]*R)),{R:x,cells:N}}function QO(r,e){var t,i=ar(e.data),n=(t=i==null?void 0:i[7])!=null&&t[0]?Bt(i[7][0].data)>>>0>0?1:0:-1,s=O0(i[5],function(a){return ZO(a,n)});return{nrows:Bt(i[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function eF(r,e,t){var i,n=ar(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Bt(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(Bt(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));t["!ref"]=et(s);var a=ar(n[4][0].data),o=Kp(r,r[An(a[4][0].data)][0]),l=(i=a[17])!=null&&i[0]?Kp(r,r[An(a[17][0].data)][0]):[],c=ar(a[3][0].data),f=0;c[1].forEach(function(h){var u=ar(h.data),d=r[An(u[2][0].data)][0],m=Bt(d.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=QO(r,d);p.data.forEach(function(g,x){g.forEach(function(y,w){var T=We({r:f+x,c:w}),C=JO(y,o,l);C&&(t[T]=C)})}),f+=p.nrows})}function tF(r,e){var t=ar(e.data),i={"!ref":"A1"},n=r[An(t[2][0].data)],s=Bt(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return eF(r,n[0],i),i}function rF(r,e){var t,i=ar(e.data),n={name:(t=i[1])!=null&&t[0]?Vh(i[1][0].data):"",sheets:[]},s=O0(i[2],An);return s.forEach(function(a){r[a].forEach(function(o){var l=Bt(o.meta[1][0].data);l==6e3&&n.sheets.push(tF(r,o))})}),n}function iF(r,e){var t=R0(),i=ar(e.data),n=O0(i[1],An);if(n.forEach(function(s){r[s].forEach(function(a){var o=Bt(a.meta[1][0].data);if(o==2){var l=rF(r,a);l.sheets.forEach(function(c,f){M0(t,c,f==0?l.name:l.name+"_"+f,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Xf(r){var e,t,i,n,s={},a=[];if(r.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=XO(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var f;try{f=GO(c)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((n=(i=(t=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:i[1])==null?void 0:n[0].data)&&Bt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var f=Bt(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return iF(s,o)}function nF(r){return function(t){for(var i=0;i!=r.length;++i){var n=r[i];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function F0(r){nF([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function sF(r){return Ds.WS.indexOf(r)>-1?"sheet":r==Ds.CS?"chart":r==Ds.DS?"dialog":r==Ds.MS?"macro":r&&r.length?r:"sheet"}function aF(r,e){if(!r)return 0;try{r=e.map(function(i){return i.id||(i.id=i.strRelID),[i.name,r["!id"][i.id].Target,sF(r["!id"][i.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function oF(r,e,t,i,n,s,a,o,l,c,f,h){try{s[i]=Xa(Hr(r,t,!0),e);var u=Ct(r,e),d;switch(o){case"sheet":d=dO(u,e,n,l,s[i],c,f,h);break;case"chart":if(d=pO(u,e,n,l,s[i],c,f,h),!d||!d["!drawel"])break;var m=Fa(d["!drawel"].Target,e),p=Nh(m),g=uA(Hr(r,m,!0),Xa(Hr(r,p,!0),m)),x=Fa(g,m),y=Nh(x);d=Y3(Hr(r,x,!0),x,l,Xa(Hr(r,y,!0),x),c,d);break;case"macro":d=mO(u,e,n,l,s[i],c,f,h);break;case"dialog":d=gO(u,e,n,l,s[i],c,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[i]=d;var w=[];s&&s[i]&&Ni(s[i]).forEach(function(T){var C="";if(s[i][T].Type==Ds.CMNT){C=Fa(s[i][T].Target,e);var R=wO(Ct(r,C,!0),C,l);if(!R||!R.length)return;Rp(d,R,!1)}s[i][T].Type==Ds.TCMNT&&(C=Fa(s[i][T].Target,e),w=w.concat(pA(Ct(r,C,!0),l)))}),w&&w.length&&Rp(d,w,!0,l.people||[])}catch(T){if(l.WTF)throw T}}function $r(r){return r.charAt(0)=="/"?r.slice(1):r}function lF(r,e){if(xx(),e=e||{},F0(e),Kr(r,"META-INF/manifest.xml")||Kr(r,"objectdata.xml"))return jp(r,e);if(Kr(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Xf<"u"){if(r.FileIndex)return Xf(r);var t=Qe.utils.cfb_new();return sp(r).forEach(function(E){cS(t,E,lS(r,E))}),Xf(t)}throw new Error("Unsupported NUMBERS file")}if(!Kr(r,"[Content_Types].xml"))throw Kr(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Kr(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=sp(r),n=nT(Hr(r,"[Content_Types].xml")),s=!1,a,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",Ct(r,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!Ct(r,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Ja=[],n.sst)try{Ja=yO(Ct(r,$r(n.sst)),n.sst,e)}catch(E){if(e.WTF)throw E}e.cellStyles&&n.themes.length&&(l=vO(Hr(r,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],e)),n.style&&(c=xO(Ct(r,$r(n.style)),n.style,l,e))}n.links.map(function(E){try{var Q=Xa(Hr(r,Nh($r(E))),E);return bO(Ct(r,$r(E)),Q,E,e)}catch{}});var f=uO(Ct(r,$r(n.workbooks[0])),n.workbooks[0],e),h={},u="";n.coreprops.length&&(u=Ct(r,$r(n.coreprops[0]),!0),u&&(h=Gx(u)),n.extprops.length!==0&&(u=Ct(r,$r(n.extprops[0]),!0),u&&cT(u,h,e)));var d={};(!e.bookSheets||e.bookProps)&&n.custprops.length!==0&&(u=Hr(r,$r(n.custprops[0]),!0),u&&(d=hT(u,e)));var m={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(Q){return Q.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(m.Props=h,m.Custprops=d),e.bookSheets&&typeof a<"u"&&(m.SheetNames=a),e.bookSheets?m.SheetNames:e.bookProps))return m;a={};var p={};e.bookDeps&&n.calcchain&&(p=kO(Ct(r,$r(n.calcchain)),n.calcchain));var g=0,x={},y,w;{var T=f.Sheets;h.Worksheets=T.length,h.SheetNames=[];for(var C=0;C!=T.length;++C)h.SheetNames[C]=T[C].name}var R=s?"bin":"xml",_=n.workbooks[0].lastIndexOf("/"),A=(n.workbooks[0].slice(0,_+1)+"_rels/"+n.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");Kr(r,A)||(A="xl/_rels/workbook."+R+".rels");var k=Xa(Hr(r,A,!0),A.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(e.xlmeta=_O(Ct(r,$r(n.metadata[0])),n.metadata[0],e)),(n.people||[]).length>=1&&(e.people=mA(Ct(r,$r(n.people[0])),e)),k&&(k=aF(k,f.Sheets));var I=Ct(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=h.Worksheets;++g){var N="sheet";if(k&&k[g]?(y="xl/"+k[g][1].replace(/[\/]?xl\//,""),Kr(r,y)||(y=k[g][1]),Kr(r,y)||(y=A.replace(/_rels\/.*$/,"")+k[g][1]),N=k[g][2]):(y="xl/worksheets/sheet"+(g+1-I)+"."+R,y=y.replace(/sheet0\./,"sheet.")),w=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(g!=e.sheets)continue e;break;case"string":if(h.SheetNames[g].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var S=!1,W=0;W!=e.sheets.length;++W)typeof e.sheets[W]=="number"&&e.sheets[W]==g&&(S=1),typeof e.sheets[W]=="string"&&e.sheets[W].toLowerCase()==h.SheetNames[g].toLowerCase()&&(S=1);if(!S)continue e}}oF(r,y,w,h.SheetNames[g],g,x,a,N,e,f,l,c)}return m={Directory:n,Workbook:f,Props:h,Custprops:d,Deps:p,Sheets:a,SheetNames:h.SheetNames,Strings:Ja,Styles:c,Themes:l,SSF:Xt(Ke)},e&&e.bookFiles&&(r.files?(m.keys=i,m.files=r.files):(m.keys=[],m.files={},r.FullPaths.forEach(function(E,Q){E=E.replace(/^Root Entry[\/]/,""),m.keys.push(E),m.files[E]=r.FileIndex[Q]}))),e&&e.bookVBA&&(n.vba.length>0?m.vbaraw=Ct(r,$r(n.vba[0]),!0):n.defaults&&n.defaults.bin===yA&&(m.vbaraw=Ct(r,"xl/vbaProject.bin",!0))),m}function cF(r,e){var t=e||{},i="Workbook",n=Qe.find(r,i);try{if(i="/!DataSpaces/Version",n=Qe.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(tC(n.content),i="/!DataSpaces/DataSpaceMap",n=Qe.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var s=iC(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Qe.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var a=nC(n.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Qe.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);aC(n.content)}catch{}if(i="/EncryptionInfo",n=Qe.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var o=oC(n.content);if(i="/EncryptedPackage",n=Qe.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,t.password||"",t);throw new Error("File is password-protected")}function D0(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=jr(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function fF(r,e){return Qe.find(r,"EncryptedPackage")?cF(r,e):Fv(r,e)}function hF(r,e){var t,i=r,n=e||{};return n.type||(n.type=Ze&&Buffer.isBuffer(r)?"buffer":"base64"),t=_x(i,n),lF(t,n)}function Iv(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return zh(r.slice(t),e);default:break e}return vo.to_workbook(r,e)}function uF(r,e){var t="",i=D0(r,e);switch(e.type){case"base64":t=jr(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=ls(r);break;default:throw new Error("Unrecognized type "+e.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(t=ut(t)),e.type="binary",Iv(t,e)}function dF(r,e){var t=r;return e.type=="base64"&&(t=jr(t)),t=po.utils.decode(1200,t.slice(2),"str"),e.type="binary",Iv(t,e)}function pF(r){return r.match(/[^\x00-\x7F]/)?Da(r):r}function qf(r,e,t,i){return i?(t.type="string",vo.to_workbook(r,t)):vo.to_workbook(e,t)}function $h(r,e){sx();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return $h(new Uint8Array(r),(t=Xt(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var i=r,n=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),js={},t.dateNF&&(js.dateNF=t.dateNF),t.type||(t.type=Ze&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=Ze?"buffer":"binary",i=tS(r),typeof Uint8Array<"u"&&!Ze&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,i=pF(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return t=Xt(t),t.type="array",$h(c0(i),t)}switch((n=D0(i,t))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return fF(Qe.read(i,t),t);break;case 9:if(n[1]<=8)return Fv(i,t);break;case 60:return zh(i,t);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return WE(i,t);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return HE.to_workbook(i,t);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?hF(i,t):qf(r,i,t,s);case 239:return n[3]===60?zh(i,t):qf(r,i,t,s);case 255:if(n[1]===254)return dF(i,t);if(n[1]===0&&n[2]===2&&n[3]===0)return Ya.to_workbook(i,t);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Ya.to_workbook(i,t);break;case 3:case 131:case 139:case 140:return Dp.to_workbook(i,t);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return yC.to_workbook(i,t);break;case 10:case 13:case 32:return uF(i,t);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return NE.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Dp.to_workbook(i,t):qf(r,i,t,s)}function mF(r,e,t,i,n,s,a,o){var l=qt(t),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,u=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:t,enumerable:!1})}catch{u.__rowNum__=t}else u.__rowNum__=t;if(!a||r[t])for(var d=e.s.c;d<=e.e.c;++d){var m=a?r[t][d]:r[i[d]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[d]!=null&&(u[s[d]]=c);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[d]!=null){if(p==null)if(m.t=="e"&&p===null)u[s[d]]=null;else if(c!==void 0)u[s[d]]=c;else if(f&&p===null)u[s[d]]=null;else continue;else u[s[d]]=f&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?p:sn(m,p,o);p!=null&&(h=!1)}}return{row:u,isempty:h}}function Gh(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},i=0,n=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},f=c.range!=null?c.range:r["!ref"];switch(c.header===1?i=1:c.header==="A"?i=2:Array.isArray(c.header)?i=3:c.header==null&&(i=0),typeof f){case"string":l=kt(f);break;case"number":l=kt(r["!ref"]),l.s.r=f;break;default:l=f}i>0&&(n=0);var h=qt(l.s.r),u=[],d=[],m=0,p=0,g=Array.isArray(r),x=l.s.r,y=0,w={};g&&!r[x]&&(r[x]=[]);var T=c.skipHidden&&r["!cols"]||[],C=c.skipHidden&&r["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(T[y]||{}).hidden)switch(u[y]=Pt(y),t=g?r[x][y]:r[u[y]+h],i){case 1:s[y]=y-l.s.c;break;case 2:s[y]=u[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=sn(t,null,c),p=w[a]||0,!p)w[a]=1;else{do o=a+"_"+p++;while(w[o]);w[a]=p,w[o]=1}s[y]=o}for(x=l.s.r+n;x<=l.e.r;++x)if(!(C[x]||{}).hidden){var R=mF(r,l,x,u,i,s,g,c);(R.isempty===!1||(i===1?c.blankrows!==!1:c.blankrows))&&(d[m++]=R.row)}return d.length=m,d}var Xp=/"/g;function gF(r,e,t,i,n,s,a,o){for(var l=!0,c=[],f="",h=qt(t),u=e.s.c;u<=e.e.c;++u)if(i[u]){var d=o.dense?(r[t]||[])[u]:r[i[u]+h];if(d==null)f="";else if(d.v!=null){l=!1,f=""+(o.rawNumbers&&d.t=="n"?d.v:sn(d,null,o));for(var m=0,p=0;m!==f.length;++m)if((p=f.charCodeAt(m))===n||p===s||p===34||o.forceQuotes){f='"'+f.replace(Xp,'""')+'"';break}f=="ID"&&(f='"ID"')}else d.f!=null&&!d.F?(l=!1,f="="+d.f,f.indexOf(",")>=0&&(f='"'+f.replace(Xp,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(a)}function Pv(r,e){var t=[],i=e??{};if(r==null||r["!ref"]==null)return"";var n=kt(r["!ref"]),s=i.FS!==void 0?i.FS:",",a=s.charCodeAt(0),o=i.RS!==void 0?i.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];i.dense=Array.isArray(r);for(var u=i.skipHidden&&r["!cols"]||[],d=i.skipHidden&&r["!rows"]||[],m=n.s.c;m<=n.e.c;++m)(u[m]||{}).hidden||(h[m]=Pt(m));for(var p=0,g=n.s.r;g<=n.e.r;++g)(d[g]||{}).hidden||(f=gF(r,n,g,h,a,l,s,i),f!=null&&(i.strip&&(f=f.replace(c,"")),(f||i.blankrows!==!1)&&t.push((p++?o:"")+f)));return delete i.dense,t.join("")}function xF(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Pv(r,e);return t}function vF(r){var e="",t,i="";if(r==null||r["!ref"]==null)return[];var n=kt(r["!ref"]),s="",a=[],o,l=[],c=Array.isArray(r);for(o=n.s.c;o<=n.e.c;++o)a[o]=Pt(o);for(var f=n.s.r;f<=n.e.r;++f)for(s=qt(f),o=n.s.c;o<=n.e.c;++o)if(e=a[o]+s,t=c?(r[f]||[])[o]:r[e],i="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;i=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}l[l.length]=e+"="+i}return l}function Lv(r,e,t){var i=t||{},n=+!i.skipHeader,s=r||{},a=0,o=0;if(s&&i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var l=typeof i.origin=="string"?kr(i.origin):i.origin;a=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+n}};if(s["!ref"]){var h=kt(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+e.length-1+n)}else a==-1&&(a=0,f.e.r=e.length-1+n);var u=i.header||[],d=0;e.forEach(function(p,g){Ni(p).forEach(function(x){(d=u.indexOf(x))==-1&&(u[d=u.length]=x);var y=p[x],w="z",T="",C=We({c:o+d,r:a+g+n});c=bo(s,C),y&&typeof y=="object"&&!(y instanceof Date)?s[C]=y:(typeof y=="number"?w="n":typeof y=="boolean"?w="b":typeof y=="string"?w="s":y instanceof Date?(w="d",i.cellDates||(w="n",y=Tr(y)),T=i.dateNF||Ke[14]):y===null&&i.nullError&&(w="e",y=0),c?(c.t=w,c.v=y,delete c.w,delete c.R,T&&(c.z=T)):s[C]=c={t:w,v:y},T&&(c.z=T))})}),f.e.c=Math.max(f.e.c,o+u.length-1);var m=qt(a);if(n)for(d=0;d<u.length;++d)s[Pt(d+o)+m]={t:"s",v:u[d]};return s["!ref"]=et(f),s}function yF(r,e){return Lv(null,r,e)}function bo(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var i=kr(e);return r[i.r]||(r[i.r]=[]),r[i.r][i.c]||(r[i.r][i.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?bo(r,We(e)):bo(r,We({r:e,c:t||0}))}function wF(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function R0(){return{SheetNames:[],Sheets:{}}}function M0(r,e,t,i){var n=1;if(!t)for(;n<=65535&&r.SheetNames.indexOf(t="Sheet"+n)!=-1;++n,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var a=s&&s[1]||t;for(++n;n<=65535&&r.SheetNames.indexOf(t=a+n)!=-1;++n);}if(nO(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function kF(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var i=wF(r,e);switch(r.Workbook.Sheets[i]||(r.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[i].Hidden=t}function bF(r,e){return r.z=e,r}function Bv(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function _F(r,e,t){return Bv(r,"#"+e,t)}function SF(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function TF(r,e,t,i){for(var n=typeof e!="string"?e:kt(e),s=typeof e=="string"?e:et(e),a=n.s.r;a<=n.e.r;++a)for(var o=n.s.c;o<=n.e.c;++o){var l=bo(r,a,o);l.t="n",l.F=s,delete l.v,a==n.s.r&&o==n.s.c&&(l.f=t,i&&(l.D=!0))}return r}var EF={encode_col:Pt,encode_row:qt,encode_cell:We,encode_range:et,decode_col:v0,decode_row:x0,split_cell:BS,decode_cell:kr,decode_range:ha,format_cell:sn,sheet_add_aoa:zx,sheet_add_json:Lv,sheet_add_dom:Dv,aoa_to_sheet:ua,json_to_sheet:yF,table_to_sheet:Rv,table_to_book:WO,sheet_to_csv:Pv,sheet_to_txt:xF,sheet_to_json:Gh,sheet_to_html:zO,sheet_to_formulae:vF,sheet_to_row_object_array:Gh,sheet_get_cell:bo,book_new:R0,book_append_sheet:M0,book_set_sheet_visibility:kF,cell_set_number_format:bF,cell_set_hyperlink:Bv,cell_set_internal_link:_F,cell_add_comment:SF,sheet_set_array_formula:TF,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const I0=(r,e)=>{const t=r.__vccOpts||r;for(const[i,n]of e)t[i]=n;return t},CF={name:"CSVUploader",emits:["csvs-changed"],data(){return{useExcel:!1,csvUrlInput:"",csvFiles:[],loading:!1,error:null,previewIndex:null}},methods:{async fetchCsv(){this.error=null,this.loading=!0;try{const r=this.csvUrlInput.trim();if(!r)throw new Error("Please enter a CSV URL");const e=await fetch(r);if(!e.ok)throw new Error(`Failed to fetch CSV (status ${e.status})`);const t=await e.text(),i=S_.parse(t,{header:!0,skipEmptyLines:!0});if(i.errors&&i.errors.length)throw new Error(`CSV parse error: ${i.errors[0].message}`);const n={url:r,rows:i.data,headers:i.meta.fields||[],text:t};this.csvFiles.find(s=>s.url===r)?this.error="URL already added":(this.csvFiles.push(n),this.emitChange(),this.csvUrlInput="")}catch(r){this.error=r.message||String(r)}finally{this.loading=!1}},async onExcelFile(r){this.error=null;const e=r.target.files&&r.target.files[0];if(!e)return;this.loading=!0;try{const n=await t(e),s=$h(n,{type:"array"}),a=e.name.replace(/\.[^/.]+$/,""),o=[];for(const l of s.SheetNames){const c=s.Sheets[l],f=EF.sheet_to_json(c,{header:1,raw:!1,defval:null}),h=i(f),u=(f[h]||[]).map(T=>T==null?"":String(T).trim()),d=[];let m=0;for(let T=h+1;T<f.length;T++){const C=f[T];if(!C||C.every(_=>_==null||String(_).trim()==="")){if(m++,m>=5)break;continue}m=0;const R={};for(let _=0;_<u.length;_++){const A=u[_]||`col${_+1}`;R[A]=C[_]==null?"":C[_]}d.push(R)}const p=T=>{if(T==null)return"";const C=String(T);return C.includes('"')||C.includes(",")||C.includes(`
`)||C.includes("\r")?'"'+C.replace(/"/g,'""')+'"':C},g=[];g.push(u.map(p).join(","));for(const T of d){const C=u.map(R=>p(T[R])).join(",");g.push(C)}const x=g.join(`
`),y=`${a}#${l}`,w={url:y,rows:d,headers:u,text:x};this.csvFiles.find(T=>T.url===y)||(this.csvFiles.push(w),o.push(w))}this.emitChange(),this.$refs.fileInput&&(this.$refs.fileInput.value="")}catch(n){this.error="Failed to parse Excel file: "+(n&&n.message?n.message:String(n))}finally{this.loading=!1}function t(n){return new Promise((s,a)=>{const o=new FileReader;o.onload=l=>s(l.target.result),o.onerror=l=>a(l),o.readAsArrayBuffer(n)})}function i(n){const s=Math.min(n.length,20);let a=0,o=-1/0;const l=c=>c?c.every(f=>f==null||String(f).trim()===""):!0;for(let c=0;c<s;c++){const f=n[c]||[];if(l(f))continue;const h=f.filter(y=>y!=null&&String(y).trim()!=="").length;if(h===0)continue;const d=new Set(f.map(y=>y==null?"":String(y).trim())).size/Math.max(1,h);let m=0,p=0;for(let y=c+1;y<Math.min(n.length,c+1+10);y++){const T=(n[y]||[]).filter(C=>C!=null&&String(C).trim()!=="").length;if(T===0){p++;continue}T>=Math.max(1,Math.floor(h*.5))&&m++,p++}const g=p===0?0:m/p,x=h*.6+d*2+g*5;d<.3||x>o&&(o=x,a=c)}if(o===-1/0){for(let c=0;c<Math.min(n.length,5);c++)if(!l(n[c]))return c;return 0}return a}},remove(r){this.csvFiles.splice(r,1),this.previewIndex=null,this.emitChange()},preview(r){this.previewIndex=this.previewIndex===r?null:r},clearAll(){this.csvFiles=[],this.previewIndex=null,this.error=null,this.emitChange()},emitChange(){this.$emit("csvs-changed",this.csvFiles.slice())}}},AF={class:"mb-4"},OF={class:"d-flex align-items-center mb-2 gap-2"},FF={class:"form-check form-switch"},DF={key:0,class:"d-flex gap-2 w-100"},RF=["disabled"],MF={key:1,class:"d-flex gap-2 w-100"},IF={key:0,class:"mb-2 text-muted"},PF={key:1,class:"mb-2 text-danger"},LF={key:2,class:"mt-3"},BF={class:"list-group mb-2"},NF={class:"ms-2 me-auto"},UF={class:"fw-bold text-truncate",style:{"max-width":"420px"}},HF=["href"],zF={class:"small text-muted"},WF=["onClick"],VF={key:0,class:"mt-2"},jF={key:0},$F={class:"table table-striped table-bordered table-sm"},GF={class:"table-dark"},KF={key:1,class:"text-muted"};function XF(r,e,t,i,n,s){return ze(),Ge("div",AF,[Pe("div",OF,[Pe("div",FF,[Ua(Pe("input",{class:"form-check-input",type:"checkbox",id:"toggleExcel","onUpdate:modelValue":e[0]||(e[0]=a=>n.useExcel=a)},null,512),[[x_,n.useExcel]]),e[6]||(e[6]=Pe("label",{class:"form-check-label small",for:"toggleExcel"}," Upload Excel instead ",-1))]),n.useExcel?(ze(),Ge("div",MF,[Pe("input",{ref:"fileInput",type:"file",accept:".xlsx,.xls",onChange:e[4]||(e[4]=(...a)=>s.onExcelFile&&s.onExcelFile(...a)),class:"form-control form-control-sm"},null,544),n.csvFiles.length?(ze(),Ge("button",{key:0,class:"btn btn-outline-secondary btn-sm",onClick:e[5]||(e[5]=(...a)=>s.clearAll&&s.clearAll(...a))},"Clear all")):Ar("",!0)])):(ze(),Ge("div",DF,[Ua(Pe("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>n.csvUrlInput=a),type:"url",placeholder:"https://example.org/data.csv",class:"form-control form-control-sm"},null,512),[[ex,n.csvUrlInput]]),Pe("button",{class:"btn btn-secondary btn-sm",onClick:e[2]||(e[2]=(...a)=>s.fetchCsv&&s.fetchCsv(...a)),disabled:!n.csvUrlInput},"Fetch & Add",8,RF),n.csvFiles.length?(ze(),Ge("button",{key:0,class:"btn btn-outline-secondary btn-sm",onClick:e[3]||(e[3]=(...a)=>s.clearAll&&s.clearAll(...a))},"Clear all")):Ar("",!0)]))]),n.loading?(ze(),Ge("div",IF,"Processing")):Ar("",!0),n.error?(ze(),Ge("div",PF,Qt(n.error),1)):Ar("",!0),n.csvFiles.length?(ze(),Ge("div",LF,[e[8]||(e[8]=Pe("h5",null,"Added CSVs / Sheets",-1)),Pe("ul",BF,[(ze(!0),Ge(It,null,Ei(n.csvFiles,(a,o)=>(ze(),Ge("li",{class:"list-group-item d-flex justify-content-between align-items-start",key:a.url},[Pe("div",NF,[Pe("div",UF,[Pe("a",{href:a.url,target:"_blank",rel:"noopener"},Qt(a.url),9,HF)]),Pe("div",zF,Qt(a.headers.length)+" columns  "+Qt(a.rows.length)+" rows",1)]),Pe("div",null,[Pe("button",{class:"btn btn-sm btn-outline-secondary me-1",onClick:l=>s.remove(o)},"Remove",8,WF)])]))),128))]),n.previewIndex!==null?(ze(),Ge("div",VF,[Pe("h6",null,"Preview  "+Qt(n.csvFiles[n.previewIndex].url),1),n.csvFiles[n.previewIndex].headers.length?(ze(),Ge("div",jF,[Pe("table",$F,[Pe("thead",GF,[Pe("tr",null,[(ze(!0),Ge(It,null,Ei(n.csvFiles[n.previewIndex].headers,a=>(ze(),Ge("th",{key:a},Qt(a),1))),128))])]),Pe("tbody",null,[(ze(!0),Ge(It,null,Ei(n.csvFiles[n.previewIndex].rows.slice(0,10),(a,o)=>(ze(),Ge("tr",{key:o},[(ze(!0),Ge(It,null,Ei(n.csvFiles[n.previewIndex].headers,l=>(ze(),Ge("td",{key:l},Qt(a[l]),1))),128))]))),128))])]),e[7]||(e[7]=Pe("small",{class:"text-muted"},"Showing first 10 rows",-1))])):(ze(),Ge("div",KF,"No headers detected."))])):Ar("",!0)])):Ar("",!0)])}const qF=I0(CF,[["render",XF],["__scopeId","data-v-30b8173f"]]);let Kh=[],Nv=[];(()=>{let r="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<r.length;e++)(e%2?Nv:Kh).push(t=t+r[e])})();function YF(r){if(r<768)return!1;for(let e=0,t=Kh.length;;){let i=e+t>>1;if(r<Kh[i])t=i;else if(r>=Nv[i])e=i+1;else return!0;if(e==t)return!1}}function qp(r){return r>=127462&&r<=127487}const Yp=8205;function JF(r,e,t=!0,i=!0){return(t?Uv:ZF)(r,e,i)}function Uv(r,e,t){if(e==r.length)return e;e&&Hv(r.charCodeAt(e))&&zv(r.charCodeAt(e-1))&&e--;let i=Yf(r,e);for(e+=Jp(i);e<r.length;){let n=Yf(r,e);if(i==Yp||n==Yp||t&&YF(n))e+=Jp(n),i=n;else if(qp(n)){let s=0,a=e-2;for(;a>=0&&qp(Yf(r,a));)s++,a-=2;if(s%2==0)break;e+=2}else break}return e}function ZF(r,e,t){for(;e>0;){let i=Uv(r,e-2,t);if(i<e)return i;e--}return 0}function Yf(r,e){let t=r.charCodeAt(e);if(!zv(t)||e+1==r.length)return t;let i=r.charCodeAt(e+1);return Hv(i)?(t-55296<<10)+(i-56320)+65536:t}function Hv(r){return r>=56320&&r<57344}function zv(r){return r>=55296&&r<56320}function Jp(r){return r<65536?1:2}class rt{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){[e,t]=ta(this,e,t);let n=[];return this.decompose(0,e,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(t,this.length,n,1),Oi.from(n,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=ta(this,e,t);let i=[];return this.decompose(e,t,i,0),Oi.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),n=new eo(this),s=new eo(e);for(let a=t,o=t;;){if(n.next(a),s.next(a),a=0,n.lineBreak!=s.lineBreak||n.done!=s.done||n.value!=s.value)return!1;if(o+=n.value.length,n.done||o>=i)return!0}}iter(e=1){return new eo(this,e)}iterRange(e,t=this.length){return new Wv(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let n=this.line(e).from;i=this.iterRange(n,Math.max(n,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new Vv(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?rt.empty:e.length<=32?new _t(e):Oi.from(_t.split(e,[]))}}class _t extends rt{constructor(e,t=QF(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,n){for(let s=0;;s++){let a=this.text[s],o=n+a.length;if((t?i:o)>=e)return new e8(n,o,i,a);n=o+1,i++}}decompose(e,t,i,n){let s=e<=0&&t>=this.length?this:new _t(Zp(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(n&1){let a=i.pop(),o=Xl(s.text,a.text.slice(),0,s.length);if(o.length<=32)i.push(new _t(o,a.length+s.length));else{let l=o.length>>1;i.push(new _t(o.slice(0,l)),new _t(o.slice(l)))}}else i.push(s)}replace(e,t,i){if(!(i instanceof _t))return super.replace(e,t,i);[e,t]=ta(this,e,t);let n=Xl(this.text,Xl(i.text,Zp(this.text,0,e)),t),s=this.length+i.length-(t-e);return n.length<=32?new _t(n,s):Oi.from(_t.split(n,[]),s)}sliceString(e,t=this.length,i=`
`){[e,t]=ta(this,e,t);let n="";for(let s=0,a=0;s<=t&&a<this.text.length;a++){let o=this.text[a],l=s+o.length;s>e&&a&&(n+=i),e<l&&t>s&&(n+=o.slice(Math.max(0,e-s),t-s)),s=l+1}return n}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],n=-1;for(let s of e)i.push(s),n+=s.length+1,i.length==32&&(t.push(new _t(i,n)),i=[],n=-1);return n>-1&&t.push(new _t(i,n)),t}}class Oi extends rt{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,n){for(let s=0;;s++){let a=this.children[s],o=n+a.length,l=i+a.lines-1;if((t?l:o)>=e)return a.lineInner(e,t,i,n);n=o+1,i=l+1}}decompose(e,t,i,n){for(let s=0,a=0;a<=t&&s<this.children.length;s++){let o=this.children[s],l=a+o.length;if(e<=l&&t>=a){let c=n&((a<=e?1:0)|(l>=t?2:0));a>=e&&l<=t&&!c?i.push(o):o.decompose(e-a,t-a,i,c)}a=l+1}}replace(e,t,i){if([e,t]=ta(this,e,t),i.lines<this.lines)for(let n=0,s=0;n<this.children.length;n++){let a=this.children[n],o=s+a.length;if(e>=s&&t<=o){let l=a.replace(e-s,t-s,i),c=this.lines-a.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let f=this.children.slice();return f[n]=l,new Oi(f,this.length-(t-e)+i.length)}return super.replace(s,o,l)}s=o+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){[e,t]=ta(this,e,t);let n="";for(let s=0,a=0;s<this.children.length&&a<=t;s++){let o=this.children[s],l=a+o.length;a>e&&s&&(n+=i),e<l&&t>a&&(n+=o.sliceString(e-a,t-a,i)),a=l+1}return n}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Oi))return 0;let i=0,[n,s,a,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;n+=t,s+=t){if(n==a||s==o)return i;let l=this.children[n],c=e.children[s];if(l!=c)return i+l.scanIdentical(c,t);i+=l.length+1}}static from(e,t=e.reduce((i,n)=>i+n.length+1,-1)){let i=0;for(let d of e)i+=d.lines;if(i<32){let d=[];for(let m of e)m.flatten(d);return new _t(d,t)}let n=Math.max(32,i>>5),s=n<<1,a=n>>1,o=[],l=0,c=-1,f=[];function h(d){let m;if(d.lines>s&&d instanceof Oi)for(let p of d.children)h(p);else d.lines>a&&(l>a||!l)?(u(),o.push(d)):d instanceof _t&&l&&(m=f[f.length-1])instanceof _t&&d.lines+m.lines<=32?(l+=d.lines,c+=d.length+1,f[f.length-1]=new _t(m.text.concat(d.text),m.length+1+d.length)):(l+d.lines>n&&u(),l+=d.lines,c+=d.length+1,f.push(d))}function u(){l!=0&&(o.push(f.length==1?f[0]:Oi.from(f,c)),c=-1,l=f.length=0)}for(let d of e)h(d);return u(),o.length==1?o[0]:new Oi(o,t)}}rt.empty=new _t([""],0);function QF(r){let e=-1;for(let t of r)e+=t.length+1;return e}function Xl(r,e,t=0,i=1e9){for(let n=0,s=0,a=!0;s<r.length&&n<=i;s++){let o=r[s],l=n+o.length;l>=t&&(l>i&&(o=o.slice(0,i-n)),n<t&&(o=o.slice(t-n)),a?(e[e.length-1]+=o,a=!1):e.push(o)),n=l+1}return e}function Zp(r,e,t){return Xl(r,[""],e,t)}class eo{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof _t?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],s=this.offsets[i],a=s>>1,o=n instanceof _t?n.text.length:n.children.length;if(a==(t>0?o:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(n instanceof _t){let l=n.text[a+(t<0?-1:0)];if(this.offsets[i]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=n.children[a+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof _t?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class Wv{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new eo(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:n}=this.cursor.next(e);return this.pos+=(n.length+e)*t,this.value=n.length<=i?n:t<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Vv{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:n}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(rt.prototype[Symbol.iterator]=function(){return this.iter()},eo.prototype[Symbol.iterator]=Wv.prototype[Symbol.iterator]=Vv.prototype[Symbol.iterator]=function(){return this});class e8{constructor(e,t,i,n){this.from=e,this.to=t,this.number=i,this.text=n}get length(){return this.to-this.from}}function ta(r,e,t){return e=Math.max(0,Math.min(r.length,e)),[e,Math.max(e,Math.min(r.length,t))]}function Kt(r,e,t=!0,i=!0){return JF(r,e,t,i)}function t8(r){return r>=56320&&r<57344}function r8(r){return r>=55296&&r<56320}function Or(r,e){let t=r.charCodeAt(e);if(!r8(t)||e+1==r.length)return t;let i=r.charCodeAt(e+1);return t8(i)?(t-55296<<10)+(i-56320)+65536:t}function P0(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function Fi(r){return r<65536?1:2}const Xh=/\r\n?|\n/;var yr=function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r}(yr||(yr={}));class Pi{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,n=0;t<this.sections.length;){let s=this.sections[t++],a=this.sections[t++];a<0?(e(i,n,s),n+=s):n+=a,i+=s}}iterChangedRanges(e,t=!1){qh(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],n=this.sections[t++];n<0?e.push(i,n):e.push(n,i)}return new Pi(e)}composeDesc(e){return this.empty?e:e.empty?this:jv(this,e)}mapDesc(e,t=!1){return e.empty?this:Yh(this,e,t)}mapPos(e,t=-1,i=yr.Simple){let n=0,s=0;for(let a=0;a<this.sections.length;){let o=this.sections[a++],l=this.sections[a++],c=n+o;if(l<0){if(c>e)return s+(e-n);s+=o}else{if(i!=yr.Simple&&c>=e&&(i==yr.TrackDel&&n<e&&c>e||i==yr.TrackBefore&&n<e||i==yr.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!o)return e==n||t<0?s:s+l;s+=l}n=c}if(e>n)throw new RangeError(`Position ${e} is out of range for changeset of length ${n}`);return s}touchesRange(e,t=e){for(let i=0,n=0;i<this.sections.length&&n<=t;){let s=this.sections[i++],a=this.sections[i++],o=n+s;if(a>=0&&n<=t&&o>=e)return n<e&&o>t?"cover":!0;n=o}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],n=this.sections[t++];e+=(e?" ":"")+i+(n>=0?":"+n:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Pi(e)}static create(e){return new Pi(e)}}class Mt extends Pi{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return qh(this,(t,i,n,s,a)=>e=e.replace(n,n+(i-t),a),!1),e}mapDesc(e,t=!1){return Yh(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let n=0,s=0;n<t.length;n+=2){let a=t[n],o=t[n+1];if(o>=0){t[n]=o,t[n+1]=a;let l=n>>1;for(;i.length<l;)i.push(rt.empty);i.push(a?e.slice(s,s+a):rt.empty)}s+=a}return new Mt(t,i)}compose(e){return this.empty?e:e.empty?this:jv(this,e,!0)}map(e,t=!1){return e.empty?this:Yh(this,e,t,!0)}iterChanges(e,t=!1){qh(this,e,t)}get desc(){return Pi.create(this.sections)}filter(e){let t=[],i=[],n=[],s=new _o(this);e:for(let a=0,o=0;;){let l=a==e.length?1e9:e[a++];for(;o<l||o==l&&s.len==0;){if(s.done)break e;let f=Math.min(s.len,l-o);tr(n,f,-1);let h=s.ins==-1?-1:s.off==0?s.ins:0;tr(t,f,h),h>0&&_n(i,t,s.text),s.forward(f),o+=f}let c=e[a++];for(;o<c;){if(s.done)break e;let f=Math.min(s.len,c-o);tr(t,f,-1),tr(n,f,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(f),o+=f}}return{changes:new Mt(t,i),filtered:Pi.create(n)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],n=this.sections[t+1];n<0?e.push(i):n==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let n=[],s=[],a=0,o=null;function l(f=!1){if(!f&&!n.length)return;a<t&&tr(n,t-a,-1);let h=new Mt(n,s);o=o?o.compose(h.map(o)):h,n=[],s=[],a=0}function c(f){if(Array.isArray(f))for(let h of f)c(h);else if(f instanceof Mt){if(f.length!=t)throw new RangeError(`Mismatched change set length (got ${f.length}, expected ${t})`);l(),o=o?o.compose(f.map(o)):f}else{let{from:h,to:u=h,insert:d}=f;if(h>u||h<0||u>t)throw new RangeError(`Invalid change range ${h} to ${u} (in doc of length ${t})`);let m=d?typeof d=="string"?rt.of(d.split(i||Xh)):d:rt.empty,p=m.length;if(h==u&&p==0)return;h<a&&l(),h>a&&tr(n,h-a,-1),tr(n,u-h,p),_n(s,n,m),a=u}}return c(e),l(!o),o}static empty(e){return new Mt(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let n=0;n<e.length;n++){let s=e[n];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((a,o)=>o&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;i.length<n;)i.push(rt.empty);i[n]=rt.of(s.slice(1)),t.push(s[0],i[n].length)}}}return new Mt(t,i)}static createSet(e,t){return new Mt(e,t)}}function tr(r,e,t,i=!1){if(e==0&&t<=0)return;let n=r.length-2;n>=0&&t<=0&&t==r[n+1]?r[n]+=e:n>=0&&e==0&&r[n]==0?r[n+1]+=t:i?(r[n]+=e,r[n+1]+=t):r.push(e,t)}function _n(r,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<r.length)r[r.length-1]=r[r.length-1].append(t);else{for(;r.length<i;)r.push(rt.empty);r.push(t)}}function qh(r,e,t){let i=r.inserted;for(let n=0,s=0,a=0;a<r.sections.length;){let o=r.sections[a++],l=r.sections[a++];if(l<0)n+=o,s+=o;else{let c=n,f=s,h=rt.empty;for(;c+=o,f+=l,l&&i&&(h=h.append(i[a-2>>1])),!(t||a==r.sections.length||r.sections[a+1]<0);)o=r.sections[a++],l=r.sections[a++];e(n,c,s,f,h),n=c,s=f}}}function Yh(r,e,t,i=!1){let n=[],s=i?[]:null,a=new _o(r),o=new _o(e);for(let l=-1;;){if(a.done&&o.len||o.done&&a.len)throw new Error("Mismatched change set lengths");if(a.ins==-1&&o.ins==-1){let c=Math.min(a.len,o.len);tr(n,c,-1),a.forward(c),o.forward(c)}else if(o.ins>=0&&(a.ins<0||l==a.i||a.off==0&&(o.len<a.len||o.len==a.len&&!t))){let c=o.len;for(tr(n,o.ins,-1);c;){let f=Math.min(a.len,c);a.ins>=0&&l<a.i&&a.len<=f&&(tr(n,0,a.ins),s&&_n(s,n,a.text),l=a.i),a.forward(f),c-=f}o.next()}else if(a.ins>=0){let c=0,f=a.len;for(;f;)if(o.ins==-1){let h=Math.min(f,o.len);c+=h,f-=h,o.forward(h)}else if(o.ins==0&&o.len<f)f-=o.len,o.next();else break;tr(n,c,l<a.i?a.ins:0),s&&l<a.i&&_n(s,n,a.text),l=a.i,a.forward(a.len-f)}else{if(a.done&&o.done)return s?Mt.createSet(n,s):Pi.create(n);throw new Error("Mismatched change set lengths")}}}function jv(r,e,t=!1){let i=[],n=t?[]:null,s=new _o(r),a=new _o(e);for(let o=!1;;){if(s.done&&a.done)return n?Mt.createSet(i,n):Pi.create(i);if(s.ins==0)tr(i,s.len,0,o),s.next();else if(a.len==0&&!a.done)tr(i,0,a.ins,o),n&&_n(n,i,a.text),a.next();else{if(s.done||a.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,a.len),c=i.length;if(s.ins==-1){let f=a.ins==-1?-1:a.off?0:a.ins;tr(i,l,f,o),n&&f&&_n(n,i,a.text)}else a.ins==-1?(tr(i,s.off?0:s.len,l,o),n&&_n(n,i,s.textBit(l))):(tr(i,s.off?0:s.len,a.off?0:a.ins,o),n&&!a.off&&_n(n,i,a.text));o=(s.ins>l||a.ins>=0&&a.len>l)&&(o||i.length>c),s.forward2(l),a.forward(l)}}}}class _o{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?rt.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?rt.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class es{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let i,n;return this.empty?i=n=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),n=e.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new es(i,n,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return ke.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return ke.range(this.anchor,i)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return ke.range(e.anchor,e.head)}static create(e,t,i){return new es(e,t,i)}}class ke{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:ke.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new ke([this.main],0)}addRange(e,t=!0){return ke.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,ke.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new ke(e.ranges.map(t=>es.fromJSON(t)),e.main)}static single(e,t=e){return new ke([ke.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<e.length;n++){let s=e[n];if(s.empty?s.from<=i:s.from<i)return ke.normalized(e.slice(),t);i=s.to}return new ke(e,t)}static cursor(e,t=0,i,n){return es.create(e,e,(t==0?0:t<0?8:16)|(i==null?7:Math.min(6,i))|(n??16777215)<<6)}static range(e,t,i,n){let s=(i??16777215)<<6|(n==null?7:Math.min(6,n));return t<e?es.create(t,e,48|s):es.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let i=e[t];e.sort((n,s)=>n.from-s.from),t=e.indexOf(i);for(let n=1;n<e.length;n++){let s=e[n],a=e[n-1];if(s.empty?s.from<=a.to:s.from<a.to){let o=a.from,l=Math.max(s.to,a.to);n<=t&&t--,e.splice(--n,2,s.anchor>s.head?ke.range(l,o):ke.range(o,l))}}return new ke(e,t)}}function $v(r,e){for(let t of r.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let L0=0;class Re{constructor(e,t,i,n,s){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=n,this.id=L0++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new Re(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:B0),!!e.static,e.enables)}of(e){return new ql([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new ql(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new ql(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function B0(r,e){return r==e||r.length==e.length&&r.every((t,i)=>t===e[i])}class ql{constructor(e,t,i,n){this.dependencies=e,this.facet=t,this.type=i,this.value=n,this.id=L0++}dynamicSlot(e){var t;let i=this.value,n=this.facet.compareInput,s=this.id,a=e[s]>>1,o=this.type==2,l=!1,c=!1,f=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?c=!0:((t=e[h.id])!==null&&t!==void 0?t:1)&1||f.push(e[h.id]);return{create(h){return h.values[a]=i(h),1},update(h,u){if(l&&u.docChanged||c&&(u.docChanged||u.selection)||Jh(h,f)){let d=i(h);if(o?!Qp(d,h.values[a],n):!n(d,h.values[a]))return h.values[a]=d,1}return 0},reconfigure:(h,u)=>{let d,m=u.config.address[s];if(m!=null){let p=Cc(u,m);if(this.dependencies.every(g=>g instanceof Re?u.facet(g)===h.facet(g):g instanceof Yt?u.field(g,!1)==h.field(g,!1):!0)||(o?Qp(d=i(h),p,n):n(d=i(h),p)))return h.values[a]=p,0}else d=i(h);return h.values[a]=d,1}}}}function Qp(r,e,t){if(r.length!=e.length)return!1;for(let i=0;i<r.length;i++)if(!t(r[i],e[i]))return!1;return!0}function Jh(r,e){let t=!1;for(let i of e)to(r,i)&1&&(t=!0);return t}function i8(r,e,t){let i=t.map(l=>r[l.id]),n=t.map(l=>l.type),s=i.filter(l=>!(l&1)),a=r[e.id]>>1;function o(l){let c=[];for(let f=0;f<i.length;f++){let h=Cc(l,i[f]);if(n[f]==2)for(let u of h)c.push(u);else c.push(h)}return e.combine(c)}return{create(l){for(let c of i)to(l,c);return l.values[a]=o(l),1},update(l,c){if(!Jh(l,s))return 0;let f=o(l);return e.compare(f,l.values[a])?0:(l.values[a]=f,1)},reconfigure(l,c){let f=Jh(l,i),h=c.config.facets[e.id],u=c.facet(e);if(h&&!f&&B0(t,h))return l.values[a]=u,0;let d=o(l);return e.compare(d,u)?(l.values[a]=u,0):(l.values[a]=d,1)}}}const yl=Re.define({static:!0});class Yt{constructor(e,t,i,n,s){this.id=e,this.createF=t,this.updateF=i,this.compareF=n,this.spec=s,this.provides=void 0}static define(e){let t=new Yt(L0++,e.create,e.update,e.compare||((i,n)=>i===n),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(yl).find(i=>i.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,n)=>{let s=i.values[t],a=this.updateF(s,n);return this.compareF(s,a)?0:(i.values[t]=a,1)},reconfigure:(i,n)=>{let s=i.facet(yl),a=n.facet(yl),o;return(o=s.find(l=>l.field==this))&&o!=a.find(l=>l.field==this)?(i.values[t]=o.create(i),1):n.config.address[this.id]!=null?(i.values[t]=n.field(this),0):(i.values[t]=this.create(i),1)}}}init(e){return[this,yl.of({field:this,create:e})]}get extension(){return this}}const Yn={lowest:4,low:3,default:2,high:1,highest:0};function ka(r){return e=>new Gv(e,r)}const bs={highest:ka(Yn.highest),high:ka(Yn.high),default:ka(Yn.default),low:ka(Yn.low),lowest:ka(Yn.lowest)};class Gv{constructor(e,t){this.inner=e,this.prec=t}}class Xo{of(e){return new Zh(this,e)}reconfigure(e){return Xo.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Zh{constructor(e,t){this.compartment=e,this.inner=t}}class Ec{constructor(e,t,i,n,s,a){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=n,this.staticValues=s,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let n=[],s=Object.create(null),a=new Map;for(let u of n8(e,t,a))u instanceof Yt?n.push(u):(s[u.facet.id]||(s[u.facet.id]=[])).push(u);let o=Object.create(null),l=[],c=[];for(let u of n)o[u.id]=c.length<<1,c.push(d=>u.slot(d));let f=i==null?void 0:i.config.facets;for(let u in s){let d=s[u],m=d[0].facet,p=f&&f[u]||[];if(d.every(g=>g.type==0))if(o[m.id]=l.length<<1|1,B0(p,d))l.push(i.facet(m));else{let g=m.combine(d.map(x=>x.value));l.push(i&&m.compare(g,i.facet(m))?i.facet(m):g)}else{for(let g of d)g.type==0?(o[g.id]=l.length<<1|1,l.push(g.value)):(o[g.id]=c.length<<1,c.push(x=>g.dynamicSlot(x)));o[m.id]=c.length<<1,c.push(g=>i8(g,m,d))}}let h=c.map(u=>u(o));return new Ec(e,a,h,o,l,s)}}function n8(r,e,t){let i=[[],[],[],[],[]],n=new Map;function s(a,o){let l=n.get(a);if(l!=null){if(l<=o)return;let c=i[l].indexOf(a);c>-1&&i[l].splice(c,1),a instanceof Zh&&t.delete(a.compartment)}if(n.set(a,o),Array.isArray(a))for(let c of a)s(c,o);else if(a instanceof Zh){if(t.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(a.compartment)||a.inner;t.set(a.compartment,c),s(c,o)}else if(a instanceof Gv)s(a.inner,a.prec);else if(a instanceof Yt)i[o].push(a),a.provides&&s(a.provides,o);else if(a instanceof ql)i[o].push(a),a.facet.extensions&&s(a.facet.extensions,Yn.default);else{let c=a.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(c,o)}}return s(r,Yn.default),i.reduce((a,o)=>a.concat(o))}function to(r,e){if(e&1)return 2;let t=e>>1,i=r.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;r.status[t]=4;let n=r.computeSlot(r,r.config.dynamicSlots[t]);return r.status[t]=2|n}function Cc(r,e){return e&1?r.config.staticValues[e>>1]:r.values[e>>1]}const Kv=Re.define(),Qh=Re.define({combine:r=>r.some(e=>e),static:!0}),Xv=Re.define({combine:r=>r.length?r[0]:void 0,static:!0}),qv=Re.define(),Yv=Re.define(),Jv=Re.define(),Zv=Re.define({combine:r=>r.length?r[0]:!1});class hn{constructor(e,t){this.type=e,this.value=t}static define(){return new s8}}class s8{of(e){return new hn(this,e)}}class a8{constructor(e){this.map=e}of(e){return new Xe(this,e)}}class Xe{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new Xe(this.type,t)}is(e){return this.type==e}static define(e={}){return new a8(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let n of e){let s=n.map(t);s&&i.push(s)}return i}}Xe.reconfigure=Xe.define();Xe.appendConfig=Xe.define();class Lt{constructor(e,t,i,n,s,a){this.startState=e,this.changes=t,this.selection=i,this.effects=n,this.annotations=s,this.scrollIntoView=a,this._doc=null,this._state=null,i&&$v(i,t.newLength),s.some(o=>o.type==Lt.time)||(this.annotations=s.concat(Lt.time.of(Date.now())))}static create(e,t,i,n,s,a){return new Lt(e,t,i,n,s,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Lt.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Lt.time=hn.define();Lt.userEvent=hn.define();Lt.addToHistory=hn.define();Lt.remote=hn.define();function o8(r,e){let t=[];for(let i=0,n=0;;){let s,a;if(i<r.length&&(n==e.length||e[n]>=r[i]))s=r[i++],a=r[i++];else if(n<e.length)s=e[n++],a=e[n++];else return t;!t.length||t[t.length-1]<s?t.push(s,a):t[t.length-1]<a&&(t[t.length-1]=a)}}function Qv(r,e,t){var i;let n,s,a;return t?(n=e.changes,s=Mt.empty(e.changes.length),a=r.changes.compose(e.changes)):(n=e.changes.map(r.changes),s=r.changes.mapDesc(e.changes,!0),a=r.changes.compose(n)),{changes:a,selection:e.selection?e.selection.map(s):(i=r.selection)===null||i===void 0?void 0:i.map(n),effects:Xe.mapEffects(r.effects,n).concat(Xe.mapEffects(e.effects,s)),annotations:r.annotations.length?r.annotations.concat(e.annotations):e.annotations,scrollIntoView:r.scrollIntoView||e.scrollIntoView}}function eu(r,e,t){let i=e.selection,n=$s(e.annotations);return e.userEvent&&(n=n.concat(Lt.userEvent.of(e.userEvent))),{changes:e.changes instanceof Mt?e.changes:Mt.of(e.changes||[],t,r.facet(Xv)),selection:i&&(i instanceof ke?i:ke.single(i.anchor,i.head)),effects:$s(e.effects),annotations:n,scrollIntoView:!!e.scrollIntoView}}function e2(r,e,t){let i=eu(r,e.length?e[0]:{},r.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let a=!!e[s].sequential;i=Qv(i,eu(r,e[s],a?i.changes.newLength:r.doc.length),a)}let n=Lt.create(r,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return c8(t?l8(n):n)}function l8(r){let e=r.startState,t=!0;for(let n of e.facet(qv)){let s=n(r);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:o8(t,s))}if(t!==!0){let n,s;if(t===!1)s=r.changes.invertedDesc,n=Mt.empty(e.doc.length);else{let a=r.changes.filter(t);n=a.changes,s=a.filtered.mapDesc(a.changes).invertedDesc}r=Lt.create(e,n,r.selection&&r.selection.map(s),Xe.mapEffects(r.effects,s),r.annotations,r.scrollIntoView)}let i=e.facet(Yv);for(let n=i.length-1;n>=0;n--){let s=i[n](r);s instanceof Lt?r=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Lt?r=s[0]:r=e2(e,$s(s),!1)}return r}function c8(r){let e=r.startState,t=e.facet(Jv),i=r;for(let n=t.length-1;n>=0;n--){let s=t[n](r);s&&Object.keys(s).length&&(i=Qv(i,eu(e,s,r.changes.newLength),!0))}return i==r?r:Lt.create(e,r.changes,r.selection,i.effects,i.annotations,i.scrollIntoView)}const f8=[];function $s(r){return r==null?f8:Array.isArray(r)?r:[r]}var gt=function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r}(gt||(gt={}));const h8=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let tu;try{tu=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function u8(r){if(tu)return tu.test(r);for(let e=0;e<r.length;e++){let t=r[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||h8.test(t)))return!0}return!1}function d8(r){return e=>{if(!/\S/.test(e))return gt.Space;if(u8(e))return gt.Word;for(let t=0;t<r.length;t++)if(e.indexOf(r[t])>-1)return gt.Word;return gt.Other}}class Je{constructor(e,t,i,n,s,a){this.config=e,this.doc=t,this.selection=i,this.values=n,this.status=e.statusTemplate.slice(),this.computeSlot=s,a&&(a._state=this);for(let o=0;o<this.config.dynamicSlots.length;o++)to(this,o<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return to(this,i),Cc(this,i)}update(...e){return e2(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:n}=t;for(let o of e.effects)o.is(Xo.reconfigure)?(t&&(n=new Map,t.compartments.forEach((l,c)=>n.set(c,l)),t=null),n.set(o.value.compartment,o.value.extension)):o.is(Xe.reconfigure)?(t=null,i=o.value):o.is(Xe.appendConfig)&&(t=null,i=$s(i).concat(o.value));let s;t?s=e.startState.values.slice():(t=Ec.resolve(i,n,this),s=new Je(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,c)=>c.reconfigure(l,this),null).values);let a=e.startState.facet(Qh)?e.newSelection:e.newSelection.asSingle();new Je(t,e.newDoc,a,s,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:ke.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),n=this.changes(i.changes),s=[i.range],a=$s(i.effects);for(let o=1;o<t.ranges.length;o++){let l=e(t.ranges[o]),c=this.changes(l.changes),f=c.map(n);for(let u=0;u<o;u++)s[u]=s[u].map(f);let h=n.mapDesc(c,!0);s.push(l.range.map(h)),n=n.compose(f),a=Xe.mapEffects(a,f).concat(Xe.mapEffects($s(l.effects),h))}return{changes:n,selection:ke.create(s,t.mainIndex),effects:a}}changes(e=[]){return e instanceof Mt?e:Mt.of(e,this.doc.length,this.facet(Je.lineSeparator))}toText(e){return rt.of(e.split(this.facet(Je.lineSeparator)||Xh))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(to(this,t),Cc(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let n=e[i];n instanceof Yt&&this.config.address[n.id]!=null&&(t[i]=n.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i){for(let s in i)if(Object.prototype.hasOwnProperty.call(e,s)){let a=i[s],o=e[s];n.push(a.init(l=>a.spec.fromJSON(o,l)))}}return Je.create({doc:e.doc,selection:ke.fromJSON(e.selection),extensions:t.extensions?n.concat([t.extensions]):n})}static create(e={}){let t=Ec.resolve(e.extensions||[],new Map),i=e.doc instanceof rt?e.doc:rt.of((e.doc||"").split(t.staticFacet(Je.lineSeparator)||Xh)),n=e.selection?e.selection instanceof ke?e.selection:ke.single(e.selection.anchor,e.selection.head):ke.single(0);return $v(n,i.length),t.staticFacet(Qh)||(n=n.asSingle()),new Je(t,i,n,t.dynamicSlots.map(()=>null),(s,a)=>a.create(s),null)}get tabSize(){return this.facet(Je.tabSize)}get lineBreak(){return this.facet(Je.lineSeparator)||`
`}get readOnly(){return this.facet(Zv)}phrase(e,...t){for(let i of this.facet(Je.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(i,n)=>{if(n=="$")return"$";let s=+(n||1);return!s||s>t.length?i:t[s-1]})),e}languageDataAt(e,t,i=-1){let n=[];for(let s of this.facet(Kv))for(let a of s(this,t,i))Object.prototype.hasOwnProperty.call(a,e)&&n.push(a[e]);return n}charCategorizer(e){return d8(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:n}=this.doc.lineAt(e),s=this.charCategorizer(e),a=e-i,o=e-i;for(;a>0;){let l=Kt(t,a,!1);if(s(t.slice(l,a))!=gt.Word)break;a=l}for(;o<n;){let l=Kt(t,o);if(s(t.slice(o,l))!=gt.Word)break;o=l}return a==o?null:ke.range(a+i,o+i)}}Je.allowMultipleSelections=Qh;Je.tabSize=Re.define({combine:r=>r.length?r[0]:4});Je.lineSeparator=Xv;Je.readOnly=Zv;Je.phrases=Re.define({compare(r,e){let t=Object.keys(r),i=Object.keys(e);return t.length==i.length&&t.every(n=>r[n]==e[n])}});Je.languageData=Kv;Je.changeFilter=qv;Je.transactionFilter=Yv;Je.transactionExtender=Jv;Xo.reconfigure=Xe.define();function Wi(r,e,t={}){let i={};for(let n of r)for(let s of Object.keys(n)){let a=n[s],o=i[s];if(o===void 0)i[s]=a;else if(!(o===a||a===void 0))if(Object.hasOwnProperty.call(t,s))i[s]=t[s](o,a);else throw new Error("Config merge conflict for field "+s)}for(let n in e)i[n]===void 0&&(i[n]=e[n]);return i}class fs{eq(e){return this==e}range(e,t=e){return ru.create(e,t,this)}}fs.prototype.startSide=fs.prototype.endSide=0;fs.prototype.point=!1;fs.prototype.mapMode=yr.TrackDel;let ru=class t2{constructor(e,t,i){this.from=e,this.to=t,this.value=i}static create(e,t,i){return new t2(e,t,i)}};function iu(r,e){return r.from-e.from||r.value.startSide-e.value.startSide}class N0{constructor(e,t,i,n){this.from=e,this.to=t,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,n=0){let s=i?this.to:this.from;for(let a=n,o=s.length;;){if(a==o)return a;let l=a+o>>1,c=s[l]-e||(i?this.value[l].endSide:this.value[l].startSide)-t;if(l==a)return c>=0?a:o;c>=0?o=l:a=l+1}}between(e,t,i,n){for(let s=this.findIndex(t,-1e9,!0),a=this.findIndex(i,1e9,!1,s);s<a;s++)if(n(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let i=[],n=[],s=[],a=-1,o=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],f=this.from[l]+e,h=this.to[l]+e,u,d;if(f==h){let m=t.mapPos(f,c.startSide,c.mapMode);if(m==null||(u=d=m,c.startSide!=c.endSide&&(d=t.mapPos(f,c.endSide),d<u)))continue}else if(u=t.mapPos(f,c.startSide),d=t.mapPos(h,c.endSide),u>d||u==d&&c.startSide>0&&c.endSide<=0)continue;(d-u||c.endSide-c.startSide)<0||(a<0&&(a=u),c.point&&(o=Math.max(o,d-u)),i.push(c),n.push(u-a),s.push(d-a))}return{mapped:i.length?new N0(n,s,i,o):null,pos:a}}}class tt{constructor(e,t,i,n){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=n}static create(e,t,i,n){return new tt(e,t,i,n)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:n=0,filterTo:s=this.length}=e,a=e.filter;if(t.length==0&&!a)return this;if(i&&(t=t.slice().sort(iu)),this.isEmpty)return t.length?tt.of(t):this;let o=new r2(this,null,-1).goto(0),l=0,c=[],f=new an;for(;o.value||l<t.length;)if(l<t.length&&(o.from-t[l].from||o.startSide-t[l].value.startSide)>=0){let h=t[l++];f.addInner(h.from,h.to,h.value)||c.push(h)}else o.rangeIndex==1&&o.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(o.chunkIndex)<t[l].from)&&(!a||n>this.chunkEnd(o.chunkIndex)||s<this.chunkPos[o.chunkIndex])&&f.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!a||n>o.to||s<o.from||a(o.from,o.to,o.value))&&(f.addInner(o.from,o.to,o.value)||c.push(ru.create(o.from,o.to,o.value))),o.next());return f.finishInner(this.nextLayer.isEmpty&&!c.length?tt.empty:this.nextLayer.update({add:c,filter:a,filterFrom:n,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],n=-1;for(let a=0;a<this.chunk.length;a++){let o=this.chunkPos[a],l=this.chunk[a],c=e.touchesRange(o,o+l.length);if(c===!1)n=Math.max(n,l.maxPoint),t.push(l),i.push(e.mapPos(o));else if(c===!0){let{mapped:f,pos:h}=l.map(o,e);f&&(n=Math.max(n,f.maxPoint),t.push(f),i.push(h))}}let s=this.nextLayer.map(e);return t.length==0?s:new tt(i,t,s||tt.empty,n)}between(e,t,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let s=this.chunkPos[n],a=this.chunk[n];if(t>=s&&e<=s+a.length&&a.between(s,e-s,t-s,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return So.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return So.from(e).goto(t)}static compare(e,t,i,n,s=-1){let a=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),o=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),l=em(a,o,i),c=new ba(a,l,s),f=new ba(o,l,s);i.iterGaps((h,u,d)=>tm(c,h,f,u,d,n)),i.empty&&i.length==0&&tm(c,0,f,0,0,n)}static eq(e,t,i=0,n){n==null&&(n=999999999);let s=e.filter(f=>!f.isEmpty&&t.indexOf(f)<0),a=t.filter(f=>!f.isEmpty&&e.indexOf(f)<0);if(s.length!=a.length)return!1;if(!s.length)return!0;let o=em(s,a),l=new ba(s,o,0).goto(i),c=new ba(a,o,0).goto(i);for(;;){if(l.to!=c.to||!nu(l.active,c.active)||l.point&&(!c.point||!l.point.eq(c.point)))return!1;if(l.to>n)return!0;l.next(),c.next()}}static spans(e,t,i,n,s=-1){let a=new ba(e,null,s).goto(t),o=t,l=a.openStart;for(;;){let c=Math.min(a.to,i);if(a.point){let f=a.activeForPoint(a.to),h=a.pointFrom<t?f.length+1:a.point.startSide<0?f.length:Math.min(f.length,l);n.point(o,c,a.point,f,h,a.pointRank),l=Math.min(a.openEnd(c),f.length)}else c>o&&(n.span(o,c,a.active,l),l=a.openEnd(c));if(a.to>i)return l+(a.point&&a.to>i?1:0);o=a.to,a.next()}}static of(e,t=!1){let i=new an;for(let n of e instanceof ru?[e]:t?p8(e):e)i.add(n.from,n.to,n.value);return i.finish()}static join(e){if(!e.length)return tt.empty;let t=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let n=e[i];n!=tt.empty;n=n.nextLayer)t=new tt(n.chunkPos,n.chunk,t,Math.max(n.maxPoint,t.maxPoint));return t}}tt.empty=new tt([],[],null,-1);function p8(r){if(r.length>1)for(let e=r[0],t=1;t<r.length;t++){let i=r[t];if(iu(e,i)>0)return r.slice().sort(iu);e=i}return r}tt.empty.nextLayer=tt.empty;class an{finishChunk(e){this.chunks.push(new N0(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new an)).add(e,t,i)}addInner(e,t,i){let n=e-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(tt.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=tt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function em(r,e,t){let i=new Map;for(let s of r)for(let a=0;a<s.chunk.length;a++)s.chunk[a].maxPoint<=0&&i.set(s.chunk[a],s.chunkPos[a]);let n=new Set;for(let s of e)for(let a=0;a<s.chunk.length;a++){let o=i.get(s.chunk[a]);o!=null&&(t?t.mapPos(o):o)==s.chunkPos[a]&&!(t!=null&&t.touchesRange(o,o+s.chunk[a].length))&&n.add(s.chunk[a])}return n}class r2{constructor(e,t,i,n=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<e||n.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class So{constructor(e){this.heap=e}static from(e,t=null,i=-1){let n=[];for(let s=0;s<e.length;s++)for(let a=e[s];!a.isEmpty;a=a.nextLayer)a.maxPoint>=i&&n.push(new r2(a,t,i,s));return n.length==1?n[0]:new So(n)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)Jf(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)Jf(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Jf(this.heap,0)}}}function Jf(r,e){for(let t=r[e];;){let i=(e<<1)+1;if(i>=r.length)break;let n=r[i];if(i+1<r.length&&n.compare(r[i+1])>=0&&(n=r[i+1],i++),t.compare(n)<0)break;r[i]=t,r[e]=n,e=i}}class ba{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=So.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){wl(this.active,e),wl(this.activeTo,e),wl(this.activeRank,e),this.minActive=rm(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:n,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||n-this.activeTo[t])>0;)t++;kl(this.active,t,i),kl(this.activeTo,t,n),kl(this.activeRank,t,s),e&&kl(e,t,this.cursor.from),this.minActive=rm(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>e){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&wl(i,n)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let n=i.length-1;n>=0&&i[n]<e;n--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function tm(r,e,t,i,n,s){r.goto(e),t.goto(i);let a=i+n,o=i,l=i-e;for(;;){let c=r.to+l-t.to,f=c||r.endSide-t.endSide,h=f<0?r.to+l:t.to,u=Math.min(h,a);if(r.point||t.point?r.point&&t.point&&(r.point==t.point||r.point.eq(t.point))&&nu(r.activeForPoint(r.to),t.activeForPoint(t.to))||s.comparePoint(o,u,r.point,t.point):u>o&&!nu(r.active,t.active)&&s.compareRange(o,u,r.active,t.active),h>a)break;(c||r.openEnd!=t.openEnd)&&s.boundChange&&s.boundChange(h),o=h,f<=0&&r.next(),f>=0&&t.next()}}function nu(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!=e[t]&&!r[t].eq(e[t]))return!1;return!0}function wl(r,e){for(let t=e,i=r.length-1;t<i;t++)r[t]=r[t+1];r.pop()}function kl(r,e,t){for(let i=r.length-1;i>=e;i--)r[i+1]=r[i];r[e]=t}function rm(r,e){let t=-1,i=1e9;for(let n=0;n<e.length;n++)(e[n]-i||r[n].endSide-r[t].endSide)<0&&(t=n,i=e[n]);return t}function da(r,e,t=r.length){let i=0;for(let n=0;n<t&&n<r.length;)r.charCodeAt(n)==9?(i+=e-i%e,n++):(i++,n=Kt(r,n));return i}function su(r,e,t,i){for(let n=0,s=0;;){if(s>=e)return n;if(n==r.length)break;s+=r.charCodeAt(n)==9?t-s%t:1,n=Kt(r,n)}return i===!0?-1:r.length}const au="",im=typeof Symbol>"u"?"__"+au:Symbol.for(au),ou=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),nm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class In{constructor(e,t){this.rules=[];let{finish:i}=t||{};function n(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function s(a,o,l,c){let f=[],h=/^@(\w+)\b/.exec(a[0]),u=h&&h[1]=="keyframes";if(h&&o==null)return l.push(a[0]+";");for(let d in o){let m=o[d];if(/&/.test(d))s(d.split(/,\s*/).map(p=>a.map(g=>p.replace(/&/,g))).reduce((p,g)=>p.concat(g)),m,l);else if(m&&typeof m=="object"){if(!h)throw new RangeError("The value of a property ("+d+") should be a primitive value.");s(n(d),m,f,u)}else m!=null&&f.push(d.replace(/_.*/,"").replace(/[A-Z]/g,p=>"-"+p.toLowerCase())+": "+m+";")}(f.length||u)&&l.push((i&&!h&&!c?a.map(i):a).join(", ")+" {"+f.join(" ")+"}")}for(let a in e)s(n(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=nm[im]||1;return nm[im]=e+1,au+e.toString(36)}static mount(e,t,i){let n=e[ou],s=i&&i.nonce;n?s&&n.setNonce(s):n=new m8(e,s),n.mount(Array.isArray(t)?t:[t],e)}}let sm=new Map;class m8{constructor(e,t){let i=e.ownerDocument||e,n=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&n.CSSStyleSheet){let s=sm.get(i);if(s)return e[ou]=s;this.sheet=new n.CSSStyleSheet,sm.set(i,this)}else this.styleTag=i.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[ou]=this}mount(e,t){let i=this.sheet,n=0,s=0;for(let a=0;a<e.length;a++){let o=e[a],l=this.modules.indexOf(o);if(l<s&&l>-1&&(this.modules.splice(l,1),s--,l=-1),l==-1){if(this.modules.splice(s++,0,o),i)for(let c=0;c<o.rules.length;c++)i.insertRule(o.rules[c],n++)}else{for(;s<l;)n+=this.modules[s++].rules.length;n+=o.rules.length,s++}}if(i)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let a="";for(let l=0;l<this.modules.length;l++)a+=this.modules[l].getRules()+`
`;this.styleTag.textContent=a;let o=t.head||t;this.styleTag.parentNode!=o&&o.insertBefore(this.styleTag,o.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Pn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},To={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},g8=typeof navigator<"u"&&/Mac/.test(navigator.platform),x8=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Gt=0;Gt<10;Gt++)Pn[48+Gt]=Pn[96+Gt]=String(Gt);for(var Gt=1;Gt<=24;Gt++)Pn[Gt+111]="F"+Gt;for(var Gt=65;Gt<=90;Gt++)Pn[Gt]=String.fromCharCode(Gt+32),To[Gt]=String.fromCharCode(Gt);for(var Zf in Pn)To.hasOwnProperty(Zf)||(To[Zf]=Pn[Zf]);function v8(r){var e=g8&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||x8&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",t=!e&&r.key||(r.shiftKey?To:Pn)[r.keyCode]||r.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function at(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i];typeof n=="string"?r.setAttribute(i,n):n!=null&&(r[i]=n)}e++}for(;e<arguments.length;e++)i2(r,arguments[e]);return r}function i2(r,e){if(typeof e=="string")r.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)r.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)i2(r,e[t]);else throw new RangeError("Unsupported child node: "+e)}function Eo(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function lu(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function Yl(r,e){if(!e.anchorNode)return!1;try{return lu(r,e.anchorNode)}catch{return!1}}function ra(r){return r.nodeType==3?us(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function ro(r,e,t,i){return t?am(r,e,t,i,-1)||am(r,e,t,i,1):!1}function hs(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function Ac(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}function am(r,e,t,i,n){for(;;){if(r==t&&e==i)return!0;if(e==(n<0?0:Ui(r))){if(r.nodeName=="DIV")return!1;let s=r.parentNode;if(!s||s.nodeType!=1)return!1;e=hs(r)+(n<0?0:1),r=s}else if(r.nodeType==1){if(r=r.childNodes[e+(n<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=n<0?Ui(r):0}else return!1}}function Ui(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function qo(r,e){let t=e?r.left:r.right;return{left:t,right:t,top:r.top,bottom:r.bottom}}function y8(r){let e=r.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function n2(r,e){let t=e.width/r.offsetWidth,i=e.height/r.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-r.offsetWidth)<1)&&(t=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-r.offsetHeight)<1)&&(i=1),{scaleX:t,scaleY:i}}function w8(r,e,t,i,n,s,a,o){let l=r.ownerDocument,c=l.defaultView||window;for(let f=r,h=!1;f&&!h;)if(f.nodeType==1){let u,d=f==l.body,m=1,p=1;if(d)u=y8(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(f).position)&&(h=!0),f.scrollHeight<=f.clientHeight&&f.scrollWidth<=f.clientWidth){f=f.assignedSlot||f.parentNode;continue}let y=f.getBoundingClientRect();({scaleX:m,scaleY:p}=n2(f,y)),u={left:y.left,right:y.left+f.clientWidth*m,top:y.top,bottom:y.top+f.clientHeight*p}}let g=0,x=0;if(n=="nearest")e.top<u.top?(x=e.top-(u.top+a),t>0&&e.bottom>u.bottom+x&&(x=e.bottom-u.bottom+a)):e.bottom>u.bottom&&(x=e.bottom-u.bottom+a,t<0&&e.top-x<u.top&&(x=e.top-(u.top+a)));else{let y=e.bottom-e.top,w=u.bottom-u.top;x=(n=="center"&&y<=w?e.top+y/2-w/2:n=="start"||n=="center"&&t<0?e.top-a:e.bottom-w+a)-u.top}if(i=="nearest"?e.left<u.left?(g=e.left-(u.left+s),t>0&&e.right>u.right+g&&(g=e.right-u.right+s)):e.right>u.right&&(g=e.right-u.right+s,t<0&&e.left<u.left+g&&(g=e.left-(u.left+s))):g=(i=="center"?e.left+(e.right-e.left)/2-(u.right-u.left)/2:i=="start"==o?e.left-s:e.right-(u.right-u.left)+s)-u.left,g||x)if(d)c.scrollBy(g,x);else{let y=0,w=0;if(x){let T=f.scrollTop;f.scrollTop+=x/p,w=(f.scrollTop-T)*p}if(g){let T=f.scrollLeft;f.scrollLeft+=g/m,y=(f.scrollLeft-T)*m}e={left:e.left-y,top:e.top-w,right:e.right-y,bottom:e.bottom-w},y&&Math.abs(y-g)<1&&(i="nearest"),w&&Math.abs(w-x)<1&&(n="nearest")}if(d)break;(e.top<u.top||e.bottom>u.bottom||e.left<u.left||e.right>u.right)&&(e={left:Math.max(e.left,u.left),right:Math.min(e.right,u.right),top:Math.max(e.top,u.top),bottom:Math.min(e.bottom,u.bottom)}),f=f.assignedSlot||f.parentNode}else if(f.nodeType==11)f=f.host;else break}function k8(r){let e=r.ownerDocument,t,i;for(let n=r.parentNode;n&&!(n==e.body||t&&i);)if(n.nodeType==1)!i&&n.scrollHeight>n.clientHeight&&(i=n),!t&&n.scrollWidth>n.clientWidth&&(t=n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;return{x:t,y:i}}class b8{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:i}=e;this.set(t,Math.min(e.anchorOffset,t?Ui(t):0),i,Math.min(e.focusOffset,i?Ui(i):0))}set(e,t,i,n){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=n}}let Ts=null;function s2(r){if(r.setActive)return r.setActive();if(Ts)return r.focus(Ts);let e=[];for(let t=r;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(r.focus(Ts==null?{get preventScroll(){return Ts={preventScroll:!0},!0}}:void 0),!Ts){Ts=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let om;function us(r,e,t=e){let i=om||(om=document.createRange());return i.setEnd(r,t),i.setStart(r,e),i}function Gs(r,e,t,i){let n={key:e,code:e,keyCode:t,which:t,cancelable:!0};i&&({altKey:n.altKey,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey}=i);let s=new KeyboardEvent("keydown",n);s.synthetic=!0,r.dispatchEvent(s);let a=new KeyboardEvent("keyup",n);return a.synthetic=!0,r.dispatchEvent(a),s.defaultPrevented||a.defaultPrevented}function _8(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function a2(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function S8(r,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(i=Math.min(i,Ui(t));;)if(i){if(t.nodeType!=1)return!1;let n=t.childNodes[i-1];n.contentEditable=="false"?i--:(t=n,i=Ui(t))}else{if(t==r)return!0;i=hs(t),t=t.parentNode}}function o2(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}function l2(r,e){for(let t=r,i=e;;){if(t.nodeType==3&&i>0)return{node:t,offset:i};if(t.nodeType==1&&i>0){if(t.contentEditable=="false")return null;t=t.childNodes[i-1],i=Ui(t)}else if(t.parentNode&&!Ac(t))i=hs(t),t=t.parentNode;else return null}}function c2(r,e){for(let t=r,i=e;;){if(t.nodeType==3&&i<t.nodeValue.length)return{node:t,offset:i};if(t.nodeType==1&&i<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[i],i=0}else if(t.parentNode&&!Ac(t))i=hs(t)+1,t=t.parentNode;else return null}}class sr{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new sr(e.parentNode,hs(e),t)}static after(e,t){return new sr(e.parentNode,hs(e)+1,t)}}const U0=[];class ct{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let i=this.dom,n=null,s;for(let a of this.children){if(a.flags&7){if(!a.dom&&(s=n?n.nextSibling:i.firstChild)){let o=ct.get(s);(!o||!o.parent&&o.canReuseDOM(a))&&a.reuseDOM(s)}a.sync(e,t),a.flags&=-8}if(s=n?n.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&s!=a.dom&&(t.written=!0),a.dom.parentNode==i)for(;s&&s!=a.dom;)s=lm(s);else i.insertBefore(a.dom,s);n=a.dom}for(s=n?n.nextSibling:i.firstChild,s&&t&&t.node==i&&(t.written=!0);s;)s=lm(s)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,t),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let n=Ui(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;n==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?n=-1:n=1),e=s}n<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!ct.get(i);)i=i.nextSibling;if(!i)return this.length;for(let n=0,s=0;;n++){let a=this.children[n];if(a.dom==i)return s;s+=a.length+a.breakAfter}}domBoundsAround(e,t,i=0){let n=-1,s=-1,a=-1,o=-1;for(let l=0,c=i,f=i;l<this.children.length;l++){let h=this.children[l],u=c+h.length;if(c<e&&u>t)return h.domBoundsAround(e,t,c);if(u>=e&&n==-1&&(n=l,s=c),c>t&&h.dom.parentNode==this.dom){a=l,o=f;break}f=u,c=u+h.breakAfter}return{from:s,to:o<0?i+this.length:o,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:a<this.children.length&&a>=0?this.children[a].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=U0){this.markDirty();for(let n=e;n<t;n++){let s=this.children[n];s.parent==this&&i.indexOf(s)<0&&s.destroy()}i.length<250?this.children.splice(e,t-e,...i):this.children=[].concat(this.children.slice(0,e),i,this.children.slice(t));for(let n=0;n<i.length;n++)i[n].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new f2(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,i,n,s,a){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}ct.prototype.breakAfter=0;function lm(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class f2{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function h2(r,e,t,i,n,s,a,o,l){let{children:c}=r,f=c.length?c[e]:null,h=s.length?s[s.length-1]:null,u=h?h.breakAfter:a;if(!(e==i&&f&&!a&&!u&&s.length<2&&f.merge(t,n,s.length?h:null,t==0,o,l))){if(i<c.length){let d=c[i];d&&(n<d.length||d.breakAfter&&(h!=null&&h.breakAfter))?(e==i&&(d=d.split(n),n=0),!u&&h&&d.merge(0,n,h,!0,0,l)?s[s.length-1]=d:((n||d.children.length&&!d.children[0].length)&&d.merge(0,n,null,!1,0,l),s.push(d))):d!=null&&d.breakAfter&&(h?h.breakAfter=1:a=1),i++}for(f&&(f.breakAfter=a,t>0&&(!a&&s.length&&f.merge(t,f.length,s[0],!1,o,0)?f.breakAfter=s.shift().breakAfter:(t<f.length||f.children.length&&f.children[f.children.length-1].length==0)&&f.merge(t,f.length,null,!1,o,0),e++));e<i&&s.length;)if(c[i-1].become(s[s.length-1]))i--,s.pop(),l=s.length?0:o;else if(c[e].become(s[0]))e++,s.shift(),o=s.length?0:l;else break;!s.length&&e&&i<c.length&&!c[e-1].breakAfter&&c[i].merge(0,0,c[e-1],!1,o,l)&&e--,(e<i||s.length)&&r.replaceChildren(e,i,s)}}function u2(r,e,t,i,n,s){let a=r.childCursor(),{i:o,off:l}=a.findPos(t,1),{i:c,off:f}=a.findPos(e,-1),h=e-t;for(let u of i)h+=u.length;r.length+=h,h2(r,c,f,o,l,i,0,n,s)}let Fr=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},cu=typeof document<"u"?document:{documentElement:{style:{}}};const fu=/Edge\/(\d+)/.exec(Fr.userAgent),d2=/MSIE \d/.test(Fr.userAgent),hu=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Fr.userAgent),mf=!!(d2||hu||fu),cm=!mf&&/gecko\/(\d+)/i.test(Fr.userAgent),Qf=!mf&&/Chrome\/(\d+)/.exec(Fr.userAgent),T8="webkitFontSmoothing"in cu.documentElement.style,p2=!mf&&/Apple Computer/.test(Fr.vendor),fm=p2&&(/Mobile\/\w+/.test(Fr.userAgent)||Fr.maxTouchPoints>2);var De={mac:fm||/Mac/.test(Fr.platform),windows:/Win/.test(Fr.platform),linux:/Linux|X11/.test(Fr.platform),ie:mf,ie_version:d2?cu.documentMode||6:hu?+hu[1]:fu?+fu[1]:0,gecko:cm,gecko_version:cm?+(/Firefox\/(\d+)/.exec(Fr.userAgent)||[0,0])[1]:0,chrome:!!Qf,chrome_version:Qf?+Qf[1]:0,ios:fm,android:/Android\b/.test(Fr.userAgent),safari:p2,webkit_version:T8?+(/\bAppleWebKit\/(\d+)/.exec(Fr.userAgent)||[0,0])[1]:0,tabSize:cu.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const E8=256;class pi extends ct{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return this.flags&8||i&&(!(i instanceof pi)||this.length-(t-e)+i.length>E8||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new pi(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new sr(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return C8(this.dom,e,t)}}class on extends ct{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let n of t)n.setParent(this)}setAttrs(e){if(a2(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,i,n,s,a){return i&&(!(i instanceof on&&i.mark.eq(this.mark))||e&&s<=0||t<this.length&&a<=0)?!1:(u2(this,e,t,i?i.children.slice():[],s-1,a-1),this.markDirty(),!0)}split(e){let t=[],i=0,n=-1,s=0;for(let o of this.children){let l=i+o.length;l>e&&t.push(i<e?o.split(e-i):o),n<0&&i>=e&&(n=s),i=l,s++}let a=this.length-e;return this.length=e,n>-1&&(this.children.length=n,this.markDirty()),new on(this.mark,t,a)}domAtPos(e){return m2(this,e)}coordsAt(e,t){return x2(this,e,t)}}function C8(r,e,t){let i=r.nodeValue.length;e>i&&(e=i);let n=e,s=e,a=0;e==0&&t<0||e==i&&t>=0?De.chrome||De.gecko||(e?(n--,a=1):s<i&&(s++,a=-1)):t<0?n--:s<i&&s++;let o=us(r,n,s).getClientRects();if(!o.length)return null;let l=o[(a?a<0:t>=0)?0:o.length-1];return De.safari&&!a&&l.width==0&&(l=Array.prototype.find.call(o,c=>c.width)||l),a?qo(l,a<0):l||null}class Sn extends ct{static create(e,t,i){return new Sn(e,t,i)}constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}split(e){let t=Sn.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,i,n,s,a){return i&&(!(i instanceof Sn)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&a<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e instanceof Sn&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return rt.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,i=t&&t.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):rt.empty}domAtPos(e){return(this.length?e==0:this.side>0)?sr.before(this.dom):sr.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);if(i)return i;let n=this.dom.getClientRects(),s=null;if(!n.length)return null;let a=this.side?this.side<0:e>0;for(let o=a?n.length-1:0;s=n[o],!(e>0?o==0:o==n.length-1||s.top<s.bottom);o+=a?-1:1);return qo(s,!a)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class ia extends ct{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof ia&&e.side==this.side}split(){return new ia(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?sr.before(this.dom):sr.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return rt.empty}get isHidden(){return!0}}pi.prototype.children=Sn.prototype.children=ia.prototype.children=U0;function m2(r,e){let t=r.dom,{children:i}=r,n=0;for(let s=0;n<i.length;n++){let a=i[n],o=s+a.length;if(!(o==s&&a.getSide()<=0)){if(e>s&&e<o&&a.dom.parentNode==t)return a.domAtPos(e-s);if(e<=s)break;s=o}}for(let s=n;s>0;s--){let a=i[s-1];if(a.dom.parentNode==t)return a.domAtPos(a.length)}for(let s=n;s<i.length;s++){let a=i[s];if(a.dom.parentNode==t)return a.domAtPos(0)}return new sr(t,0)}function g2(r,e,t){let i,{children:n}=r;t>0&&e instanceof on&&n.length&&(i=n[n.length-1])instanceof on&&i.mark.eq(e.mark)?g2(i,e.children[0],t-1):(n.push(e),e.setParent(r)),r.length+=e.length}function x2(r,e,t){let i=null,n=-1,s=null,a=-1;function o(c,f){for(let h=0,u=0;h<c.children.length&&u<=f;h++){let d=c.children[h],m=u+d.length;m>=f&&(d.children.length?o(d,f-u):(!s||s.isHidden&&(t>0||O8(s,d)))&&(m>f||u==m&&d.getSide()>0)?(s=d,a=f-u):(u<f||u==m&&d.getSide()<0&&!d.isHidden)&&(i=d,n=f-u)),u=m}}o(r,e);let l=(t<0?i:s)||i||s;return l?l.coordsAt(Math.max(0,l==i?n:a),t):A8(r)}function A8(r){let e=r.dom.lastChild;if(!e)return r.dom.getBoundingClientRect();let t=ra(e);return t[t.length-1]||null}function O8(r,e){let t=r.coordsAt(0,1),i=e.coordsAt(0,1);return t&&i&&i.top<t.bottom}function uu(r,e){for(let t in r)t=="class"&&e.class?e.class+=" "+r.class:t=="style"&&e.style?e.style+=";"+r.style:e[t]=r[t];return e}const hm=Object.create(null);function Oc(r,e,t){if(r==e)return!0;r||(r=hm),e||(e=hm);let i=Object.keys(r),n=Object.keys(e);if(i.length-(t&&i.indexOf(t)>-1?1:0)!=n.length-(t&&n.indexOf(t)>-1?1:0))return!1;for(let s of i)if(s!=t&&(n.indexOf(s)==-1||r[s]!==e[s]))return!1;return!0}function du(r,e,t){let i=!1;if(e)for(let n in e)t&&n in t||(i=!0,n=="style"?r.style.cssText="":r.removeAttribute(n));if(t)for(let n in t)e&&e[n]==t[n]||(i=!0,n=="style"?r.style.cssText=t[n]:r.setAttribute(n,t[n]));return i}function F8(r){let e=Object.create(null);for(let t=0;t<r.attributes.length;t++){let i=r.attributes[t];e[i.name]=i.value}return e}class un{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var _r=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}(_r||(_r={}));class Be extends fs{constructor(e,t,i,n){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(e){return new Yo(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return t+=i&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Ln(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,n;if(e.isBlockGap)i=-5e8,n=4e8;else{let{start:s,end:a}=v2(e,t);i=(s?t?-3e8:-1:5e8)-1,n=(a?t?2e8:1:-6e8)+1}return new Ln(e,i,n,t,e.widget||null,!0)}static line(e){return new Jo(e)}static set(e,t=!1){return tt.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Be.none=tt.empty;class Yo extends Be{constructor(e){let{start:t,end:i}=v2(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,i;return this==e||e instanceof Yo&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&Oc(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Yo.prototype.point=!1;class Jo extends Be{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Jo&&this.spec.class==e.spec.class&&Oc(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Jo.prototype.mapMode=yr.TrackBefore;Jo.prototype.point=!0;class Ln extends Be{constructor(e,t,i,n,s,a){super(t,i,s,e),this.block=n,this.isReplace=a,this.mapMode=n?t<=0?yr.TrackBefore:yr.TrackAfter:yr.TrackDel}get type(){return this.startSide!=this.endSide?_r.WidgetRange:this.startSide<=0?_r.WidgetBefore:_r.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Ln&&D8(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Ln.prototype.point=!0;function v2(r,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=r;return t==null&&(t=r.inclusive),i==null&&(i=r.inclusive),{start:t??e,end:i??e}}function D8(r,e){return r==e||!!(r&&e&&r.compare(e))}function Jl(r,e,t,i=0){let n=t.length-1;n>=0&&t[n]+i>=r?t[n]=Math.max(t[n],e):t.push(r,e)}class Ot extends ct{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,n,s,a){if(i){if(!(i instanceof Ot))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),u2(this,e,t,i?i.children.slice():[],s,a),!0}split(e){let t=new Ot;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:n}=this.childPos(e);n&&(t.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let s=i;s<this.children.length;s++)t.append(this.children[s],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Oc(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){g2(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=uu(t,this.attrs||{})),i&&(this.attrs=uu({class:i},this.attrs||{}))}domAtPos(e){return m2(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var i;this.dom?this.flags&4&&(a2(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(du(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let n=this.dom.lastChild;for(;n&&ct.get(n)instanceof on;)n=n.lastChild;if(!n||!this.length||n.nodeName!="BR"&&((i=ct.get(n))===null||i===void 0?void 0:i.isEditable)==!1&&(!De.ios||!this.children.some(s=>s instanceof pi))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let i of this.children){if(!(i instanceof pi)||/[^ -~]/.test(i.text))return null;let n=ra(i.dom);if(n.length!=1)return null;e+=n[0].width,t=n[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let i=x2(this,e,t);if(!this.children.length&&i&&this.parent){let{heightOracle:n}=this.parent.view.viewState,s=i.bottom-i.top;if(Math.abs(s-n.lineHeight)<2&&n.textHeight<s){let a=(s-n.textHeight)/2;return{top:i.top+a,bottom:i.bottom-a,left:i.left,right:i.left}}}return i}become(e){return e instanceof Ot&&this.children.length==0&&e.children.length==0&&Oc(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let i=0,n=0;i<e.children.length;i++){let s=e.children[i],a=n+s.length;if(a>=t){if(s instanceof Ot)return s;if(a>t)break}n=a+s.breakAfter}return null}}class tn extends ct{constructor(e,t,i){super(),this.widget=e,this.length=t,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,n,s,a){return i&&(!(i instanceof tn)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&a<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?sr.before(this.dom):sr.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new tn(this.widget,t,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return U0}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):rt.empty}domBoundsAround(){return null}become(e){return e instanceof tn&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);return i||(this.widget instanceof pu?null:qo(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:i}=this.deco;return t==i?!1:e<0?t<0:i>0}}class pu extends un{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class io{constructor(e,t,i,n){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof tn&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Ot),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(bl(new ia(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof tn)&&this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:a,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=a,this.textOff=0}let n=Math.min(this.text.length-this.textOff,e),s=Math.min(n,512);this.flushBuffer(t.slice(t.length-i)),this.getLine().append(bl(new pi(this.text.slice(this.textOff,this.textOff+s)),t),i),this.atCursorPos=!0,this.textOff+=s,e-=s,i=n<=s?0:t.length}}span(e,t,i,n){this.buildText(t-e,i,n),this.pos=t,this.openStart<0&&(this.openStart=n)}point(e,t,i,n,s,a){if(this.disallowBlockEffectsFor[a]&&i instanceof Ln){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=t-e;if(i instanceof Ln)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new tn(i.widget||na.block,o,i));else{let l=Sn.create(i.widget||na.inline,o,o?0:i.startSide),c=this.atCursorPos&&!l.isEditable&&s<=n.length&&(e<t||i.startSide>0),f=!l.isEditable&&(e<t||s>n.length||i.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!c&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(n),c&&(h.append(bl(new ia(1),n),s),s=n.length+Math.max(0,s-n.length)),h.append(bl(l,n),s),this.atCursorPos=f,this.pendingBuffer=f?e<t||s>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,i,n,s){let a=new io(e,t,i,s);return a.openEnd=tt.spans(n,t,i,a),a.openStart<0&&(a.openStart=a.openEnd),a.finish(a.openEnd),a}}function bl(r,e){for(let t of e)r=new on(t,[r],r.length);return r}class na extends un{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}na.inline=new na("span");na.block=new na("div");var pt=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}(pt||(pt={}));const ds=pt.LTR,H0=pt.RTL;function y2(r){let e=[];for(let t=0;t<r.length;t++)e.push(1<<+r[t]);return e}const R8=y2("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),M8=y2("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),mu=Object.create(null),wi=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),t=r.charCodeAt(1);mu[e]=t,mu[t]=-e}function w2(r){return r<=247?R8[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?M8[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8204?256:64336<=r&&r<=65023?4:1}const I8=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Tn{get dir(){return this.level%2?H0:ds}constructor(e,t,i){this.from=e,this.to=t,this.level=i}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,i,n){let s=-1;for(let a=0;a<e.length;a++){let o=e[a];if(o.from<=t&&o.to>=t){if(o.level==i)return a;(s<0||(n!=0?n<0?o.from<t:o.to>t:e[s].level>o.level))&&(s=a)}}if(s<0)throw new RangeError("Index out of range");return s}}function k2(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++){let i=r[t],n=e[t];if(i.from!=n.from||i.to!=n.to||i.direction!=n.direction||!k2(i.inner,n.inner))return!1}return!0}const ot=[];function P8(r,e,t,i,n){for(let s=0;s<=i.length;s++){let a=s?i[s-1].to:e,o=s<i.length?i[s].from:t,l=s?256:n;for(let c=a,f=l,h=l;c<o;c++){let u=w2(r.charCodeAt(c));u==512?u=f:u==8&&h==4&&(u=16),ot[c]=u==4?2:u,u&7&&(h=u),f=u}for(let c=a,f=l,h=l;c<o;c++){let u=ot[c];if(u==128)c<o-1&&f==ot[c+1]&&f&24?u=ot[c]=f:ot[c]=256;else if(u==64){let d=c+1;for(;d<o&&ot[d]==64;)d++;let m=c&&f==8||d<t&&ot[d]==8?h==1?1:8:256;for(let p=c;p<d;p++)ot[p]=m;c=d-1}else u==8&&h==1&&(ot[c]=1);f=u,u&7&&(h=u)}}}function L8(r,e,t,i,n){let s=n==1?2:1;for(let a=0,o=0,l=0;a<=i.length;a++){let c=a?i[a-1].to:e,f=a<i.length?i[a].from:t;for(let h=c,u,d,m;h<f;h++)if(d=mu[u=r.charCodeAt(h)])if(d<0){for(let p=o-3;p>=0;p-=3)if(wi[p+1]==-d){let g=wi[p+2],x=g&2?n:g&4?g&1?s:n:0;x&&(ot[h]=ot[wi[p]]=x),o=p;break}}else{if(wi.length==189)break;wi[o++]=h,wi[o++]=u,wi[o++]=l}else if((m=ot[h])==2||m==1){let p=m==n;l=p?0:1;for(let g=o-3;g>=0;g-=3){let x=wi[g+2];if(x&2)break;if(p)wi[g+2]|=2;else{if(x&4)break;wi[g+2]|=4}}}}}function B8(r,e,t,i){for(let n=0,s=i;n<=t.length;n++){let a=n?t[n-1].to:r,o=n<t.length?t[n].from:e;for(let l=a;l<o;){let c=ot[l];if(c==256){let f=l+1;for(;;)if(f==o){if(n==t.length)break;f=t[n++].to,o=n<t.length?t[n].from:e}else if(ot[f]==256)f++;else break;let h=s==1,u=(f<e?ot[f]:i)==1,d=h==u?h?1:2:i;for(let m=f,p=n,g=p?t[p-1].to:r;m>l;)m==g&&(m=t[--p].from,g=p?t[p-1].to:r),ot[--m]=d;l=f}else s=c,l++}}}function gu(r,e,t,i,n,s,a){let o=i%2?2:1;if(i%2==n%2)for(let l=e,c=0;l<t;){let f=!0,h=!1;if(c==s.length||l<s[c].from){let p=ot[l];p!=o&&(f=!1,h=p==16)}let u=!f&&o==1?[]:null,d=f?i:i+1,m=l;e:for(;;)if(c<s.length&&m==s[c].from){if(h)break e;let p=s[c];if(!f)for(let g=p.to,x=c+1;;){if(g==t)break e;if(x<s.length&&s[x].from==g)g=s[x++].to;else{if(ot[g]==o)break e;break}}if(c++,u)u.push(p);else{p.from>l&&a.push(new Tn(l,p.from,d));let g=p.direction==ds!=!(d%2);xu(r,g?i+1:i,n,p.inner,p.from,p.to,a),l=p.to}m=p.to}else{if(m==t||(f?ot[m]!=o:ot[m]==o))break;m++}u?gu(r,l,m,i+1,n,u,a):l<m&&a.push(new Tn(l,m,d)),l=m}else for(let l=t,c=s.length;l>e;){let f=!0,h=!1;if(!c||l>s[c-1].to){let p=ot[l-1];p!=o&&(f=!1,h=p==16)}let u=!f&&o==1?[]:null,d=f?i:i+1,m=l;e:for(;;)if(c&&m==s[c-1].to){if(h)break e;let p=s[--c];if(!f)for(let g=p.from,x=c;;){if(g==e)break e;if(x&&s[x-1].to==g)g=s[--x].from;else{if(ot[g-1]==o)break e;break}}if(u)u.push(p);else{p.to<l&&a.push(new Tn(p.to,l,d));let g=p.direction==ds!=!(d%2);xu(r,g?i+1:i,n,p.inner,p.from,p.to,a),l=p.from}m=p.from}else{if(m==e||(f?ot[m-1]!=o:ot[m-1]==o))break;m--}u?gu(r,m,l,i+1,n,u,a):m<l&&a.push(new Tn(m,l,d)),l=m}}function xu(r,e,t,i,n,s,a){let o=e%2?2:1;P8(r,n,s,i,o),L8(r,n,s,i,o),B8(n,s,i,o),gu(r,n,s,e,t,i,a)}function N8(r,e,t){if(!r)return[new Tn(0,0,e==H0?1:0)];if(e==ds&&!t.length&&!I8.test(r))return b2(r.length);if(t.length)for(;r.length>ot.length;)ot[ot.length]=256;let i=[],n=e==ds?0:1;return xu(r,n,n,t,0,r.length,i),i}function b2(r){return[new Tn(0,r,0)]}let _2="";function U8(r,e,t,i,n){var s;let a=i.head-r.from,o=Tn.find(e,a,(s=i.bidiLevel)!==null&&s!==void 0?s:-1,i.assoc),l=e[o],c=l.side(n,t);if(a==c){let u=o+=n?1:-1;if(u<0||u>=e.length)return null;l=e[o=u],a=l.side(!n,t),c=l.side(n,t)}let f=Kt(r.text,a,l.forward(n,t));(f<l.from||f>l.to)&&(f=c),_2=r.text.slice(Math.min(a,f),Math.max(a,f));let h=o==(n?e.length-1:0)?null:e[o+(n?1:-1)];return h&&f==c&&h.level+(n?0:1)<l.level?ke.cursor(h.side(!n,t)+r.from,h.forward(n,t)?1:-1,h.level):ke.cursor(f+r.from,l.forward(n,t)?-1:1,l.level)}function H8(r,e,t){for(let i=e;i<t;i++){let n=w2(r.charCodeAt(i));if(n==1)return ds;if(n==2||n==4)return H0}return ds}const S2=Re.define(),T2=Re.define(),E2=Re.define(),C2=Re.define(),vu=Re.define(),A2=Re.define(),O2=Re.define(),z0=Re.define(),W0=Re.define(),F2=Re.define({combine:r=>r.some(e=>e)}),D2=Re.define({combine:r=>r.some(e=>e)}),R2=Re.define();class Ks{constructor(e,t="nearest",i="nearest",n=5,s=5,a=!1){this.range=e,this.y=t,this.x=i,this.yMargin=n,this.xMargin=s,this.isSnapshot=a}map(e){return e.empty?this:new Ks(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Ks(ke.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const _l=Xe.define({map:(r,e)=>r.map(e)}),M2=Xe.define();function Rr(r,e,t){let i=r.facet(C2);i.length?i[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const Yi=Re.define({combine:r=>r.length?r[0]:!0});let z8=0;const Rs=Re.define({combine(r){return r.filter((e,t)=>{for(let i=0;i<t;i++)if(r[i].plugin==e.plugin)return!1;return!0})}});class St{constructor(e,t,i,n,s){this.id=e,this.create=t,this.domEventHandlers=i,this.domEventObservers=n,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(Rs.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(Rs.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:i,eventObservers:n,provide:s,decorations:a}=t||{};return new St(z8++,e,i,n,o=>{let l=[];return a&&l.push(Co.of(c=>{let f=c.plugin(o);return f?a(f):Be.none})),s&&l.push(s(o)),l})}static fromClass(e,t){return St.define((i,n)=>new e(i,n),t)}}class eh{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(Rr(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){Rr(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){Rr(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const I2=Re.define(),V0=Re.define(),Co=Re.define(),P2=Re.define(),Zo=Re.define(),L2=Re.define();function um(r,e){let t=r.state.facet(L2);if(!t.length)return t;let i=t.map(s=>s instanceof Function?s(r):s),n=[];return tt.spans(i,e.from,e.to,{point(){},span(s,a,o,l){let c=s-e.from,f=a-e.from,h=n;for(let u=o.length-1;u>=0;u--,l--){let d=o[u].spec.bidiIsolate,m;if(d==null&&(d=H8(e.text,c,f)),l>0&&h.length&&(m=h[h.length-1]).to==c&&m.direction==d)m.to=f,h=m.inner;else{let p={from:c,to:f,direction:d,inner:[]};h.push(p),h=p.inner}}}}),n}const B2=Re.define();function j0(r){let e=0,t=0,i=0,n=0;for(let s of r.state.facet(B2)){let a=s(r);a&&(a.left!=null&&(e=Math.max(e,a.left)),a.right!=null&&(t=Math.max(t,a.right)),a.top!=null&&(i=Math.max(i,a.top)),a.bottom!=null&&(n=Math.max(n,a.bottom)))}return{left:e,right:t,top:i,bottom:n}}const Ra=Re.define();class Zr{constructor(e,t,i,n){this.fromA=e,this.toA=t,this.fromB=i,this.toB=n}join(e){return new Zr(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let n=e[t-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let n=0,s=0,a=0,o=0;;n++){let l=n==e.length?null:e[n],c=a-o,f=l?l.fromB:1e9;for(;s<t.length&&t[s]<f;){let h=t[s],u=t[s+1],d=Math.max(o,h),m=Math.min(f,u);if(d<=m&&new Zr(d+c,m+c,d,m).addToSet(i),u>f)break;s+=2}if(!l)return i;new Zr(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),a=l.toA,o=l.toB}}}class Fc{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=Mt.empty(this.startState.doc.length);for(let s of i)this.changes=this.changes.compose(s.changes);let n=[];this.changes.iterChangedRanges((s,a,o,l)=>n.push(new Zr(s,a,o,l))),this.changedRanges=n}static create(e,t,i){return new Fc(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class dm extends ct{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Be.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Ot],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Zr(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:c,toA:f})=>f<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?n=this.domChanged.newSel.head:!X8(e.changes,this.hasComposition)&&!e.selectionSet&&(n=e.state.selection.main.head));let s=n>-1?V8(this.view,e.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:f}=this.hasComposition;i=new Zr(c,f,e.changes.mapPos(c,-1),e.changes.mapPos(f,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(De.ie||De.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let a=this.decorations,o=this.updateDeco(),l=G8(a,o,e.changes);return i=Zr.extendWithRanges(i,l),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,i);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let a=De.chrome||De.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,a),this.flags&=-8,a&&(a.written||n.selectionRange.focusNode!=a.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(a=>a.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let a of this.children)a instanceof tn&&a.widget instanceof pu&&s.push(a.dom);n.updateGaps(s)}updateChildren(e,t,i){let n=i?i.range.addToSet(e.slice()):e,s=this.childCursor(t);for(let a=n.length-1;;a--){let o=a>=0?n[a]:null;if(!o)break;let{fromA:l,toA:c,fromB:f,toB:h}=o,u,d,m,p;if(i&&i.range.fromB<h&&i.range.toB>f){let T=io.build(this.view.state.doc,f,i.range.fromB,this.decorations,this.dynamicDecorationMap),C=io.build(this.view.state.doc,i.range.toB,h,this.decorations,this.dynamicDecorationMap);d=T.breakAtStart,m=T.openStart,p=C.openEnd;let R=this.compositionView(i);C.breakAtStart?R.breakAfter=1:C.content.length&&R.merge(R.length,R.length,C.content[0],!1,C.openStart,0)&&(R.breakAfter=C.content[0].breakAfter,C.content.shift()),T.content.length&&R.merge(0,0,T.content[T.content.length-1],!0,0,T.openEnd)&&T.content.pop(),u=T.content.concat(R).concat(C.content)}else({content:u,breakAtStart:d,openStart:m,openEnd:p}=io.build(this.view.state.doc,f,h,this.decorations,this.dynamicDecorationMap));let{i:g,off:x}=s.findPos(c,1),{i:y,off:w}=s.findPos(l,-1);h2(this,y,w,g,x,u,d,m,p)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let i of t.effects)i.is(M2)&&(this.editContextFormatting=i.value)}compositionView(e){let t=new pi(e.text.nodeValue);t.flags|=8;for(let{deco:n}of e.marks)t=new on(n,[t],t.length);let i=new Ot;return i.append(t,0),i}fixCompositionDOM(e){let t=(s,a)=>{a.flags|=8|(a.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(a);let o=ct.get(s);o&&o!=a&&(o.dom=null),a.setDOM(s)},i=this.childPos(e.range.fromB,1),n=this.children[i.i];t(e.line,n);for(let s=e.marks.length-1;s>=-1;s--)i=n.childPos(i.off,1),n=n.children[i.i],t(s>=0?e.marks[s].node:e.text,n)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,s=!n&&!(this.view.state.facet(Yi)||this.dom.tabIndex>-1)&&Yl(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||t||s))return;let a=this.forceSelection;this.forceSelection=!1;let o=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(o.anchor)),c=o.empty?l:this.moveToLine(this.domAtPos(o.head));if(De.gecko&&o.empty&&!this.hasComposition&&W8(l)){let h=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(h,l.node.childNodes[l.offset]||null)),l=c=new sr(h,0),a=!0}let f=this.view.observer.selectionRange;(a||!f.focusNode||(!ro(l.node,l.offset,f.anchorNode,f.anchorOffset)||!ro(c.node,c.offset,f.focusNode,f.focusOffset))&&!this.suppressWidgetCursorChange(f,o))&&(this.view.observer.ignore(()=>{De.android&&De.chrome&&this.dom.contains(f.focusNode)&&K8(f.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=Eo(this.view.root);if(h)if(o.empty){if(De.gecko){let u=j8(l.node,l.offset);if(u&&u!=3){let d=(u==1?l2:c2)(l.node,l.offset);d&&(l=new sr(d.node,d.offset))}}h.collapse(l.node,l.offset),o.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=o.bidiLevel)}else if(h.extend){h.collapse(l.node,l.offset);try{h.extend(c.node,c.offset)}catch{}}else{let u=document.createRange();o.anchor>o.head&&([l,c]=[c,l]),u.setEnd(c.node,c.offset),u.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(u)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new sr(f.anchorNode,f.anchorOffset),this.impreciseHead=c.precise?null:new sr(f.focusNode,f.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&ro(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,i=Eo(e.root),{anchorNode:n,anchorOffset:s}=e.observer.selectionRange;if(!i||!t.empty||!t.assoc||!i.modify)return;let a=Ot.find(this,t.head);if(!a)return;let o=a.posAtStart;if(t.head==o||t.head==o+a.length)return;let l=this.coordsAt(t.head,-1),c=this.coordsAt(t.head,1);if(!l||!c||l.bottom>c.top)return;let f=this.domAtPos(t.head+t.assoc);i.collapse(f.node,f.offset),i.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&i.collapse(n,s)}moveToLine(e){let t=this.dom,i;if(e.node!=t)return e;for(let n=e.offset;!i&&n<t.childNodes.length;n++){let s=ct.get(t.childNodes[n]);s instanceof Ot&&(i=s.domAtPos(0))}for(let n=e.offset-1;!i&&n>=0;n--){let s=ct.get(t.childNodes[n]);s instanceof Ot&&(i=s.domAtPos(s.length))}return i?new sr(i.node,i.offset,!0):e}nearest(e){for(let t=e;t;){let i=ct.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let n=this.children[t];if(i<n.length||n instanceof Ot)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){let i=null,n=0;for(let s=this.length,a=this.children.length-1;a>=0;a--){let o=this.children[a],l=s-o.breakAfter,c=l-o.length;if(l<e)break;if(c<=e&&(c<e||o.covers(-1))&&(l>e||o.covers(1))&&(!i||o instanceof Ot&&!(i instanceof Ot&&t>=0)))i=o,n=c;else if(i&&c==e&&l==e&&o instanceof tn&&Math.abs(t)<2){if(o.deco.startSide<0)break;a&&(i=null)}s=c}return i?i.coordsAt(e-n,t):null}coordsForChar(e){let{i:t,off:i}=this.childPos(e,1),n=this.children[t];if(!(n instanceof Ot))return null;for(;n.children.length;){let{i:o,off:l}=n.childPos(i,1);for(;;o++){if(o==n.children.length)return null;if((n=n.children[o]).length)break}i=l}if(!(n instanceof pi))return null;let s=Kt(n.text,i);if(s==i)return null;let a=us(n.dom,i,s).getClientRects();for(let o=0;o<a.length;o++){let l=a[o];if(o==a.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let t=[],{from:i,to:n}=e,s=this.view.contentDOM.clientWidth,a=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==pt.LTR;for(let c=0,f=0;f<this.children.length;f++){let h=this.children[f],u=c+h.length;if(u>n)break;if(c>=i){let d=h.dom.getBoundingClientRect();if(t.push(d.height),a){let m=h.dom.lastChild,p=m?ra(m):[];if(p.length){let g=p[p.length-1],x=l?g.right-d.left:d.right-g.left;x>o&&(o=x,this.minWidth=s,this.minWidthFrom=c,this.minWidthTo=u)}}}c=u+h.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?pt.RTL:pt.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Ot){let a=s.measureTextSize();if(a)return a}let e=document.createElement("div"),t,i,n;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=ra(e.firstChild)[0];t=e.getBoundingClientRect().height,i=s?s.width/27:7,n=s?s.height:t,e.remove()}),{lineHeight:t,charWidth:i,textHeight:n}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new f2(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,n=0;;n++){let s=n==t.viewports.length?null:t.viewports[n],a=s?s.from-1:this.length;if(a>i){let o=(t.lineBlockAt(a).bottom-t.lineBlockAt(i).top)/this.view.scaleY;e.push(Be.replace({widget:new pu(o),block:!0,inclusive:!0,isBlockGap:!0}).range(i,a))}if(!s)break;i=s.to+1}return Be.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Co).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),i=!1,n=this.view.state.facet(P2).map((s,a)=>{let o=typeof s=="function";return o&&(i=!0),o?s(this.view):s});for(n.length&&(this.dynamicDecorationMap[e++]=i,t.push(tt.join(n))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(R2))try{if(c(this.view,e.range,e))return!0}catch(f){Rr(this.view.state,f,"scroll handler")}let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),n;if(!i)return;!t.empty&&(n=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,n.left),top:Math.min(i.top,n.top),right:Math.max(i.right,n.right),bottom:Math.max(i.bottom,n.bottom)});let s=j0(this.view),a={left:i.left-s.left,top:i.top-s.top,right:i.right+s.right,bottom:i.bottom+s.bottom},{offsetWidth:o,offsetHeight:l}=this.view.scrollDOM;w8(this.view.scrollDOM,a,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==pt.LTR)}}function W8(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}function N2(r,e){let t=r.observer.selectionRange;if(!t.focusNode)return null;let i=l2(t.focusNode,t.focusOffset),n=c2(t.focusNode,t.focusOffset),s=i||n;if(n&&i&&n.node!=i.node){let o=ct.get(n.node);if(!o||o instanceof pi&&o.text!=n.node.nodeValue)s=n;else if(r.docView.lastCompositionAfterCursor){let l=ct.get(i.node);!l||l instanceof pi&&l.text!=i.node.nodeValue||(s=n)}}if(r.docView.lastCompositionAfterCursor=s!=i,!s)return null;let a=e-s.offset;return{from:a,to:a+s.node.nodeValue.length,node:s.node}}function V8(r,e,t){let i=N2(r,t);if(!i)return null;let{node:n,from:s,to:a}=i,o=n.nodeValue;if(/[\n\r]/.test(o)||r.state.doc.sliceString(i.from,i.to)!=o)return null;let l=e.invertedDesc,c=new Zr(l.mapPos(s),l.mapPos(a),s,a),f=[];for(let h=n.parentNode;;h=h.parentNode){let u=ct.get(h);if(u instanceof on)f.push({node:h,deco:u.mark});else{if(u instanceof Ot||h.nodeName=="DIV"&&h.parentNode==r.contentDOM)return{range:c,text:n,marks:f,line:h};if(h!=r.contentDOM)f.push({node:h,deco:new Yo({inclusive:!0,attributes:F8(h),tagName:h.tagName.toLowerCase()})});else return null}}}function j8(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}let $8=class{constructor(){this.changes=[]}compareRange(e,t){Jl(e,t,this.changes)}comparePoint(e,t){Jl(e,t,this.changes)}boundChange(e){Jl(e,e,this.changes)}};function G8(r,e,t){let i=new $8;return tt.compare(r,e,t,i),i.changes}function K8(r,e){for(let t=r;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function X8(r,e){let t=!1;return e&&r.iterChangedRanges((i,n)=>{i<e.to&&n>e.from&&(t=!0)}),t}function q8(r,e,t=1){let i=r.charCategorizer(e),n=r.doc.lineAt(e),s=e-n.from;if(n.length==0)return ke.cursor(e);s==0?t=1:s==n.length&&(t=-1);let a=s,o=s;t<0?a=Kt(n.text,s,!1):o=Kt(n.text,s);let l=i(n.text.slice(a,o));for(;a>0;){let c=Kt(n.text,a,!1);if(i(n.text.slice(c,a))!=l)break;a=c}for(;o<n.length;){let c=Kt(n.text,o);if(i(n.text.slice(o,c))!=l)break;o=c}return ke.range(a+n.from,o+n.from)}function Y8(r,e){return e.left>r?e.left-r:Math.max(0,r-e.right)}function J8(r,e){return e.top>r?e.top-r:Math.max(0,r-e.bottom)}function th(r,e){return r.top<e.bottom-1&&r.bottom>e.top+1}function pm(r,e){return e<r.top?{top:e,left:r.left,right:r.right,bottom:r.bottom}:r}function mm(r,e){return e>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:e}:r}function yu(r,e,t){let i,n,s,a,o=!1,l,c,f,h;for(let m=r.firstChild;m;m=m.nextSibling){let p=ra(m);for(let g=0;g<p.length;g++){let x=p[g];n&&th(n,x)&&(x=pm(mm(x,n.bottom),n.top));let y=Y8(e,x),w=J8(t,x);if(y==0&&w==0)return m.nodeType==3?gm(m,e,t):yu(m,e,t);(!i||a>w||a==w&&s>y)&&(i=m,n=x,s=y,a=w,o=y?e<x.left?g>0:g<p.length-1:!0),y==0?t>x.bottom&&(!f||f.bottom<x.bottom)?(l=m,f=x):t<x.top&&(!h||h.top>x.top)&&(c=m,h=x):f&&th(f,x)?f=mm(f,x.bottom):h&&th(h,x)&&(h=pm(h,x.top))}}if(f&&f.bottom>=t?(i=l,n=f):h&&h.top<=t&&(i=c,n=h),!i)return{node:r,offset:0};let u=Math.max(n.left,Math.min(n.right,e));if(i.nodeType==3)return gm(i,u,t);if(o&&i.contentEditable!="false")return yu(i,u,t);let d=Array.prototype.indexOf.call(r.childNodes,i)+(e>=(n.left+n.right)/2?1:0);return{node:r,offset:d}}function gm(r,e,t){let i=r.nodeValue.length,n=-1,s=1e9,a=0;for(let o=0;o<i;o++){let l=us(r,o,o+1).getClientRects();for(let c=0;c<l.length;c++){let f=l[c];if(f.top==f.bottom)continue;a||(a=e-f.left);let h=(f.top>t?f.top-t:t-f.bottom)-1;if(f.left-1<=e&&f.right+1>=e&&h<s){let u=e>=(f.left+f.right)/2,d=u;if((De.chrome||De.gecko)&&us(r,o).getBoundingClientRect().left==f.right&&(d=!u),h<=0)return{node:r,offset:o+(d?1:0)};n=o+(d?1:0),s=h}}}return{node:r,offset:n>-1?n:a>0?r.nodeValue.length:0}}function U2(r,e,t,i=-1){var n,s;let a=r.contentDOM.getBoundingClientRect(),o=a.top+r.viewState.paddingTop,l,{docHeight:c}=r.viewState,{x:f,y:h}=e,u=h-o;if(u<0)return 0;if(u>c)return r.state.doc.length;for(let T=r.viewState.heightOracle.textHeight/2,C=!1;l=r.elementAtHeight(u),l.type!=_r.Text;)for(;u=i>0?l.bottom+T:l.top-T,!(u>=0&&u<=c);){if(C)return t?null:0;C=!0,i=-i}h=o+u;let d=l.from;if(d<r.viewport.from)return r.viewport.from==0?0:t?null:xm(r,a,l,f,h);if(d>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:t?null:xm(r,a,l,f,h);let m=r.dom.ownerDocument,p=r.root.elementFromPoint?r.root:m,g=p.elementFromPoint(f,h);g&&!r.contentDOM.contains(g)&&(g=null),g||(f=Math.max(a.left+1,Math.min(a.right-1,f)),g=p.elementFromPoint(f,h),g&&!r.contentDOM.contains(g)&&(g=null));let x,y=-1;if(g&&((n=r.docView.nearest(g))===null||n===void 0?void 0:n.isEditable)!=!1){if(m.caretPositionFromPoint){let T=m.caretPositionFromPoint(f,h);T&&({offsetNode:x,offset:y}=T)}else if(m.caretRangeFromPoint){let T=m.caretRangeFromPoint(f,h);T&&({startContainer:x,startOffset:y}=T)}x&&(!r.contentDOM.contains(x)||De.safari&&Z8(x,y,f)||De.chrome&&Q8(x,y,f))&&(x=void 0),x&&(y=Math.min(Ui(x),y))}if(!x||!r.docView.dom.contains(x)){let T=Ot.find(r.docView,d);if(!T)return u>l.top+l.height/2?l.to:l.from;({node:x,offset:y}=yu(T.dom,f,h))}let w=r.docView.nearest(x);if(!w)return null;if(w.isWidget&&((s=w.dom)===null||s===void 0?void 0:s.nodeType)==1){let T=w.dom.getBoundingClientRect();return e.y<T.top||e.y<=T.bottom&&e.x<=(T.left+T.right)/2?w.posAtStart:w.posAtEnd}else return w.localPosFromDOM(x,y)+w.posAtStart}function xm(r,e,t,i,n){let s=Math.round((i-e.left)*r.defaultCharacterWidth);if(r.lineWrapping&&t.height>r.defaultLineHeight*1.5){let o=r.viewState.heightOracle.textHeight,l=Math.floor((n-t.top-(r.defaultLineHeight-o)*.5)/o);s+=l*r.viewState.heightOracle.lineLength}let a=r.state.sliceDoc(t.from,t.to);return t.from+su(a,s,r.state.tabSize)}function H2(r,e,t){let i,n=r;if(r.nodeType!=3||e!=(i=r.nodeValue.length))return!1;for(;;){let s=n.nextSibling;if(s){if(s.nodeName=="BR")break;return!1}else{let a=n.parentNode;if(!a||a.nodeName=="DIV")break;n=a}}return us(r,i-1,i).getBoundingClientRect().right>t}function Z8(r,e,t){return H2(r,e,t)}function Q8(r,e,t){if(e!=0)return H2(r,e,t);for(let n=r;;){let s=n.parentNode;if(!s||s.nodeType!=1||s.firstChild!=n)return!1;if(s.classList.contains("cm-line"))break;n=s}let i=r.nodeType==1?r.getBoundingClientRect():us(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return t-i.left>5}function wu(r,e,t){let i=r.lineBlockAt(e);if(Array.isArray(i.type)){let n;for(let s of i.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!n||s.type==_r.Text&&(n.type!=s.type||(t<0?s.from<e:s.to>e)))&&(n=s)}}return n||i}return i}function eD(r,e,t,i){let n=wu(r,e.head,e.assoc||-1),s=!i||n.type!=_r.Text||!(r.lineWrapping||n.widgetLineBreaks)?null:r.coordsAtPos(e.assoc<0&&e.head>n.from?e.head-1:e.head);if(s){let a=r.dom.getBoundingClientRect(),o=r.textDirectionAt(n.from),l=r.posAtCoords({x:t==(o==pt.LTR)?a.right-1:a.left+1,y:(s.top+s.bottom)/2});if(l!=null)return ke.cursor(l,t?-1:1)}return ke.cursor(t?n.to:n.from,t?-1:1)}function vm(r,e,t,i){let n=r.state.doc.lineAt(e.head),s=r.bidiSpans(n),a=r.textDirectionAt(n.from);for(let o=e,l=null;;){let c=U8(n,s,a,o,t),f=_2;if(!c){if(n.number==(t?r.state.doc.lines:1))return o;f=`
`,n=r.state.doc.line(n.number+(t?1:-1)),s=r.bidiSpans(n),c=r.visualLineSide(n,!t)}if(l){if(!l(f))return o}else{if(!i)return c;l=i(f)}o=c}}function tD(r,e,t){let i=r.state.charCategorizer(e),n=i(t);return s=>{let a=i(s);return n==gt.Space&&(n=a),n==a}}function rD(r,e,t,i){let n=e.head,s=t?1:-1;if(n==(t?r.state.doc.length:0))return ke.cursor(n,e.assoc);let a=e.goalColumn,o,l=r.contentDOM.getBoundingClientRect(),c=r.coordsAtPos(n,e.assoc||-1),f=r.documentTop;if(c)a==null&&(a=c.left-l.left),o=s<0?c.top:c.bottom;else{let d=r.viewState.lineBlockAt(n);a==null&&(a=Math.min(l.right-l.left,r.defaultCharacterWidth*(n-d.from))),o=(s<0?d.top:d.bottom)+f}let h=l.left+a,u=i??r.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let m=o+(u+d)*s,p=U2(r,{x:h,y:m},!1,s);if(m<l.top||m>l.bottom||(s<0?p<n:p>n)){let g=r.docView.coordsForChar(p),x=!g||m<g.top?-1:1;return ke.cursor(p,x,void 0,a)}}}function no(r,e,t){for(;;){let i=0;for(let n of r)n.between(e-1,e+1,(s,a,o)=>{if(e>s&&e<a){let l=i||t||(e-s<a-e?-1:1);e=l<0?s:a,i=l}});if(!i)return e}}function z2(r,e){let t=null;for(let i=0;i<e.ranges.length;i++){let n=e.ranges[i],s=null;if(n.empty){let a=no(r,n.from,0);a!=n.from&&(s=ke.cursor(a,-1))}else{let a=no(r,n.from,-1),o=no(r,n.to,1);(a!=n.from||o!=n.to)&&(s=ke.range(n.from==n.anchor?a:o,n.from==n.head?a:o))}s&&(t||(t=e.ranges.slice()),t[i]=s)}return t?ke.create(t,e.mainIndex):e}function rh(r,e,t){let i=no(r.state.facet(Zo).map(n=>n(r)),t.from,e.head>t.from?-1:1);return i==t.from?t:ke.cursor(i,i<t.from?1:-1)}const Ma="";class iD{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(Je.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Ma}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let n=e;;){this.findPointBefore(i,n);let s=this.text.length;this.readNode(n);let a=n.nextSibling;if(a==t)break;let o=ct.get(n),l=ct.get(a);(o&&l?o.breakAfter:(o?o.breakAfter:Ac(n))||Ac(a)&&(n.nodeName!="BR"||n.cmIgnore)&&this.text.length>s)&&this.lineBreak(),n=a}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,a=1,o;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,i),a=this.lineSeparator.length):(o=n.exec(t))&&(s=o.index,a=o[0].length),this.append(t.slice(i,s<0?t.length:s)),s<0)break;if(this.lineBreak(),a>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=a-1);i=s+a}}readNode(e){if(e.cmIgnore)return;let t=ct.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let n=i.iter();!n.next().done;)n.lineBreak?this.lineBreak():this.append(n.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(nD(e,i.node,i.offset)?t:0))}}function nD(r,e,t){for(;;){if(!e||t<Ui(e))return!1;if(e==r)return!0;t=hs(e)+1,e=e.parentNode}}class ym{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class sD{constructor(e,t,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,i,0))){let o=s||a?[]:lD(e),l=new iD(o,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=cD(o,this.bounds.from)}else{let o=e.observer.selectionRange,l=s&&s.node==o.focusNode&&s.offset==o.focusOffset||!lu(e.contentDOM,o.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(o.focusNode,o.focusOffset),c=a&&a.node==o.anchorNode&&a.offset==o.anchorOffset||!lu(e.contentDOM,o.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(o.anchorNode,o.anchorOffset),f=e.viewport;if((De.ios||De.chrome)&&e.state.selection.main.empty&&l!=c&&(f.from>0||f.to<e.state.doc.length)){let h=Math.min(l,c),u=Math.max(l,c),d=f.from-h,m=f.to-u;(d==0||d==1||h==0)&&(m==0||m==-1||u==e.state.doc.length)&&(l=0,c=e.state.doc.length)}this.newSel=ke.single(c,l)}}}function W2(r,e){let t,{newSel:i}=e,n=r.state.selection.main,s=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(e.bounds){let{from:a,to:o}=e.bounds,l=n.from,c=null;(s===8||De.android&&e.text.length<o-a)&&(l=n.to,c="end");let f=oD(r.state.doc.sliceString(a,o,Ma),e.text,l-a,c);f&&(De.chrome&&s==13&&f.toB==f.from+2&&e.text.slice(f.from,f.toB)==Ma+Ma&&f.toB--,t={from:a+f.from,to:a+f.toA,insert:rt.of(e.text.slice(f.from,f.toB).split(Ma))})}else i&&(!r.hasFocus&&r.state.facet(Yi)||i.main.eq(n))&&(i=null);if(!t&&!i)return!1;if(!t&&e.typeOver&&!n.empty&&i&&i.main.empty?t={from:n.from,to:n.to,insert:r.state.doc.slice(n.from,n.to)}:(De.mac||De.android)&&t&&t.from==t.to&&t.from==n.head-1&&/^\. ?$/.test(t.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(i&&t.insert.length==2&&(i=ke.single(i.main.anchor-1,i.main.head-1)),t={from:t.from,to:t.to,insert:rt.of([t.insert.toString().replace("."," ")])}):t&&t.from>=n.from&&t.to<=n.to&&(t.from!=n.from||t.to!=n.to)&&n.to-n.from-(t.to-t.from)<=4?t={from:n.from,to:n.to,insert:r.state.doc.slice(n.from,t.from).append(t.insert).append(r.state.doc.slice(t.to,n.to))}:De.chrome&&t&&t.from==t.to&&t.from==n.head&&t.insert.toString()==`
 `&&r.lineWrapping&&(i&&(i=ke.single(i.main.anchor-1,i.main.head-1)),t={from:n.from,to:n.to,insert:rt.of([" "])}),t)return $0(r,t,i,s);if(i&&!i.main.eq(n)){let a=!1,o="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(a=!0),o=r.inputState.lastSelectionOrigin,o=="select.pointer"&&(i=z2(r.state.facet(Zo).map(l=>l(r)),i))),r.dispatch({selection:i,scrollIntoView:a,userEvent:o}),!0}else return!1}function $0(r,e,t,i=-1){if(De.ios&&r.inputState.flushIOSKey(e))return!0;let n=r.state.selection.main;if(De.android&&(e.to==n.to&&(e.from==n.from||e.from==n.from-1&&r.state.sliceDoc(e.from,n.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Gs(r.contentDOM,"Enter",13)||(e.from==n.from-1&&e.to==n.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>n.head)&&Gs(r.contentDOM,"Backspace",8)||e.from==n.from&&e.to==n.to+1&&e.insert.length==0&&Gs(r.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let a,o=()=>a||(a=aD(r,e,t));return r.state.facet(A2).some(l=>l(r,e.from,e.to,s,o))||r.dispatch(o()),!0}function aD(r,e,t){let i,n=r.state,s=n.selection.main,a=-1;if(e.from==e.to&&e.from<s.from||e.from>s.to){let l=e.from<s.from?-1:1,c=l<0?s.from:s.to,f=no(n.facet(Zo).map(h=>h(r)),c,l);e.from==f&&(a=f)}if(a>-1)i={changes:e,selection:ke.cursor(e.from+e.insert.length,-1)};else if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&r.inputState.composing<0){let l=s.from<e.from?n.sliceDoc(s.from,e.from):"",c=s.to>e.to?n.sliceDoc(e.to,s.to):"";i=n.replaceSelection(r.state.toText(l+e.insert.sliceString(0,void 0,r.state.lineBreak)+c))}else{let l=n.changes(e),c=t&&t.main.to<=l.newLength?t.main:void 0;if(n.selection.ranges.length>1&&r.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let f=r.state.sliceDoc(e.from,e.to),h,u=t&&N2(r,t.main.head);if(u){let p=e.insert.length-(e.to-e.from);h={from:u.from,to:u.to-p}}else h=r.state.doc.lineAt(s.head);let d=s.to-e.to,m=s.to-s.from;i=n.changeByRange(p=>{if(p.from==s.from&&p.to==s.to)return{changes:l,range:c||p.map(l)};let g=p.to-d,x=g-f.length;if(p.to-p.from!=m||r.state.sliceDoc(x,g)!=f||p.to>=h.from&&p.from<=h.to)return{range:p};let y=n.changes({from:x,to:g,insert:e.insert}),w=p.to-s.to;return{changes:y,range:c?ke.range(Math.max(0,c.anchor+w),Math.max(0,c.head+w)):p.map(y)}})}else i={changes:l,selection:c&&n.selection.replaceRange(c)}}let o="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,o+=".compose",r.inputState.compositionFirstChange&&(o+=".start",r.inputState.compositionFirstChange=!1)),n.update(i,{userEvent:o,scrollIntoView:!0})}function oD(r,e,t,i){let n=Math.min(r.length,e.length),s=0;for(;s<n&&r.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==n&&r.length==e.length)return null;let a=r.length,o=e.length;for(;a>0&&o>0&&r.charCodeAt(a-1)==e.charCodeAt(o-1);)a--,o--;if(i=="end"){let l=Math.max(0,s-Math.min(a,o));t-=a+l-s}if(a<s&&r.length<e.length){let l=t<=s&&t>=a?s-t:0;s-=l,o=s+(o-a),a=s}else if(o<s){let l=t<=s&&t>=o?s-t:0;s-=l,a=s+(a-o),o=s}return{from:s,toA:a,toB:o}}function lD(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:n,focusOffset:s}=r.observer.selectionRange;return t&&(e.push(new ym(t,i)),(n!=t||s!=i)&&e.push(new ym(n,s))),e}function cD(r,e){if(r.length==0)return null;let t=r[0].pos,i=r.length==2?r[1].pos:t;return t>-1&&i>-1?ke.single(t+e,i+e):null}class fD{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,De.safari&&e.contentDOM.addEventListener("input",()=>null),De.gecko&&ED(e.contentDOM.ownerDocument)}handleEvent(e){!vD(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let i=this.handlers[e];if(i){for(let n of i.observers)n(this.view,t);for(let n of i.handlers){if(t.defaultPrevented)break;if(n(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=hD(e),i=this.handlers,n=this.view.contentDOM;for(let s in t)if(s!="scroll"){let a=!t[s].handlers.length,o=i[s];o&&a!=!o.handlers.length&&(n.removeEventListener(s,this.handleEvent),o=null),o||n.addEventListener(s,this.handleEvent,{passive:a})}for(let s in i)s!="scroll"&&!t[s]&&n.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&j2.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),De.android&&De.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return De.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=V2.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||uD.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Gs(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:De.safari&&!De.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function wm(r,e){return(t,i)=>{try{return e.call(r,i,t)}catch(n){Rr(t.state,n)}}}function hD(r){let e=Object.create(null);function t(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of r){let n=i.spec,s=n&&n.plugin.domEventHandlers,a=n&&n.plugin.domEventObservers;if(s)for(let o in s){let l=s[o];l&&t(o).handlers.push(wm(i.value,l))}if(a)for(let o in a){let l=a[o];l&&t(o).observers.push(wm(i.value,l))}}for(let i in mi)t(i).handlers.push(mi[i]);for(let i in ri)t(i).observers.push(ri[i]);return e}const V2=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],uD="dthko",j2=[16,17,18,20,91,92,224,225],Sl=6;function Tl(r){return Math.max(0,r)*.7+8}function dD(r,e){return Math.max(Math.abs(r.clientX-e.clientX),Math.abs(r.clientY-e.clientY))}class pD{constructor(e,t,i,n){this.view=e,this.startEvent=t,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=k8(e.contentDOM),this.atoms=e.state.facet(Zo).map(a=>a(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Je.allowMultipleSelections)&&mD(e,t),this.dragging=xD(e,t)&&K2(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&dD(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,i=0,n=0,s=0,a=this.view.win.innerWidth,o=this.view.win.innerHeight;this.scrollParents.x&&({left:n,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:o}=this.scrollParents.y.getBoundingClientRect());let l=j0(this.view);e.clientX-l.left<=n+Sl?t=-Tl(n-e.clientX):e.clientX+l.right>=a-Sl&&(t=Tl(e.clientX-a)),e.clientY-l.top<=s+Sl?i=-Tl(s-e.clientY):e.clientY+l.bottom>=o-Sl&&(i=Tl(e.clientY-o)),this.setScrollSpeed(t,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,i=z2(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function mD(r,e){let t=r.state.facet(S2);return t.length?t[0](e):De.mac?e.metaKey:e.ctrlKey}function gD(r,e){let t=r.state.facet(T2);return t.length?t[0](e):De.mac?!e.altKey:!e.ctrlKey}function xD(r,e){let{main:t}=r.state.selection;if(t.empty)return!1;let i=Eo(r.root);if(!i||i.rangeCount==0)return!0;let n=i.getRangeAt(0).getClientRects();for(let s=0;s<n.length;s++){let a=n[s];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function vD(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=r.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=ct.get(t))&&i.ignoreEvent(e))return!1;return!0}const mi=Object.create(null),ri=Object.create(null),$2=De.ie&&De.ie_version<15||De.ios&&De.webkit_version<604;function yD(r){let e=r.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{r.focus(),t.remove(),G2(r,t.value)},50)}function gf(r,e,t){for(let i of r.facet(e))t=i(t,r);return t}function G2(r,e){e=gf(r.state,z0,e);let{state:t}=r,i,n=1,s=t.toText(e),a=s.lines==t.selection.ranges.length;if(ku!=null&&t.selection.ranges.every(l=>l.empty)&&ku==s.toString()){let l=-1;i=t.changeByRange(c=>{let f=t.doc.lineAt(c.from);if(f.from==l)return{range:c};l=f.from;let h=t.toText((a?s.line(n++).text:e)+t.lineBreak);return{changes:{from:f.from,insert:h},range:ke.cursor(c.from+h.length)}})}else a?i=t.changeByRange(l=>{let c=s.line(n++);return{changes:{from:l.from,to:l.to,insert:c.text},range:ke.cursor(l.from+c.length)}}):i=t.replaceSelection(s);r.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}ri.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft};mi.keydown=(r,e)=>(r.inputState.setSelectionOrigin("select"),e.keyCode==27&&r.inputState.tabFocusMode!=0&&(r.inputState.tabFocusMode=Date.now()+2e3),!1);ri.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};ri.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};mi.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let i of r.state.facet(E2))if(t=i(r,e),t)break;if(!t&&e.button==0&&(t=bD(r,e)),t){let i=!r.hasFocus;r.inputState.startMouseSelection(new pD(r,e,t,i)),i&&r.observer.ignore(()=>{s2(r.contentDOM);let s=r.root.activeElement;s&&!s.contains(r.contentDOM)&&s.blur()});let n=r.inputState.mouseSelection;if(n)return n.start(e),n.dragging===!1}else r.inputState.setSelectionOrigin("select.pointer");return!1};function km(r,e,t,i){if(i==1)return ke.cursor(e,t);if(i==2)return q8(r.state,e,t);{let n=Ot.find(r.docView,e),s=r.state.doc.lineAt(n?n.posAtEnd:e),a=n?n.posAtStart:s.from,o=n?n.posAtEnd:s.to;return o<r.state.doc.length&&o==s.to&&o++,ke.range(a,o)}}let bm=(r,e,t)=>e>=t.top&&e<=t.bottom&&r>=t.left&&r<=t.right;function wD(r,e,t,i){let n=Ot.find(r.docView,e);if(!n)return 1;let s=e-n.posAtStart;if(s==0)return 1;if(s==n.length)return-1;let a=n.coordsAt(s,-1);if(a&&bm(t,i,a))return-1;let o=n.coordsAt(s,1);return o&&bm(t,i,o)?1:a&&a.bottom>=i?-1:1}function _m(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:wD(r,t,e.clientX,e.clientY)}}const kD=De.ie&&De.ie_version<=11;let Sm=null,Tm=0,Em=0;function K2(r){if(!kD)return r.detail;let e=Sm,t=Em;return Sm=r,Em=Date.now(),Tm=!e||t>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(Tm+1)%3:1}function bD(r,e){let t=_m(r,e),i=K2(e),n=r.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),n=n.map(s.changes))},get(s,a,o){let l=_m(r,s),c,f=km(r,l.pos,l.bias,i);if(t.pos!=l.pos&&!a){let h=km(r,t.pos,t.bias,i),u=Math.min(h.from,f.from),d=Math.max(h.to,f.to);f=u<f.from?ke.range(u,d):ke.range(d,u)}return a?n.replaceRange(n.main.extend(f.from,f.to)):o&&i==1&&n.ranges.length>1&&(c=_D(n,l.pos))?c:o?n.addRange(f):ke.create([f])}}}function _D(r,e){for(let t=0;t<r.ranges.length;t++){let{from:i,to:n}=r.ranges[t];if(i<=e&&n>=e)return ke.create(r.ranges.slice(0,t).concat(r.ranges.slice(t+1)),r.mainIndex==t?0:r.mainIndex-(r.mainIndex>t?1:0))}return null}mi.dragstart=(r,e)=>{let{selection:{main:t}}=r.state;if(e.target.draggable){let n=r.docView.nearest(e.target);if(n&&n.isWidget){let s=n.posAtStart,a=s+n.length;(s>=t.to||a<=t.from)&&(t=ke.range(s,a))}}let{inputState:i}=r;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",gf(r.state,W0,r.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};mi.dragend=r=>(r.inputState.draggedContent=null,!1);function Cm(r,e,t,i){if(t=gf(r.state,z0,t),!t)return;let n=r.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=r.inputState,a=i&&s&&gD(r,e)?{from:s.from,to:s.to}:null,o={from:n,insert:t},l=r.state.changes(a?[a,o]:o);r.focus(),r.dispatch({changes:l,selection:{anchor:l.mapPos(n,-1),head:l.mapPos(n,1)},userEvent:a?"move.drop":"input.drop"}),r.inputState.draggedContent=null}mi.drop=(r,e)=>{if(!e.dataTransfer)return!1;if(r.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let i=Array(t.length),n=0,s=()=>{++n==t.length&&Cm(r,e,i.filter(a=>a!=null).join(r.state.lineBreak),!1)};for(let a=0;a<t.length;a++){let o=new FileReader;o.onerror=s,o.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(o.result)||(i[a]=o.result),s()},o.readAsText(t[a])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return Cm(r,e,i,!0),!0}return!1};mi.paste=(r,e)=>{if(r.state.readOnly)return!0;r.observer.flush();let t=$2?null:e.clipboardData;return t?(G2(r,t.getData("text/plain")||t.getData("text/uri-list")),!0):(yD(r),!1)};function SD(r,e){let t=r.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),r.focus()},50)}function TD(r){let e=[],t=[],i=!1;for(let n of r.selection.ranges)n.empty||(e.push(r.sliceDoc(n.from,n.to)),t.push(n));if(!e.length){let n=-1;for(let{from:s}of r.selection.ranges){let a=r.doc.lineAt(s);a.number>n&&(e.push(a.text),t.push({from:a.from,to:Math.min(r.doc.length,a.to+1)})),n=a.number}i=!0}return{text:gf(r,W0,e.join(r.lineBreak)),ranges:t,linewise:i}}let ku=null;mi.copy=mi.cut=(r,e)=>{let{text:t,ranges:i,linewise:n}=TD(r.state);if(!t&&!n)return!1;ku=n?t:null,e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let s=$2?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",t),!0):(SD(r,t),!1)};const X2=hn.define();function q2(r,e){let t=[];for(let i of r.facet(O2)){let n=i(r,e);n&&t.push(n)}return t.length?r.update({effects:t,annotations:X2.of(!0)}):null}function Y2(r){setTimeout(()=>{let e=r.hasFocus;if(e!=r.inputState.notifiedFocused){let t=q2(r.state,e);t?r.dispatch(t):r.update([])}},10)}ri.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),Y2(r)};ri.blur=r=>{r.observer.clearSelectionRange(),Y2(r)};ri.compositionstart=ri.compositionupdate=r=>{r.observer.editContext||(r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0))};ri.compositionend=r=>{r.observer.editContext||(r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,De.chrome&&De.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50))};ri.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};mi.beforeinput=(r,e)=>{var t,i;if(e.inputType=="insertReplacementText"&&r.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),a=e.getTargetRanges();if(s&&a.length){let o=a[0],l=r.posAtDOM(o.startContainer,o.startOffset),c=r.posAtDOM(o.endContainer,o.endOffset);return $0(r,{from:l,to:c,insert:r.state.toText(s)},null),!0}}let n;if(De.chrome&&De.android&&(n=V2.find(s=>s.inputType==e.inputType))&&(r.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let s=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>s+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return De.ios&&e.inputType=="deleteContentForward"&&r.observer.flushSoon(),De.safari&&e.inputType=="insertText"&&r.inputState.composing>=0&&setTimeout(()=>ri.compositionend(r,e),20),!1};const Am=new Set;function ED(r){Am.has(r)||(Am.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}const Om=["pre-wrap","normal","pre-line","break-spaces"];let sa=!1;function Fm(){sa=!1}class CD{constructor(e){this.lineWrapping=e,this.doc=rt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Om.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let n=e[i];n<0?i++:this.heightSamples[Math.floor(n*10)]||(t=!0,this.heightSamples[Math.floor(n*10)]=!0)}return t}refresh(e,t,i,n,s,a){let o=Om.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=i,this.textHeight=n,this.lineLength=s,l){this.heightSamples={};for(let c=0;c<a.length;c++){let f=a[c];f<0?c++:this.heightSamples[Math.floor(f*10)]=!0}}return l}}class AD{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Di{constructor(e,t,i,n,s){this.from=e,this.length=t,this.top=i,this.height=n,this._content=s}get type(){return typeof this._content=="number"?_r.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Ln?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Di(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var dt=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(dt||(dt={}));const Zl=.001;class Sr{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Zl&&(sa=!0),this.height=e)}replace(e,t,i){return Sr.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,n){let s=this,a=i.doc;for(let o=n.length-1;o>=0;o--){let{fromA:l,toA:c,fromB:f,toB:h}=n[o],u=s.lineAt(l,dt.ByPosNoHeight,i.setDoc(t),0,0),d=u.to>=c?u:s.lineAt(c,dt.ByPosNoHeight,i,0,0);for(h+=d.to-c,c=d.to;o>0&&u.from<=n[o-1].toA;)l=n[o-1].fromA,f=n[o-1].fromB,o--,l<u.from&&(u=s.lineAt(l,dt.ByPosNoHeight,i,0,0));f+=u.from-l,l=u.from;let m=G0.build(i.setDoc(a),e,f,h);s=Dc(s,s.replace(l,c,m))}return s.updateHeight(i,0)}static empty(){return new Nr(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,n=0,s=0;for(;;)if(t==i)if(n>s*2){let o=e[t-1];o.break?e.splice(--t,1,o.left,null,o.right):e.splice(--t,1,o.left,o.right),i+=1+o.break,n-=o.size}else if(s>n*2){let o=e[i];o.break?e.splice(i,1,o.left,null,o.right):e.splice(i,1,o.left,o.right),i+=2+o.break,s-=o.size}else break;else if(n<s){let o=e[t++];o&&(n+=o.size)}else{let o=e[--i];o&&(s+=o.size)}let a=0;return e[t-1]==null?(a=1,t--):e[t]==null&&(a=1,i++),new OD(Sr.of(e.slice(0,t)),a,Sr.of(e.slice(i)))}}function Dc(r,e){return r==e?r:(r.constructor!=e.constructor&&(sa=!0),e)}Sr.prototype.size=1;class J2 extends Sr{constructor(e,t,i){super(e,t),this.deco=i}blockAt(e,t,i,n){return new Di(n,this.length,i,this.height,this.deco||0)}lineAt(e,t,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(e,t,i,n,s,a){e<=s+this.length&&t>=s&&a(this.blockAt(0,i,n,s))}updateHeight(e,t=0,i=!1,n){return n&&n.from<=t&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Nr extends J2{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,i,n){return new Di(n,this.length,i,this.height,this.breaks)}replace(e,t,i){let n=i[0];return i.length==1&&(n instanceof Nr||n instanceof Vt&&n.flags&4)&&Math.abs(this.length-n.length)<10?(n instanceof Vt?n=new Nr(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):Sr.of(i)}updateHeight(e,t=0,i=!1,n){return n&&n.from<=t&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Vt extends Sr{constructor(e){super(e,0)}heightMetrics(e,t){let i=e.doc.lineAt(t).number,n=e.doc.lineAt(t+this.length).number,s=n-i+1,a,o=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);a=l/s,this.length>s+1&&(o=(this.height-l)/(this.length-s-1))}else a=this.height/s;return{firstLine:i,lastLine:n,perLine:a,perChar:o}}blockAt(e,t,i,n){let{firstLine:s,lastLine:a,perLine:o,perChar:l}=this.heightMetrics(t,n);if(t.lineWrapping){let c=n+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),f=t.doc.lineAt(c),h=o+f.length*l,u=Math.max(i,e-h/2);return new Di(f.from,f.length,u,h,0)}else{let c=Math.max(0,Math.min(a-s,Math.floor((e-i)/o))),{from:f,length:h}=t.doc.line(s+c);return new Di(f,h,i+o*c,o,0)}}lineAt(e,t,i,n,s){if(t==dt.ByHeight)return this.blockAt(e,i,n,s);if(t==dt.ByPosNoHeight){let{from:d,to:m}=i.doc.lineAt(e);return new Di(d,m-d,0,0,0)}let{firstLine:a,perLine:o,perChar:l}=this.heightMetrics(i,s),c=i.doc.lineAt(e),f=o+c.length*l,h=c.number-a,u=n+o*h+l*(c.from-s-h);return new Di(c.from,c.length,Math.max(n,Math.min(u,n+this.height-f)),f,0)}forEachLine(e,t,i,n,s,a){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:o,perLine:l,perChar:c}=this.heightMetrics(i,s);for(let f=e,h=n;f<=t;){let u=i.doc.lineAt(f);if(f==e){let m=u.number-o;h+=l*m+c*(e-s-m)}let d=l+c*u.length;a(new Di(u.from,u.length,h,d,0)),h+=d,f=u.to+1}}replace(e,t,i){let n=this.length-t;if(n>0){let s=i[i.length-1];s instanceof Vt?i[i.length-1]=new Vt(s.length+n):i.push(null,new Vt(n-1))}if(e>0){let s=i[0];s instanceof Vt?i[0]=new Vt(e+s.length):i.unshift(new Vt(e-1),null)}return Sr.of(i)}decomposeLeft(e,t){t.push(new Vt(e-1),null)}decomposeRight(e,t){t.push(null,new Vt(this.length-e-1))}updateHeight(e,t=0,i=!1,n){let s=t+this.length;if(n&&n.from<=t+this.length&&n.more){let a=[],o=Math.max(t,n.from),l=-1;for(n.from>t&&a.push(new Vt(n.from-t-1).updateHeight(e,t));o<=s&&n.more;){let f=e.doc.lineAt(o).length;a.length&&a.push(null);let h=n.heights[n.index++];l==-1?l=h:Math.abs(h-l)>=Zl&&(l=-2);let u=new Nr(f,h);u.outdated=!1,a.push(u),o+=f+1}o<=s&&a.push(null,new Vt(s-o).updateHeight(e,o));let c=Sr.of(a);return(l<0||Math.abs(c.height-this.height)>=Zl||Math.abs(l-this.heightMetrics(e,t).perLine)>=Zl)&&(sa=!0),Dc(this,c)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class OD extends Sr{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,n){let s=i+this.left.height;return e<s?this.left.blockAt(e,t,i,n):this.right.blockAt(e,t,s,n+this.left.length+this.break)}lineAt(e,t,i,n,s){let a=n+this.left.height,o=s+this.left.length+this.break,l=t==dt.ByHeight?e<a:e<o,c=l?this.left.lineAt(e,t,i,n,s):this.right.lineAt(e,t,i,a,o);if(this.break||(l?c.to<o:c.from>o))return c;let f=t==dt.ByPosNoHeight?dt.ByPosNoHeight:dt.ByPos;return l?c.join(this.right.lineAt(o,f,i,a,o)):this.left.lineAt(o,f,i,n,s).join(c)}forEachLine(e,t,i,n,s,a){let o=n+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,i,n,s,a),t>=l&&this.right.forEachLine(e,t,i,o,l,a);else{let c=this.lineAt(l,dt.ByPos,i,n,s);e<c.from&&this.left.forEachLine(e,c.from-1,i,n,s,a),c.to>=e&&c.from<=t&&a(c),t>c.to&&this.right.forEachLine(c.to+1,t,i,o,l,a)}}replace(e,t,i){let n=this.left.length+this.break;if(t<n)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-n,t-n,i));let s=[];e>0&&this.decomposeLeft(e,s);let a=s.length;for(let o of i)s.push(o);if(e>0&&Dm(s,a-1),t<this.length){let o=s.length;this.decomposeRight(t,s),Dm(s,o)}return Sr.of(s)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,n=i+this.break;if(e>=n)return this.right.decomposeRight(e-n,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<n&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Sr.of(this.break?[e,null,t]:[e,t]):(this.left=Dc(this.left,e),this.right=Dc(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,n){let{left:s,right:a}=this,o=t+s.length+this.break,l=null;return n&&n.from<=t+s.length&&n.more?l=s=s.updateHeight(e,t,i,n):s.updateHeight(e,t,i),n&&n.from<=o+a.length&&n.more?l=a=a.updateHeight(e,o,i,n):a.updateHeight(e,o,i),l?this.balanced(s,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Dm(r,e){let t,i;r[e]==null&&(t=r[e-1])instanceof Vt&&(i=r[e+1])instanceof Vt&&r.splice(e-1,3,new Vt(t.length+1+i.length))}const FD=5;class G0{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof Nr?n.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Nr(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let a=t-e;i.block?this.addBlock(new J2(a,n,i)):(a||s||n>=FD)&&this.addLineDeco(n,s,a)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Nr(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new Vt(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Nr)return e;let t=new Nr(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,e),n.breaks+=t,this.writtenTo=this.pos=this.pos+i}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Nr)&&!this.isCovered?this.nodes.push(new Nr(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let n of this.nodes)n instanceof Nr&&n.updateHeight(this.oracle,i),i+=n?n.length:1;return this.nodes}static build(e,t,i,n){let s=new G0(i,e);return tt.spans(t,i,n,s,0),s.finish(i)}}function DD(r,e,t){let i=new RD;return tt.compare(r,e,t,i,0),i.changes}class RD{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,n){(e<t||i&&i.heightRelevant||n&&n.heightRelevant)&&Jl(e,t,this.changes,5)}}function MD(r,e){let t=r.getBoundingClientRect(),i=r.ownerDocument,n=i.defaultView||window,s=Math.max(0,t.left),a=Math.min(n.innerWidth,t.right),o=Math.max(0,t.top),l=Math.min(n.innerHeight,t.bottom);for(let c=r.parentNode;c&&c!=i.body;)if(c.nodeType==1){let f=c,h=window.getComputedStyle(f);if((f.scrollHeight>f.clientHeight||f.scrollWidth>f.clientWidth)&&h.overflow!="visible"){let u=f.getBoundingClientRect();s=Math.max(s,u.left),a=Math.min(a,u.right),o=Math.max(o,u.top),l=Math.min(c==r.parentNode?n.innerHeight:l,u.bottom)}c=h.position=="absolute"||h.position=="fixed"?f.offsetParent:f.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:s-t.left,right:Math.max(s,a)-t.left,top:o-(t.top+e),bottom:Math.max(o,l)-(t.top+e)}}function ID(r){let e=r.getBoundingClientRect(),t=r.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function PD(r,e){let t=r.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class ih{constructor(e,t,i,n){this.from=e,this.to=t,this.size=i,this.displaySize=n}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let n=e[i],s=t[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(e,t){return Be.replace({widget:new LD(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class LD extends un{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Rm{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Mm,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=pt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(V0).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new CD(t),this.stateDeco=e.facet(Co).filter(i=>typeof i!="function"),this.heightMap=Sr.empty().applyChanges(this.stateDeco,rt.empty,this.heightOracle.setDoc(e.doc),[new Zr(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Be.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let n=i?t.head:t.anchor;if(!e.some(({from:s,to:a})=>n>=s&&n<=a)){let{from:s,to:a}=this.lineBlockAt(n);e.push(new El(s,a))}}return this.viewports=e.sort((i,n)=>i.from-n.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?Mm:new K0(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Ia(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Co).filter(f=>typeof f!="function");let n=e.changedRanges,s=Zr.extendWithRanges(n,DD(i,this.stateDeco,e?e.changes:Mt.empty(this.state.doc.length))),a=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Fm(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=a||sa)&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=a);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(D2)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),n=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?pt.RTL:pt.LTR;let a=this.heightOracle.mustRefreshForWrapping(s),o=t.getBoundingClientRect(),l=a||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let c=0,f=0;if(o.width&&o.height){let{scaleX:T,scaleY:C}=n2(t,o);(T>.005&&Math.abs(this.scaleX-T)>.005||C>.005&&Math.abs(this.scaleY-C)>.005)&&(this.scaleX=T,this.scaleY=C,c|=16,a=l=!0)}let h=(parseInt(i.paddingTop)||0)*this.scaleY,u=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=u)&&(this.paddingTop=h,this.paddingBottom=u,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(n.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=o2(e.scrollDOM);let m=(this.printing?PD:MD)(t,this.paddingTop),p=m.top-this.pixelViewport.top,g=m.bottom-this.pixelViewport.bottom;this.pixelViewport=m;let x=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(x!=this.inView&&(this.inView=x,x&&(l=!0)),!this.inView&&!this.scrollTarget&&!ID(e.dom))return 0;let y=o.width;if((this.contentDOMWidth!=y||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),l){let T=e.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(T)&&(a=!0),a||n.lineWrapping&&Math.abs(y-this.contentDOMWidth)>n.charWidth){let{lineHeight:C,charWidth:R,textHeight:_}=e.docView.measureTextSize();a=C>0&&n.refresh(s,C,R,_,Math.max(5,y/R),T),a&&(e.docView.minWidth=0,c|=16)}p>0&&g>0?f=Math.max(p,g):p<0&&g<0&&(f=Math.min(p,g)),Fm();for(let C of this.viewports){let R=C.from==this.viewport.from?T:e.docView.measureVisibleLineHeights(C);this.heightMap=(a?Sr.empty().applyChanges(this.stateDeco,rt.empty,this.heightOracle,[new Zr(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(n,0,a,new AD(C.from,R))}sa&&(c|=2)}let w=!this.viewportIsAppropriate(this.viewport,f)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return w&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(f,this.scrollTarget),c|=this.updateForViewport()),(c&2||w)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),n=this.heightMap,s=this.heightOracle,{visibleTop:a,visibleBottom:o}=this,l=new El(n.lineAt(a-i*1e3,dt.ByHeight,s,0,0).from,n.lineAt(o+(1-i)*1e3,dt.ByHeight,s,0,0).to);if(t){let{head:c}=t.range;if(c<l.from||c>l.to){let f=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=n.lineAt(c,dt.ByPos,s,0,0),u;t.y=="center"?u=(h.top+h.bottom)/2-f/2:t.y=="start"||t.y=="nearest"&&c<l.from?u=h.top:u=h.bottom-f,l=new El(n.lineAt(u-1e3/2,dt.ByHeight,s,0,0).from,n.lineAt(u+f+1e3/2,dt.ByHeight,s,0,0).to)}}return l}mapViewport(e,t){let i=t.mapPos(e.from,-1),n=t.mapPos(e.to,1);return new El(this.heightMap.lineAt(i,dt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,dt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(e,dt.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,dt.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:o}=this;return(e==0||n<=a-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||s>=o+Math.max(10,Math.min(i,250)))&&n>a-2*1e3&&s<o+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let n of e)t.touchesRange(n.from,n.to)||i.push(new ih(t.mapPos(n.from),t.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,a=n<<1;if(this.defaultTextDirection!=pt.LTR&&!i)return[];let o=[],l=(f,h,u,d)=>{if(h-f<s)return;let m=this.state.selection.main,p=[m.from];m.empty||p.push(m.to);for(let x of p)if(x>f&&x<h){l(f,x-10,u,d),l(x+10,h,u,d);return}let g=ND(e,x=>x.from>=u.from&&x.to<=u.to&&Math.abs(x.from-f)<s&&Math.abs(x.to-h)<s&&!p.some(y=>x.from<y&&x.to>y));if(!g){if(h<u.to&&t&&i&&t.visibleRanges.some(w=>w.from<=h&&w.to>=h)){let w=t.moveToLineBoundary(ke.cursor(h),!1,!0).head;w>f&&(h=w)}let x=this.gapSize(u,f,h,d),y=i||x<2e6?x:2e6;g=new ih(f,h,x,y)}o.push(g)},c=f=>{if(f.length<a||f.type!=_r.Text)return;let h=BD(f.from,f.to,this.stateDeco);if(h.total<a)return;let u=this.scrollTarget?this.scrollTarget.range.head:null,d,m;if(i){let p=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,g,x;if(u!=null){let y=Al(h,u),w=((this.visibleBottom-this.visibleTop)/2+p)/f.height;g=y-w,x=y+w}else g=(this.visibleTop-f.top-p)/f.height,x=(this.visibleBottom-f.top+p)/f.height;d=Cl(h,g),m=Cl(h,x)}else{let p=h.total*this.heightOracle.charWidth,g=n*this.heightOracle.charWidth,x=0;if(p>2e6)for(let R of e)R.from>=f.from&&R.from<f.to&&R.size!=R.displaySize&&R.from*this.heightOracle.charWidth+x<this.pixelViewport.left&&(x=R.size-R.displaySize);let y=this.pixelViewport.left+x,w=this.pixelViewport.right+x,T,C;if(u!=null){let R=Al(h,u),_=((w-y)/2+g)/p;T=R-_,C=R+_}else T=(y-g)/p,C=(w+g)/p;d=Cl(h,T),m=Cl(h,C)}d>f.from&&l(f.from,d,f,h),m<f.to&&l(m,f.to,f,h)};for(let f of this.viewportLines)Array.isArray(f.type)?f.type.forEach(c):c(f);return o}gapSize(e,t,i,n){let s=Al(n,i)-Al(n,t);return this.heightOracle.lineWrapping?e.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(e){ih.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Be.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let i=[];tt.spans(t,this.viewport.from,this.viewport.to,{span(s,a){i.push({from:s,to:a})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let s=0;s<i.length&&!(n&8);s++){let a=this.visibleRanges[s],o=i[s];(a.from!=o.from||a.to!=o.to)&&(n|=4,e&&e.mapPos(a.from,-1)==o.from&&e.mapPos(a.to,1)==o.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Ia(this.heightMap.lineAt(e,dt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Ia(this.heightMap.lineAt(this.scaler.fromDOM(e),dt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Ia(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class El{constructor(e,t){this.from=e,this.to=t}}function BD(r,e,t){let i=[],n=r,s=0;return tt.spans(t,r,e,{span(){},point(a,o){a>n&&(i.push({from:n,to:a}),s+=a-n),n=o}},20),n<e&&(i.push({from:n,to:e}),s+=e-n),{total:s,ranges:i}}function Cl({total:r,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(r*t);for(let n=0;;n++){let{from:s,to:a}=e[n],o=a-s;if(i<=o)return s+i;i-=o}}function Al(r,e){let t=0;for(let{from:i,to:n}of r.ranges){if(e<=n){t+=e-i;break}t+=n-i}return t/r.total}function ND(r,e){for(let t of r)if(e(t))return t}const Mm={toDOM(r){return r},fromDOM(r){return r},scale:1,eq(r){return r==this}};class K0{constructor(e,t,i){let n=0,s=0,a=0;this.viewports=i.map(({from:o,to:l})=>{let c=t.lineAt(o,dt.ByPos,e,0,0).top,f=t.lineAt(l,dt.ByPos,e,0,0).bottom;return n+=f-c,{from:o,to:l,top:c,bottom:f,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(t.height-n);for(let o of this.viewports)o.domTop=a+(o.top-s)*this.scale,a=o.domBottom=o.domTop+(o.bottom-o.top),s=o.bottom}toDOM(e){for(let t=0,i=0,n=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return n+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom,n=s.domBottom}}fromDOM(e){for(let t=0,i=0,n=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return i+(e-n)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom,n=s.domBottom}}eq(e){return e instanceof K0?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,i)=>t.from==e.viewports[i].from&&t.to==e.viewports[i].to):!1}}function Ia(r,e){if(e.scale==1)return r;let t=e.toDOM(r.top),i=e.toDOM(r.bottom);return new Di(r.from,r.length,t,i-t,Array.isArray(r._content)?r._content.map(n=>Ia(n,e)):r._content)}const Ol=Re.define({combine:r=>r.join(" ")}),bu=Re.define({combine:r=>r.indexOf(!0)>-1}),_u=In.newName(),Z2=In.newName(),Q2=In.newName(),ey={"&light":"."+Z2,"&dark":"."+Q2};function Su(r,e,t){return new In(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,n=>{if(n=="&")return r;if(!t||!t[n])throw new RangeError(`Unsupported selector: ${n}`);return t[n]}):r+" "+i}})}const UD=Su("."+_u,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},ey),HD={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},nh=De.ie&&De.ie_version<=11;class zD{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new b8,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let i of t)this.queue.push(i);(De.ie&&De.ie_version<=11||De.ios&&e.composing)&&t.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&De.android&&e.constructor.EDIT_CONTEXT!==!1&&!(De.chrome&&De.chrome_version<126)&&(this.editContext=new VD(e),e.state.facet(Yi)&&(e.contentDOM.editContext=this.editContext.editContext)),nh&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(Yi)?i.root.activeElement!=this.dom:!Yl(this.dom,n))return;let s=n.anchorNode&&i.docView.nearest(n.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(De.ie&&De.ie_version<=11||De.android&&De.chrome)&&!i.state.selection.main.empty&&n.focusNode&&ro(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Eo(e.root);if(!t)return!1;let i=De.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&WD(this.view,t)||t;if(!i||this.selectionRange.eq(i))return!1;let n=Yl(this.dom,i);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&S8(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,HD),nh&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),nh&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;if(!this.delayedAndroidKey){let n=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&Gs(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(n)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,i=-1,n=!1;for(let s of e){let a=this.readMutation(s);a&&(a.typeOver&&(n=!0),t==-1?{from:t,to:i}=a:(t=Math.min(a.from,t),i=Math.max(a.to,i)))}return{from:t,to:i,typeOver:n}}readChange(){let{from:e,to:t,typeOver:i}=this.processRecords(),n=this.selectionChanged&&Yl(this.dom,this.selectionRange);if(e<0&&!n)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new sD(this.view,e,t,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let i=this.view.state,n=W2(this.view,t);return this.view.state==i&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let i=Im(t,e.previousSibling||e.target.previousSibling,-1),n=Im(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:n?t.posBefore(n):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Yi)!=e.state.facet(Yi)&&(e.view.contentDOM.editContext=e.state.facet(Yi)?this.editContext.editContext:null))}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Im(r,e,t){for(;e;){let i=ct.get(e);if(i&&i.parent==r)return i;let n=e.parentNode;e=n!=r.dom?n:t>0?e.nextSibling:e.previousSibling}return null}function Pm(r,e){let t=e.startContainer,i=e.startOffset,n=e.endContainer,s=e.endOffset,a=r.docView.domAtPos(r.state.selection.main.anchor);return ro(a.node,a.offset,n,s)&&([t,i,n,s]=[n,s,t,i]),{anchorNode:t,anchorOffset:i,focusNode:n,focusOffset:s}}function WD(r,e){if(e.getComposedRanges){let n=e.getComposedRanges(r.root)[0];if(n)return Pm(r,n)}let t=null;function i(n){n.preventDefault(),n.stopImmediatePropagation(),t=n.getTargetRanges()[0]}return r.contentDOM.addEventListener("beforeinput",i,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",i,!0),t?Pm(r,t):null}class VD{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let n=e.state.selection.main,{anchor:s,head:a}=n,o=this.toEditorPos(i.updateRangeStart),l=this.toEditorPos(i.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:o,drifted:!1});let c={from:o,to:l,insert:rt.of(i.text.split(`
`))};if(c.from==this.from&&s<this.from?c.from=s:c.to==this.to&&s>this.to&&(c.to=s),c.from==c.to&&!c.insert.length){let f=ke.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));f.main.eq(n)||e.dispatch({selection:f,userEvent:"select"});return}if((De.mac||De.android)&&c.from==a-1&&/^\. ?$/.test(i.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:o,to:l,insert:rt.of([i.text.replace("."," ")])}),this.pendingContextChange=c,!e.state.readOnly){let f=this.to-this.from+(c.to-c.from+c.insert.length);$0(e,c,ke.single(this.toEditorPos(i.selectionStart,f),this.toEditorPos(i.selectionEnd,f)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),c.from<c.to&&!c.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,i.updateRangeStart-1),Math.min(t.text.length,i.updateRangeStart+1)))&&this.handlers.compositionend(i)},this.handlers.characterboundsupdate=i=>{let n=[],s=null;for(let a=this.toEditorPos(i.rangeStart),o=this.toEditorPos(i.rangeEnd);a<o;a++){let l=e.coordsForChar(a);s=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||s||new DOMRect,n.push(s)}t.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=i=>{let n=[];for(let s of i.getTextFormats()){let a=s.underlineStyle,o=s.underlineThickness;if(!/none/i.test(a)&&!/none/i.test(o)){let l=this.toEditorPos(s.rangeStart),c=this.toEditorPos(s.rangeEnd);if(l<c){let f=`text-decoration: underline ${/^[a-z]/.test(a)?a+" ":a=="Dashed"?"dashed ":a=="Squiggle"?"wavy ":""}${/thin/i.test(o)?1:2}px`;n.push(Be.mark({attributes:{style:f}}).range(l,c))}}}e.dispatch({effects:M2.of(Be.set(n))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(e.state)}};for(let i in this.handlers)t.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let n=Eo(i.root);n&&n.rangeCount&&this.editContext.updateSelectionBounds(n.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,i=!1,n=this.pendingContextChange;return e.changes.iterChanges((s,a,o,l,c)=>{if(i)return;let f=c.length-(a-s);if(n&&a>=n.to)if(n.from==s&&n.to==a&&n.insert.eq(c)){n=this.pendingContextChange=null,t+=f,this.to+=f;return}else n=null,this.revertPending(e.state);if(s+=t,a+=t,a<=this.from)this.from+=f,this.to+=f;else if(s<this.to){if(s<this.from||a>this.to||this.to-this.from+c.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(a),c.toString()),this.to+=f}t+=f}),n&&!i&&this.revertPending(e.state),!i}update(e){let t=this.pendingContextChange,i=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(i.from,i.to)&&e.transactions.some(n=>!n.isUserEvent("input.type")&&n.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),n=this.toContextPos(t.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=n)&&this.editContext.updateSelection(i,n)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let i=this.composing;return i&&i.drifted?i.editorBase+(e-i.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class Oe{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(n=>n.forEach(s=>i(s,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=e.root||_8(e.parent)||document,this.viewState=new Rm(e.state||Je.create(e)),e.scrollTo&&e.scrollTo.is(_l)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Rs).map(n=>new eh(n));for(let n of this.plugins)n.update(this);this.observer=new zD(this),this.inputState=new fD(this),this.inputState.ensureHandlers(this.plugins),this.docView=new dm(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof Lt?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,n,s=this.state;for(let u of e){if(u.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=u.state}if(this.destroyed){this.viewState.state=s;return}let a=this.hasFocus,o=0,l=null;e.some(u=>u.annotation(X2))?(this.inputState.notifiedFocused=a,o=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,l=q2(s,a),l||(o=1));let c=this.observer.delayedAndroidKey,f=null;if(c?(this.observer.clearDelayedAndroidKey(),f=this.observer.readChange(),(f&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(f=null)):this.observer.clear(),s.facet(Je.phrases)!=this.state.facet(Je.phrases))return this.setState(s);n=Fc.create(this,s,e),n.flags|=o;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let u of e){if(h&&(h=h.map(u.changes)),u.scrollIntoView){let{main:d}=u.state.selection;h=new Ks(d.empty?d:ke.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of u.effects)d.is(_l)&&(h=d.value.clip(this.state))}this.viewState.update(n,h),this.bidiCache=Rc.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),t=this.docView.update(n),this.state.facet(Ra)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(u=>u.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(Ol)!=n.state.facet(Ol)&&(this.viewState.mustMeasureContent=!0),(t||i||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!n.empty)for(let u of this.state.facet(vu))try{u(n)}catch(d){Rr(this.state,d,"update listener")}(l||f)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),f&&!W2(this,f)&&c.force&&Gs(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Rm(e),this.plugins=e.facet(Rs).map(i=>new eh(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new dm(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Rs),i=e.state.facet(Rs);if(t!=i){let n=[];for(let s of i){let a=t.indexOf(s);if(a<0)n.push(new eh(s));else{let o=this.plugins[a];o.mustUpdate=e,n.push(o)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let n of this.plugins)n.mustUpdate=e;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this);t!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(i){Rr(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:a}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let o=0;;o++){if(a<0)if(o2(i))s=-1,a=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(n);s=d.from,a=d.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(o>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let f=c.map(d=>{try{return d.read(this)}catch(m){return Rr(this.state,m),Lm}}),h=Fc.create(this,this.state,[]),u=!1;h.flags|=l,t?t.flags|=l:t=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),u=this.docView.update(h),u&&this.docViewUpdate());for(let d=0;d<c.length;d++)if(f[d]!=Lm)try{let m=c[d];m.write&&m.write(f[d],this)}catch(m){Rr(this.state,m)}if(u&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}else{let m=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-a;if(m>1||m<-1){n=n+m,i.scrollTop=n/this.scaleY,a=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let o of this.state.facet(vu))o(t)}get themeClasses(){return _u+" "+(this.state.facet(bu)?Q2:Z2)+" "+this.state.facet(Ol)}updateAttrs(){let e=Bm(this,I2,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Yi)?"true":"false",class:"cm-content",style:`${De.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),Bm(this,V0,t);let i=this.observer.ignore(()=>{let n=du(this.contentDOM,this.contentAttrs,t),s=du(this.dom,this.editorAttrs,e);return n||s});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let n of i.effects)if(n.is(Oe.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=n.value}}mountStyles(){this.styleModules=this.state.facet(Ra);let e=this.state.facet(Oe.cspNonce);In.mount(this.root,this.styleModules.concat(UD).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return rh(this,e,vm(this,e,t,i))}moveByGroup(e,t){return rh(this,e,vm(this,e,t,i=>tD(this,e.head,i)))}visualLineSide(e,t){let i=this.bidiSpans(e),n=this.textDirectionAt(e.from),s=i[t?i.length-1:0];return ke.cursor(s.side(t,n)+e.from,s.forward(!t,n)?1:-1)}moveToLineBoundary(e,t,i=!0){return eD(this,e,t,i)}moveVertically(e,t,i){return rh(this,e,rD(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),U2(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(e),s=this.bidiSpans(n),a=s[Tn.find(s,e-n.from,-1,t)];return qo(i,a.dir==pt.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(F2)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>jD)return b2(e.length);let t=this.textDirectionAt(e.from),i;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||k2(s.isolates,i=um(this,e))))return s.order;i||(i=um(this,e));let n=N8(e.text,t,i);return this.bidiCache.push(new Rc(e.from,e.to,t,i,!0,n)),n}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||De.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{s2(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return _l.of(new Ks(typeof e=="number"?ke.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return _l.of(new Ks(ke.cursor(i.from),"start","start",i.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return St.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return St.define(()=>({}),{eventObservers:e})}static theme(e,t){let i=In.newName(),n=[Ol.of(i),Ra.of(Su(`.${i}`,e))];return t&&t.dark&&n.push(bu.of(!0)),n}static baseTheme(e){return bs.lowest(Ra.of(Su("."+_u,e,ey)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),n=i&&ct.get(i)||ct.get(e);return((t=n==null?void 0:n.rootView)===null||t===void 0?void 0:t.view)||null}}Oe.styleModule=Ra;Oe.inputHandler=A2;Oe.clipboardInputFilter=z0;Oe.clipboardOutputFilter=W0;Oe.scrollHandler=R2;Oe.focusChangeEffect=O2;Oe.perLineTextDirection=F2;Oe.exceptionSink=C2;Oe.updateListener=vu;Oe.editable=Yi;Oe.mouseSelectionStyle=E2;Oe.dragMovesSelection=T2;Oe.clickAddsSelectionRange=S2;Oe.decorations=Co;Oe.outerDecorations=P2;Oe.atomicRanges=Zo;Oe.bidiIsolatedRanges=L2;Oe.scrollMargins=B2;Oe.darkTheme=bu;Oe.cspNonce=Re.define({combine:r=>r.length?r[0]:""});Oe.contentAttributes=V0;Oe.editorAttributes=I2;Oe.lineWrapping=Oe.contentAttributes.of({class:"cm-lineWrapping"});Oe.announce=Xe.define();const jD=4096,Lm={};class Rc{constructor(e,t,i,n,s,a){this.from=e,this.to=t,this.dir=i,this.isolates=n,this.fresh=s,this.order=a}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let i=[],n=e.length?e[e.length-1].dir:pt.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let a=e[s];a.dir==n&&!t.touchesRange(a.from,a.to)&&i.push(new Rc(t.mapPos(a.from,1),t.mapPos(a.to,-1),a.dir,a.isolates,!1,a.order))}return i}}function Bm(r,e,t){for(let i=r.state.facet(e),n=i.length-1;n>=0;n--){let s=i[n],a=typeof s=="function"?s(r):s;a&&uu(a,t)}return t}const $D=De.mac?"mac":De.windows?"win":De.linux?"linux":"key";function GD(r,e){const t=r.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let n,s,a,o;for(let l=0;l<t.length-1;++l){const c=t[l];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))a=!0;else if(/^mod$/i.test(c))e=="mac"?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(i="Alt-"+i),s&&(i="Ctrl-"+i),o&&(i="Meta-"+i),a&&(i="Shift-"+i),i}function Fl(r,e,t){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),t!==!1&&e.shiftKey&&(r="Shift-"+r),r}const KD=bs.default(Oe.domEventHandlers({keydown(r,e){return ry(ty(e.state),r,e,"editor")}})),xf=Re.define({enables:KD}),Nm=new WeakMap;function ty(r){let e=r.facet(xf),t=Nm.get(e);return t||Nm.set(e,t=YD(e.reduce((i,n)=>i.concat(n),[]))),t}function XD(r,e,t){return ry(ty(r.state),e,r,t)}let wn=null;const qD=4e3;function YD(r,e=$D){let t=Object.create(null),i=Object.create(null),n=(a,o)=>{let l=i[a];if(l==null)i[a]=o;else if(l!=o)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},s=(a,o,l,c,f)=>{var h,u;let d=t[a]||(t[a]=Object.create(null)),m=o.split(/ (?!$)/).map(x=>GD(x,e));for(let x=1;x<m.length;x++){let y=m.slice(0,x).join(" ");n(y,!0),d[y]||(d[y]={preventDefault:!0,stopPropagation:!1,run:[w=>{let T=wn={view:w,prefix:y,scope:a};return setTimeout(()=>{wn==T&&(wn=null)},qD),!0}]})}let p=m.join(" ");n(p,!1);let g=d[p]||(d[p]={preventDefault:!1,stopPropagation:!1,run:((u=(h=d._any)===null||h===void 0?void 0:h.run)===null||u===void 0?void 0:u.slice())||[]});l&&g.run.push(l),c&&(g.preventDefault=!0),f&&(g.stopPropagation=!0)};for(let a of r){let o=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let c of o){let f=t[c]||(t[c]=Object.create(null));f._any||(f._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=a;for(let u in f)f[u].run.push(d=>h(d,Tu))}let l=a[e]||a.key;if(l)for(let c of o)s(c,l,a.run,a.preventDefault,a.stopPropagation),a.shift&&s(c,"Shift-"+l,a.shift,a.preventDefault,a.stopPropagation)}return t}let Tu=null;function ry(r,e,t,i){Tu=e;let n=v8(e),s=Or(n,0),a=Fi(s)==n.length&&n!=" ",o="",l=!1,c=!1,f=!1;wn&&wn.view==t&&wn.scope==i&&(o=wn.prefix+" ",j2.indexOf(e.keyCode)<0&&(c=!0,wn=null));let h=new Set,u=g=>{if(g){for(let x of g.run)if(!h.has(x)&&(h.add(x),x(t)))return g.stopPropagation&&(f=!0),!0;g.preventDefault&&(g.stopPropagation&&(f=!0),c=!0)}return!1},d=r[i],m,p;return d&&(u(d[o+Fl(n,e,!a)])?l=!0:a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(De.windows&&e.ctrlKey&&e.altKey)&&!(De.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(m=Pn[e.keyCode])&&m!=n?(u(d[o+Fl(m,e,!0)])||e.shiftKey&&(p=To[e.keyCode])!=n&&p!=m&&u(d[o+Fl(p,e,!1)]))&&(l=!0):a&&e.shiftKey&&u(d[o+Fl(n,e,!0)])&&(l=!0),!l&&u(d._any)&&(l=!0)),c&&(l=!0),l&&f&&e.stopPropagation(),Tu=null,l}class Qo{constructor(e,t,i,n,s){this.className=e,this.left=t,this.top=i,this.width=n,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,i){if(i.empty){let n=e.coordsAtPos(i.head,i.assoc||1);if(!n)return[];let s=iy(e);return[new Qo(t,n.left-s.left,n.top-s.top,null,n.bottom-n.top)]}else return JD(e,t,i)}}function iy(r){let e=r.scrollDOM.getBoundingClientRect();return{left:(r.textDirection==pt.LTR?e.left:e.right-r.scrollDOM.clientWidth*r.scaleX)-r.scrollDOM.scrollLeft*r.scaleX,top:e.top-r.scrollDOM.scrollTop*r.scaleY}}function Um(r,e,t,i){let n=r.coordsAtPos(e,t*2);if(!n)return i;let s=r.dom.getBoundingClientRect(),a=(n.top+n.bottom)/2,o=r.posAtCoords({x:s.left+1,y:a}),l=r.posAtCoords({x:s.right-1,y:a});return o==null||l==null?i:{from:Math.max(i.from,Math.min(o,l)),to:Math.min(i.to,Math.max(o,l))}}function JD(r,e,t){if(t.to<=r.viewport.from||t.from>=r.viewport.to)return[];let i=Math.max(t.from,r.viewport.from),n=Math.min(t.to,r.viewport.to),s=r.textDirection==pt.LTR,a=r.contentDOM,o=a.getBoundingClientRect(),l=iy(r),c=a.querySelector(".cm-line"),f=c&&window.getComputedStyle(c),h=o.left+(f?parseInt(f.paddingLeft)+Math.min(0,parseInt(f.textIndent)):0),u=o.right-(f?parseInt(f.paddingRight):0),d=wu(r,i,1),m=wu(r,n,-1),p=d.type==_r.Text?d:null,g=m.type==_r.Text?m:null;if(p&&(r.lineWrapping||d.widgetLineBreaks)&&(p=Um(r,i,1,p)),g&&(r.lineWrapping||m.widgetLineBreaks)&&(g=Um(r,n,-1,g)),p&&g&&p.from==g.from&&p.to==g.to)return y(w(t.from,t.to,p));{let C=p?w(t.from,null,p):T(d,!1),R=g?w(null,t.to,g):T(m,!0),_=[];return(p||d).to<(g||m).from-(p&&g?1:0)||d.widgetLineBreaks>1&&C.bottom+r.defaultLineHeight/2<R.top?_.push(x(h,C.bottom,u,R.top)):C.bottom<R.top&&r.elementAtHeight((C.bottom+R.top)/2).type==_r.Text&&(C.bottom=R.top=(C.bottom+R.top)/2),y(C).concat(_).concat(y(R))}function x(C,R,_,A){return new Qo(e,C-l.left,R-l.top,_-C,A-R)}function y({top:C,bottom:R,horizontal:_}){let A=[];for(let k=0;k<_.length;k+=2)A.push(x(_[k],C,_[k+1],R));return A}function w(C,R,_){let A=1e9,k=-1e9,I=[];function N(E,Q,ae,Z,xe){let L=r.coordsAtPos(E,E==_.to?-2:2),ge=r.coordsAtPos(ae,ae==_.from?2:-2);!L||!ge||(A=Math.min(L.top,ge.top,A),k=Math.max(L.bottom,ge.bottom,k),xe==pt.LTR?I.push(s&&Q?h:L.left,s&&Z?u:ge.right):I.push(!s&&Z?h:ge.left,!s&&Q?u:L.right))}let S=C??_.from,W=R??_.to;for(let E of r.visibleRanges)if(E.to>S&&E.from<W)for(let Q=Math.max(E.from,S),ae=Math.min(E.to,W);;){let Z=r.state.doc.lineAt(Q);for(let xe of r.bidiSpans(Z)){let L=xe.from+Z.from,ge=xe.to+Z.from;if(L>=ae)break;ge>Q&&N(Math.max(L,Q),C==null&&L<=S,Math.min(ge,ae),R==null&&ge>=W,xe.dir)}if(Q=Z.to+1,Q>=ae)break}return I.length==0&&N(S,C==null,W,R==null,r.textDirection),{top:A,bottom:k,horizontal:I}}function T(C,R){let _=o.top+(R?C.top:C.bottom);return{top:_,bottom:_,horizontal:[]}}}function ZD(r,e){return r.constructor==e.constructor&&r.eq(e)}class QD{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Ql)!=e.state.facet(Ql)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,i=e.facet(Ql);for(;t<i.length&&i[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,i)=>!ZD(t,this.drawn[i]))){let t=this.dom.firstChild,i=0;for(let n of e)n.update&&t&&n.constructor&&this.drawn[i].constructor&&n.update(t,this.drawn[i])?(t=t.nextSibling,i++):this.dom.insertBefore(n.draw(),t);for(;t;){let n=t.nextSibling;t.remove(),t=n}this.drawn=e,De.ios&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Ql=Re.define();function ny(r){return[St.define(e=>new QD(e,r)),Ql.of(r)]}const Ao=Re.define({combine(r){return Wi(r,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function eR(r={}){return[Ao.of(r),tR,rR,iR,D2.of(!0)]}function sy(r){return r.startState.facet(Ao)!=r.state.facet(Ao)}const tR=ny({above:!0,markers(r){let{state:e}=r,t=e.facet(Ao),i=[];for(let n of e.selection.ranges){let s=n==e.selection.main;if(n.empty||t.drawRangeCursor){let a=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",o=n.empty?n:ke.cursor(n.head,n.head>n.anchor?-1:1);for(let l of Qo.forRange(r,a,o))i.push(l)}}return i},update(r,e){r.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=sy(r);return t&&Hm(r.state,e),r.docChanged||r.selectionSet||t},mount(r,e){Hm(e.state,r)},class:"cm-cursorLayer"});function Hm(r,e){e.style.animationDuration=r.facet(Ao).cursorBlinkRate+"ms"}const rR=ny({above:!1,markers(r){return r.state.selection.ranges.map(e=>e.empty?[]:Qo.forRange(r,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(r,e){return r.docChanged||r.selectionSet||r.viewportChanged||sy(r)},class:"cm-selectionLayer"}),iR=bs.highest(Oe.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),ay=Xe.define({map(r,e){return r==null?null:e.mapPos(r)}}),Pa=Yt.define({create(){return null},update(r,e){return r!=null&&(r=e.changes.mapPos(r)),e.effects.reduce((t,i)=>i.is(ay)?i.value:t,r)}}),nR=St.fromClass(class{constructor(r){this.view=r,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(r){var e;let t=r.state.field(Pa);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(r.startState.field(Pa)!=t||r.docChanged||r.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:r}=this,e=r.state.field(Pa),t=e!=null&&r.coordsAtPos(e);if(!t)return null;let i=r.scrollDOM.getBoundingClientRect();return{left:t.left-i.left+r.scrollDOM.scrollLeft*r.scaleX,top:t.top-i.top+r.scrollDOM.scrollTop*r.scaleY,height:t.bottom-t.top}}drawCursor(r){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;r?(this.cursor.style.left=r.left/e+"px",this.cursor.style.top=r.top/t+"px",this.cursor.style.height=r.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(r){this.view.state.field(Pa)!=r&&this.view.dispatch({effects:ay.of(r)})}},{eventObservers:{dragover(r){this.setDropPos(this.view.posAtCoords({x:r.clientX,y:r.clientY}))},dragleave(r){(r.target==this.view.contentDOM||!this.view.contentDOM.contains(r.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function sR(){return[Pa,nR]}function zm(r,e,t,i,n){e.lastIndex=0;for(let s=r.iterRange(t,i),a=t,o;!s.next().done;a+=s.value.length)if(!s.lineBreak)for(;o=e.exec(s.value);)n(a+o.index,o)}function aR(r,e){let t=r.visibleRanges;if(t.length==1&&t[0].from==r.viewport.from&&t[0].to==r.viewport.to)return t;let i=[];for(let{from:n,to:s}of t)n=Math.max(r.state.doc.lineAt(n).from,n-e),s=Math.min(r.state.doc.lineAt(s).to,s+e),i.length&&i[i.length-1].to>=n?i[i.length-1].to=s:i.push({from:n,to:s});return i}class oR{constructor(e){const{regexp:t,decoration:i,decorate:n,boundary:s,maxLength:a=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,n)this.addMatch=(o,l,c,f)=>n(f,c,c+o[0].length,o,l);else if(typeof i=="function")this.addMatch=(o,l,c,f)=>{let h=i(o,l,c);h&&f(c,c+o[0].length,h)};else if(i)this.addMatch=(o,l,c,f)=>f(c,c+o[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=a}createDeco(e){let t=new an,i=t.add.bind(t);for(let{from:n,to:s}of aR(e,this.maxLength))zm(e.state.doc,this.regexp,n,s,(a,o)=>this.addMatch(o,e,a,i));return t.finish()}updateDeco(e,t){let i=1e9,n=-1;return e.docChanged&&e.changes.iterChanges((s,a,o,l)=>{l>=e.view.viewport.from&&o<=e.view.viewport.to&&(i=Math.min(o,i),n=Math.max(l,n))}),e.viewportMoved||n-i>1e3?this.createDeco(e.view):n>-1?this.updateRange(e.view,t.map(e.changes),i,n):t}updateRange(e,t,i,n){for(let s of e.visibleRanges){let a=Math.max(s.from,i),o=Math.min(s.to,n);if(o>=a){let l=e.state.doc.lineAt(a),c=l.to<o?e.state.doc.lineAt(o):l,f=Math.max(s.from,l.from),h=Math.min(s.to,c.to);if(this.boundary){for(;a>l.from;a--)if(this.boundary.test(l.text[a-1-l.from])){f=a;break}for(;o<c.to;o++)if(this.boundary.test(c.text[o-c.from])){h=o;break}}let u=[],d,m=(p,g,x)=>u.push(x.range(p,g));if(l==c)for(this.regexp.lastIndex=f-l.from;(d=this.regexp.exec(l.text))&&d.index<h-l.from;)this.addMatch(d,e,d.index+l.from,m);else zm(e.state.doc,this.regexp,f,h,(p,g)=>this.addMatch(g,e,p,m));t=t.update({filterFrom:f,filterTo:h,filter:(p,g)=>p<f||g>h,add:u})}}return t}}const Eu=/x/.unicode!=null?"gu":"g",lR=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,Eu),cR={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let sh=null;function fR(){var r;if(sh==null&&typeof document<"u"&&document.body){let e=document.body.style;sh=((r=e.tabSize)!==null&&r!==void 0?r:e.MozTabSize)!=null}return sh||!1}const ec=Re.define({combine(r){let e=Wi(r,{render:null,specialChars:lR,addSpecialChars:null});return(e.replaceTabs=!fR())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Eu)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Eu)),e}});function hR(r={}){return[ec.of(r),uR()]}let Wm=null;function uR(){return Wm||(Wm=St.fromClass(class{constructor(r){this.view=r,this.decorations=Be.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(r.state.facet(ec)),this.decorations=this.decorator.createDeco(r)}makeDecorator(r){return new oR({regexp:r.specialChars,decoration:(e,t,i)=>{let{doc:n}=t.state,s=Or(e[0],0);if(s==9){let a=n.lineAt(i),o=t.state.tabSize,l=da(a.text,o,i-a.from);return Be.replace({widget:new gR((o-l%o)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=Be.replace({widget:new mR(r,s)}))},boundary:r.replaceTabs?void 0:/[^]/})}update(r){let e=r.state.facet(ec);r.startState.facet(ec)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(r.view)):this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations}))}const dR="";function pR(r){return r>=32?dR:r==10?"":String.fromCharCode(9216+r)}class mR extends un{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=pR(this.code),i=e.state.phrase("Control character")+" "+(cR[this.code]||"0x"+this.code.toString(16)),n=this.options.render&&this.options.render(this.code,i,t);if(n)return n;let s=document.createElement("span");return s.textContent=t,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class gR extends un{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function xR(){return yR}const vR=Be.line({class:"cm-activeLine"}),yR=St.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.docChanged||r.selectionSet)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=-1,t=[];for(let i of r.state.selection.ranges){let n=r.lineBlockAt(i.head);n.from>e&&(t.push(vR.range(n.from)),e=n.from)}return Be.set(t)}},{decorations:r=>r.decorations});class wR extends un{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?ra(e.firstChild):[];if(!t.length)return null;let i=window.getComputedStyle(e.parentNode),n=qo(t[0],i.direction!="rtl"),s=parseInt(i.lineHeight);return n.bottom-n.top>s*1.5?{left:n.left,right:n.right,top:n.top,bottom:n.top+s}:n}ignoreEvent(){return!1}}function kR(r){let e=St.fromClass(class{constructor(t){this.view=t,this.placeholder=r?Be.set([Be.widget({widget:new wR(r),side:1}).range(0)]):Be.none}get decorations(){return this.view.state.doc.length?Be.none:this.placeholder}},{decorations:t=>t.decorations});return typeof r=="string"?[e,Oe.contentAttributes.of({"aria-placeholder":r})]:e}const Cu=2e3;function bR(r,e,t){let i=Math.min(e.line,t.line),n=Math.max(e.line,t.line),s=[];if(e.off>Cu||t.off>Cu||e.col<0||t.col<0){let a=Math.min(e.off,t.off),o=Math.max(e.off,t.off);for(let l=i;l<=n;l++){let c=r.doc.line(l);c.length<=o&&s.push(ke.range(c.from+a,c.to+o))}}else{let a=Math.min(e.col,t.col),o=Math.max(e.col,t.col);for(let l=i;l<=n;l++){let c=r.doc.line(l),f=su(c.text,a,r.tabSize,!0);if(f<0)s.push(ke.cursor(c.to));else{let h=su(c.text,o,r.tabSize);s.push(ke.range(c.from+f,c.from+h))}}}return s}function _R(r,e){let t=r.coordsAtPos(r.viewport.from);return t?Math.round(Math.abs((t.left-e)/r.defaultCharacterWidth)):-1}function Vm(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1),i=r.state.doc.lineAt(t),n=t-i.from,s=n>Cu?-1:n==i.length?_R(r,e.clientX):da(i.text,r.state.tabSize,t-i.from);return{line:i.number,col:s,off:n}}function SR(r,e){let t=Vm(r,e),i=r.state.selection;return t?{update(n){if(n.docChanged){let s=n.changes.mapPos(n.startState.doc.line(t.line).from),a=n.state.doc.lineAt(s);t={line:a.number,col:t.col,off:Math.min(t.off,a.length)},i=i.map(n.changes)}},get(n,s,a){let o=Vm(r,n);if(!o)return i;let l=bR(r.state,t,o);return l.length?a?ke.create(l.concat(i.ranges)):ke.create(l):i}}:null}function TR(r){let e=t=>t.altKey&&t.button==0;return Oe.mouseSelectionStyle.of((t,i)=>e(i)?SR(t,i):null)}const ER={Alt:[18,r=>!!r.altKey],Control:[17,r=>!!r.ctrlKey],Shift:[16,r=>!!r.shiftKey],Meta:[91,r=>!!r.metaKey]},CR={style:"cursor: crosshair"};function AR(r={}){let[e,t]=ER[r.key||"Alt"],i=St.fromClass(class{constructor(n){this.view=n,this.isDown=!1}set(n){this.isDown!=n&&(this.isDown=n,this.view.update([]))}},{eventObservers:{keydown(n){this.set(n.keyCode==e||t(n))},keyup(n){(n.keyCode==e||!t(n))&&this.set(!1)},mousemove(n){this.set(t(n))}}});return[i,Oe.contentAttributes.of(n=>{var s;return!((s=n.plugin(i))===null||s===void 0)&&s.isDown?CR:null})]}const _a="-10000px";class oy{constructor(e,t,i,n){this.facet=t,this.createTooltipView=i,this.removeTooltipView=n,this.input=e.state.facet(t),this.tooltips=this.input.filter(a=>a);let s=null;this.tooltipViews=this.tooltips.map(a=>s=i(a,s))}update(e,t){var i;let n=e.state.facet(this.facet),s=n.filter(l=>l);if(n===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let a=[],o=t?[]:null;for(let l=0;l<s.length;l++){let c=s[l],f=-1;if(c){for(let h=0;h<this.tooltips.length;h++){let u=this.tooltips[h];u&&u.create==c.create&&(f=h)}if(f<0)a[l]=this.createTooltipView(c,l?a[l-1]:null),o&&(o[l]=!!c.above);else{let h=a[l]=this.tooltipViews[f];o&&(o[l]=t[f]),h.update&&h.update(e)}}}for(let l of this.tooltipViews)a.indexOf(l)<0&&(this.removeTooltipView(l),(i=l.destroy)===null||i===void 0||i.call(l));return t&&(o.forEach((l,c)=>t[c]=l),t.length=o.length),this.input=n,this.tooltips=s,this.tooltipViews=a,!0}}function OR(r){let e=r.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const ah=Re.define({combine:r=>{var e,t,i;return{position:De.ios?"absolute":((e=r.find(n=>n.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=r.find(n=>n.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=r.find(n=>n.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||OR}}}),jm=new WeakMap,X0=St.fromClass(class{constructor(r){this.view=r,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=r.state.facet(ah);this.position=e.position,this.parent=e.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new oy(r,q0,(t,i)=>this.createTooltip(t,i),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(r,this.above);e&&this.observeIntersection();let t=e||r.geometryChanged,i=r.state.facet(ah);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let n of this.manager.tooltipViews)n.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let n of this.manager.tooltipViews)this.container.appendChild(n.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(r,e){let t=r.create(this.view),i=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),r.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let n=document.createElement("div");n.className="cm-tooltip-arrow",t.dom.appendChild(n)}return t.dom.style.position=this.position,t.dom.style.top=_a,t.dom.style.left="0px",this.container.insertBefore(t.dom,i),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var r,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(r=i.destroy)===null||r===void 0||r.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(De.gecko)t=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==_a&&s.style.left=="0px"){let a=s.getBoundingClientRect();t=Math.abs(a.top+1e4)>1||Math.abs(a.left)>1}}if(t||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(r=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:r,scaleY:e}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),n=j0(this.view);return{visible:{left:i.left+n.left,top:i.top+n.top,right:i.right-n.right,bottom:i.bottom-n.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,a)=>{let o=this.manager.tooltipViews[a];return o.getCoords?o.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(ah).tooltipSpace(this.view),scaleX:r,scaleY:e,makeAbsolute:t}}writeMeasure(r){var e;if(r.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let o of this.manager.tooltipViews)o.dom.style.position="absolute"}let{visible:t,space:i,scaleX:n,scaleY:s}=r,a=[];for(let o=0;o<this.manager.tooltips.length;o++){let l=this.manager.tooltips[o],c=this.manager.tooltipViews[o],{dom:f}=c,h=r.pos[o],u=r.size[o];if(!h||l.clip!==!1&&(h.bottom<=Math.max(t.top,i.top)||h.top>=Math.min(t.bottom,i.bottom)||h.right<Math.max(t.left,i.left)-.1||h.left>Math.min(t.right,i.right)+.1)){f.style.top=_a;continue}let d=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,m=d?7:0,p=u.right-u.left,g=(e=jm.get(c))!==null&&e!==void 0?e:u.bottom-u.top,x=c.offset||DR,y=this.view.textDirection==pt.LTR,w=u.width>i.right-i.left?y?i.left:i.right-u.width:y?Math.max(i.left,Math.min(h.left-(d?14:0)+x.x,i.right-p)):Math.min(Math.max(i.left,h.left-p+(d?14:0)-x.x),i.right-p),T=this.above[o];!l.strictSide&&(T?h.top-g-m-x.y<i.top:h.bottom+g+m+x.y>i.bottom)&&T==i.bottom-h.bottom>h.top-i.top&&(T=this.above[o]=!T);let C=(T?h.top-i.top:i.bottom-h.bottom)-m;if(C<g&&c.resize!==!1){if(C<this.view.defaultLineHeight){f.style.top=_a;continue}jm.set(c,g),f.style.height=(g=C)/s+"px"}else f.style.height&&(f.style.height="");let R=T?h.top-g-m-x.y:h.bottom+m+x.y,_=w+p;if(c.overlap!==!0)for(let A of a)A.left<_&&A.right>w&&A.top<R+g&&A.bottom>R&&(R=T?A.top-g-2-m:A.bottom+m+2);if(this.position=="absolute"?(f.style.top=(R-r.parent.top)/s+"px",$m(f,(w-r.parent.left)/n)):(f.style.top=R/s+"px",$m(f,w/n)),d){let A=h.left+(y?x.x:-x.x)-(w+14-7);d.style.left=A/n+"px"}c.overlap!==!0&&a.push({left:w,top:R,right:_,bottom:R+g}),f.classList.toggle("cm-tooltip-above",T),f.classList.toggle("cm-tooltip-below",!T),c.positioned&&c.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=_a}},{eventObservers:{scroll(){this.maybeMeasure()}}});function $m(r,e){let t=parseInt(r.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(r.style.left=e+"px")}const FR=Oe.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),DR={x:0,y:0},q0=Re.define({enables:[X0,FR]}),Mc=Re.define({combine:r=>r.reduce((e,t)=>e.concat(t),[])});class vf{static create(e){return new vf(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new oy(e,Mc,(t,i)=>this.createHostedView(t,i),t=>t.dom.remove())}createHostedView(e,t){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let i of this.manager.tooltipViews){let n=i[e];if(n!==void 0){if(t===void 0)t=n;else if(t!==n)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const RR=q0.compute([Mc],r=>{let e=r.facet(Mc);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var i;return(i=t.end)!==null&&i!==void 0?i:t.pos})),create:vf.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class MR{constructor(e,t,i,n,s){this.view=e,this.source=t,this.field=i,this.setHover=n,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,i=e.docView.nearest(t.target);if(!i)return;let n,s=1;if(i instanceof Sn)n=i.posAtStart;else{if(n=e.posAtCoords(t),n==null)return;let o=e.coordsAtPos(n);if(!o||t.y<o.top||t.y>o.bottom||t.x<o.left-e.defaultCharacterWidth||t.x>o.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(n)).find(f=>f.from<=n&&f.to>=n),c=l&&l.dir==pt.RTL?-1:1;s=t.x<o.left?-c:c}let a=this.source(e,n,s);if(a!=null&&a.then){let o=this.pending={pos:n};a.then(l=>{this.pending==o&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>Rr(e.state,l,"hover tooltip"))}else a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])})}get tooltip(){let e=this.view.plugin(X0),t=e?e.manager.tooltips.findIndex(i=>i.create==vf.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:s}=this;if(n.length&&s&&!IR(s.dom,e)||this.pending){let{pos:a}=n[0]||this.pending,o=(i=(t=n[0])===null||t===void 0?void 0:t.end)!==null&&i!==void 0?i:a;(a==o?this.view.posAtCoords(this.lastMove)!=a:!PR(this.view,a,o,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=i=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Dl=4;function IR(r,e){let{left:t,right:i,top:n,bottom:s}=r.getBoundingClientRect(),a;if(a=r.querySelector(".cm-tooltip-arrow")){let o=a.getBoundingClientRect();n=Math.min(o.top,n),s=Math.max(o.bottom,s)}return e.clientX>=t-Dl&&e.clientX<=i+Dl&&e.clientY>=n-Dl&&e.clientY<=s+Dl}function PR(r,e,t,i,n,s){let a=r.scrollDOM.getBoundingClientRect(),o=r.documentTop+r.documentPadding.top+r.contentHeight;if(a.left>i||a.right<i||a.top>n||Math.min(a.bottom,o)<n)return!1;let l=r.posAtCoords({x:i,y:n},!1);return l>=e&&l<=t}function LR(r,e={}){let t=Xe.define(),i=Yt.define({create(){return[]},update(n,s){if(n.length&&(e.hideOnChange&&(s.docChanged||s.selection)?n=[]:e.hideOn&&(n=n.filter(a=>!e.hideOn(s,a))),s.docChanged)){let a=[];for(let o of n){let l=s.changes.mapPos(o.pos,-1,yr.TrackDel);if(l!=null){let c=Object.assign(Object.create(null),o);c.pos=l,c.end!=null&&(c.end=s.changes.mapPos(c.end)),a.push(c)}}n=a}for(let a of s.effects)a.is(t)&&(n=a.value),a.is(BR)&&(n=[]);return n},provide:n=>Mc.from(n)});return{active:i,extension:[i,St.define(n=>new MR(n,r,i,t,e.hoverTime||300)),RR]}}function ly(r,e){let t=r.plugin(X0);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}const BR=Xe.define(),Gm=Re.define({combine(r){let e,t;for(let i of r)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Oo(r,e){let t=r.plugin(cy),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const cy=St.fromClass(class{constructor(r){this.input=r.state.facet(Fo),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(r));let e=r.state.facet(Gm);this.top=new Rl(r,!0,e.topContainer),this.bottom=new Rl(r,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(r){let e=r.state.facet(Gm);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Rl(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Rl(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=r.state.facet(Fo);if(t!=this.input){let i=t.filter(l=>l),n=[],s=[],a=[],o=[];for(let l of i){let c=this.specs.indexOf(l),f;c<0?(f=l(r.view),o.push(f)):(f=this.panels[c],f.update&&f.update(r)),n.push(f),(f.top?s:a).push(f)}this.specs=i,this.panels=n,this.top.sync(s),this.bottom.sync(a);for(let l of o)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let i of this.panels)i.update&&i.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>Oe.scrollMargins.of(e=>{let t=e.plugin(r);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Rl{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Km(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Km(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Km(r){let e=r.nextSibling;return r.remove(),e}const Fo=Re.define({enables:cy});class ln extends fs{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}ln.prototype.elementClass="";ln.prototype.toDOM=void 0;ln.prototype.mapMode=yr.TrackBefore;ln.prototype.startSide=ln.prototype.endSide=-1;ln.prototype.point=!0;const tc=Re.define(),NR=Re.define(),UR={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>tt.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},so=Re.define();function HR(r){return[fy(),so.of({...UR,...r})]}const Xm=Re.define({combine:r=>r.some(e=>e)});function fy(r){return[zR]}const zR=St.fromClass(class{constructor(r){this.view=r,this.domAfter=null,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=r.state.facet(so).map(e=>new Ym(r,e)),this.fixed=!r.state.facet(Xm);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(r){if(this.updateGutters(r)){let e=this.prevViewport,t=r.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}if(r.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(Xm)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let t=tt.iter(this.view.state.facet(tc),this.view.viewport.from),i=[],n=this.gutters.map(s=>new WR(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(s.type)){let a=!0;for(let o of s.type)if(o.type==_r.Text&&a){Au(t,i,o.from);for(let l of n)l.line(this.view,o,i);a=!1}else if(o.widget)for(let l of n)l.widget(this.view,o)}else if(s.type==_r.Text){Au(t,i,s.from);for(let a of n)a.line(this.view,s,i)}else if(s.widget)for(let a of n)a.widget(this.view,s);for(let s of n)s.finish();r&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(r){let e=r.startState.facet(so),t=r.state.facet(so),i=r.docChanged||r.heightChanged||r.viewportChanged||!tt.eq(r.startState.facet(tc),r.state.facet(tc),r.view.viewport.from,r.view.viewport.to);if(e==t)for(let n of this.gutters)n.update(r)&&(i=!0);else{i=!0;let n=[];for(let s of t){let a=e.indexOf(s);a<0?n.push(new Ym(this.view,s)):(this.gutters[a].update(r),n.push(this.gutters[a]))}for(let s of this.gutters)s.dom.remove(),n.indexOf(s)<0&&s.destroy();for(let s of n)s.config.side=="after"?this.getDOMAfter().appendChild(s.dom):this.dom.appendChild(s.dom);this.gutters=n}return i}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:r=>Oe.scrollMargins.of(e=>{let t=e.plugin(r);if(!t||t.gutters.length==0||!t.fixed)return null;let i=t.dom.offsetWidth*e.scaleX,n=t.domAfter?t.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==pt.LTR?{left:i,right:n}:{right:i,left:n}})});function qm(r){return Array.isArray(r)?r:[r]}function Au(r,e,t){for(;r.value&&r.from<=t;)r.from==t&&e.push(r.value),r.next()}class WR{constructor(e,t,i){this.gutter=e,this.height=i,this.i=0,this.cursor=tt.iter(e.markers,t.from)}addElement(e,t,i){let{gutter:n}=this,s=(t.top-this.height)/e.scaleY,a=t.height/e.scaleY;if(this.i==n.elements.length){let o=new hy(e,a,s,i);n.elements.push(o),n.dom.appendChild(o.dom)}else n.elements[this.i].update(e,a,s,i);this.height=t.bottom,this.i++}line(e,t,i){let n=[];Au(this.cursor,n,t.from),i.length&&(n=n.concat(i));let s=this.gutter.config.lineMarker(e,t,n);s&&n.unshift(s);let a=this.gutter;n.length==0&&!a.config.renderEmptyElements||this.addElement(e,t,n)}widget(e,t){let i=this.gutter.config.widgetMarker(e,t.widget,t),n=i?[i]:null;for(let s of e.state.facet(NR)){let a=s(e,t.widget,t);a&&(n||(n=[])).push(a)}n&&this.addElement(e,t,n)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Ym{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,n=>{let s=n.target,a;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let l=s.getBoundingClientRect();a=(l.top+l.bottom)/2}else a=n.clientY;let o=e.lineBlockAtHeight(a-e.documentTop);t.domEventHandlers[i](e,o,n)&&n.preventDefault()});this.markers=qm(t.markers(e)),t.initialSpacer&&(this.spacer=new hy(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=qm(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let n=this.config.updateSpacer(this.spacer.markers[0],e);n!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[n])}let i=e.view.viewport;return!tt.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class hy{constructor(e,t,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,n)}update(e,t,i,n){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),VR(this.markers,n)||this.setMarkers(e,n)}setMarkers(e,t){let i="cm-gutterElement",n=this.dom.firstChild;for(let s=0,a=0;;){let o=a,l=s<t.length?t[s++]:null,c=!1;if(l){let f=l.elementClass;f&&(i+=" "+f);for(let h=a;h<this.markers.length;h++)if(this.markers[h].compare(l)){o=h,c=!0;break}}else o=this.markers.length;for(;a<o;){let f=this.markers[a++];if(f.toDOM){f.destroy(n);let h=n.nextSibling;n.remove(),n=h}}if(!l)break;l.toDOM&&(c?n=n.nextSibling:this.dom.insertBefore(l.toDOM(e),n)),c&&a++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function VR(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].compare(e[t]))return!1;return!0}const jR=Re.define(),$R=Re.define(),Ms=Re.define({combine(r){return Wi(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let n in t){let s=i[n],a=t[n];i[n]=s?(o,l,c)=>s(o,l,c)||a(o,l,c):a}return i}})}});class oh extends ln{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function lh(r,e){return r.state.facet(Ms).formatNumber(e,r.state)}const GR=so.compute([Ms],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(jR)},lineMarker(e,t,i){return i.some(n=>n.toDOM)?null:new oh(lh(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,i)=>{for(let n of e.state.facet($R)){let s=n(e,t,i);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(Ms)!=e.state.facet(Ms),initialSpacer(e){return new oh(lh(e,Jm(e.state.doc.lines)))},updateSpacer(e,t){let i=lh(t.view,Jm(t.view.state.doc.lines));return i==e.number?e:new oh(i)},domEventHandlers:r.facet(Ms).domEventHandlers,side:"before"}));function KR(r={}){return[Ms.of(r),fy(),GR]}function Jm(r){let e=9;for(;e<r;)e=e*10+9;return e}const XR=new class extends ln{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},qR=tc.compute(["selection"],r=>{let e=[],t=-1;for(let i of r.selection.ranges){let n=r.doc.lineAt(i.head).from;n>t&&(t=n,e.push(XR.range(n)))}return tt.of(e)});function YR(){return qR}const uy=1024;let JR=0;class ch{constructor(e,t){this.from=e,this.to=t}}class Ye{constructor(e={}){this.id=JR++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Ir.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}Ye.closedBy=new Ye({deserialize:r=>r.split(" ")});Ye.openedBy=new Ye({deserialize:r=>r.split(" ")});Ye.group=new Ye({deserialize:r=>r.split(" ")});Ye.isolate=new Ye({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});Ye.contextHash=new Ye({perNode:!0});Ye.lookAhead=new Ye({perNode:!0});Ye.mounted=new Ye({perNode:!0});class Ic{constructor(e,t,i){this.tree=e,this.overlay=t,this.parser=i}static get(e){return e&&e.props&&e.props[Ye.mounted.id]}}const ZR=Object.create(null);class Ir{constructor(e,t,i,n=0){this.name=e,this.props=t,this.id=i,this.flags=n}static define(e){let t=e.props&&e.props.length?Object.create(null):ZR,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),n=new Ir(e.name||"",t,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(n)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return n}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Ye.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let n of i.split(" "))t[n]=e[i];return i=>{for(let n=i.prop(Ye.group),s=-1;s<(n?n.length:0);s++){let a=t[s<0?i.name:n[s]];if(a)return a}}}}Ir.none=new Ir("",Object.create(null),0,8);class Y0{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let n=null;for(let s of e){let a=s(i);a&&(n||(n=Object.assign({},i.props)),n[a[0].id]=a[1])}t.push(n?new Ir(i.name,n,i.id,i.flags):i)}return new Y0(t)}}const Ml=new WeakMap,Zm=new WeakMap;var Ht;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(Ht||(Ht={}));class Ft{constructor(e,t,i,n,s){if(this.type=e,this.children=t,this.positions=i,this.length=n,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=Ic.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let n=i.toString();n&&(t&&(t+=","),t+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Fu(this.topNode,e)}cursorAt(e,t=0,i=0){let n=Ml.get(this)||this.topNode,s=new Fu(n);return s.moveTo(e,t),Ml.set(this,s._tree),s}get topNode(){return new Qr(this,0,0,null)}resolve(e,t=0){let i=Do(Ml.get(this)||this.topNode,e,t,!1);return Ml.set(this,i),i}resolveInner(e,t=0){let i=Do(Zm.get(this)||this.topNode,e,t,!0);return Zm.set(this,i),i}resolveStack(e,t=0){return t6(this,e,t)}iterate(e){let{enter:t,leave:i,from:n=0,to:s=this.length}=e,a=e.mode||0,o=(a&Ht.IncludeAnonymous)>0;for(let l=this.cursor(a|Ht.IncludeAnonymous);;){let c=!1;if(l.from<=s&&l.to>=n&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&i&&(o||!l.type.isAnonymous)&&i(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Q0(Ir.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,n)=>new Ft(this.type,t,i,n,this.propValues),e.makeTree||((t,i,n)=>new Ft(Ir.none,t,i,n)))}static build(e){return r6(e)}}Ft.empty=new Ft(Ir.none,[],[],0);class J0{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new J0(this.buffer,this.index)}}class Bn{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return Ir.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],n=this.set.types[t],s=n.name;if(/\W/.test(s)&&!n.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let a=[];for(;e<i;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,t,i,n,s){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(dy(s,n,a[l+1],a[l+2])&&(o=l,i>0));l=a[l+3]);return o}slice(e,t,i){let n=this.buffer,s=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){s[l++]=n[o++],s[l++]=n[o++]-i;let c=s[l++]=n[o++]-i;s[l++]=n[o++]-e,a=Math.max(a,c)}return new Bn(s,a,this.set)}}function dy(r,e,t,i){switch(r){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function Do(r,e,t,i){for(var n;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!i&&r instanceof Qr&&r.index<0?null:r.parent;if(!a)return r;r=a}let s=i?0:Ht.IgnoreOverlays;if(i)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof Qr&&a.index<0&&((n=o.enter(e,t,s))===null||n===void 0?void 0:n.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,s);if(!a)return r;r=a}}class py{cursor(e=0){return new Fu(this,e)}getChild(e,t=null,i=null){let n=Qm(this,e,t,i);return n.length?n[0]:null}getChildren(e,t=null,i=null){return Qm(this,e,t,i)}resolve(e,t=0){return Do(this,e,t,!1)}resolveInner(e,t=0){return Do(this,e,t,!0)}matchContext(e){return Ou(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),i=this;for(;t;){let n=t.lastChild;if(!n||n.to!=t.to)break;n.type.isError&&n.from==n.to?(i=t,t=n.prevSibling):t=n}return i}get node(){return this}get next(){return this.parent}}class Qr extends py{constructor(e,t,i,n){super(),this._tree=e,this.from=t,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,n,s=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,c=t>0?o.length:-1;e!=c;e+=t){let f=o[e],h=l[e]+a.from;if(dy(n,i,h,h+f.length)){if(f instanceof Bn){if(s&Ht.ExcludeBuffers)continue;let u=f.findChild(0,f.buffer.length,t,i-h,n);if(u>-1)return new En(new QR(a,f,e,h),null,u)}else if(s&Ht.IncludeAnonymous||!f.type.isAnonymous||Z0(f)){let u;if(!(s&Ht.IgnoreMounts)&&(u=Ic.get(f))&&!u.overlay)return new Qr(u.tree,h,e,a);let d=new Qr(f,h,e,a);return s&Ht.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?f.children.length-1:0,t,i,n)}}}if(s&Ht.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,i=0){let n;if(!(i&Ht.IgnoreOverlays)&&(n=Ic.get(this._tree))&&n.overlay){let s=e-this.from;for(let{from:a,to:o}of n.overlay)if((t>0?a<=s:a<s)&&(t<0?o>=s:o>s))return new Qr(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Qm(r,e,t,i){let n=r.cursor(),s=[];if(!n.firstChild())return s;if(t!=null){for(let a=!1;!a;)if(a=n.type.is(t),!n.nextSibling())return s}for(;;){if(i!=null&&n.type.is(i))return s;if(n.type.is(e)&&s.push(n.node),!n.nextSibling())return i==null?s:[]}}function Ou(r,e,t=e.length-1){for(let i=r;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}class QR{constructor(e,t,i,n){this.parent=e,this.buffer=t,this.index=i,this.start=n}}class En extends py{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,i){super(),this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,t,i){let{buffer:n}=this.context,s=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.context.start,i);return s<0?null:new En(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i=0){if(i&Ht.ExcludeBuffers)return null;let{buffer:n}=this.context,s=n.findChild(this.index+4,n.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new En(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new En(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new En(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,n=this.index+4,s=i.buffer[this.index+3];if(s>n){let a=i.buffer[this.index+1];e.push(i.slice(n,s,a)),t.push(0)}return new Ft(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function my(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let a=r[s];(a.from>t.from||a.to<t.to)&&(t=a,e=s)}let i=t instanceof Qr&&t.index<0?null:t.parent,n=r.slice();return i?n[e]=i:n.splice(e,1),new e6(n,t)}class e6{constructor(e,t){this.heads=e,this.node=t}get next(){return my(this.heads)}}function t6(r,e,t){let i=r.resolveInner(e,t),n=null;for(let s=i instanceof Qr?i:i.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(n||(n=[i])).push(a.resolve(e,t)),s=a}else{let a=Ic.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Qr(a.tree,a.overlay[0].from+s.from,-1,s);(n||(n=[i])).push(Do(o,e,t,!1))}}return n?my(n):i}class Fu{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Qr)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:n}=this.buffer;return this.type=t||n.set.types[n.buffer[e]],this.from=i+n.buffer[e+1],this.to=i+n.buffer[e+2],!0}yield(e){return e?e instanceof Qr?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:n}=this.buffer,s=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&Ht.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ht.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Ht.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let n=i<0?0:this.stack[i]+4;if(this.index!=n)return this.yieldBuf(t.findChild(n,this.index,-1,0,4))}else{let n=t.buffer[this.index+3];if(n<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(n)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:n}=this;if(n){if(e>0){if(this.index<n.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(n.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:i}=n)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let s=t+e,a=e<0?-1:i._tree.children.length;s!=a;s+=e){let o=i._tree.children[s];if(this.mode&Ht.IncludeAnonymous||o instanceof Bn||!o.type.isAnonymous||Z0(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let n=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==n){if(n==this.index)return a;t=a,i=s+1;break e}n=this.stack[--s]}for(let n=i;n<this.stack.length;n++)t=new En(this.buffer,t,this.stack[n]);return this.bufferNode=new En(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let n=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;;){if(n&&t&&t(this),n=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,n=!0}}}matchContext(e){if(!this.buffer)return Ou(this.node.parent,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let n=e.length-1,s=this.stack.length-1;n>=0;s--){if(s<0)return Ou(this._tree,e,n);let a=i[t.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[n]&&e[n]!=a.name)return!1;n--}}return!0}}function Z0(r){return r.children.some(e=>e instanceof Bn||!e.type.isAnonymous||Z0(e))}function r6(r){var e;let{buffer:t,nodeSet:i,maxBufferLength:n=uy,reused:s=[],minRepeatType:a=i.types.length}=r,o=Array.isArray(t)?new J0(t,t.length):t,l=i.types,c=0,f=0;function h(C,R,_,A,k,I){let{id:N,start:S,end:W,size:E}=o,Q=f,ae=c;for(;E<0;)if(o.next(),E==-1){let Y=s[N];_.push(Y),A.push(S-C);return}else if(E==-3){c=N;return}else if(E==-4){f=N;return}else throw new RangeError(`Unrecognized record size: ${E}`);let Z=l[N],xe,L,ge=S-C;if(W-S<=n&&(L=g(o.pos-R,k))){let Y=new Uint16Array(L.size-L.skip),O=o.pos-L.size,j=Y.length;for(;o.pos>O;)j=x(L.start,Y,j);xe=new Bn(Y,W-L.start,i),ge=L.start-C}else{let Y=o.pos-E;o.next();let O=[],j=[],V=N>=a?N:-1,H=0,ne=W;for(;o.pos>Y;)V>=0&&o.id==V&&o.size>=0?(o.end<=ne-n&&(m(O,j,S,H,o.end,ne,V,Q,ae),H=O.length,ne=o.end),o.next()):I>2500?u(S,Y,O,j):h(S,Y,O,j,V,I+1);if(V>=0&&H>0&&H<O.length&&m(O,j,S,H,S,ne,V,Q,ae),O.reverse(),j.reverse(),V>-1&&H>0){let ye=d(Z,ae);xe=Q0(Z,O,j,0,O.length,0,W-S,ye,ye)}else xe=p(Z,O,j,W-S,Q-W,ae)}_.push(xe),A.push(ge)}function u(C,R,_,A){let k=[],I=0,N=-1;for(;o.pos>R;){let{id:S,start:W,end:E,size:Q}=o;if(Q>4)o.next();else{if(N>-1&&W<N)break;N<0&&(N=E-n),k.push(S,W,E),I++,o.next()}}if(I){let S=new Uint16Array(I*4),W=k[k.length-2];for(let E=k.length-3,Q=0;E>=0;E-=3)S[Q++]=k[E],S[Q++]=k[E+1]-W,S[Q++]=k[E+2]-W,S[Q++]=Q;_.push(new Bn(S,k[2]-W,i)),A.push(W-C)}}function d(C,R){return(_,A,k)=>{let I=0,N=_.length-1,S,W;if(N>=0&&(S=_[N])instanceof Ft){if(!N&&S.type==C&&S.length==k)return S;(W=S.prop(Ye.lookAhead))&&(I=A[N]+S.length+W)}return p(C,_,A,k,I,R)}}function m(C,R,_,A,k,I,N,S,W){let E=[],Q=[];for(;C.length>A;)E.push(C.pop()),Q.push(R.pop()+_-k);C.push(p(i.types[N],E,Q,I-k,S-I,W)),R.push(k-_)}function p(C,R,_,A,k,I,N){if(I){let S=[Ye.contextHash,I];N=N?[S].concat(N):[S]}if(k>25){let S=[Ye.lookAhead,k];N=N?[S].concat(N):[S]}return new Ft(C,R,_,A,N)}function g(C,R){let _=o.fork(),A=0,k=0,I=0,N=_.end-n,S={size:0,start:0,skip:0};e:for(let W=_.pos-C;_.pos>W;){let E=_.size;if(_.id==R&&E>=0){S.size=A,S.start=k,S.skip=I,I+=4,A+=4,_.next();continue}let Q=_.pos-E;if(E<0||Q<W||_.start<N)break;let ae=_.id>=a?4:0,Z=_.start;for(_.next();_.pos>Q;){if(_.size<0)if(_.size==-3)ae+=4;else break e;else _.id>=a&&(ae+=4);_.next()}k=Z,A+=E,I+=ae}return(R<0||A==C)&&(S.size=A,S.start=k,S.skip=I),S.size>4?S:void 0}function x(C,R,_){let{id:A,start:k,end:I,size:N}=o;if(o.next(),N>=0&&A<a){let S=_;if(N>4){let W=o.pos-(N-4);for(;o.pos>W;)_=x(C,R,_)}R[--_]=S,R[--_]=I-C,R[--_]=k-C,R[--_]=A}else N==-3?c=A:N==-4&&(f=A);return _}let y=[],w=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,y,w,-1,0);let T=(e=r.length)!==null&&e!==void 0?e:y.length?w[0]+y[0].length:0;return new Ft(l[r.topID],y.reverse(),w.reverse(),T)}const eg=new WeakMap;function rc(r,e){if(!r.isAnonymous||e instanceof Bn||e.type!=r)return 1;let t=eg.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=r||!(i instanceof Ft)){t=1;break}t+=rc(r,i)}eg.set(e,t)}return t}function Q0(r,e,t,i,n,s,a,o,l){let c=0;for(let m=i;m<n;m++)c+=rc(r,e[m]);let f=Math.ceil(c*1.5/8),h=[],u=[];function d(m,p,g,x,y){for(let w=g;w<x;){let T=w,C=p[w],R=rc(r,m[w]);for(w++;w<x;w++){let _=rc(r,m[w]);if(R+_>=f)break;R+=_}if(w==T+1){if(R>f){let _=m[T];d(_.children,_.positions,0,_.children.length,p[T]+y);continue}h.push(m[T])}else{let _=p[w-1]+m[w-1].length-C;h.push(Q0(r,m,p,T,w,C,_,null,l))}u.push(C+y-s)}}return d(e,t,i,n,0),(o||l)(h,u,a)}class ss{constructor(e,t,i,n,s=!1,a=!1){this.from=e,this.to=t,this.tree=i,this.offset=n,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let n=[new ss(0,e.length,e,0,!1,i)];for(let s of t)s.to>e.length&&n.push(s);return n}static applyChanges(e,t,i=128){if(!t.length)return e;let n=[],s=1,a=e.length?e[0]:null;for(let o=0,l=0,c=0;;o++){let f=o<t.length?t[o]:null,h=f?f.fromA:1e9;if(h-l>=i)for(;a&&a.from<h;){let u=a;if(l>=u.from||h<=u.to||c){let d=Math.max(u.from,l)-c,m=Math.min(u.to,h)-c;u=d>=m?null:new ss(d,m,u.tree,u.offset+c,o>0,!!f)}if(u&&n.push(u),a.to>h)break;a=s<e.length?e[s++]:null}if(!f)break;l=f.toA,c=f.toA-f.toB}return n}}class gy{startParse(e,t,i){return typeof e=="string"&&(e=new i6(e)),i=i?i.length?i.map(n=>new ch(n.from,n.to)):[new ch(0,0)]:[new ch(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let n=this.startParse(e,t,i);for(;;){let s=n.advance();if(s)return s}}}class i6{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Ye({perNode:!0});let n6=0;class Xr{constructor(e,t,i,n){this.name=e,this.set=t,this.base=i,this.modified=n,this.id=n6++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let i=typeof e=="string"?e:"?";if(e instanceof Xr&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let n=new Xr(i,[],null,[]);if(n.set.push(n),t)for(let s of t.set)n.set.push(s);return n}static defineModifier(e){let t=new Pc(e);return i=>i.modified.indexOf(t)>-1?i:Pc.get(i.base||i,i.modified.concat(t).sort((n,s)=>n.id-s.id))}}let s6=0;class Pc{constructor(e){this.name=e,this.instances=[],this.id=s6++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(o=>o.base==e&&a6(t,o.modified));if(i)return i;let n=[],s=new Xr(e.name,n,e,t);for(let o of t)o.instances.push(s);let a=o6(t);for(let o of e.set)if(!o.modified.length)for(let l of a)n.push(Pc.get(o,l));return s}}function a6(r,e){return r.length==e.length&&r.every((t,i)=>t==e[i])}function o6(r){let e=[[]];for(let t=0;t<r.length;t++)for(let i=0,n=e.length;i<n;i++)e.push(e[i].concat(r[t]));return e.sort((t,i)=>i.length-t.length)}function xy(r){let e=Object.create(null);for(let t in r){let i=r[t];Array.isArray(i)||(i=[i]);for(let n of t.split(" "))if(n){let s=[],a=2,o=n;for(let h=0;;){if(o=="..."&&h>0&&h+3==n.length){a=1;break}let u=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!u)throw new RangeError("Invalid path: "+n);if(s.push(u[0]=="*"?"":u[0][0]=='"'?JSON.parse(u[0]):u[0]),h+=u[0].length,h==n.length)break;let d=n[h++];if(h==n.length&&d=="!"){a=0;break}if(d!="/")throw new RangeError("Invalid path: "+n);o=n.slice(h)}let l=s.length-1,c=s[l];if(!c)throw new RangeError("Invalid path: "+n);let f=new Lc(i,a,l>0?s.slice(0,l):null);e[c]=f.sort(e[c])}}return vy.add(e)}const vy=new Ye;class Lc{constructor(e,t,i,n){this.tags=e,this.mode=t,this.context=i,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Lc.empty=new Lc([],2,null);function yy(r,e){let t=Object.create(null);for(let s of r)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let a of s.tag)t[a.id]=s.class;let{scope:i,all:n=null}=e||{};return{style:s=>{let a=n;for(let o of s)for(let l of o.set){let c=t[l.id];if(c){a=a?a+" "+c:c;break}}return a},scope:i}}function l6(r,e){let t=null;for(let i of r){let n=i.style(e);n&&(t=t?t+" "+n:n)}return t}function c6(r,e,t,i=0,n=r.length){let s=new f6(i,Array.isArray(e)?e:[e],t);s.highlightRange(r.cursor(),i,n,"",s.highlighters),s.flush(n)}class f6{constructor(e,t,i){this.at=e,this.highlighters=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,n,s){let{type:a,from:o,to:l}=e;if(o>=i||l<=t)return;a.isTop&&(s=this.highlighters.filter(d=>!d.scope||d.scope(a)));let c=n,f=h6(e)||Lc.empty,h=l6(s,f.tags);if(h&&(c&&(c+=" "),c+=h,f.mode==1&&(n+=(n?" ":"")+h)),this.startSpan(Math.max(t,o),c),f.opaque)return;let u=e.tree&&e.tree.prop(Ye.mounted);if(u&&u.overlay){let d=e.node.enter(u.overlay[0].from+o,1),m=this.highlighters.filter(g=>!g.scope||g.scope(u.tree.type)),p=e.firstChild();for(let g=0,x=o;;g++){let y=g<u.overlay.length?u.overlay[g]:null,w=y?y.from+o:l,T=Math.max(t,x),C=Math.min(i,w);if(T<C&&p)for(;e.from<C&&(this.highlightRange(e,T,C,n,s),this.startSpan(Math.min(C,e.to),c),!(e.to>=w||!e.nextSibling())););if(!y||w>i)break;x=y.to+o,x>t&&(this.highlightRange(d.cursor(),Math.max(t,y.from+o),Math.min(i,x),"",m),this.startSpan(Math.min(i,x),c))}p&&e.parent()}else if(e.firstChild()){u&&(n="");do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,n,s),this.startSpan(Math.min(i,e.to),c)}while(e.nextSibling());e.parent()}}}function h6(r){let e=r.type.prop(vy);for(;e&&e.context&&!r.matchContext(e.context);)e=e.next;return e||null}const Ce=Xr.define,Il=Ce(),gn=Ce(),tg=Ce(gn),rg=Ce(gn),xn=Ce(),Pl=Ce(xn),fh=Ce(xn),Si=Ce(),Kn=Ce(Si),ki=Ce(),bi=Ce(),Du=Ce(),Sa=Ce(Du),Ll=Ce(),me={comment:Il,lineComment:Ce(Il),blockComment:Ce(Il),docComment:Ce(Il),name:gn,variableName:Ce(gn),typeName:tg,tagName:Ce(tg),propertyName:rg,attributeName:Ce(rg),className:Ce(gn),labelName:Ce(gn),namespace:Ce(gn),macroName:Ce(gn),literal:xn,string:Pl,docString:Ce(Pl),character:Ce(Pl),attributeValue:Ce(Pl),number:fh,integer:Ce(fh),float:Ce(fh),bool:Ce(xn),regexp:Ce(xn),escape:Ce(xn),color:Ce(xn),url:Ce(xn),keyword:ki,self:Ce(ki),null:Ce(ki),atom:Ce(ki),unit:Ce(ki),modifier:Ce(ki),operatorKeyword:Ce(ki),controlKeyword:Ce(ki),definitionKeyword:Ce(ki),moduleKeyword:Ce(ki),operator:bi,derefOperator:Ce(bi),arithmeticOperator:Ce(bi),logicOperator:Ce(bi),bitwiseOperator:Ce(bi),compareOperator:Ce(bi),updateOperator:Ce(bi),definitionOperator:Ce(bi),typeOperator:Ce(bi),controlOperator:Ce(bi),punctuation:Du,separator:Ce(Du),bracket:Sa,angleBracket:Ce(Sa),squareBracket:Ce(Sa),paren:Ce(Sa),brace:Ce(Sa),content:Si,heading:Kn,heading1:Ce(Kn),heading2:Ce(Kn),heading3:Ce(Kn),heading4:Ce(Kn),heading5:Ce(Kn),heading6:Ce(Kn),contentSeparator:Ce(Si),list:Ce(Si),quote:Ce(Si),emphasis:Ce(Si),strong:Ce(Si),link:Ce(Si),monospace:Ce(Si),strikethrough:Ce(Si),inserted:Ce(),deleted:Ce(),changed:Ce(),invalid:Ce(),meta:Ll,documentMeta:Ce(Ll),annotation:Ce(Ll),processingInstruction:Ce(Ll),definition:Xr.defineModifier("definition"),constant:Xr.defineModifier("constant"),function:Xr.defineModifier("function"),standard:Xr.defineModifier("standard"),local:Xr.defineModifier("local"),special:Xr.defineModifier("special")};for(let r in me){let e=me[r];e instanceof Xr&&(e.name=r)}yy([{tag:me.link,class:"tok-link"},{tag:me.heading,class:"tok-heading"},{tag:me.emphasis,class:"tok-emphasis"},{tag:me.strong,class:"tok-strong"},{tag:me.keyword,class:"tok-keyword"},{tag:me.atom,class:"tok-atom"},{tag:me.bool,class:"tok-bool"},{tag:me.url,class:"tok-url"},{tag:me.labelName,class:"tok-labelName"},{tag:me.inserted,class:"tok-inserted"},{tag:me.deleted,class:"tok-deleted"},{tag:me.literal,class:"tok-literal"},{tag:me.string,class:"tok-string"},{tag:me.number,class:"tok-number"},{tag:[me.regexp,me.escape,me.special(me.string)],class:"tok-string2"},{tag:me.variableName,class:"tok-variableName"},{tag:me.local(me.variableName),class:"tok-variableName tok-local"},{tag:me.definition(me.variableName),class:"tok-variableName tok-definition"},{tag:me.special(me.variableName),class:"tok-variableName2"},{tag:me.definition(me.propertyName),class:"tok-propertyName tok-definition"},{tag:me.typeName,class:"tok-typeName"},{tag:me.namespace,class:"tok-namespace"},{tag:me.className,class:"tok-className"},{tag:me.macroName,class:"tok-macroName"},{tag:me.propertyName,class:"tok-propertyName"},{tag:me.operator,class:"tok-operator"},{tag:me.comment,class:"tok-comment"},{tag:me.meta,class:"tok-meta"},{tag:me.invalid,class:"tok-invalid"},{tag:me.punctuation,class:"tok-punctuation"}]);var hh;const Is=new Ye;function u6(r){return Re.define({combine:r?e=>e.concat(r):void 0})}const d6=new Ye;class hi{constructor(e,t,i=[],n=""){this.data=e,this.name=n,Je.prototype.hasOwnProperty("tree")||Object.defineProperty(Je.prototype,"tree",{get(){return hr(this)}}),this.parser=t,this.extension=[Nn.of(this),Je.languageData.of((s,a,o)=>{let l=ig(s,a,o),c=l.type.prop(Is);if(!c)return[];let f=s.facet(c),h=l.type.prop(d6);if(h){let u=l.resolve(a-l.from,o);for(let d of h)if(d.test(u,s)){let m=s.facet(d.facet);return d.type=="replace"?m:m.concat(f)}}return f})].concat(i)}isActiveAt(e,t,i=-1){return ig(e,t,i).type.prop(Is)==this.data}findRegions(e){let t=e.facet(Nn);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],n=(s,a)=>{if(s.prop(Is)==this.data){i.push({from:a,to:a+s.length});return}let o=s.prop(Ye.mounted);if(o){if(o.tree.prop(Is)==this.data){if(o.overlay)for(let l of o.overlay)i.push({from:l.from+a,to:l.to+a});else i.push({from:a,to:a+s.length});return}else if(o.overlay){let l=i.length;if(n(o.tree,o.overlay[0].from+a),i.length>l)return}}for(let l=0;l<s.children.length;l++){let c=s.children[l];c instanceof Ft&&n(c,s.positions[l]+a)}};return n(hr(e),0),i}get allowsNesting(){return!0}}hi.setState=Xe.define();function ig(r,e,t){let i=r.facet(Nn),n=hr(r).topNode;if(!i||i.allowsNesting)for(let s=n;s;s=s.enter(e,t,Ht.ExcludeBuffers))s.type.isTop&&(n=s);return n}class Bc extends hi{constructor(e,t,i){super(e,t,[],i),this.parser=t}static define(e){let t=u6(e.languageData);return new Bc(t,e.parser.configure({props:[Is.add(i=>i.isTop?t:void 0)]}),e.name)}configure(e,t){return new Bc(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function hr(r){let e=r.field(hi.state,!1);return e?e.tree:Ft.empty}class p6{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let Ta=null;class Nc{constructor(e,t,i=[],n,s,a,o,l){this.parser=e,this.state=t,this.fragments=i,this.tree=n,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,i){return new Nc(e,t,[],Ft.empty,0,i,[],null)}startParse(){return this.parser.startParse(new p6(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Ft.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let n=Date.now()+e;e=()=>Date.now()>n}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let n=this.parse.advance();if(n)if(this.fragments=this.withoutTempSkipped(ss.addTree(n,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=n,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(ss.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Ta;Ta=this;try{return e()}finally{Ta=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=ng(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:n,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((c,f,h,u)=>l.push({fromA:c,toA:f,fromB:h,toB:u})),i=ss.applyChanges(i,l),n=Ft.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let c of this.skipped){let f=e.mapPos(c.from,1),h=e.mapPos(c.to,-1);f<h&&o.push({from:f,to:h})}}}return new Nc(this.parser,t,i,n,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:n,to:s}=this.skipped[i];n<e.to&&s>e.from&&(this.fragments=ng(this.fragments,n,s),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends gy{createParse(t,i,n){let s=n[0].from,a=n[n.length-1].to;return{parsedPos:s,advance(){let l=Ta;if(l){for(let c of n)l.tempSkipped.push(c);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new Ft(Ir.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Ta}}function ng(r,e,t){return ss.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}class aa{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new aa(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=Nc.create(e.facet(Nn).parser,e,{from:0,to:t});return i.work(20,t)||i.takeTree(),new aa(i)}}hi.state=Yt.define({create:aa.init,update(r,e){for(let t of e.effects)if(t.is(hi.setState))return t.value;return e.startState.facet(Nn)!=e.state.facet(Nn)?aa.init(e.state):r.apply(e)}});let wy=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(wy=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const uh=typeof navigator<"u"&&(!((hh=navigator.scheduling)===null||hh===void 0)&&hh.isInputPending)?()=>navigator.scheduling.isInputPending():null,m6=St.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(hi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(hi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=wy(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,s=i.field(hi.state);if(s.tree==s.context.tree&&s.context.isDone(n+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!uh?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<n&&i.doc.length>n+1e3,l=s.context.work(()=>uh&&uh()||Date.now()>a,n+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:hi.setState.of(new aa(s.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Rr(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Nn=Re.define({combine(r){return r.length?r[0]:null},enables:r=>[hi.state,m6,Oe.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]});class g6{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const x6=Re.define(),yf=Re.define({combine:r=>{if(!r.length)return"  ";let e=r[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return e}});function Uc(r){let e=r.facet(yf);return e.charCodeAt(0)==9?r.tabSize*e.length:e.length}function Ro(r,e){let t="",i=r.tabSize,n=r.facet(yf)[0];if(n=="	"){for(;e>=i;)t+="	",e-=i;n=" "}for(let s=0;s<e;s++)t+=n;return t}function ed(r,e){r instanceof Je&&(r=new wf(r));for(let i of r.state.facet(x6)){let n=i(r,e);if(n!==void 0)return n}let t=hr(r.state);return t.length>=e?v6(r,t,e):null}class wf{constructor(e,t={}){this.state=e,this.options=t,this.unit=Uc(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:n,simulateDoubleBreak:s}=this.options;return n!=null&&n>=i.from&&n<=i.to?s&&n==e?{text:"",from:e}:(t<0?n<e:n<=e)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(e,t);return i.slice(e-n,Math.min(i.length,e+100-n))}column(e,t=1){let{text:i,from:n}=this.lineAt(e,t),s=this.countColumn(i,e-n),a=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return a>-1&&(s+=a-this.countColumn(i,i.search(/\S|$/))),s}countColumn(e,t=e.length){return da(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:n}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let a=s(n);if(a>-1)return a}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const ky=new Ye;function v6(r,e,t){let i=e.resolveStack(t),n=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(n!=i.node){let s=[];for(let a=n;a&&!(a.from<i.node.from||a.to>i.node.to||a.from==i.node.from&&a.type==i.node.type);a=a.parent)s.push(a);for(let a=s.length-1;a>=0;a--)i={node:s[a],next:i}}return by(i,r,t)}function by(r,e,t){for(let i=r;i;i=i.next){let n=w6(i.node);if(n)return n(td.create(e,t,i))}return 0}function y6(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function w6(r){let e=r.type.prop(ky);if(e)return e;let t=r.firstChild,i;if(t&&(i=t.type.prop(Ye.closedBy))){let n=r.lastChild,s=n&&i.indexOf(n.name)>-1;return a=>S6(a,!0,1,void 0,s&&!y6(a)?n.from:void 0)}return r.parent==null?k6:null}function k6(){return 0}class td extends wf{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.context=i}get node(){return this.context.node}static create(e,t,i){return new td(e,t,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(t.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(b6(i,e))break;t=this.state.doc.lineAt(i.from)}return this.lineIndent(t.from)}continue(){return by(this.context.next,this.base,this.pos)}}function b6(r,e){for(let t=e;t;t=t.parent)if(r==t)return!0;return!1}function _6(r){let e=r.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let n=r.options.simulateBreak,s=r.state.doc.lineAt(t.from),a=n==null||n<=s.from?s.to:Math.min(s.to,n);for(let o=t.to;;){let l=e.childAfter(o);if(!l||l==i)return null;if(!l.type.isSkipped){if(l.from>=a)return null;let c=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+c}}o=l.to}}function S6(r,e,t,i,n){let s=r.textAfter,a=s.match(/^\s*/)[0].length,o=i&&s.slice(a,a+i.length)==i||n==r.pos+a,l=_6(r);return l?o?r.column(l.from):r.column(l.to):r.baseIndent+(o?0:r.unit*t)}function sg({except:r,units:e=1}={}){return t=>{let i=r&&r.test(t.textAfter);return t.baseIndent+(i?0:e*t.unit)}}const T6=200;function E6(){return Je.transactionFilter.of(r=>{if(!r.docChanged||!r.isUserEvent("input.type")&&!r.isUserEvent("input.complete"))return r;let e=r.startState.languageDataAt("indentOnInput",r.startState.selection.main.head);if(!e.length)return r;let t=r.newDoc,{head:i}=r.newSelection.main,n=t.lineAt(i);if(i>n.from+T6)return r;let s=t.sliceString(n.from,i);if(!e.some(c=>c.test(s)))return r;let{state:a}=r,o=-1,l=[];for(let{head:c}of a.selection.ranges){let f=a.doc.lineAt(c);if(f.from==o)continue;o=f.from;let h=ed(a,f.from);if(h==null)continue;let u=/^\s*/.exec(f.text)[0],d=Ro(a,h);u!=d&&l.push({from:f.from,to:f.from+u.length,insert:d})}return l.length?[r,{changes:l,sequential:!0}]:r})}const C6=Re.define(),_y=new Ye;function A6(r){let e=r.firstChild,t=r.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?r.to:t.from}:null}function O6(r,e,t){let i=hr(r);if(i.length<t)return null;let n=i.resolveStack(t,1),s=null;for(let a=n;a;a=a.next){let o=a.node;if(o.to<=t||o.from>t)continue;if(s&&o.from<e)break;let l=o.type.prop(_y);if(l&&(o.to<i.length-50||i.length==r.doc.length||!F6(o))){let c=l(o,r);c&&c.from<=t&&c.from>=e&&c.to>t&&(s=c)}}return s}function F6(r){let e=r.lastChild;return e&&e.to==r.to&&e.type.isError}function Hc(r,e,t){for(let i of r.facet(C6)){let n=i(r,e,t);if(n)return n}return O6(r,e,t)}function Sy(r,e){let t=e.mapPos(r.from,1),i=e.mapPos(r.to,-1);return t>=i?void 0:{from:t,to:i}}const kf=Xe.define({map:Sy}),el=Xe.define({map:Sy});function Ty(r){let e=[];for(let{head:t}of r.state.selection.ranges)e.some(i=>i.from<=t&&i.to>=t)||e.push(r.lineBlockAt(t));return e}const ps=Yt.define({create(){return Be.none},update(r,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((t,i)=>r=ag(r,t,i)),r=r.map(e.changes);for(let t of e.effects)if(t.is(kf)&&!D6(r,t.value.from,t.value.to)){let{preparePlaceholder:i}=e.state.facet(Ay),n=i?Be.replace({widget:new N6(i(e.state,t.value))}):og;r=r.update({add:[n.range(t.value.from,t.value.to)]})}else t.is(el)&&(r=r.update({filter:(i,n)=>t.value.from!=i||t.value.to!=n,filterFrom:t.value.from,filterTo:t.value.to}));return e.selection&&(r=ag(r,e.selection.main.head)),r},provide:r=>Oe.decorations.from(r),toJSON(r,e){let t=[];return r.between(0,e.doc.length,(i,n)=>{t.push(i,n)}),t},fromJSON(r){if(!Array.isArray(r)||r.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<r.length;){let i=r[t++],n=r[t++];if(typeof i!="number"||typeof n!="number")throw new RangeError("Invalid JSON for fold state");e.push(og.range(i,n))}return Be.set(e,!0)}});function ag(r,e,t=e){let i=!1;return r.between(e,t,(n,s)=>{n<t&&s>e&&(i=!0)}),i?r.update({filterFrom:e,filterTo:t,filter:(n,s)=>n>=t||s<=e}):r}function zc(r,e,t){var i;let n=null;return(i=r.field(ps,!1))===null||i===void 0||i.between(e,t,(s,a)=>{(!n||n.from>s)&&(n={from:s,to:a})}),n}function D6(r,e,t){let i=!1;return r.between(e,e,(n,s)=>{n==e&&s==t&&(i=!0)}),i}function Ey(r,e){return r.field(ps,!1)?e:e.concat(Xe.appendConfig.of(Oy()))}const R6=r=>{for(let e of Ty(r)){let t=Hc(r.state,e.from,e.to);if(t)return r.dispatch({effects:Ey(r.state,[kf.of(t),Cy(r,t)])}),!0}return!1},M6=r=>{if(!r.state.field(ps,!1))return!1;let e=[];for(let t of Ty(r)){let i=zc(r.state,t.from,t.to);i&&e.push(el.of(i),Cy(r,i,!1))}return e.length&&r.dispatch({effects:e}),e.length>0};function Cy(r,e,t=!0){let i=r.state.doc.lineAt(e.from).number,n=r.state.doc.lineAt(e.to).number;return Oe.announce.of(`${r.state.phrase(t?"Folded lines":"Unfolded lines")} ${i} ${r.state.phrase("to")} ${n}.`)}const I6=r=>{let{state:e}=r,t=[];for(let i=0;i<e.doc.length;){let n=r.lineBlockAt(i),s=Hc(e,n.from,n.to);s&&t.push(kf.of(s)),i=(s?r.lineBlockAt(s.to):n).to+1}return t.length&&r.dispatch({effects:Ey(r.state,t)}),!!t.length},P6=r=>{let e=r.state.field(ps,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,r.state.doc.length,(i,n)=>{t.push(el.of({from:i,to:n}))}),r.dispatch({effects:t}),!0},L6=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:R6},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:M6},{key:"Ctrl-Alt-[",run:I6},{key:"Ctrl-Alt-]",run:P6}],B6={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},Ay=Re.define({combine(r){return Wi(r,B6)}});function Oy(r){return[ps,z6]}function Fy(r,e){let{state:t}=r,i=t.facet(Ay),n=a=>{let o=r.lineBlockAt(r.posAtDOM(a.target)),l=zc(r.state,o.from,o.to);l&&r.dispatch({effects:el.of(l)}),a.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(r,n,e);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=n,s}const og=Be.replace({widget:new class extends un{toDOM(r){return Fy(r,null)}}});class N6 extends un{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return Fy(e,this.value)}}const U6={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class dh extends ln{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function H6(r={}){let e={...U6,...r},t=new dh(e,!0),i=new dh(e,!1),n=St.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(Nn)!=a.state.facet(Nn)||a.startState.field(ps,!1)!=a.state.field(ps,!1)||hr(a.startState)!=hr(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let o=new an;for(let l of a.viewportLineBlocks){let c=zc(a.state,l.from,l.to)?i:Hc(a.state,l.from,l.to)?t:null;c&&o.add(l.from,l.from,c)}return o.finish()}}),{domEventHandlers:s}=e;return[n,HR({class:"cm-foldGutter",markers(a){var o;return((o=a.plugin(n))===null||o===void 0?void 0:o.markers)||tt.empty},initialSpacer(){return new dh(e,!1)},domEventHandlers:{...s,click:(a,o,l)=>{if(s.click&&s.click(a,o,l))return!0;let c=zc(a.state,o.from,o.to);if(c)return a.dispatch({effects:el.of(c)}),!0;let f=Hc(a.state,o.from,o.to);return f?(a.dispatch({effects:kf.of(f)}),!0):!1}}}),Oy()]}const z6=Oe.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class tl{constructor(e,t){this.specs=e;let i;function n(o){let l=In.newName();return(i||(i=Object.create(null)))["."+l]=o,l}const s=typeof t.all=="string"?t.all:t.all?n(t.all):void 0,a=t.scope;this.scope=a instanceof hi?o=>o.prop(Is)==a.data:a?o=>o==a:void 0,this.style=yy(e.map(o=>({tag:o.tag,class:o.class||n(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=i?new In(i):null,this.themeType=t.themeType}static define(e,t){return new tl(e,t||{})}}const Ru=Re.define(),Dy=Re.define({combine(r){return r.length?[r[0]]:null}});function ph(r){let e=r.facet(Ru);return e.length?e:r.facet(Dy)}function Ry(r,e){let t=[V6],i;return r instanceof tl&&(r.module&&t.push(Oe.styleModule.of(r.module)),i=r.themeType),e!=null&&e.fallback?t.push(Dy.of(r)):i?t.push(Ru.computeN([Oe.darkTheme],n=>n.facet(Oe.darkTheme)==(i=="dark")?[r]:[])):t.push(Ru.of(r)),t}class W6{constructor(e){this.markCache=Object.create(null),this.tree=hr(e.state),this.decorations=this.buildDeco(e,ph(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=hr(e.state),i=ph(e.state),n=i!=ph(e.startState),{viewport:s}=e.view,a=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!n&&t.type==this.tree.type&&a>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=a):(t!=this.tree||e.viewportChanged||n)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return Be.none;let i=new an;for(let{from:n,to:s}of e.visibleRanges)c6(this.tree,t,(a,o,l)=>{i.add(a,o,this.markCache[l]||(this.markCache[l]=Be.mark({class:l})))},n,s);return i.finish()}}const V6=bs.high(St.fromClass(W6,{decorations:r=>r.decorations})),j6=tl.define([{tag:me.meta,color:"#404740"},{tag:me.link,textDecoration:"underline"},{tag:me.heading,textDecoration:"underline",fontWeight:"bold"},{tag:me.emphasis,fontStyle:"italic"},{tag:me.strong,fontWeight:"bold"},{tag:me.strikethrough,textDecoration:"line-through"},{tag:me.keyword,color:"#708"},{tag:[me.atom,me.bool,me.url,me.contentSeparator,me.labelName],color:"#219"},{tag:[me.literal,me.inserted],color:"#164"},{tag:[me.string,me.deleted],color:"#a11"},{tag:[me.regexp,me.escape,me.special(me.string)],color:"#e40"},{tag:me.definition(me.variableName),color:"#00f"},{tag:me.local(me.variableName),color:"#30a"},{tag:[me.typeName,me.namespace],color:"#085"},{tag:me.className,color:"#167"},{tag:[me.special(me.variableName),me.macroName],color:"#256"},{tag:me.definition(me.propertyName),color:"#00c"},{tag:me.comment,color:"#940"},{tag:me.invalid,color:"#f00"}]),$6=Oe.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),My=1e4,Iy="()[]{}",Py=Re.define({combine(r){return Wi(r,{afterCursor:!0,brackets:Iy,maxScanDistance:My,renderMatch:X6})}}),G6=Be.mark({class:"cm-matchingBracket"}),K6=Be.mark({class:"cm-nonmatchingBracket"});function X6(r){let e=[],t=r.matched?G6:K6;return e.push(t.range(r.start.from,r.start.to)),r.end&&e.push(t.range(r.end.from,r.end.to)),e}const q6=Yt.define({create(){return Be.none},update(r,e){if(!e.docChanged&&!e.selection)return r;let t=[],i=e.state.facet(Py);for(let n of e.state.selection.ranges){if(!n.empty)continue;let s=Ri(e.state,n.head,-1,i)||n.head>0&&Ri(e.state,n.head-1,1,i)||i.afterCursor&&(Ri(e.state,n.head,1,i)||n.head<e.state.doc.length&&Ri(e.state,n.head+1,-1,i));s&&(t=t.concat(i.renderMatch(s,e.state)))}return Be.set(t,!0)},provide:r=>Oe.decorations.from(r)}),Y6=[q6,$6];function J6(r={}){return[Py.of(r),Y6]}const Z6=new Ye;function Mu(r,e,t){let i=r.prop(e<0?Ye.openedBy:Ye.closedBy);if(i)return i;if(r.name.length==1){let n=t.indexOf(r.name);if(n>-1&&n%2==(e<0?1:0))return[t[n+e]]}return null}function Iu(r){let e=r.type.prop(Z6);return e?e(r.node):r}function Ri(r,e,t,i={}){let n=i.maxScanDistance||My,s=i.brackets||Iy,a=hr(r),o=a.resolveInner(e,t);for(let l=o;l;l=l.parent){let c=Mu(l.type,t,s);if(c&&l.from<l.to){let f=Iu(l);if(f&&(t>0?e>=f.from&&e<f.to:e>f.from&&e<=f.to))return Q6(r,e,t,l,f,c,s)}}return e5(r,e,t,a,o.type,n,s)}function Q6(r,e,t,i,n,s,a){let o=i.parent,l={from:n.from,to:n.to},c=0,f=o==null?void 0:o.cursor();if(f&&(t<0?f.childBefore(i.from):f.childAfter(i.to)))do if(t<0?f.to<=i.from:f.from>=i.to){if(c==0&&s.indexOf(f.type.name)>-1&&f.from<f.to){let h=Iu(f);return{start:l,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(Mu(f.type,t,a))c++;else if(Mu(f.type,-t,a)){if(c==0){let h=Iu(f);return{start:l,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}c--}}while(t<0?f.prevSibling():f.nextSibling());return{start:l,matched:!1}}function e5(r,e,t,i,n,s,a){let o=t<0?r.sliceDoc(e-1,e):r.sliceDoc(e,e+1),l=a.indexOf(o);if(l<0||l%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},f=r.doc.iterRange(e,t>0?r.doc.length:0),h=0;for(let u=0;!f.next().done&&u<=s;){let d=f.value;t<0&&(u+=d.length);let m=e+u*t;for(let p=t>0?0:d.length-1,g=t>0?d.length:-1;p!=g;p+=t){let x=a.indexOf(d[p]);if(!(x<0||i.resolveInner(m+p,1).type!=n))if(x%2==0==t>0)h++;else{if(h==1)return{start:c,end:{from:m+p,to:m+p+1},matched:x>>1==l>>1};h--}}t>0&&(u+=d.length)}return f.done?{start:c,matched:!1}:null}const t5=Object.create(null),lg=[Ir.none],cg=[],fg=Object.create(null),r5=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])r5[r]=i5(t5,e);function mh(r,e){cg.indexOf(r)>-1||(cg.push(r),console.warn(e))}function i5(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let c of o.split(".")){let f=r[c]||me[c];f?typeof f=="function"?l.length?l=l.map(f):mh(c,`Modifier ${c} used at start of tag`):l.length?mh(c,`Tag ${c} used as modifier`):l=Array.isArray(f)?f:[f]:mh(c,`Unknown highlighting tag ${c}`)}for(let c of l)t.push(c)}if(!t.length)return 0;let i=e.replace(/ /g,"_"),n=i+" "+t.map(o=>o.id),s=fg[n];if(s)return s.id;let a=fg[n]=Ir.define({id:lg.length,name:i,props:[xy({[i]:t})]});return lg.push(a),a.id}pt.RTL,pt.LTR;const n5=r=>{let{state:e}=r,t=e.doc.lineAt(e.selection.main.from),i=id(r.state,t.from);return i.line?s5(r):i.block?o5(r):!1};function rd(r,e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let n=r(e,t);return n?(i(t.update(n)),!0):!1}}const s5=rd(f5,0),a5=rd(Ly,0),o5=rd((r,e)=>Ly(r,e,c5(e)),0);function id(r,e){let t=r.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const Ea=50;function l5(r,{open:e,close:t},i,n){let s=r.sliceDoc(i-Ea,i),a=r.sliceDoc(n,n+Ea),o=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(a)[0].length,c=s.length-o;if(s.slice(c-e.length,c)==e&&a.slice(l,l+t.length)==t)return{open:{pos:i-o,margin:o&&1},close:{pos:n+l,margin:l&&1}};let f,h;n-i<=2*Ea?f=h=r.sliceDoc(i,n):(f=r.sliceDoc(i,i+Ea),h=r.sliceDoc(n-Ea,n));let u=/^\s*/.exec(f)[0].length,d=/\s*$/.exec(h)[0].length,m=h.length-d-t.length;return f.slice(u,u+e.length)==e&&h.slice(m,m+t.length)==t?{open:{pos:i+u+e.length,margin:/\s/.test(f.charAt(u+e.length))?1:0},close:{pos:n-d-t.length,margin:/\s/.test(h.charAt(m-1))?1:0}}:null}function c5(r){let e=[];for(let t of r.selection.ranges){let i=r.doc.lineAt(t.from),n=t.to<=i.to?i:r.doc.lineAt(t.to);n.from>i.from&&n.from==t.to&&(n=t.to==i.to+1?i:r.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>i.from?e[s].to=n.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:n.to})}return e}function Ly(r,e,t=e.selection.ranges){let i=t.map(s=>id(e,s.from).block);if(!i.every(s=>s))return null;let n=t.map((s,a)=>l5(e,i[a],s.from,s.to));if(r!=2&&!n.every(s=>s))return{changes:e.changes(t.map((s,a)=>n[a]?[]:[{from:s.from,insert:i[a].open+" "},{from:s.to,insert:" "+i[a].close}]))};if(r!=1&&n.some(s=>s)){let s=[];for(let a=0,o;a<n.length;a++)if(o=n[a]){let l=i[a],{open:c,close:f}=o;s.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:f.pos-f.margin,to:f.pos+l.close.length})}return{changes:s}}return null}function f5(r,e,t=e.selection.ranges){let i=[],n=-1;for(let{from:s,to:a}of t){let o=i.length,l=1e9,c=id(e,s).line;if(c){for(let f=s;f<=a;){let h=e.doc.lineAt(f);if(h.from>n&&(s==a||a>h.from)){n=h.from;let u=/^\s*/.exec(h.text)[0].length,d=u==h.length,m=h.text.slice(u,u+c.length)==c?u:-1;u<h.text.length&&u<l&&(l=u),i.push({line:h,comment:m,token:c,indent:u,empty:d,single:!1})}f=h.to+1}if(l<1e9)for(let f=o;f<i.length;f++)i[f].indent<i[f].line.text.length&&(i[f].indent=l);i.length==o+1&&(i[o].single=!0)}}if(r!=2&&i.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:o,token:l,indent:c,empty:f,single:h}of i)(h||!f)&&s.push({from:o.from+c,insert:l+" "});let a=e.changes(s);return{changes:a,selection:e.selection.map(a,1)}}else if(r!=1&&i.some(s=>s.comment>=0)){let s=[];for(let{line:a,comment:o,token:l}of i)if(o>=0){let c=a.from+o,f=c+l.length;a.text[f-a.from]==" "&&f++,s.push({from:c,to:f})}return{changes:s}}return null}const Pu=hn.define(),h5=hn.define(),u5=Re.define(),By=Re.define({combine(r){return Wi(r,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(i,n)=>e(i,n)||t(i,n)})}}),Ny=Yt.define({create(){return Mi.empty},update(r,e){let t=e.state.facet(By),i=e.annotation(Pu);if(i){let l=Mr.fromTransaction(e,i.selection),c=i.side,f=c==0?r.undone:r.done;return l?f=Wc(f,f.length,t.minDepth,l):f=zy(f,e.startState.selection),new Mi(c==0?i.rest:f,c==0?f:i.rest)}let n=e.annotation(h5);if((n=="full"||n=="before")&&(r=r.isolate()),e.annotation(Lt.addToHistory)===!1)return e.changes.empty?r:r.addMapping(e.changes.desc);let s=Mr.fromTransaction(e),a=e.annotation(Lt.time),o=e.annotation(Lt.userEvent);return s?r=r.addChanges(s,a,o,t,e):e.selection&&(r=r.addSelection(e.startState.selection,a,o,t.newGroupDelay)),(n=="full"||n=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(e=>e.toJSON()),undone:r.undone.map(e=>e.toJSON())}},fromJSON(r){return new Mi(r.done.map(Mr.fromJSON),r.undone.map(Mr.fromJSON))}});function d5(r={}){return[Ny,By.of(r),Oe.domEventHandlers({beforeinput(e,t){let i=e.inputType=="historyUndo"?Uy:e.inputType=="historyRedo"?Lu:null;return i?(e.preventDefault(),i(t)):!1}})]}function bf(r,e){return function({state:t,dispatch:i}){if(!e&&t.readOnly)return!1;let n=t.field(Ny,!1);if(!n)return!1;let s=n.pop(r,t,e);return s?(i(s),!0):!1}}const Uy=bf(0,!1),Lu=bf(1,!1),p5=bf(0,!0),m5=bf(1,!0);class Mr{constructor(e,t,i,n,s){this.changes=e,this.effects=t,this.mapped=i,this.startSelection=n,this.selectionsAfter=s}setSelAfter(e){return new Mr(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(n=>n.toJSON())}}static fromJSON(e){return new Mr(e.changes&&Mt.fromJSON(e.changes),[],e.mapped&&Pi.fromJSON(e.mapped),e.startSelection&&ke.fromJSON(e.startSelection),e.selectionsAfter.map(ke.fromJSON))}static fromTransaction(e,t){let i=qr;for(let n of e.startState.facet(u5)){let s=n(e);s.length&&(i=i.concat(s))}return!i.length&&e.changes.empty?null:new Mr(e.changes.invert(e.startState.doc),i,void 0,t||e.startState.selection,qr)}static selection(e){return new Mr(void 0,qr,void 0,void 0,e)}}function Wc(r,e,t,i){let n=e+1>t+20?e-t-1:0,s=r.slice(n,e);return s.push(i),s}function g5(r,e){let t=[],i=!1;return r.iterChangedRanges((n,s)=>t.push(n,s)),e.iterChangedRanges((n,s,a,o)=>{for(let l=0;l<t.length;){let c=t[l++],f=t[l++];o>=c&&a<=f&&(i=!0)}}),i}function x5(r,e){return r.ranges.length==e.ranges.length&&r.ranges.filter((t,i)=>t.empty!=e.ranges[i].empty).length===0}function Hy(r,e){return r.length?e.length?r.concat(e):r:e}const qr=[],v5=200;function zy(r,e){if(r.length){let t=r[r.length-1],i=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-v5));return i.length&&i[i.length-1].eq(e)?r:(i.push(e),Wc(r,r.length-1,1e9,t.setSelAfter(i)))}else return[Mr.selection([e])]}function y5(r){let e=r[r.length-1],t=r.slice();return t[r.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function gh(r,e){if(!r.length)return r;let t=r.length,i=qr;for(;t;){let n=w5(r[t-1],e,i);if(n.changes&&!n.changes.empty||n.effects.length){let s=r.slice(0,t);return s[t-1]=n,s}else e=n.mapped,t--,i=n.selectionsAfter}return i.length?[Mr.selection(i)]:qr}function w5(r,e,t){let i=Hy(r.selectionsAfter.length?r.selectionsAfter.map(o=>o.map(e)):qr,t);if(!r.changes)return Mr.selection(i);let n=r.changes.map(e),s=e.mapDesc(r.changes,!0),a=r.mapped?r.mapped.composeDesc(s):s;return new Mr(n,Xe.mapEffects(r.effects,e),a,r.startSelection.map(s),i)}const k5=/^(input\.type|delete)($|\.)/;class Mi{constructor(e,t,i=0,n=void 0){this.done=e,this.undone=t,this.prevTime=i,this.prevUserEvent=n}isolate(){return this.prevTime?new Mi(this.done,this.undone):this}addChanges(e,t,i,n,s){let a=this.done,o=a[a.length-1];return o&&o.changes&&!o.changes.empty&&e.changes&&(!i||k5.test(i))&&(!o.selectionsAfter.length&&t-this.prevTime<n.newGroupDelay&&n.joinToEvent(s,g5(o.changes,e.changes))||i=="input.type.compose")?a=Wc(a,a.length-1,n.minDepth,new Mr(e.changes.compose(o.changes),Hy(Xe.mapEffects(e.effects,o.changes),o.effects),o.mapped,o.startSelection,qr)):a=Wc(a,a.length,n.minDepth,e),new Mi(a,qr,t,i)}addSelection(e,t,i,n){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:qr;return s.length>0&&t-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&x5(s[s.length-1],e)?this:new Mi(zy(this.done,e),this.undone,t,i)}addMapping(e){return new Mi(gh(this.done,e),gh(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let n=e==0?this.done:this.undone;if(n.length==0)return null;let s=n[n.length-1],a=s.selectionsAfter[0]||t.selection;if(i&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Pu.of({side:e,rest:y5(n),selection:a}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let o=n.length==1?qr:n.slice(0,n.length-1);return s.mapped&&(o=gh(o,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Pu.of({side:e,rest:o,selection:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Mi.empty=new Mi(qr,qr);const b5=[{key:"Mod-z",run:Uy,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Lu,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Lu,preventDefault:!0},{key:"Mod-u",run:p5,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:m5,preventDefault:!0}];function pa(r,e){return ke.create(r.ranges.map(e),r.mainIndex)}function gi(r,e){return r.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function xi({state:r,dispatch:e},t){let i=pa(r.selection,t);return i.eq(r.selection,!0)?!1:(e(gi(r,i)),!0)}function _f(r,e){return ke.cursor(e?r.to:r.from)}function Wy(r,e){return xi(r,t=>t.empty?r.moveByChar(t,e):_f(t,e))}function dr(r){return r.textDirectionAt(r.state.selection.main.head)==pt.LTR}const Vy=r=>Wy(r,!dr(r)),jy=r=>Wy(r,dr(r));function $y(r,e){return xi(r,t=>t.empty?r.moveByGroup(t,e):_f(t,e))}const _5=r=>$y(r,!dr(r)),S5=r=>$y(r,dr(r));function T5(r,e,t){if(e.type.prop(t))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(r.sliceDoc(e.from,e.to)))||e.firstChild}function Sf(r,e,t){let i=hr(r).resolveInner(e.head),n=t?Ye.closedBy:Ye.openedBy;for(let l=e.head;;){let c=t?i.childAfter(l):i.childBefore(l);if(!c)break;T5(r,c,n)?i=c:l=t?c.to:c.from}let s=i.type.prop(n),a,o;return s&&(a=t?Ri(r,i.from,1):Ri(r,i.to,-1))&&a.matched?o=t?a.end.to:a.end.from:o=t?i.to:i.from,ke.cursor(o,t?-1:1)}const E5=r=>xi(r,e=>Sf(r.state,e,!dr(r))),C5=r=>xi(r,e=>Sf(r.state,e,dr(r)));function Gy(r,e){return xi(r,t=>{if(!t.empty)return _f(t,e);let i=r.moveVertically(t,e);return i.head!=t.head?i:r.moveToLineBoundary(t,e)})}const Ky=r=>Gy(r,!1),Xy=r=>Gy(r,!0);function qy(r){let e=r.scrollDOM.clientHeight<r.scrollDOM.scrollHeight-2,t=0,i=0,n;if(e){for(let s of r.state.facet(Oe.scrollMargins)){let a=s(r);a!=null&&a.top&&(t=Math.max(a==null?void 0:a.top,t)),a!=null&&a.bottom&&(i=Math.max(a==null?void 0:a.bottom,i))}n=r.scrollDOM.clientHeight-t-i}else n=(r.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:i,selfScroll:e,height:Math.max(r.defaultLineHeight,n-5)}}function Yy(r,e){let t=qy(r),{state:i}=r,n=pa(i.selection,a=>a.empty?r.moveVertically(a,e,t.height):_f(a,e));if(n.eq(i.selection))return!1;let s;if(t.selfScroll){let a=r.coordsAtPos(i.selection.main.head),o=r.scrollDOM.getBoundingClientRect(),l=o.top+t.marginTop,c=o.bottom-t.marginBottom;a&&a.top>l&&a.bottom<c&&(s=Oe.scrollIntoView(n.main.head,{y:"start",yMargin:a.top-l}))}return r.dispatch(gi(i,n),{effects:s}),!0}const hg=r=>Yy(r,!1),Bu=r=>Yy(r,!0);function Hn(r,e,t){let i=r.lineBlockAt(e.head),n=r.moveToLineBoundary(e,t);if(n.head==e.head&&n.head!=(t?i.to:i.from)&&(n=r.moveToLineBoundary(e,t,!1)),!t&&n.head==i.from&&i.length){let s=/^\s*/.exec(r.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&e.head!=i.from+s&&(n=ke.cursor(i.from+s))}return n}const A5=r=>xi(r,e=>Hn(r,e,!0)),O5=r=>xi(r,e=>Hn(r,e,!1)),F5=r=>xi(r,e=>Hn(r,e,!dr(r))),D5=r=>xi(r,e=>Hn(r,e,dr(r))),R5=r=>xi(r,e=>ke.cursor(r.lineBlockAt(e.head).from,1)),M5=r=>xi(r,e=>ke.cursor(r.lineBlockAt(e.head).to,-1));function I5(r,e,t){let i=!1,n=pa(r.selection,s=>{let a=Ri(r,s.head,-1)||Ri(r,s.head,1)||s.head>0&&Ri(r,s.head-1,1)||s.head<r.doc.length&&Ri(r,s.head+1,-1);if(!a||!a.end)return s;i=!0;let o=a.start.from==s.head?a.end.to:a.end.from;return ke.cursor(o)});return i?(e(gi(r,n)),!0):!1}const P5=({state:r,dispatch:e})=>I5(r,e);function ni(r,e){let t=pa(r.state.selection,i=>{let n=e(i);return ke.range(i.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return t.eq(r.state.selection)?!1:(r.dispatch(gi(r.state,t)),!0)}function Jy(r,e){return ni(r,t=>r.moveByChar(t,e))}const Zy=r=>Jy(r,!dr(r)),Qy=r=>Jy(r,dr(r));function ew(r,e){return ni(r,t=>r.moveByGroup(t,e))}const L5=r=>ew(r,!dr(r)),B5=r=>ew(r,dr(r)),N5=r=>ni(r,e=>Sf(r.state,e,!dr(r))),U5=r=>ni(r,e=>Sf(r.state,e,dr(r)));function tw(r,e){return ni(r,t=>r.moveVertically(t,e))}const rw=r=>tw(r,!1),iw=r=>tw(r,!0);function nw(r,e){return ni(r,t=>r.moveVertically(t,e,qy(r).height))}const ug=r=>nw(r,!1),dg=r=>nw(r,!0),H5=r=>ni(r,e=>Hn(r,e,!0)),z5=r=>ni(r,e=>Hn(r,e,!1)),W5=r=>ni(r,e=>Hn(r,e,!dr(r))),V5=r=>ni(r,e=>Hn(r,e,dr(r))),j5=r=>ni(r,e=>ke.cursor(r.lineBlockAt(e.head).from)),$5=r=>ni(r,e=>ke.cursor(r.lineBlockAt(e.head).to)),pg=({state:r,dispatch:e})=>(e(gi(r,{anchor:0})),!0),mg=({state:r,dispatch:e})=>(e(gi(r,{anchor:r.doc.length})),!0),gg=({state:r,dispatch:e})=>(e(gi(r,{anchor:r.selection.main.anchor,head:0})),!0),xg=({state:r,dispatch:e})=>(e(gi(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),G5=({state:r,dispatch:e})=>(e(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),K5=({state:r,dispatch:e})=>{let t=Tf(r).map(({from:i,to:n})=>ke.range(i,Math.min(n+1,r.doc.length)));return e(r.update({selection:ke.create(t),userEvent:"select"})),!0},X5=({state:r,dispatch:e})=>{let t=pa(r.selection,i=>{let n=hr(r),s=n.resolveStack(i.from,1);if(i.empty){let a=n.resolveStack(i.from,-1);a.node.from>=s.node.from&&a.node.to<=s.node.to&&(s=a)}for(let a=s;a;a=a.next){let{node:o}=a;if((o.from<i.from&&o.to>=i.to||o.to>i.to&&o.from<=i.from)&&a.next)return ke.range(o.to,o.from)}return i});return t.eq(r.selection)?!1:(e(gi(r,t)),!0)};function sw(r,e){let{state:t}=r,i=t.selection,n=t.selection.ranges.slice();for(let s of t.selection.ranges){let a=t.doc.lineAt(s.head);if(e?a.to<r.state.doc.length:a.from>0)for(let o=s;;){let l=r.moveVertically(o,e);if(l.head<a.from||l.head>a.to){n.some(c=>c.head==l.head)||n.push(l);break}else{if(l.head==o.head)break;o=l}}}return n.length==i.ranges.length?!1:(r.dispatch(gi(t,ke.create(n,n.length-1))),!0)}const q5=r=>sw(r,!1),Y5=r=>sw(r,!0),J5=({state:r,dispatch:e})=>{let t=r.selection,i=null;return t.ranges.length>1?i=ke.create([t.main]):t.main.empty||(i=ke.create([ke.cursor(t.main.head)])),i?(e(gi(r,i)),!0):!1};function rl(r,e){if(r.state.readOnly)return!1;let t="delete.selection",{state:i}=r,n=i.changeByRange(s=>{let{from:a,to:o}=s;if(a==o){let l=e(s);l<a?(t="delete.backward",l=Bl(r,l,!1)):l>a&&(t="delete.forward",l=Bl(r,l,!0)),a=Math.min(a,l),o=Math.max(o,l)}else a=Bl(r,a,!1),o=Bl(r,o,!0);return a==o?{range:s}:{changes:{from:a,to:o},range:ke.cursor(a,a<s.head?-1:1)}});return n.changes.empty?!1:(r.dispatch(i.update(n,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?Oe.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function Bl(r,e,t){if(r instanceof Oe)for(let i of r.state.facet(Oe.atomicRanges).map(n=>n(r)))i.between(e,e,(n,s)=>{n<e&&s>e&&(e=t?s:n)});return e}const aw=(r,e,t)=>rl(r,i=>{let n=i.from,{state:s}=r,a=s.doc.lineAt(n),o,l;if(t&&!e&&n>a.from&&n<a.from+200&&!/[^ \t]/.test(o=a.text.slice(0,n-a.from))){if(o[o.length-1]=="	")return n-1;let c=da(o,s.tabSize),f=c%Uc(s)||Uc(s);for(let h=0;h<f&&o[o.length-1-h]==" ";h++)n--;l=n}else l=Kt(a.text,n-a.from,e,e)+a.from,l==n&&a.number!=(e?s.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(l-a.from,n-a.from))&&(l=Kt(a.text,l-a.from,!1,!1)+a.from);return l}),Nu=r=>aw(r,!1,!0),ow=r=>aw(r,!0,!1),lw=(r,e)=>rl(r,t=>{let i=t.head,{state:n}=r,s=n.doc.lineAt(i),a=n.charCategorizer(i);for(let o=null;;){if(i==(e?s.to:s.from)){i==t.head&&s.number!=(e?n.doc.lines:1)&&(i+=e?1:-1);break}let l=Kt(s.text,i-s.from,e)+s.from,c=s.text.slice(Math.min(i,l)-s.from,Math.max(i,l)-s.from),f=a(c);if(o!=null&&f!=o)break;(c!=" "||i!=t.head)&&(o=f),i=l}return i}),cw=r=>lw(r,!1),Z5=r=>lw(r,!0),Q5=r=>rl(r,e=>{let t=r.lineBlockAt(e.head).to;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),eM=r=>rl(r,e=>{let t=r.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),tM=r=>rl(r,e=>{let t=r.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),rM=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:rt.of(["",""])},range:ke.cursor(i.from)}));return e(r.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},iM=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(i=>{if(!i.empty||i.from==0||i.from==r.doc.length)return{range:i};let n=i.from,s=r.doc.lineAt(n),a=n==s.from?n-1:Kt(s.text,n-s.from,!1)+s.from,o=n==s.to?n+1:Kt(s.text,n-s.from,!0)+s.from;return{changes:{from:a,to:o,insert:r.doc.slice(n,o).append(r.doc.slice(a,n))},range:ke.cursor(o)}});return t.changes.empty?!1:(e(r.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Tf(r){let e=[],t=-1;for(let i of r.selection.ranges){let n=r.doc.lineAt(i.from),s=r.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=r.doc.lineAt(i.to-1)),t>=n.number){let a=e[e.length-1];a.to=s.to,a.ranges.push(i)}else e.push({from:n.from,to:s.to,ranges:[i]});t=s.number+1}return e}function fw(r,e,t){if(r.readOnly)return!1;let i=[],n=[];for(let s of Tf(r)){if(t?s.to==r.doc.length:s.from==0)continue;let a=r.doc.lineAt(t?s.to+1:s.from-1),o=a.length+1;if(t){i.push({from:s.to,to:a.to},{from:s.from,insert:a.text+r.lineBreak});for(let l of s.ranges)n.push(ke.range(Math.min(r.doc.length,l.anchor+o),Math.min(r.doc.length,l.head+o)))}else{i.push({from:a.from,to:s.from},{from:s.to,insert:r.lineBreak+a.text});for(let l of s.ranges)n.push(ke.range(l.anchor-o,l.head-o))}}return i.length?(e(r.update({changes:i,scrollIntoView:!0,selection:ke.create(n,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}const nM=({state:r,dispatch:e})=>fw(r,e,!1),sM=({state:r,dispatch:e})=>fw(r,e,!0);function hw(r,e,t){if(r.readOnly)return!1;let i=[];for(let n of Tf(r))t?i.push({from:n.from,insert:r.doc.slice(n.from,n.to)+r.lineBreak}):i.push({from:n.to,insert:r.lineBreak+r.doc.slice(n.from,n.to)});return e(r.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const aM=({state:r,dispatch:e})=>hw(r,e,!1),oM=({state:r,dispatch:e})=>hw(r,e,!0),lM=r=>{if(r.state.readOnly)return!1;let{state:e}=r,t=e.changes(Tf(e).map(({from:n,to:s})=>(n>0?n--:s<e.doc.length&&s++,{from:n,to:s}))),i=pa(e.selection,n=>{let s;if(r.lineWrapping){let a=r.lineBlockAt(n.head),o=r.coordsAtPos(n.head,n.assoc||1);o&&(s=a.bottom+r.documentTop-o.bottom+r.defaultLineHeight/2)}return r.moveVertically(n,!0,s)}).map(t);return r.dispatch({changes:t,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function cM(r,e){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=hr(r).resolveInner(e),i=t.childBefore(e),n=t.childAfter(e),s;return i&&n&&i.to<=e&&n.from>=e&&(s=i.type.prop(Ye.closedBy))&&s.indexOf(n.name)>-1&&r.doc.lineAt(i.to).from==r.doc.lineAt(n.from).from&&!/\S/.test(r.sliceDoc(i.to,n.from))?{from:i.to,to:n.from}:null}const vg=uw(!1),fM=uw(!0);function uw(r){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange(n=>{let{from:s,to:a}=n,o=e.doc.lineAt(s),l=!r&&s==a&&cM(e,s);r&&(s=a=(a<=o.to?o:e.doc.lineAt(a)).to);let c=new wf(e,{simulateBreak:s,simulateDoubleBreak:!!l}),f=ed(c,s);for(f==null&&(f=da(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));a<o.to&&/\s/.test(o.text[a-o.from]);)a++;l?{from:s,to:a}=l:s>o.from&&s<o.from+100&&!/\S/.test(o.text.slice(0,s))&&(s=o.from);let h=["",Ro(e,f)];return l&&h.push(Ro(e,c.lineIndent(o.from,-1))),{changes:{from:s,to:a,insert:rt.of(h)},range:ke.cursor(s+1+h[1].length)}});return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function nd(r,e){let t=-1;return r.changeByRange(i=>{let n=[];for(let a=i.from;a<=i.to;){let o=r.doc.lineAt(a);o.number>t&&(i.empty||i.to>o.from)&&(e(o,n,i),t=o.number),a=o.to+1}let s=r.changes(n);return{changes:n,range:ke.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const hM=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=Object.create(null),i=new wf(r,{overrideIndentation:s=>{let a=t[s];return a??-1}}),n=nd(r,(s,a,o)=>{let l=ed(i,s.from);if(l==null)return;/\S/.test(s.text)||(l=0);let c=/^\s*/.exec(s.text)[0],f=Ro(r,l);(c!=f||o.from<s.from+c.length)&&(t[s.from]=l,a.push({from:s.from,to:s.from+c.length,insert:f}))});return n.changes.empty||e(r.update(n,{userEvent:"indent"})),!0},dw=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(nd(r,(t,i)=>{i.push({from:t.from,insert:r.facet(yf)})}),{userEvent:"input.indent"})),!0),pw=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(nd(r,(t,i)=>{let n=/^\s*/.exec(t.text)[0];if(!n)return;let s=da(n,r.tabSize),a=0,o=Ro(r,Math.max(0,s-Uc(r)));for(;a<n.length&&a<o.length&&n.charCodeAt(a)==o.charCodeAt(a);)a++;i.push({from:t.from+a,to:t.from+n.length,insert:o.slice(a)})}),{userEvent:"delete.dedent"})),!0),uM=r=>(r.setTabFocusMode(),!0),dM=[{key:"Ctrl-b",run:Vy,shift:Zy,preventDefault:!0},{key:"Ctrl-f",run:jy,shift:Qy},{key:"Ctrl-p",run:Ky,shift:rw},{key:"Ctrl-n",run:Xy,shift:iw},{key:"Ctrl-a",run:R5,shift:j5},{key:"Ctrl-e",run:M5,shift:$5},{key:"Ctrl-d",run:ow},{key:"Ctrl-h",run:Nu},{key:"Ctrl-k",run:Q5},{key:"Ctrl-Alt-h",run:cw},{key:"Ctrl-o",run:rM},{key:"Ctrl-t",run:iM},{key:"Ctrl-v",run:Bu}],pM=[{key:"ArrowLeft",run:Vy,shift:Zy,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:_5,shift:L5,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:F5,shift:W5,preventDefault:!0},{key:"ArrowRight",run:jy,shift:Qy,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:S5,shift:B5,preventDefault:!0},{mac:"Cmd-ArrowRight",run:D5,shift:V5,preventDefault:!0},{key:"ArrowUp",run:Ky,shift:rw,preventDefault:!0},{mac:"Cmd-ArrowUp",run:pg,shift:gg},{mac:"Ctrl-ArrowUp",run:hg,shift:ug},{key:"ArrowDown",run:Xy,shift:iw,preventDefault:!0},{mac:"Cmd-ArrowDown",run:mg,shift:xg},{mac:"Ctrl-ArrowDown",run:Bu,shift:dg},{key:"PageUp",run:hg,shift:ug},{key:"PageDown",run:Bu,shift:dg},{key:"Home",run:O5,shift:z5,preventDefault:!0},{key:"Mod-Home",run:pg,shift:gg},{key:"End",run:A5,shift:H5,preventDefault:!0},{key:"Mod-End",run:mg,shift:xg},{key:"Enter",run:vg,shift:vg},{key:"Mod-a",run:G5},{key:"Backspace",run:Nu,shift:Nu,preventDefault:!0},{key:"Delete",run:ow,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:cw,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:Z5,preventDefault:!0},{mac:"Mod-Backspace",run:eM,preventDefault:!0},{mac:"Mod-Delete",run:tM,preventDefault:!0}].concat(dM.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),mM=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:E5,shift:N5},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:C5,shift:U5},{key:"Alt-ArrowUp",run:nM},{key:"Shift-Alt-ArrowUp",run:aM},{key:"Alt-ArrowDown",run:sM},{key:"Shift-Alt-ArrowDown",run:oM},{key:"Mod-Alt-ArrowUp",run:q5},{key:"Mod-Alt-ArrowDown",run:Y5},{key:"Escape",run:J5},{key:"Mod-Enter",run:fM},{key:"Alt-l",mac:"Ctrl-l",run:K5},{key:"Mod-i",run:X5,preventDefault:!0},{key:"Mod-[",run:pw},{key:"Mod-]",run:dw},{key:"Mod-Alt-\\",run:hM},{key:"Shift-Mod-k",run:lM},{key:"Shift-Mod-\\",run:P5},{key:"Mod-/",run:n5},{key:"Alt-A",run:a5},{key:"Ctrl-m",mac:"Shift-Alt-m",run:uM}].concat(pM),gM={key:"Tab",run:dw,shift:pw},yg=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class oa{constructor(e,t,i=0,n=e.length,s,a){this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,n),this.bufferStart=i,this.normalize=s?o=>s(yg(o)):yg,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Or(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=P0(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Fi(e);let n=this.normalize(t);if(n.length)for(let s=0,a=i;;s++){let o=n.charCodeAt(s),l=this.match(o,a,this.bufferPos+this.bufferStart);if(s==n.length-1){if(l)return this.value=l,this;break}a==i&&s<t.length&&t.charCodeAt(s)==o&&a++}}}match(e,t,i){let n=null;for(let s=0;s<this.matches.length;s+=2){let a=this.matches[s],o=!1;this.query.charCodeAt(a)==e&&(a==this.query.length-1?n={from:this.matches[s+1],to:i}:(this.matches[s]++,o=!0)),o||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?n={from:t,to:i}:this.matches.push(1,t)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferStart)&&(n=null),n}}typeof Symbol<"u"&&(oa.prototype[Symbol.iterator]=function(){return this});const mw={from:-1,to:-1,match:/.*/.exec("")},sd="gm"+(/x/.unicode==null?"":"u");class gw{constructor(e,t,i,n=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=mw,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new xw(e,t,i,n,s);this.re=new RegExp(t,sd+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=e.iter();let a=e.lineAt(n);this.curLineStart=a.from,this.matchPos=Vc(e,n),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,n=i+t[0].length;if(this.matchPos=Vc(this.text,n+(i==n?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<n||i>this.value.to)&&(!this.test||this.test(i,n,t)))return this.value={from:i,to:n,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const xh=new WeakMap;class Xs{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let n=xh.get(e);if(!n||n.from>=i||n.to<=t){let o=new Xs(t,e.sliceString(t,i));return xh.set(e,o),o}if(n.from==t&&n.to==i)return n;let{text:s,from:a}=n;return a>t&&(s=e.sliceString(t,a)+s,a=t),n.to<i&&(s+=e.sliceString(n.to,i)),xh.set(e,new Xs(a,s)),new Xs(t,s.slice(t-a,i-a))}}class xw{constructor(e,t,i,n,s){this.text=e,this.to=s,this.done=!1,this.value=mw,this.matchPos=Vc(e,n),this.re=new RegExp(t,sd+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=Xs.get(e,n,this.chunkEnd(n+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let i=this.flat.from+t.index,n=i+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,n,t)))return this.value={from:i,to:n,match:t},this.matchPos=Vc(this.text,n+(i==n?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Xs.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(gw.prototype[Symbol.iterator]=xw.prototype[Symbol.iterator]=function(){return this});function xM(r){try{return new RegExp(r,sd),!0}catch{return!1}}function Vc(r,e){if(e>=r.length)return e;let t=r.lineAt(e),i;for(;e<t.to&&(i=t.text.charCodeAt(e-t.from))>=56320&&i<57344;)e++;return e}function Uu(r){let e=String(r.state.doc.lineAt(r.state.selection.main.head).number),t=at("input",{class:"cm-textfield",name:"line",value:e}),i=at("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),r.dispatch({effects:ao.of(!1)}),r.focus()):s.keyCode==13&&(s.preventDefault(),n())},onsubmit:s=>{s.preventDefault(),n()}},at("label",r.state.phrase("Go to line"),": ",t)," ",at("button",{class:"cm-button",type:"submit"},r.state.phrase("go")),at("button",{name:"close",onclick:()=>{r.dispatch({effects:ao.of(!1)}),r.focus()},"aria-label":r.state.phrase("close"),type:"button"},[""]));function n(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!s)return;let{state:a}=r,o=a.doc.lineAt(a.selection.main.head),[,l,c,f,h]=s,u=f?+f.slice(1):0,d=c?+c:o.number;if(c&&h){let g=d/100;l&&(g=g*(l=="-"?-1:1)+o.number/a.doc.lines),d=Math.round(a.doc.lines*g)}else c&&l&&(d=d*(l=="-"?-1:1)+o.number);let m=a.doc.line(Math.max(1,Math.min(a.doc.lines,d))),p=ke.cursor(m.from+Math.max(0,Math.min(u,m.length)));r.dispatch({effects:[ao.of(!1),Oe.scrollIntoView(p.from,{y:"center"})],selection:p}),r.focus()}return{dom:i}}const ao=Xe.define(),wg=Yt.define({create(){return!0},update(r,e){for(let t of e.effects)t.is(ao)&&(r=t.value);return r},provide:r=>Fo.from(r,e=>e?Uu:null)}),vM=r=>{let e=Oo(r,Uu);if(!e){let t=[ao.of(!0)];r.state.field(wg,!1)==null&&t.push(Xe.appendConfig.of([wg,yM])),r.dispatch({effects:t}),e=Oo(r,Uu)}return e&&e.dom.querySelector("input").select(),!0},yM=Oe.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),wM={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},kM=Re.define({combine(r){return Wi(r,wM,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function bM(r){return[CM,EM]}const _M=Be.mark({class:"cm-selectionMatch"}),SM=Be.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function kg(r,e,t,i){return(t==0||r(e.sliceDoc(t-1,t))!=gt.Word)&&(i==e.doc.length||r(e.sliceDoc(i,i+1))!=gt.Word)}function TM(r,e,t,i){return r(e.sliceDoc(t,t+1))==gt.Word&&r(e.sliceDoc(i-1,i))==gt.Word}const EM=St.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=r.state.facet(kM),{state:t}=r,i=t.selection;if(i.ranges.length>1)return Be.none;let n=i.main,s,a=null;if(n.empty){if(!e.highlightWordAroundCursor)return Be.none;let l=t.wordAt(n.head);if(!l)return Be.none;a=t.charCategorizer(n.head),s=t.sliceDoc(l.from,l.to)}else{let l=n.to-n.from;if(l<e.minSelectionLength||l>200)return Be.none;if(e.wholeWords){if(s=t.sliceDoc(n.from,n.to),a=t.charCategorizer(n.head),!(kg(a,t,n.from,n.to)&&TM(a,t,n.from,n.to)))return Be.none}else if(s=t.sliceDoc(n.from,n.to),!s)return Be.none}let o=[];for(let l of r.visibleRanges){let c=new oa(t.doc,s,l.from,l.to);for(;!c.next().done;){let{from:f,to:h}=c.value;if((!a||kg(a,t,f,h))&&(n.empty&&f<=n.from&&h>=n.to?o.push(SM.range(f,h)):(f>=n.to||h<=n.from)&&o.push(_M.range(f,h)),o.length>e.maxMatches))return Be.none}}return Be.set(o)}},{decorations:r=>r.decorations}),CM=Oe.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),AM=({state:r,dispatch:e})=>{let{selection:t}=r,i=ke.create(t.ranges.map(n=>r.wordAt(n.head)||ke.cursor(n.head)),t.mainIndex);return i.eq(t)?!1:(e(r.update({selection:i})),!0)};function OM(r,e){let{main:t,ranges:i}=r.selection,n=r.wordAt(t.head),s=n&&n.from==t.from&&n.to==t.to;for(let a=!1,o=new oa(r.doc,e,i[i.length-1].to);;)if(o.next(),o.done){if(a)return null;o=new oa(r.doc,e,0,Math.max(0,i[i.length-1].from-1)),a=!0}else{if(a&&i.some(l=>l.from==o.value.from))continue;if(s){let l=r.wordAt(o.value.from);if(!l||l.from!=o.value.from||l.to!=o.value.to)continue}return o.value}}const FM=({state:r,dispatch:e})=>{let{ranges:t}=r.selection;if(t.some(s=>s.from===s.to))return AM({state:r,dispatch:e});let i=r.sliceDoc(t[0].from,t[0].to);if(r.selection.ranges.some(s=>r.sliceDoc(s.from,s.to)!=i))return!1;let n=OM(r,i);return n?(e(r.update({selection:r.selection.addRange(ke.range(n.from,n.to),!1),effects:Oe.scrollIntoView(n.to)})),!0):!1},ma=Re.define({combine(r){return Wi(r,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new WM(e),scrollToMatch:e=>Oe.scrollIntoView(e)})}});class vw{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||xM(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new IM(this):new RM(this)}getCursor(e,t=0,i){let n=e.doc?e:Je.create({doc:e});return i==null&&(i=n.doc.length),this.regexp?Os(this,n,t,i):As(this,n,t,i)}}class yw{constructor(e){this.spec=e}}function As(r,e,t,i){return new oa(e.doc,r.unquoted,t,i,r.caseSensitive?void 0:n=>n.toLowerCase(),r.wholeWord?DM(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function DM(r,e){return(t,i,n,s)=>((s>t||s+n.length<i)&&(s=Math.max(0,t-2),n=r.sliceString(s,Math.min(r.length,i+2))),(e(jc(n,t-s))!=gt.Word||e($c(n,t-s))!=gt.Word)&&(e($c(n,i-s))!=gt.Word||e(jc(n,i-s))!=gt.Word))}class RM extends yw{constructor(e){super(e)}nextMatch(e,t,i){let n=As(this.spec,e,i,e.doc.length).nextOverlapping();if(n.done){let s=Math.min(e.doc.length,t+this.spec.unquoted.length);n=As(this.spec,e,0,s).nextOverlapping()}return n.done||n.value.from==t&&n.value.to==i?null:n.value}prevMatchInRange(e,t,i){for(let n=i;;){let s=Math.max(t,n-1e4-this.spec.unquoted.length),a=As(this.spec,e,s,n),o=null;for(;!a.nextOverlapping().done;)o=a.value;if(o)return o;if(s==t)return null;n-=1e4}}prevMatch(e,t,i){let n=this.prevMatchInRange(e,0,t);return n||(n=this.prevMatchInRange(e,Math.max(0,i-this.spec.unquoted.length),e.doc.length)),n&&(n.from!=t||n.to!=i)?n:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let i=As(this.spec,e,0,e.doc.length),n=[];for(;!i.next().done;){if(n.length>=t)return null;n.push(i.value)}return n}highlight(e,t,i,n){let s=As(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)n(s.value.from,s.value.to)}}function Os(r,e,t,i){return new gw(e.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?MM(e.charCategorizer(e.selection.main.head)):void 0},t,i)}function jc(r,e){return r.slice(Kt(r,e,!1),e)}function $c(r,e){return r.slice(e,Kt(r,e))}function MM(r){return(e,t,i)=>!i[0].length||(r(jc(i.input,i.index))!=gt.Word||r($c(i.input,i.index))!=gt.Word)&&(r($c(i.input,i.index+i[0].length))!=gt.Word||r(jc(i.input,i.index+i[0].length))!=gt.Word)}class IM extends yw{nextMatch(e,t,i){let n=Os(this.spec,e,i,e.doc.length).next();return n.done&&(n=Os(this.spec,e,0,t).next()),n.done?null:n.value}prevMatchInRange(e,t,i){for(let n=1;;n++){let s=Math.max(t,i-n*1e4),a=Os(this.spec,e,s,i),o=null;for(;!a.next().done;)o=a.value;if(o&&(s==t||o.from>s+10))return o;if(s==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,i)=>{if(i=="&")return e.match[0];if(i=="$")return"$";for(let n=i.length;n>0;n--){let s=+i.slice(0,n);if(s>0&&s<e.match.length)return e.match[s]+i.slice(n)}return t})}matchAll(e,t){let i=Os(this.spec,e,0,e.doc.length),n=[];for(;!i.next().done;){if(n.length>=t)return null;n.push(i.value)}return n}highlight(e,t,i,n){let s=Os(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.doc.length));for(;!s.next().done;)n(s.value.from,s.value.to)}}const Mo=Xe.define(),ad=Xe.define(),On=Yt.define({create(r){return new vh(Hu(r).create(),null)},update(r,e){for(let t of e.effects)t.is(Mo)?r=new vh(t.value.create(),r.panel):t.is(ad)&&(r=new vh(r.query,t.value?od:null));return r},provide:r=>Fo.from(r,e=>e.panel)});class vh{constructor(e,t){this.query=e,this.panel=t}}const PM=Be.mark({class:"cm-searchMatch"}),LM=Be.mark({class:"cm-searchMatch cm-searchMatch-selected"}),BM=St.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(On))}update(r){let e=r.state.field(On);(e!=r.startState.field(On)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:r,panel:e}){if(!e||!r.spec.valid)return Be.none;let{view:t}=this,i=new an;for(let n=0,s=t.visibleRanges,a=s.length;n<a;n++){let{from:o,to:l}=s[n];for(;n<a-1&&l>s[n+1].from-2*250;)l=s[++n].to;r.highlight(t.state,o,l,(c,f)=>{let h=t.state.selection.ranges.some(u=>u.from==c&&u.to==f);i.add(c,f,h?LM:PM)})}return i.finish()}},{decorations:r=>r.decorations});function il(r){return e=>{let t=e.state.field(On,!1);return t&&t.query.spec.valid?r(e,t):bw(e)}}const Gc=il((r,{query:e})=>{let{to:t}=r.state.selection.main,i=e.nextMatch(r.state,t,t);if(!i)return!1;let n=ke.single(i.from,i.to),s=r.state.facet(ma);return r.dispatch({selection:n,effects:[ld(r,i),s.scrollToMatch(n.main,r)],userEvent:"select.search"}),kw(r),!0}),Kc=il((r,{query:e})=>{let{state:t}=r,{from:i}=t.selection.main,n=e.prevMatch(t,i,i);if(!n)return!1;let s=ke.single(n.from,n.to),a=r.state.facet(ma);return r.dispatch({selection:s,effects:[ld(r,n),a.scrollToMatch(s.main,r)],userEvent:"select.search"}),kw(r),!0}),NM=il((r,{query:e})=>{let t=e.matchAll(r.state,1e3);return!t||!t.length?!1:(r.dispatch({selection:ke.create(t.map(i=>ke.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),UM=({state:r,dispatch:e})=>{let t=r.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:n}=t.main,s=[],a=0;for(let o=new oa(r.doc,r.sliceDoc(i,n));!o.next().done;){if(s.length>1e3)return!1;o.value.from==i&&(a=s.length),s.push(ke.range(o.value.from,o.value.to))}return e(r.update({selection:ke.create(s,a),userEvent:"select.search.matches"})),!0},bg=il((r,{query:e})=>{let{state:t}=r,{from:i,to:n}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,i,i);if(!s)return!1;let a=s,o=[],l,c,f=[];a.from==i&&a.to==n&&(c=t.toText(e.getReplacement(a)),o.push({from:a.from,to:a.to,insert:c}),a=e.nextMatch(t,a.from,a.to),f.push(Oe.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(i).number)+".")));let h=r.state.changes(o);return a&&(l=ke.single(a.from,a.to).map(h),f.push(ld(r,a)),f.push(t.facet(ma).scrollToMatch(l.main,r))),r.dispatch({changes:h,selection:l,effects:f,userEvent:"input.replace"}),!0}),HM=il((r,{query:e})=>{if(r.state.readOnly)return!1;let t=e.matchAll(r.state,1e9).map(n=>{let{from:s,to:a}=n;return{from:s,to:a,insert:e.getReplacement(n)}});if(!t.length)return!1;let i=r.state.phrase("replaced $ matches",t.length)+".";return r.dispatch({changes:t,effects:Oe.announce.of(i),userEvent:"input.replace.all"}),!0});function od(r){return r.state.facet(ma).createPanel(r)}function Hu(r,e){var t,i,n,s,a;let o=r.selection.main,l=o.empty||o.to>o.from+100?"":r.sliceDoc(o.from,o.to);if(e&&!l)return e;let c=r.facet(ma);return new vw({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(i=e==null?void 0:e.caseSensitive)!==null&&i!==void 0?i:c.caseSensitive,literal:(n=e==null?void 0:e.literal)!==null&&n!==void 0?n:c.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:c.regexp,wholeWord:(a=e==null?void 0:e.wholeWord)!==null&&a!==void 0?a:c.wholeWord})}function ww(r){let e=Oo(r,od);return e&&e.dom.querySelector("[main-field]")}function kw(r){let e=ww(r);e&&e==r.root.activeElement&&e.select()}const bw=r=>{let e=r.state.field(On,!1);if(e&&e.panel){let t=ww(r);if(t&&t!=r.root.activeElement){let i=Hu(r.state,e.query.spec);i.valid&&r.dispatch({effects:Mo.of(i)}),t.focus(),t.select()}}else r.dispatch({effects:[ad.of(!0),e?Mo.of(Hu(r.state,e.query.spec)):Xe.appendConfig.of(jM)]});return!0},_w=r=>{let e=r.state.field(On,!1);if(!e||!e.panel)return!1;let t=Oo(r,od);return t&&t.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:ad.of(!1)}),!0},zM=[{key:"Mod-f",run:bw,scope:"editor search-panel"},{key:"F3",run:Gc,shift:Kc,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Gc,shift:Kc,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:_w,scope:"editor search-panel"},{key:"Mod-Shift-l",run:UM},{key:"Mod-Alt-g",run:vM},{key:"Mod-d",run:FM,preventDefault:!0}];class WM{constructor(e){this.view=e;let t=this.query=e.state.field(On).query.spec;this.commit=this.commit.bind(this),this.searchField=at("input",{value:t.search,placeholder:Pr(e,"Find"),"aria-label":Pr(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=at("input",{value:t.replace,placeholder:Pr(e,"Replace"),"aria-label":Pr(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=at("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=at("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=at("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function i(n,s,a){return at("button",{class:"cm-button",name:n,onclick:s,type:"button"},a)}this.dom=at("div",{onkeydown:n=>this.keydown(n),class:"cm-search"},[this.searchField,i("next",()=>Gc(e),[Pr(e,"next")]),i("prev",()=>Kc(e),[Pr(e,"previous")]),i("select",()=>NM(e),[Pr(e,"all")]),at("label",null,[this.caseField,Pr(e,"match case")]),at("label",null,[this.reField,Pr(e,"regexp")]),at("label",null,[this.wordField,Pr(e,"by word")]),...e.state.readOnly?[]:[at("br"),this.replaceField,i("replace",()=>bg(e),[Pr(e,"replace")]),i("replaceAll",()=>HM(e),[Pr(e,"replace all")])],at("button",{name:"close",onclick:()=>_w(e),"aria-label":Pr(e,"close"),type:"button"},[""])])}commit(){let e=new vw({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Mo.of(e)}))}keydown(e){XD(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Kc:Gc)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),bg(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(Mo)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(ma).top}}function Pr(r,e){return r.state.phrase(e)}const Nl=30,Ul=/[\s\.,:;?!]/;function ld(r,{from:e,to:t}){let i=r.state.doc.lineAt(e),n=r.state.doc.lineAt(t).to,s=Math.max(i.from,e-Nl),a=Math.min(n,t+Nl),o=r.state.sliceDoc(s,a);if(s!=i.from){for(let l=0;l<Nl;l++)if(!Ul.test(o[l+1])&&Ul.test(o[l])){o=o.slice(l);break}}if(a!=n){for(let l=o.length-1;l>o.length-Nl;l--)if(!Ul.test(o[l-1])&&Ul.test(o[l])){o=o.slice(0,l);break}}return Oe.announce.of(`${r.state.phrase("current match")}. ${o} ${r.state.phrase("on line")} ${i.number}.`)}const VM=Oe.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),jM=[On,bs.low(BM),VM];class Sw{constructor(e,t,i,n){this.state=e,this.pos=t,this.explicit=i,this.view=n,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=hr(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),n=t.text.slice(i-t.from,this.pos-t.from),s=n.search(Tw(e,!1));return s<0?null:{from:i+s,to:this.pos,text:n.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,i){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function _g(r){let e=Object.keys(r).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function $M(r){let e=Object.create(null),t=Object.create(null);for(let{label:n}of r){e[n[0]]=!0;for(let s=1;s<n.length;s++)t[n[s]]=!0}let i=_g(e)+_g(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function GM(r){let e=r.map(n=>typeof n=="string"?{label:n}:n),[t,i]=e.every(n=>/^\w+$/.test(n.label))?[/\w*$/,/\w+$/]:$M(e);return n=>{let s=n.matchBefore(i);return s||n.explicit?{from:s?s.from:n.pos,options:e,validFor:t}:null}}class Sg{constructor(e,t,i,n){this.completion=e,this.source=t,this.match=i,this.score=n}}function as(r){return r.selection.main.from}function Tw(r,e){var t;let{source:i}=r,n=e&&i[0]!="^",s=i[i.length-1]!="$";return!n&&!s?r:new RegExp(`${n?"^":""}(?:${i})${s?"$":""}`,(t=r.flags)!==null&&t!==void 0?t:r.ignoreCase?"i":"")}const Ew=hn.define();function KM(r,e,t,i){let{main:n}=r.selection,s=t-n.from,a=i-n.from;return{...r.changeByRange(o=>{if(o!=n&&t!=i&&r.sliceDoc(o.from+s,o.from+a)!=r.sliceDoc(t,i))return{range:o};let l=r.toText(e);return{changes:{from:o.from+s,to:i==n.from?o.to:o.from+a,insert:l},range:ke.cursor(o.from+s+l.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const Tg=new WeakMap;function XM(r){if(!Array.isArray(r))return r;let e=Tg.get(r);return e||Tg.set(r,e=GM(r)),e}const Xc=Xe.define(),Io=Xe.define();class qM{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let i=Or(e,t),n=Fi(i);this.chars.push(i);let s=e.slice(t,t+n),a=s.toUpperCase();this.folded.push(Or(a==s?s.toLowerCase():a,0)),t+=n}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:n,precise:s,byWord:a}=this;if(t.length==1){let y=Or(e,0),w=Fi(y),T=w==e.length?0:-100;if(y!=t[0])if(y==i[0])T+=-200;else return null;return this.ret(T,[0,w])}let o=e.indexOf(this.pattern);if(o==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=t.length,c=0;if(o<0){for(let y=0,w=Math.min(e.length,200);y<w&&c<l;){let T=Or(e,y);(T==t[c]||T==i[c])&&(n[c++]=y),y+=Fi(T)}if(c<l)return null}let f=0,h=0,u=!1,d=0,m=-1,p=-1,g=/[a-z]/.test(e),x=!0;for(let y=0,w=Math.min(e.length,200),T=0;y<w&&h<l;){let C=Or(e,y);o<0&&(f<l&&C==t[f]&&(s[f++]=y),d<l&&(C==t[d]||C==i[d]?(d==0&&(m=y),p=y+1,d++):d=0));let R,_=C<255?C>=48&&C<=57||C>=97&&C<=122?2:C>=65&&C<=90?1:0:(R=P0(C))!=R.toLowerCase()?1:R!=R.toUpperCase()?2:0;(!y||_==1&&g||T==0&&_!=0)&&(t[h]==C||i[h]==C&&(u=!0)?a[h++]=y:a.length&&(x=!1)),T=_,y+=Fi(C)}return h==l&&a[0]==0&&x?this.result(-100+(u?-200:0),a,e):d==l&&m==0?this.ret(-200-e.length+(p==e.length?0:-100),[0,p]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):d==l?this.ret(-900-e.length,[m,p]):h==l?this.result(-100+(u?-200:0)+-700+(x?0:-1100),a,e):t.length==2?null:this.result((n[0]?-700:0)+-200+-1100,n,e)}result(e,t,i){let n=[],s=0;for(let a of t){let o=a+(this.astral?Fi(Or(i,a)):1);s&&n[s-1]==a?n[s-1]=o:(n[s++]=a,n[s++]=o)}return this.ret(e-i.length,n)}}class YM{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),i=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,t.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const zt=Re.define({combine(r){return Wi(r,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:JM,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>i=>Eg(e(i),t(i)),optionClass:(e,t)=>i=>Eg(e(i),t(i)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function Eg(r,e){return r?e?r+" "+e:r:e}function JM(r,e,t,i,n,s){let a=r.textDirection==pt.RTL,o=a,l=!1,c="top",f,h,u=e.left-n.left,d=n.right-e.right,m=i.right-i.left,p=i.bottom-i.top;if(o&&u<Math.min(m,d)?o=!1:!o&&d<Math.min(m,u)&&(o=!0),m<=(o?u:d))f=Math.max(n.top,Math.min(t.top,n.bottom-p))-e.top,h=Math.min(400,o?u:d);else{l=!0,h=Math.min(400,(a?e.right:n.right-e.left)-30);let y=n.bottom-e.bottom;y>=p||y>e.top?f=t.bottom-e.top:(c="bottom",f=e.bottom-t.top)}let g=(e.bottom-e.top)/s.offsetHeight,x=(e.right-e.left)/s.offsetWidth;return{style:`${c}: ${f/g}px; max-width: ${h/x}px`,class:"cm-completionInfo-"+(l?a?"left-narrow":"right-narrow":o?"left":"right")}}function ZM(r){let e=r.addToOptions.slice();return r.icons&&e.push({render(t){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),t.type&&i.classList.add(...t.type.split(/\s+/g).map(n=>"cm-completionIcon-"+n)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(t,i,n,s){let a=document.createElement("span");a.className="cm-completionLabel";let o=t.displayLabel||t.label,l=0;for(let c=0;c<s.length;){let f=s[c++],h=s[c++];f>l&&a.appendChild(document.createTextNode(o.slice(l,f)));let u=a.appendChild(document.createElement("span"));u.appendChild(document.createTextNode(o.slice(f,h))),u.className="cm-completionMatchedText",l=h}return l<o.length&&a.appendChild(document.createTextNode(o.slice(l))),a},position:50},{render(t){if(!t.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=t.detail,i},position:80}),e.sort((t,i)=>t.position-i.position).map(t=>t.render)}function yh(r,e,t){if(r<=t)return{from:0,to:r};if(e<0&&(e=0),e<=r>>1){let n=Math.floor(e/t);return{from:n*t,to:(n+1)*t}}let i=Math.floor((r-e)/t);return{from:r-(i+1)*t,to:r-i*t}}class QM{constructor(e,t,i){this.view=e,this.stateField=t,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let n=e.state.field(t),{options:s,selected:a}=n.open,o=e.state.facet(zt);this.optionContent=ZM(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=yh(s.length,a,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=e.state.field(t).open;for(let f=l.target,h;f&&f!=this.dom;f=f.parentNode)if(f.nodeName=="LI"&&(h=/-(\d+)$/.exec(f.id))&&+h[1]<c.length){this.applyCompletion(e,c[+h[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(zt).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:Io.of(null)})}),this.showOptions(s,n.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let i=e.state.field(this.stateField),n=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=n){let{options:s,selected:a,disabled:o}=i.open;(!n.open||n.open.options!=s)&&(this.range=yh(s.length,a,e.state.facet(zt).maxRenderedOptions),this.showOptions(s,i.id)),this.updateSel(),o!=((t=n.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of t.split(" "))i&&this.dom.classList.add(i);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=yh(t.options.length,t.selected,this.view.state.facet(zt).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:i}=t.options[t.selected],{info:n}=i;if(!n)return;let s=typeof n=="string"?document.createTextNode(n):n(i);if(!s)return;"then"in s?s.then(a=>{a&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(a,i)}).catch(a=>Rr(this.view.state,a,"completion info")):this.addInfoPane(s,i)}}addInfoPane(e,t){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:n,destroy:s}=e;i.appendChild(n),this.infoDestroy=s||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,n=this.range.from;i;i=i.nextSibling,n++)i.nodeName!="LI"||!i.id?n--:n==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return t&&tI(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),n=e.getBoundingClientRect(),s=this.space;if(!s){let a=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:a.clientWidth,bottom:a.clientHeight}}return n.top>Math.min(s.bottom,t.bottom)-10||n.bottom<Math.max(s.top,t.top)+10?null:this.view.state.facet(zt).positionInfo(this.view,t,n,i,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,i){const n=document.createElement("ul");n.id=t,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions")),n.addEventListener("mousedown",a=>{a.target==n&&a.preventDefault()});let s=null;for(let a=i.from;a<i.to;a++){let{completion:o,match:l}=e[a],{section:c}=o;if(c){let u=typeof c=="string"?c:c.name;if(u!=s&&(a>i.from||i.from==0))if(s=u,typeof c!="string"&&c.header)n.appendChild(c.header(c));else{let d=n.appendChild(document.createElement("completion-section"));d.textContent=u}}const f=n.appendChild(document.createElement("li"));f.id=t+"-"+a,f.setAttribute("role","option");let h=this.optionClass(o);h&&(f.className=h);for(let u of this.optionContent){let d=u(o,this.view.state,this.view,l);d&&f.appendChild(d)}}return i.from&&n.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&n.classList.add("cm-completionListIncompleteBottom"),n}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function eI(r,e){return t=>new QM(t,r,e)}function tI(r,e){let t=r.getBoundingClientRect(),i=e.getBoundingClientRect(),n=t.height/r.offsetHeight;i.top<t.top?r.scrollTop-=(t.top-i.top)/n:i.bottom>t.bottom&&(r.scrollTop+=(i.bottom-t.bottom)/n)}function Cg(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function rI(r,e){let t=[],i=null,n=null,s=f=>{t.push(f);let{section:h}=f.completion;if(h){i||(i=[]);let u=typeof h=="string"?h:h.name;i.some(d=>d.name==u)||i.push(typeof h=="string"?{name:u}:h)}},a=e.facet(zt);for(let f of r)if(f.hasResult()){let h=f.result.getMatch;if(f.result.filter===!1)for(let u of f.result.options)s(new Sg(u,f.source,h?h(u):[],1e9-t.length));else{let u=e.sliceDoc(f.from,f.to),d,m=a.filterStrict?new YM(u):new qM(u);for(let p of f.result.options)if(d=m.match(p.label)){let g=p.displayLabel?h?h(p,d.matched):[]:d.matched,x=d.score+(p.boost||0);if(s(new Sg(p,f.source,g,x)),typeof p.section=="object"&&p.section.rank==="dynamic"){let{name:y}=p.section;n||(n=Object.create(null)),n[y]=Math.max(x,n[y]||-1e9)}}}}if(i){let f=Object.create(null),h=0,u=(d,m)=>(d.rank==="dynamic"&&m.rank==="dynamic"?n[m.name]-n[d.name]:0)||(typeof d.rank=="number"?d.rank:1e9)-(typeof m.rank=="number"?m.rank:1e9)||(d.name<m.name?-1:1);for(let d of i.sort(u))h-=1e5,f[d.name]=h;for(let d of t){let{section:m}=d.completion;m&&(d.score+=f[typeof m=="string"?m:m.name])}}let o=[],l=null,c=a.compareCompletions;for(let f of t.sort((h,u)=>u.score-h.score||c(h.completion,u.completion))){let h=f.completion;!l||l.label!=h.label||l.detail!=h.detail||l.type!=null&&h.type!=null&&l.type!=h.type||l.apply!=h.apply||l.boost!=h.boost?o.push(f):Cg(f.completion)>Cg(l)&&(o[o.length-1]=f),l=f.completion}return o}class Ps{constructor(e,t,i,n,s,a){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=n,this.selected=s,this.disabled=a}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new Ps(this.options,Ag(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,i,n,s,a){if(n&&!a&&e.some(c=>c.isPending))return n.setDisabled();let o=rI(e,t);if(!o.length)return n&&e.some(c=>c.isPending)?n.setDisabled():null;let l=t.facet(zt).selectOnOpen?0:-1;if(n&&n.selected!=l&&n.selected!=-1){let c=n.options[n.selected].completion;for(let f=0;f<o.length;f++)if(o[f].completion==c){l=f;break}}return new Ps(o,Ag(i,l),{pos:e.reduce((c,f)=>f.hasResult()?Math.min(c,f.from):c,1e8),create:lI,above:s.aboveCursor},n?n.timestamp:Date.now(),l,!1)}map(e){return new Ps(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new Ps(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class qc{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new qc(aI,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,i=t.facet(zt),s=(i.override||t.languageDataAt("autocomplete",as(t)).map(XM)).map(l=>(this.active.find(f=>f.source==l)||new Yr(l,this.active.some(f=>f.state!=0)?1:0)).update(e,i));s.length==this.active.length&&s.every((l,c)=>l==this.active[c])&&(s=this.active);let a=this.open,o=e.effects.some(l=>l.is(cd));a&&e.docChanged&&(a=a.map(e.changes)),e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!iI(s,this.active)||o?a=Ps.build(s,t,this.id,a,i,o):a&&a.disabled&&!s.some(l=>l.isPending)&&(a=null),!a&&s.every(l=>!l.isPending)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new Yr(l.source,0):l));for(let l of e.effects)l.is(Aw)&&(a=a&&a.setSelected(l.value,this.id));return s==this.active&&a==this.open?this:new qc(s,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?nI:sI}}function iI(r,e){if(r==e)return!0;for(let t=0,i=0;;){for(;t<r.length&&!r[t].hasResult();)t++;for(;i<e.length&&!e[i].hasResult();)i++;let n=t==r.length,s=i==e.length;if(n||s)return n==s;if(r[t++].result!=e[i++].result)return!1}}const nI={"aria-autocomplete":"list"},sI={};function Ag(r,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return e>-1&&(t["aria-activedescendant"]=r+"-"+e),t}const aI=[];function Cw(r,e){if(r.isUserEvent("input.complete")){let i=r.annotation(Ew);if(i&&e.activateOnCompletion(i))return 12}let t=r.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:r.isUserEvent("delete.backward")?2:r.selection?8:r.docChanged?16:0}class Yr{constructor(e,t,i=!1){this.source=e,this.state=t,this.explicit=i}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let i=Cw(e,t),n=this;(i&8||i&16&&this.touches(e))&&(n=new Yr(n.source,0)),i&4&&n.state==0&&(n=new Yr(this.source,1)),n=n.updateFor(e,i);for(let s of e.effects)if(s.is(Xc))n=new Yr(n.source,1,s.value);else if(s.is(Io))n=new Yr(n.source,0);else if(s.is(cd))for(let a of s.value)a.source==n.source&&(n=a);return n}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(as(e.state))}}class qs extends Yr{constructor(e,t,i,n,s,a){super(e,3,t),this.limit=i,this.result=n,this.from=s,this.to=a}hasResult(){return!0}updateFor(e,t){var i;if(!(t&3))return this.map(e.changes);let n=this.result;n.map&&!e.changes.empty&&(n=n.map(n,e.changes));let s=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),o=as(e.state);if(o>a||!n||t&2&&(as(e.startState)==this.from||o<this.limit))return new Yr(this.source,t&4?1:0);let l=e.changes.mapPos(this.limit);return oI(n.validFor,e.state,s,a)?new qs(this.source,this.explicit,l,n,s,a):n.update&&(n=n.update(n,s,a,new Sw(e.state,o,!1)))?new qs(this.source,this.explicit,l,n,n.from,(i=n.to)!==null&&i!==void 0?i:as(e.state)):new Yr(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new qs(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new Yr(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function oI(r,e,t,i){if(!r)return!1;let n=e.sliceDoc(t,i);return typeof r=="function"?r(n,t,i,e):Tw(r,!0).test(n)}const cd=Xe.define({map(r,e){return r.map(t=>t.map(e))}}),Aw=Xe.define(),Dr=Yt.define({create(){return qc.start()},update(r,e){return r.update(e)},provide:r=>[q0.from(r,e=>e.tooltip),Oe.contentAttributes.from(r,e=>e.attrs)]});function fd(r,e){const t=e.completion.apply||e.completion.label;let i=r.state.field(Dr).active.find(n=>n.source==e.source);return i instanceof qs?(typeof t=="string"?r.dispatch({...KM(r.state,t,i.from,i.to),annotations:Ew.of(e.completion)}):t(r,e.completion,i.from,i.to),!0):!1}const lI=eI(Dr,fd);function Hl(r,e="option"){return t=>{let i=t.state.field(Dr,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<t.state.facet(zt).interactionDelay)return!1;let n=1,s;e=="page"&&(s=ly(t,i.open.tooltip))&&(n=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:a}=i.open.options,o=i.open.selected>-1?i.open.selected+n*(r?1:-1):r?0:a-1;return o<0?o=e=="page"?0:a-1:o>=a&&(o=e=="page"?a-1:0),t.dispatch({effects:Aw.of(o)}),!0}}const cI=r=>{let e=r.state.field(Dr,!1);return r.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<r.state.facet(zt).interactionDelay?!1:fd(r,e.open.options[e.open.selected])},wh=r=>r.state.field(Dr,!1)?(r.dispatch({effects:Xc.of(!0)}),!0):!1,fI=r=>{let e=r.state.field(Dr,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(r.dispatch({effects:Io.of(null)}),!0)};class hI{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const uI=50,dI=1e3,pI=St.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of r.state.field(Dr).active)e.isPending&&this.startQuery(e)}update(r){let e=r.state.field(Dr),t=r.state.facet(zt);if(!r.selectionSet&&!r.docChanged&&r.startState.field(Dr)==e)return;let i=r.transactions.some(s=>{let a=Cw(s,t);return a&8||(s.selection||s.docChanged)&&!(a&3)});for(let s=0;s<this.running.length;s++){let a=this.running[s];if(i||a.context.abortOnDocChange&&r.docChanged||a.updates.length+r.transactions.length>uI&&Date.now()-a.time>dI){for(let o of a.context.abortListeners)try{o()}catch(l){Rr(this.view.state,l)}a.context.abortListeners=null,this.running.splice(s--,1)}else a.updates.push(...r.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),r.transactions.some(s=>s.effects.some(a=>a.is(Xc)))&&(this.pendingStart=!0);let n=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(a=>a.active.source==s.source))?setTimeout(()=>this.startUpdate(),n):-1,this.composing!=0)for(let s of r.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:r}=this.view,e=r.field(Dr);for(let t of e.active)t.isPending&&!this.running.some(i=>i.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(zt).updateSyncTime))}startQuery(r){let{state:e}=this.view,t=as(e),i=new Sw(e,t,r.explicit,this.view),n=new hI(r,i);this.running.push(n),Promise.resolve(r.source(i)).then(s=>{n.context.aborted||(n.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:Io.of(null)}),Rr(this.view.state,s)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(zt).updateSyncTime))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(zt),i=this.view.state.field(Dr);for(let n=0;n<this.running.length;n++){let s=this.running[n];if(s.done===void 0)continue;if(this.running.splice(n--,1),s.done){let o=as(s.updates.length?s.updates[0].startState:this.view.state),l=Math.min(o,s.done.from+(s.active.explicit?0:1)),c=new qs(s.active.source,s.active.explicit,l,s.done,s.done.from,(r=s.done.to)!==null&&r!==void 0?r:o);for(let f of s.updates)c=c.update(f,t);if(c.hasResult()){e.push(c);continue}}let a=i.active.find(o=>o.source==s.active.source);if(a&&a.isPending)if(s.done==null){let o=new Yr(s.active.source,0);for(let l of s.updates)o=o.update(l,t);o.isPending||e.push(o)}else this.startQuery(a)}(e.length||i.open&&i.open.disabled)&&this.view.dispatch({effects:cd.of(e)})}},{eventHandlers:{blur(r){let e=this.view.state.field(Dr,!1);if(e&&e.tooltip&&this.view.state.facet(zt).closeOnBlur){let t=e.open&&ly(this.view,e.open.tooltip);(!t||!t.dom.contains(r.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Io.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Xc.of(!1)}),20),this.composing=0}}}),mI=typeof navigator=="object"&&/Win/.test(navigator.platform),gI=bs.highest(Oe.domEventHandlers({keydown(r,e){let t=e.state.field(Dr,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||r.key.length>1||r.ctrlKey&&!(mI&&r.altKey)||r.metaKey)return!1;let i=t.open.options[t.open.selected],n=t.active.find(a=>a.source==i.source),s=i.completion.commitCharacters||n.result.commitCharacters;return s&&s.indexOf(r.key)>-1&&fd(e,i),!1}})),xI=Oe.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Po={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},ts=Xe.define({map(r,e){let t=e.mapPos(r,-1,yr.TrackAfter);return t??void 0}}),hd=new class extends fs{};hd.startSide=1;hd.endSide=-1;const Ow=Yt.define({create(){return tt.empty},update(r,e){if(r=r.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);r=r.update({filter:i=>i>=t.from&&i<=t.to})}for(let t of e.effects)t.is(ts)&&(r=r.update({add:[hd.range(t.value,t.value+1)]}));return r}});function vI(){return[wI,Ow]}const kh="()[]{}<>";function Fw(r){for(let e=0;e<kh.length;e+=2)if(kh.charCodeAt(e)==r)return kh.charAt(e+1);return P0(r<128?r:r+1)}function Dw(r,e){return r.languageDataAt("closeBrackets",e)[0]||Po}const yI=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),wI=Oe.inputHandler.of((r,e,t,i)=>{if((yI?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let n=r.state.selection.main;if(i.length>2||i.length==2&&Fi(Or(i,0))==1||e!=n.from||t!=n.to)return!1;let s=_I(r.state,i);return s?(r.dispatch(s),!0):!1}),kI=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let i=Dw(r,r.selection.main.head).brackets||Po.brackets,n=null,s=r.changeByRange(a=>{if(a.empty){let o=SI(r.doc,a.head);for(let l of i)if(l==o&&Ef(r.doc,a.head)==Fw(Or(l,0)))return{changes:{from:a.head-l.length,to:a.head+l.length},range:ke.cursor(a.head-l.length)}}return{range:n=a}});return n||e(r.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!n},bI=[{key:"Backspace",run:kI}];function _I(r,e){let t=Dw(r,r.selection.main.head),i=t.brackets||Po.brackets;for(let n of i){let s=Fw(Or(n,0));if(e==n)return s==n?CI(r,n,i.indexOf(n+n+n)>-1,t):TI(r,n,s,t.before||Po.before);if(e==s&&Rw(r,r.selection.main.from))return EI(r,n,s)}return null}function Rw(r,e){let t=!1;return r.field(Ow).between(0,r.doc.length,i=>{i==e&&(t=!0)}),t}function Ef(r,e){let t=r.sliceString(e,e+2);return t.slice(0,Fi(Or(t,0)))}function SI(r,e){let t=r.sliceString(e-2,e);return Fi(Or(t,0))==t.length?t:t.slice(1)}function TI(r,e,t,i){let n=null,s=r.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:t,from:a.to}],effects:ts.of(a.to+e.length),range:ke.range(a.anchor+e.length,a.head+e.length)};let o=Ef(r.doc,a.head);return!o||/\s/.test(o)||i.indexOf(o)>-1?{changes:{insert:e+t,from:a.head},effects:ts.of(a.head+e.length),range:ke.cursor(a.head+e.length)}:{range:n=a}});return n?null:r.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function EI(r,e,t){let i=null,n=r.changeByRange(s=>s.empty&&Ef(r.doc,s.head)==t?{changes:{from:s.head,to:s.head+t.length,insert:t},range:ke.cursor(s.head+t.length)}:i={range:s});return i?null:r.update(n,{scrollIntoView:!0,userEvent:"input.type"})}function CI(r,e,t,i){let n=i.stringPrefixes||Po.stringPrefixes,s=null,a=r.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:e,from:o.to}],effects:ts.of(o.to+e.length),range:ke.range(o.anchor+e.length,o.head+e.length)};let l=o.head,c=Ef(r.doc,l),f;if(c==e){if(Og(r,l))return{changes:{insert:e+e,from:l},effects:ts.of(l+e.length),range:ke.cursor(l+e.length)};if(Rw(r,l)){let u=t&&r.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+u.length,insert:u},range:ke.cursor(l+u.length)}}}else{if(t&&r.sliceDoc(l-2*e.length,l)==e+e&&(f=Fg(r,l-2*e.length,n))>-1&&Og(r,f))return{changes:{insert:e+e+e+e,from:l},effects:ts.of(l+e.length),range:ke.cursor(l+e.length)};if(r.charCategorizer(l)(c)!=gt.Word&&Fg(r,l,n)>-1&&!AI(r,l,e,n))return{changes:{insert:e+e,from:l},effects:ts.of(l+e.length),range:ke.cursor(l+e.length)}}return{range:s=o}});return s?null:r.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function Og(r,e){let t=hr(r).resolveInner(e+1);return t.parent&&t.from==e}function AI(r,e,t,i){let n=hr(r).resolveInner(e,-1),s=i.reduce((a,o)=>Math.max(a,o.length),0);for(let a=0;a<5;a++){let o=r.sliceDoc(n.from,Math.min(n.to,n.from+t.length+s)),l=o.indexOf(t);if(!l||l>-1&&i.indexOf(o.slice(0,l))>-1){let f=n.firstChild;for(;f&&f.from==n.from&&f.to-f.from>t.length+l;){if(r.sliceDoc(f.to-t.length,f.to)==t)return!1;f=f.firstChild}return!0}let c=n.to==e&&n.parent;if(!c)break;n=c}return!1}function Fg(r,e,t){let i=r.charCategorizer(e);if(i(r.sliceDoc(e-1,e))!=gt.Word)return e;for(let n of t){let s=e-n.length;if(r.sliceDoc(s,e)==n&&i(r.sliceDoc(s-1,s))!=gt.Word)return s}return-1}function OI(r={}){return[gI,Dr,zt.of(r),pI,FI,xI]}const Mw=[{key:"Ctrl-Space",run:wh},{mac:"Alt-`",run:wh},{mac:"Alt-i",run:wh},{key:"Escape",run:fI},{key:"ArrowDown",run:Hl(!0)},{key:"ArrowUp",run:Hl(!1)},{key:"PageDown",run:Hl(!0,"page")},{key:"PageUp",run:Hl(!1,"page")},{key:"Enter",run:cI}],FI=bs.highest(xf.computeN([zt],r=>r.facet(zt).defaultKeymap?[Mw]:[]));class Dg{constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class Jn{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let n=i.facet(Lo).markerFilter;n&&(e=n(e,i));let s=e.slice().sort((f,h)=>f.from-h.from||f.to-h.to),a=new an,o=[],l=0;for(let f=0;;){let h=f==s.length?null:s[f];if(!h&&!o.length)break;let u,d;for(o.length?(u=l,d=o.reduce((p,g)=>Math.min(p,g.to),h&&h.from>u?h.from:1e8)):(u=h.from,d=h.to,o.push(h),f++);f<s.length;){let p=s[f];if(p.from==u&&(p.to>p.from||p.to==u))o.push(p),f++,d=Math.min(p.to,d);else{d=Math.min(p.from,d);break}}let m=VI(o);if(o.some(p=>p.from==p.to||p.from==p.to-1&&i.doc.lineAt(p.from).to==p.from))a.add(u,u,Be.widget({widget:new UI(m),diagnostics:o.slice()}));else{let p=o.reduce((g,x)=>x.markClass?g+" "+x.markClass:g,"");a.add(u,d,Be.mark({class:"cm-lintRange cm-lintRange-"+m+p,diagnostics:o.slice(),inclusiveEnd:o.some(g=>g.to>d)}))}l=d;for(let p=0;p<o.length;p++)o[p].to<=l&&o.splice(p--,1)}let c=a.finish();return new Jn(c,t,la(c))}}function la(r,e=null,t=0){let i=null;return r.between(t,1e9,(n,s,{spec:a})=>{if(!(e&&a.diagnostics.indexOf(e)<0))if(!i)i=new Dg(n,s,e||a.diagnostics[0]);else{if(a.diagnostics.indexOf(i.diagnostic)<0)return!1;i=new Dg(i.from,s,i.diagnostic)}}),i}function DI(r,e){let t=e.pos,i=e.end||t,n=r.state.facet(Lo).hideOn(r,t,i);if(n!=null)return n;let s=r.startState.doc.lineAt(e.pos);return!!(r.effects.some(a=>a.is(Iw))||r.changes.touchesRange(s.from,Math.max(s.to,i)))}function RI(r,e){return r.field(Vr,!1)?e:e.concat(Xe.appendConfig.of(jI))}const Iw=Xe.define(),ud=Xe.define(),Pw=Xe.define(),Vr=Yt.define({create(){return new Jn(Be.none,null,null)},update(r,e){if(e.docChanged&&r.diagnostics.size){let t=r.diagnostics.map(e.changes),i=null,n=r.panel;if(r.selected){let s=e.changes.mapPos(r.selected.from,1);i=la(t,r.selected.diagnostic,s)||la(t,null,s)}!t.size&&n&&e.state.facet(Lo).autoPanel&&(n=null),r=new Jn(t,n,i)}for(let t of e.effects)if(t.is(Iw)){let i=e.state.facet(Lo).autoPanel?t.value.length?Bo.open:null:r.panel;r=Jn.init(t.value,i,e.state)}else t.is(ud)?r=new Jn(r.diagnostics,t.value?Bo.open:null,r.selected):t.is(Pw)&&(r=new Jn(r.diagnostics,r.panel,t.value));return r},provide:r=>[Fo.from(r,e=>e.panel),Oe.decorations.from(r,e=>e.diagnostics)]}),MI=Be.mark({class:"cm-lintRange cm-lintRange-active"});function II(r,e,t){let{diagnostics:i}=r.state.field(Vr),n,s=-1,a=-1;i.between(e-(t<0?1:0),e+(t>0?1:0),(l,c,{spec:f})=>{if(e>=l&&e<=c&&(l==c||(e>l||t>0)&&(e<c||t<0)))return n=f.diagnostics,s=l,a=c,!1});let o=r.state.facet(Lo).tooltipFilter;return n&&o&&(n=o(n,r.state)),n?{pos:s,end:a,above:r.state.doc.lineAt(s).to<a,create(){return{dom:PI(r,n)}}}:null}function PI(r,e){return at("ul",{class:"cm-tooltip-lint"},e.map(t=>Bw(r,t,!1)))}const LI=r=>{let e=r.state.field(Vr,!1);(!e||!e.panel)&&r.dispatch({effects:RI(r.state,[ud.of(!0)])});let t=Oo(r,Bo.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},Rg=r=>{let e=r.state.field(Vr,!1);return!e||!e.panel?!1:(r.dispatch({effects:ud.of(!1)}),!0)},BI=r=>{let e=r.state.field(Vr,!1);if(!e)return!1;let t=r.state.selection.main,i=e.diagnostics.iter(t.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==t.from&&i.to==t.to)?!1:(r.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},NI=[{key:"Mod-Shift-m",run:LI,preventDefault:!0},{key:"F8",run:BI}],Lo=Re.define({combine(r){return{sources:r.map(e=>e.source).filter(e=>e!=null),...Wi(r.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:Mg,tooltipFilter:Mg,needsRefresh:(e,t)=>e?t?i=>e(i)||t(i):e:t,hideOn:(e,t)=>e?t?(i,n,s)=>e(i,n,s)||t(i,n,s):e:t,autoPanel:(e,t)=>e||t})}}});function Mg(r,e){return r?e?(t,i)=>e(r(t,i),i):r:e}function Lw(r){let e=[];if(r)e:for(let{name:t}of r){for(let i=0;i<t.length;i++){let n=t[i];if(/[a-zA-Z]/.test(n)&&!e.some(s=>s.toLowerCase()==n.toLowerCase())){e.push(n);continue e}}e.push("")}return e}function Bw(r,e,t){var i;let n=t?Lw(e.actions):[];return at("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},at("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(r):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((s,a)=>{let o=!1,l=d=>{if(d.preventDefault(),o)return;o=!0;let m=la(r.state.field(Vr).diagnostics,e);m&&s.apply(r,m.from,m.to)},{name:c}=s,f=n[a]?c.indexOf(n[a]):-1,h=f<0?c:[c.slice(0,f),at("u",c.slice(f,f+1)),c.slice(f+1)],u=s.markClass?" "+s.markClass:"";return at("button",{type:"button",class:"cm-diagnosticAction"+u,onclick:l,onmousedown:l,"aria-label":` Action: ${c}${f<0?"":` (access key "${n[a]})"`}.`},h)}),e.source&&at("div",{class:"cm-diagnosticSource"},e.source))}class UI extends un{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return at("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class Ig{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Bw(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Bo{constructor(e){this.view=e,this.items=[];let t=n=>{if(n.keyCode==27)Rg(this.view),this.view.focus();else if(n.keyCode==38||n.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(n.keyCode==40||n.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(n.keyCode==36)this.moveSelection(0);else if(n.keyCode==35)this.moveSelection(this.items.length-1);else if(n.keyCode==13)this.view.focus();else if(n.keyCode>=65&&n.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],a=Lw(s.actions);for(let o=0;o<a.length;o++)if(a[o].toUpperCase().charCodeAt(0)==n.keyCode){let l=la(this.view.state.field(Vr).diagnostics,s);l&&s.actions[o].apply(e,l.from,l.to)}}else return;n.preventDefault()},i=n=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(n.target)&&this.moveSelection(s)};this.list=at("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i}),this.dom=at("div",{class:"cm-panel-lint"},this.list,at("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Rg(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(Vr).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Vr),i=0,n=!1,s=null,a=new Set;for(e.between(0,this.view.state.doc.length,(o,l,{spec:c})=>{for(let f of c.diagnostics){if(a.has(f))continue;a.add(f);let h=-1,u;for(let d=i;d<this.items.length;d++)if(this.items[d].diagnostic==f){h=d;break}h<0?(u=new Ig(this.view,f),this.items.splice(i,0,u),n=!0):(u=this.items[h],h>i&&(this.items.splice(i,h-i),n=!0)),t&&u.diagnostic==t.diagnostic?u.dom.hasAttribute("aria-selected")||(u.dom.setAttribute("aria-selected","true"),s=u):u.dom.hasAttribute("aria-selected")&&u.dom.removeAttribute("aria-selected"),i++}});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();this.items.length==0&&(this.items.push(new Ig(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{let c=l.height/this.list.offsetHeight;o.top<l.top?this.list.scrollTop-=(l.top-o.top)/c:o.bottom>l.bottom&&(this.list.scrollTop+=(o.bottom-l.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let e=this.list.firstChild;function t(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Vr),i=la(t.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:Pw.of(i)})}static open(e){return new Bo(e)}}function HI(r,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(r)}</svg>')`}function zl(r){return HI(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const zI=Oe.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:zl("#d11")},".cm-lintRange-warning":{backgroundImage:zl("orange")},".cm-lintRange-info":{backgroundImage:zl("#999")},".cm-lintRange-hint":{backgroundImage:zl("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function WI(r){return r=="error"?4:r=="warning"?3:r=="info"?2:1}function VI(r){let e="hint",t=1;for(let i of r){let n=WI(i.severity);n>t&&(t=n,e=i.severity)}return e}const jI=[Vr,Oe.decorations.compute([Vr],r=>{let{selected:e,panel:t}=r.field(Vr);return!e||!t||e.from==e.to?Be.none:Be.set([MI.range(e.from,e.to)])}),LR(II,{hideOn:DI}),zI],$I=[KR(),YR(),hR(),d5(),H6(),eR(),sR(),Je.allowMultipleSelections.of(!0),E6(),Ry(j6,{fallback:!0}),J6(),vI(),OI(),TR(),AR(),xR(),bM(),xf.of([...bI,...mM,...zM,...b5,...L6,...Mw,...NI])];/*!
* VueCodemirror v6.1.1
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon
*/var GI=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[$I]}),KI=Symbol("vue-codemirror-global-config"),vr,XI=function(r){var e=r.onUpdate,t=r.onChange,i=r.onFocus,n=r.onBlur,s=function(a,o){var l={};for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&o.indexOf(c)<0&&(l[c]=a[c]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function"){var f=0;for(c=Object.getOwnPropertySymbols(a);f<c.length;f++)o.indexOf(c[f])<0&&Object.prototype.propertyIsEnumerable.call(a,c[f])&&(l[c[f]]=a[c[f]])}return l}(r,["onUpdate","onChange","onFocus","onBlur"]);return Je.create({doc:s.doc,selection:s.selection,extensions:(Array.isArray(s.extensions)?s.extensions:[s.extensions]).concat([Oe.updateListener.of(function(a){e(a),a.docChanged&&t(a.state.doc.toString(),a),a.focusChanged&&(a.view.hasFocus?i(a):n(a))})])})},Fs=function(r){var e=new Xo;return{compartment:e,run:function(t){e.get(r.state)?r.dispatch({effects:e.reconfigure(t)}):r.dispatch({effects:Xe.appendConfig.of(e.of(t))})}}},Pg=function(r,e){var t=Fs(r),i=t.compartment,n=t.run;return function(s){var a=i.get(r.state);n(s??a!==e?e:[])}},Wl={type:Boolean,default:void 0},qI={autofocus:Wl,disabled:Wl,indentWithTab:Wl,tabSize:Number,placeholder:String,style:Object,autoDestroy:Wl,phrases:Object,root:Object,extensions:Array,selection:Object},YI={modelValue:{type:String,default:""}},JI=Object.assign(Object.assign({},qI),YI);(function(r){r.Change="change",r.Update="update",r.Focus="focus",r.Blur="blur",r.Ready="ready",r.ModelUpdate="update:modelValue"})(vr||(vr={}));var Zn={};Zn[vr.Change]=function(r,e){return!0},Zn[vr.Update]=function(r){return!0},Zn[vr.Focus]=function(r){return!0},Zn[vr.Blur]=function(r){return!0},Zn[vr.Ready]=function(r){return!0};var Nw={};Nw[vr.ModelUpdate]=Zn[vr.Change];var ZI=Object.assign(Object.assign({},Zn),Nw),QI=_1({name:"VueCodemirror",props:Object.assign({},JI),emits:Object.assign({},ZI),setup:function(r,e){var t=If(),i=If(),n=If(),s=Object.assign(Object.assign({},GI),Va(KI,{})),a=Z1(function(){var o={};return Object.keys(nt(r)).forEach(function(l){var c;l!=="modelValue"&&(o[l]=(c=r[l])!==null&&c!==void 0?c:s[l])}),o});return C1(function(){var o;i.value=XI({doc:r.modelValue,selection:a.value.selection,extensions:(o=s.extensions)!==null&&o!==void 0?o:[],onFocus:function(c){return e.emit(vr.Focus,c)},onBlur:function(c){return e.emit(vr.Blur,c)},onUpdate:function(c){return e.emit(vr.Update,c)},onChange:function(c,f){c!==r.modelValue&&(e.emit(vr.Change,c,f),e.emit(vr.ModelUpdate,c,f))}}),n.value=function(c){return new Oe(Object.assign({},c))}({state:i.value,parent:t.value,root:a.value.root});var l=function(c){var f=function(){return c.state.doc.toString()},h=Fs(c).run,u=Pg(c,[Oe.editable.of(!1),Je.readOnly.of(!0)]),d=Pg(c,xf.of([gM])),m=Fs(c).run,p=Fs(c).run,g=Fs(c).run,x=Fs(c).run;return{focus:function(){return c.focus()},getDoc:f,setDoc:function(y){y!==f()&&c.dispatch({changes:{from:0,to:c.state.doc.length,insert:y}})},reExtensions:h,toggleDisabled:u,toggleIndentWithTab:d,setTabSize:function(y){m([Je.tabSize.of(y),yf.of(" ".repeat(y))])},setPhrases:function(y){p([Je.phrases.of(y)])},setPlaceholder:function(y){g(kR(y))},setStyle:function(y){y===void 0&&(y={}),x(Oe.theme({"&":Object.assign({},y)}))}}}(n.value);oi(function(){return r.modelValue},function(c){c!==l.getDoc()&&l.setDoc(c)}),oi(function(){return r.extensions},function(c){return l.reExtensions(c||[])},{immediate:!0}),oi(function(){return a.value.disabled},function(c){return l.toggleDisabled(c)},{immediate:!0}),oi(function(){return a.value.indentWithTab},function(c){return l.toggleIndentWithTab(c)},{immediate:!0}),oi(function(){return a.value.tabSize},function(c){return l.setTabSize(c)},{immediate:!0}),oi(function(){return a.value.phrases},function(c){return l.setPhrases(c||{})},{immediate:!0}),oi(function(){return a.value.placeholder},function(c){return l.setPlaceholder(c)},{immediate:!0}),oi(function(){return a.value.style},function(c){return l.setStyle(c)},{immediate:!0}),a.value.autofocus&&l.focus(),e.emit(vr.Ready,{state:i.value,view:n.value,container:t.value})}),A1(function(){a.value.autoDestroy&&n.value&&function(o){o.destroy()}(n.value)}),function(){return qb("div",{class:"v-codemirror",style:{display:"contents"},ref:t})}}}),eP=QI,Lg={};class Yc{constructor(e,t,i,n,s,a,o,l,c,f=0,h){this.p=e,this.stack=t,this.state=i,this.reducePos=n,this.pos=s,this.score=a,this.buffer=o,this.bufferBase=l,this.curContext=c,this.lookAhead=f,this.parent=h}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,i=0){let n=e.parser.context;return new Yc(e,[],t,i,i,0,[],0,n?new Bg(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let i=e>>19,n=e&65535,{parser:s}=this.p,a=this.reducePos<this.pos-25;a&&this.setLookAhead(this.pos);let o=s.dynamicPrecedence(n);if(o&&(this.score+=o),i==0){this.pushState(s.getGoto(this.state,n,!0),this.reducePos),n<s.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,a?8:4,!0),this.reduceContext(n,this.reducePos);return}let l=this.stack.length-(i-1)*3-(e&262144?6:0),c=l?this.stack[l-2]:this.p.ranges[0].from,f=this.reducePos-c;f>=2e3&&!(!((t=this.p.parser.nodeSet.types[n])===null||t===void 0)&&t.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=f):this.p.lastBigReductionSize<f&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=f));let h=l?this.stack[l-1]:0,u=this.bufferBase+this.buffer.length-h;if(n<s.minRepeatTerm||e&131072){let d=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,c,d,u+4,!0)}if(e&262144)this.state=this.stack[l];else{let d=this.stack[l-3];this.state=s.getGoto(d,n,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(n,c)}storeNode(e,t,i,n=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let a=this,o=this.buffer.length;if(o==0&&a.parent&&(o=a.bufferBase-a.parent.bufferBase,a=a.parent),o>0&&a.buffer[o-4]==0&&a.buffer[o-1]>-1){if(t==i)return;if(a.buffer[o-2]>=t){a.buffer[o-2]=i;return}}}if(!s||this.pos==i)this.buffer.push(e,t,i,n);else{let a=this.buffer.length;if(a>0&&this.buffer[a-4]!=0){let o=!1;for(let l=a;l>0&&this.buffer[l-2]>i;l-=4)if(this.buffer[l-1]>=0){o=!0;break}if(o)for(;a>0&&this.buffer[a-2]>i;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,n>4&&(n-=4)}this.buffer[a]=e,this.buffer[a+1]=t,this.buffer[a+2]=i,this.buffer[a+3]=n}}shift(e,t,i,n){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=n,this.shiftContext(t,i),t<=this.p.parser.maxNode&&this.buffer.push(t,i,n,4);else{let s=e,{parser:a}=this.p;(n>this.pos||t<=a.maxNode)&&(this.pos=n,a.stateFlag(s,1)||(this.reducePos=n)),this.pushState(s,i),this.shiftContext(t,i),t<=a.maxNode&&this.buffer.push(t,i,n,4)}}apply(e,t,i,n){e&65536?this.reduce(e):this.shift(e,t,i,n)}useNode(e,t){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=e)&&(this.p.reused.push(e),i++);let n=this.pos;this.reducePos=this.pos=n+e.length,this.pushState(t,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let i=e.buffer.slice(t),n=e.bufferBase+t;for(;e&&n==e.bufferBase;)e=e.parent;return new Yc(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let i=e<=this.p.parser.maxNode;i&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,i?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new tP(this);;){let i=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(i==0)return!1;if(!(i&65536))return!0;t.reduce(i)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let n=[];for(let s=0,a;s<t.length;s+=2)(a=t[s+1])!=this.state&&this.p.parser.hasAction(a,e)&&n.push(t[s],a);if(this.stack.length<120)for(let s=0;n.length<8&&s<t.length;s+=2){let a=t[s+1];n.some((o,l)=>l&1&&o==a)||n.push(t[s],a)}t=n}let i=[];for(let n=0;n<t.length&&i.length<4;n+=2){let s=t[n+1];if(s==this.state)continue;let a=this.split();a.pushState(s,this.pos),a.storeNode(0,a.pos,a.pos,4,!0),a.shiftContext(t[n],this.pos),a.reducePos=this.pos,a.score-=200,i.push(a)}return i}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(t&65536))return!1;if(!e.validAction(this.state,t)){let i=t>>19,n=t&65535,s=this.stack.length-i*3;if(s<0||e.getGoto(this.stack[s],n,!1)<0){let a=this.findForcedReduction();if(a==null)return!1;t=a}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],i=(n,s)=>{if(!t.includes(n))return t.push(n),e.allActions(n,a=>{if(!(a&393216))if(a&65536){let o=(a>>19)-s;if(o>1){let l=a&65535,c=this.stack.length-o*3;if(c>=0&&e.getGoto(this.stack[c],l,!1)>=0)return o<<19|65536|l}}else{let o=i(a,s+1);if(o!=null)return o}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new Bg(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Bg{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class tP{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,i=e>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let n=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=n}}class Jc{constructor(e,t,i){this.stack=e,this.pos=t,this.index=i,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Jc(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Jc(this.stack,this.pos,this.index)}}function Vl(r,e=Uint16Array){if(typeof r!="string")return r;let t=null;for(let i=0,n=0;i<r.length;){let s=0;for(;;){let a=r.charCodeAt(i++),o=!1;if(a==126){s=65535;break}a>=92&&a--,a>=34&&a--;let l=a-32;if(l>=46&&(l-=46,o=!0),s+=l,o)break;s*=46}t?t[n++]=s:t=new e(s)}return t}class ic{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const Ng=new ic;class rP{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Ng,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let i=this.range,n=this.rangeIndex,s=this.pos+e;for(;s<i.from;){if(!n)return null;let a=this.ranges[--n];s-=i.from-a.to,i=a}for(;t<0?s>i.to:s>=i.to;){if(n==this.ranges.length-1)return null;let a=this.ranges[++n];s+=a.from-i.to,i=a}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,i,n;if(t>=0&&t<this.chunk.length)i=this.pos+e,n=this.chunk.charCodeAt(t);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(i=s,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let a=this.rangeIndex,o=this.range;for(;o.to<=i;)o=this.ranges[++a];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>o.to&&(this.chunk2=this.chunk2.slice(0,o.to-i)),n=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),n}acceptToken(e,t=0){let i=t?this.resolveOffset(t,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=i}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=Ng,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let i="";for(let n of this.ranges){if(n.from>=t)break;n.to>e&&(i+=this.input.read(Math.max(n.from,e),Math.min(n.to,t)))}return i}}class Ys{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:i}=t.p;iP(this.data,e,t,this.id,i.data,i.tokenPrecTable)}}Ys.prototype.contextual=Ys.prototype.fallback=Ys.prototype.extend=!1;Ys.prototype.fallback=Ys.prototype.extend=!1;function iP(r,e,t,i,n,s){let a=0,o=1<<i,{dialect:l}=t.p.parser;e:for(;o&r[a];){let c=r[a+1];for(let d=a+3;d<c;d+=2)if((r[d+1]&o)>0){let m=r[d];if(l.allows(m)&&(e.token.value==-1||e.token.value==m||nP(m,e.token.value,n,s))){e.acceptToken(m);break}}let f=e.next,h=0,u=r[a+2];if(e.next<0&&u>h&&r[c+u*3-3]==65535){a=r[c+u*3-1];continue e}for(;h<u;){let d=h+u>>1,m=c+d+(d<<1),p=r[m],g=r[m+1]||65536;if(f<p)u=d;else if(f>=g)h=d+1;else{a=r[m+2],e.advance();continue e}}break}}function Ug(r,e,t){for(let i=e,n;(n=r[i])!=65535;i++)if(n==t)return i-e;return-1}function nP(r,e,t,i){let n=Ug(t,i,e);return n<0||Ug(t,i,r)<n}const Lr=typeof process<"u"&&Lg&&/\bparse\b/.test(Lg.LOG);let bh=null;function Hg(r,e,t){let i=r.cursor(Ht.IncludeAnonymous);for(i.moveTo(e);;)if(!(t<0?i.childBefore(e):i.childAfter(e)))for(;;){if((t<0?i.to<e:i.from>e)&&!i.type.isError)return t<0?Math.max(0,Math.min(i.to-1,e-25)):Math.min(r.length,Math.max(i.from+1,e+25));if(t<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return t<0?0:r.length}}class sP{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?Hg(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?Hg(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let i=this.trees[t],n=this.index[t];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=i.children[n],a=this.start[t]+i.positions[n];if(a>e)return this.nextStart=a,null;if(s instanceof Ft){if(a==e){if(a<this.safeFrom)return null;let o=a+s.length;if(o<=this.safeTo){let l=s.prop(Ye.lookAhead);if(!l||o+l<this.fragment.to)return s}}this.index[t]++,a+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(a),this.index.push(0))}else this.index[t]++,this.nextStart=a+s.length}}}class aP{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(i=>new ic)}getActions(e){let t=0,i=null,{parser:n}=e.p,{tokenizers:s}=n,a=n.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,l=0;for(let c=0;c<s.length;c++){if(!(1<<c&a))continue;let f=s[c],h=this.tokens[c];if(!(i&&!f.fallback)&&((f.contextual||h.start!=e.pos||h.mask!=a||h.context!=o)&&(this.updateCachedToken(h,f,e),h.mask=a,h.context=o),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),h.value!=0)){let u=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!f.extend&&(i=h,t>u))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!i&&e.pos==this.stream.end&&(i=new ic,i.value=e.p.parser.eofTerm,i.start=i.end=e.pos,t=this.addActions(e,i.value,i.end,t)),this.mainToken=i,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new ic,{pos:i,p:n}=e;return t.start=i,t.end=Math.min(i+1,n.stream.end),t.value=i==n.stream.end?n.parser.eofTerm:0,t}updateCachedToken(e,t,i){let n=this.stream.clipPos(i.pos);if(t.token(this.stream.reset(n,e),i),e.value>-1){let{parser:s}=i.p;for(let a=0;a<s.specialized.length;a++)if(s.specialized[a]==e.value){let o=s.specializers[a](this.stream.read(e.start,e.end),i);if(o>=0&&i.p.parser.dialect.allows(o>>1)){o&1?e.extended=o>>1:e.value=o>>1;break}}}else e.value=0,e.end=this.stream.clipPos(n+1)}putAction(e,t,i,n){for(let s=0;s<n;s+=3)if(this.actions[s]==e)return n;return this.actions[n++]=e,this.actions[n++]=t,this.actions[n++]=i,n}addActions(e,t,i,n){let{state:s}=e,{parser:a}=e.p,{data:o}=a;for(let l=0;l<2;l++)for(let c=a.stateSlot(s,l?2:1);;c+=3){if(o[c]==65535)if(o[c+1]==1)c=Ki(o,c+2);else{n==0&&o[c+1]==2&&(n=this.putAction(Ki(o,c+2),t,i,n));break}o[c]==t&&(n=this.putAction(Ki(o,c+1),t,i,n))}return n}}class oP{constructor(e,t,i,n){this.parser=e,this.input=t,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new rP(t,n),this.tokens=new aP(e,this.stream),this.topTerm=e.top[1];let{from:s}=n[0];this.stacks=[Yc.start(this,e.top[0],s)],this.fragments=i.length&&this.stream.end-s>e.bufferLength*4?new sP(i,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,i=this.stacks=[],n,s;if(this.bigReductionCount>300&&e.length==1){let[a]=e;for(;a.forceReduce()&&a.stack.length&&a.stack[a.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<e.length;a++){let o=e[a];for(;;){if(this.tokens.mainToken=null,o.pos>t)i.push(o);else{if(this.advanceStack(o,i,e))continue;{n||(n=[],s=[]),n.push(o);let l=this.tokens.getMainToken(o);s.push(l.value,l.end)}}break}}if(!i.length){let a=n&&cP(n);if(a)return Lr&&console.log("Finish with "+this.stackID(a)),this.stackToTree(a);if(this.parser.strict)throw Lr&&n&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&n){let a=this.stoppedAt!=null&&n[0].pos>this.stoppedAt?n[0]:this.runRecovery(n,s,i);if(a)return Lr&&console.log("Force-finish "+this.stackID(a)),this.stackToTree(a.forceAll())}if(this.recovering){let a=this.recovering==1?1:this.recovering*3;if(i.length>a)for(i.sort((o,l)=>l.score-o.score);i.length>a;)i.pop();i.some(o=>o.reducePos>t)&&this.recovering--}else if(i.length>1){e:for(let a=0;a<i.length-1;a++){let o=i[a];for(let l=a+1;l<i.length;l++){let c=i[l];if(o.sameState(c)||o.buffer.length>500&&c.buffer.length>500)if((o.score-c.score||o.buffer.length-c.buffer.length)>0)i.splice(l--,1);else{i.splice(a--,1);continue e}}}i.length>12&&i.splice(12,i.length-12)}this.minStackPos=i[0].pos;for(let a=1;a<i.length;a++)i[a].pos<this.minStackPos&&(this.minStackPos=i[a].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,i){let n=e.pos,{parser:s}=this,a=Lr?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&n>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let c=e.curContext&&e.curContext.tracker.strict,f=c?e.curContext.hash:0;for(let h=this.fragments.nodeAt(n);h;){let u=this.parser.nodeSet.types[h.type.id]==h.type?s.getGoto(e.state,h.type.id):-1;if(u>-1&&h.length&&(!c||(h.prop(Ye.contextHash)||0)==f))return e.useNode(h,u),Lr&&console.log(a+this.stackID(e)+` (via reuse of ${s.getName(h.type.id)})`),!0;if(!(h instanceof Ft)||h.children.length==0||h.positions[0]>0)break;let d=h.children[0];if(d instanceof Ft&&h.positions[0]==0)h=d;else break}}let o=s.stateSlot(e.state,4);if(o>0)return e.reduce(o),Lr&&console.log(a+this.stackID(e)+` (via always-reduce ${s.getName(o&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let c=0;c<l.length;){let f=l[c++],h=l[c++],u=l[c++],d=c==l.length||!i,m=d?e:e.split(),p=this.tokens.mainToken;if(m.apply(f,h,p?p.start:m.pos,u),Lr&&console.log(a+this.stackID(m)+` (via ${f&65536?`reduce of ${s.getName(f&65535)}`:"shift"} for ${s.getName(h)} @ ${n}${m==e?"":", split"})`),d)return!0;m.pos>n?t.push(m):i.push(m)}return!1}advanceFully(e,t){let i=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>i)return zg(e,t),!0}}runRecovery(e,t,i){let n=null,s=!1;for(let a=0;a<e.length;a++){let o=e[a],l=t[a<<1],c=t[(a<<1)+1],f=Lr?this.stackID(o)+" -> ":"";if(o.deadEnd&&(s||(s=!0,o.restart(),Lr&&console.log(f+this.stackID(o)+" (restarted)"),this.advanceFully(o,i))))continue;let h=o.split(),u=f;for(let d=0;h.forceReduce()&&d<10&&(Lr&&console.log(u+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,i));d++)Lr&&(u=this.stackID(h)+" -> ");for(let d of o.recoverByInsert(l))Lr&&console.log(f+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,i);this.stream.end>o.pos?(c==o.pos&&(c++,l=0),o.recoverByDelete(l,c),Lr&&console.log(f+this.stackID(o)+` (via recover-delete ${this.parser.getName(l)})`),zg(o,i)):(!n||n.score<o.score)&&(n=o)}return n}stackToTree(e){return e.close(),Ft.build({buffer:Jc.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(bh||(bh=new WeakMap)).get(e);return t||bh.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function zg(r,e){for(let t=0;t<e.length;t++){let i=e[t];if(i.pos==r.pos&&i.sameState(r)){e[t].score<r.score&&(e[t]=r);return}}e.push(r)}class lP{constructor(e,t,i){this.source=e,this.flags=t,this.disabled=i}allows(e){return!this.disabled||this.disabled[e]==0}}class Zc extends gy{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let o=0;o<e.repeatNodeCount;o++)t.push("");let i=Object.keys(e.topRules).map(o=>e.topRules[o][1]),n=[];for(let o=0;o<t.length;o++)n.push([]);function s(o,l,c){n[o].push([l,l.deserialize(String(c))])}if(e.nodeProps)for(let o of e.nodeProps){let l=o[0];typeof l=="string"&&(l=Ye[l]);for(let c=1;c<o.length;){let f=o[c++];if(f>=0)s(f,l,o[c++]);else{let h=o[c+-f];for(let u=-f;u>0;u--)s(o[c++],l,h);c++}}}this.nodeSet=new Y0(t.map((o,l)=>Ir.define({name:l>=this.minRepeatTerm?void 0:o,id:l,props:n[l],top:i.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=uy;let a=Vl(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let o=0;o<this.specializerSpecs.length;o++)this.specialized[o]=this.specializerSpecs[o].term;this.specializers=this.specializerSpecs.map(Wg),this.states=Vl(e.states,Uint32Array),this.data=Vl(e.stateData),this.goto=Vl(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(o=>typeof o=="number"?new Ys(a,o):o),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,i){let n=new oP(this,e,t,i);for(let s of this.wrappers)n=s(n,e,t,i);return n}getGoto(e,t,i=!1){let n=this.goto;if(t>=n[0])return-1;for(let s=n[t+1];;){let a=n[s++],o=a&1,l=n[s++];if(o&&i)return l;for(let c=s+(a>>1);s<c;s++)if(n[s]==e)return l;if(o)return-1}}hasAction(e,t){let i=this.data;for(let n=0;n<2;n++)for(let s=this.stateSlot(e,n?2:1),a;;s+=3){if((a=i[s])==65535)if(i[s+1]==1)a=i[s=Ki(i,s+2)];else{if(i[s+1]==2)return Ki(i,s+2);break}if(a==t||a==0)return Ki(i,s+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,i=>i==t?!0:null)}allActions(e,t){let i=this.stateSlot(e,4),n=i?t(i):void 0;for(let s=this.stateSlot(e,1);n==null;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=Ki(this.data,s+2);else break;n=t(Ki(this.data,s+1))}return n}nextStates(e){let t=[];for(let i=this.stateSlot(e,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=Ki(this.data,i+2);else break;if(!(this.data[i+2]&1)){let n=this.data[i+1];t.some((s,a)=>a&1&&s==n)||t.push(this.data[i],n)}}return t}configure(e){let t=Object.assign(Object.create(Zc.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let i=this.topRules[e.top];if(!i)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=i}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(i=>{let n=e.tokenizers.find(s=>s.from==i);return n?n.to:i})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((i,n)=>{let s=e.specializers.find(o=>o.from==i.external);if(!s)return i;let a=Object.assign(Object.assign({},i),{external:s.to});return t.specializers[n]=Wg(a),a})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),i=t.map(()=>!1);if(e)for(let s of e.split(" ")){let a=t.indexOf(s);a>=0&&(i[a]=!0)}let n=null;for(let s=0;s<t.length;s++)if(!i[s])for(let a=this.dialects[t[s]],o;(o=this.data[a++])!=65535;)(n||(n=new Uint8Array(this.maxTerm+1)))[o]=1;return new lP(e,i,n)}static deserialize(e){return new Zc(e)}}function Ki(r,e){return r[e]|r[e+1]<<16}function cP(r){let e=null;for(let t of r){let i=t.p.stoppedAt;(t.pos==t.p.stream.end||i!=null&&t.pos>i)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function Wg(r){if(r.external){let e=r.extend?1:0;return(t,i)=>r.external(t,i)<<1|e}return r.get}const fP=xy({String:me.string,Number:me.number,"True False":me.bool,PropertyName:me.propertyName,Null:me.null,", :":me.separator,"[ ]":me.squareBracket,"{ }":me.brace}),hP=Zc.deserialize({version:14,states:"$bOVQPOOOOQO'#Cb'#CbOnQPO'#CeOvQPO'#ClOOQO'#Cr'#CrQOQPOOOOQO'#Cg'#CgO}QPO'#CfO!SQPO'#CtOOQO,59P,59PO![QPO,59PO!aQPO'#CuOOQO,59W,59WO!iQPO,59WOVQPO,59QOqQPO'#CmO!nQPO,59`OOQO1G.k1G.kOVQPO'#CnO!vQPO,59aOOQO1G.r1G.rOOQO1G.l1G.lOOQO,59X,59XOOQO-E6k-E6kOOQO,59Y,59YOOQO-E6l-E6l",stateData:"#O~OeOS~OQSORSOSSOTSOWQO_ROgPO~OVXOgUO~O^[O~PVO[^O~O]_OVhX~OVaO~O]bO^iX~O^dO~O]_OVha~O]bO^ia~O",goto:"!kjPPPPPPkPPkqwPPPPk{!RPPP!XP!e!hXSOR^bQWQRf_TVQ_Q`WRg`QcZRicQTOQZRQe^RhbRYQR]R",nodeNames:" JsonText True False Null Number String } { Object Property PropertyName : , ] [ Array",maxTerm:25,nodeProps:[["isolate",-2,6,11,""],["openedBy",7,"{",14,"["],["closedBy",8,"}",15,"]"]],propSources:[fP],skippedNodes:[0],repeatNodeCount:2,tokenData:"(|~RaXY!WYZ!W]^!Wpq!Wrs!]|}$u}!O$z!Q!R%T!R![&c![!]&t!}#O&y#P#Q'O#Y#Z'T#b#c'r#h#i(Z#o#p(r#q#r(w~!]Oe~~!`Wpq!]qr!]rs!xs#O!]#O#P!}#P;'S!];'S;=`$o<%lO!]~!}Og~~#QXrs!]!P!Q!]#O#P!]#U#V!]#Y#Z!]#b#c!]#f#g!]#h#i!]#i#j#m~#pR!Q![#y!c!i#y#T#Z#y~#|R!Q![$V!c!i$V#T#Z$V~$YR!Q![$c!c!i$c#T#Z$c~$fR!Q![!]!c!i!]#T#Z!]~$rP;=`<%l!]~$zO]~~$}Q!Q!R%T!R![&c~%YRT~!O!P%c!g!h%w#X#Y%w~%fP!Q![%i~%nRT~!Q![%i!g!h%w#X#Y%w~%zR{|&T}!O&T!Q![&Z~&WP!Q![&Z~&`PT~!Q![&Z~&hST~!O!P%c!Q![&c!g!h%w#X#Y%w~&yO[~~'OO_~~'TO^~~'WP#T#U'Z~'^P#`#a'a~'dP#g#h'g~'jP#X#Y'm~'rOR~~'uP#i#j'x~'{P#`#a(O~(RP#`#a(U~(ZOS~~(^P#f#g(a~(dP#i#j(g~(jP#X#Y(m~(rOQ~~(wOW~~(|OV~",tokenizers:[0],topRules:{JsonText:[0,1]},tokenPrec:0}),uP=Bc.define({name:"json",parser:hP.configure({props:[ky.add({Object:sg({except:/^\s*\}/}),Array:sg({except:/^\s*\]/})}),_y.add({"Object Array":A6})]}),languageData:{closeBrackets:{brackets:["[","{",'"']},indentOnInput:/^\s*[\}\]]$/}});function dP(){return new g6(uP)}const pP="#e5c07b",Vg="#e06c75",mP="#56b6c2",gP="#ffffff",nc="#abb2bf",zu="#7d8799",xP="#61afef",vP="#98c379",jg="#d19a66",yP="#c678dd",wP="#21252b",$g="#2c313a",Gg="#282c34",_h="#353a42",kP="#3E4451",Kg="#528bff",bP=Oe.theme({"&":{color:nc,backgroundColor:Gg},".cm-content":{caretColor:Kg},".cm-cursor, .cm-dropCursor":{borderLeftColor:Kg},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:kP},".cm-panels":{backgroundColor:wP,color:nc},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Gg,color:zu,border:"none"},".cm-activeLineGutter":{backgroundColor:$g},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:_h},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:_h,borderBottomColor:_h},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:$g,color:nc}}},{dark:!0}),_P=tl.define([{tag:me.keyword,color:yP},{tag:[me.name,me.deleted,me.character,me.propertyName,me.macroName],color:Vg},{tag:[me.function(me.variableName),me.labelName],color:xP},{tag:[me.color,me.constant(me.name),me.standard(me.name)],color:jg},{tag:[me.definition(me.name),me.separator],color:nc},{tag:[me.typeName,me.className,me.number,me.changed,me.annotation,me.modifier,me.self,me.namespace],color:pP},{tag:[me.operator,me.operatorKeyword,me.url,me.escape,me.regexp,me.link,me.special(me.string)],color:mP},{tag:[me.meta,me.comment],color:zu},{tag:me.strong,fontWeight:"bold"},{tag:me.emphasis,fontStyle:"italic"},{tag:me.strikethrough,textDecoration:"line-through"},{tag:me.link,color:zu,textDecoration:"underline"},{tag:me.heading,fontWeight:"bold",color:Vg},{tag:[me.atom,me.bool,me.special(me.variableName)],color:jg},{tag:[me.processingInstruction,me.string,me.inserted],color:vP},{tag:me.invalid,color:gP}]),SP=[bP,Ry(_P)];function jl(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Uw={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,e){(function(t){r.exports=t()})(function(){return function t(i,n,s){function a(c,f){if(!n[c]){if(!i[c]){var h=typeof jl=="function"&&jl;if(!f&&h)return h(c,!0);if(o)return o(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[c]={exports:{}};i[c][0].call(d.exports,function(m){var p=i[c][1][m];return a(p||m)},d,d.exports,t,i,n,s)}return n[c].exports}for(var o=typeof jl=="function"&&jl,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,i,n){var s=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(l){for(var c,f,h,u,d,m,p,g=[],x=0,y=l.length,w=y,T=s.getTypeOf(l)!=="string";x<l.length;)w=y-x,h=T?(c=l[x++],f=x<y?l[x++]:0,x<y?l[x++]:0):(c=l.charCodeAt(x++),f=x<y?l.charCodeAt(x++):0,x<y?l.charCodeAt(x++):0),u=c>>2,d=(3&c)<<4|f>>4,m=1<w?(15&f)<<2|h>>6:64,p=2<w?63&h:64,g.push(o.charAt(u)+o.charAt(d)+o.charAt(m)+o.charAt(p));return g.join("")},n.decode=function(l){var c,f,h,u,d,m,p=0,g=0,x="data:";if(l.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var y,w=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&w--,l.charAt(l.length-2)===o.charAt(64)&&w--,w%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=a.uint8array?new Uint8Array(0|w):new Array(0|w);p<l.length;)c=o.indexOf(l.charAt(p++))<<2|(u=o.indexOf(l.charAt(p++)))>>4,f=(15&u)<<4|(d=o.indexOf(l.charAt(p++)))>>2,h=(3&d)<<6|(m=o.indexOf(l.charAt(p++))),y[g++]=c,d!==64&&(y[g++]=f),m!==64&&(y[g++]=h);return y}},{"./support":30,"./utils":32}],2:[function(t,i,n){var s=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function c(f,h,u,d,m){this.compressedSize=f,this.uncompressedSize=h,this.crc32=u,this.compression=d,this.compressedContent=m}c.prototype={getContentWorker:function(){var f=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),h=this;return f.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),f},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(f,h,u){return f.pipe(new o).pipe(new l("uncompressedSize")).pipe(h.compressWorker(u)).pipe(new l("compressedSize")).withStreamInfo("compression",h)},i.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,i,n){var s=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,i,n){var s=t("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var f=0;f<8;f++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();i.exports=function(o,l){return o!==void 0&&o.length?s.getTypeOf(o)!=="string"?function(c,f,h,u){var d=a,m=u+h;c^=-1;for(var p=u;p<m;p++)c=c>>>8^d[255&(c^f[p])];return-1^c}(0|l,o,o.length,0):function(c,f,h,u){var d=a,m=u+h;c^=-1;for(var p=u;p<m;p++)c=c>>>8^d[255&(c^f.charCodeAt(p))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(t,i,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,i,n){var s=null;s=typeof Promise<"u"?Promise:t("lie"),i.exports={Promise:s}},{lie:37}],7:[function(t,i,n){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),c=s?"uint8array":"array";function f(h,u){l.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=u,this.meta={}}n.magic="\b\0",o.inherits(f,l),f.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,h.data),!1)},f.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},f.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},f.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(u){h.push({data:u,meta:h.meta})}},n.compressWorker=function(h){return new f("Deflate",h)},n.uncompressWorker=function(){return new f("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,i,n){function s(d,m){var p,g="";for(p=0;p<m;p++)g+=String.fromCharCode(255&d),d>>>=8;return g}function a(d,m,p,g,x,y){var w,T,C=d.file,R=d.compression,_=y!==c.utf8encode,A=o.transformTo("string",y(C.name)),k=o.transformTo("string",c.utf8encode(C.name)),I=C.comment,N=o.transformTo("string",y(I)),S=o.transformTo("string",c.utf8encode(I)),W=k.length!==C.name.length,E=S.length!==I.length,Q="",ae="",Z="",xe=C.dir,L=C.date,ge={crc32:0,compressedSize:0,uncompressedSize:0};m&&!p||(ge.crc32=d.crc32,ge.compressedSize=d.compressedSize,ge.uncompressedSize=d.uncompressedSize);var Y=0;m&&(Y|=8),_||!W&&!E||(Y|=2048);var O=0,j=0;xe&&(O|=16),x==="UNIX"?(j=798,O|=function(H,ne){var ye=H;return H||(ye=ne?16893:33204),(65535&ye)<<16}(C.unixPermissions,xe)):(j=20,O|=function(H){return 63&(H||0)}(C.dosPermissions)),w=L.getUTCHours(),w<<=6,w|=L.getUTCMinutes(),w<<=5,w|=L.getUTCSeconds()/2,T=L.getUTCFullYear()-1980,T<<=4,T|=L.getUTCMonth()+1,T<<=5,T|=L.getUTCDate(),W&&(ae=s(1,1)+s(f(A),4)+k,Q+="up"+s(ae.length,2)+ae),E&&(Z=s(1,1)+s(f(N),4)+S,Q+="uc"+s(Z.length,2)+Z);var V="";return V+=`
\0`,V+=s(Y,2),V+=R.magic,V+=s(w,2),V+=s(T,2),V+=s(ge.crc32,4),V+=s(ge.compressedSize,4),V+=s(ge.uncompressedSize,4),V+=s(A.length,2),V+=s(Q.length,2),{fileRecord:h.LOCAL_FILE_HEADER+V+A+Q,dirRecord:h.CENTRAL_FILE_HEADER+s(j,2)+V+s(N.length,2)+"\0\0\0\0"+s(O,4)+s(g,4)+A+Q+N}}var o=t("../utils"),l=t("../stream/GenericWorker"),c=t("../utf8"),f=t("../crc32"),h=t("../signature");function u(d,m,p,g){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=p,this.encodeFileName=g,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(u,l),u.prototype.push=function(d){var m=d.meta.percent||0,p=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,l.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:p?(m+100*(p-g-1))/p:100}}))},u.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var m=this.streamFiles&&!d.file.dir;if(m){var p=a(d,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(d){this.accumulate=!1;var m=this.streamFiles&&!d.file.dir,p=a(d,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),m)this.push({data:function(g){return h.DATA_DESCRIPTOR+s(g.crc32,4)+s(g.compressedSize,4)+s(g.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var d=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var p=this.bytesWritten-d,g=function(x,y,w,T,C){var R=o.transformTo("string",C(T));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(x,2)+s(x,2)+s(y,4)+s(w,4)+s(R.length,2)+R}(this.dirRecords.length,p,d,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(d){this._sources.push(d);var m=this;return d.on("data",function(p){m.processChunk(p)}),d.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),d.on("error",function(p){m.error(p)}),this},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(d){var m=this._sources;if(!l.prototype.error.call(this,d))return!1;for(var p=0;p<m.length;p++)try{m[p].error(d)}catch{}return!0},u.prototype.lock=function(){l.prototype.lock.call(this);for(var d=this._sources,m=0;m<d.length;m++)d[m].lock()},i.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,i,n){var s=t("../compressions"),a=t("./ZipFileWorker");n.generateWorker=function(o,l,c){var f=new a(l.streamFiles,c,l.platform,l.encodeFileName),h=0;try{o.forEach(function(u,d){h++;var m=function(y,w){var T=y||w,C=s[T];if(!C)throw new Error(T+" is not a valid compression method !");return C}(d.options.compression,l.compression),p=d.options.compressionOptions||l.compressionOptions||{},g=d.dir,x=d.date;d._compressWorker(m,p).withStreamInfo("file",{name:u,dir:g,date:x,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(f)}),f.entriesCount=h}catch(u){f.error(u)}return f}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,i,n){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(s.prototype=t("./object")).loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=t("./external"),i.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,i,n){var s=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),c=t("./stream/Crc32Probe"),f=t("./nodejsUtils");function h(u){return new a.Promise(function(d,m){var p=u.decompressed.getContentWorker().pipe(new c);p.on("error",function(g){m(g)}).on("end",function(){p.streamInfo.crc32!==u.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}i.exports=function(u,d){var m=this;return d=s.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),f.isNode&&f.isStream(u)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",u,!0,d.optimizedBinaryString,d.base64).then(function(p){var g=new l(d);return g.load(p),g}).then(function(p){var g=[a.Promise.resolve(p)],x=p.files;if(d.checkCRC32)for(var y=0;y<x.length;y++)g.push(h(x[y]));return a.Promise.all(g)}).then(function(p){for(var g=p.shift(),x=g.files,y=0;y<x.length;y++){var w=x[y],T=w.fileNameStr,C=s.resolve(w.fileNameStr);m.file(C,w.decompressed,{binary:!0,optimizedBinaryString:!0,date:w.date,dir:w.dir,comment:w.fileCommentStr.length?w.fileCommentStr:null,unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions,createFolders:d.createFolders}),w.dir||(m.file(C).unsafeOriginalName=T)}return g.zipComment.length&&(m.comment=g.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,i,n){var s=t("../utils"),a=t("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(f){c.push({data:f,meta:{percent:0}})}).on("error",function(f){c.isPaused?this.generatedError=f:c.error(f)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,i,n){var s=t("readable-stream").Readable;function a(o,l,c){s.call(this,l),this._helper=o;var f=this;o.on("data",function(h,u){f.push(h)||f._helper.pause(),c&&c(u)}).on("error",function(h){f.emit("error",h)}).on("end",function(){f.push(null)})}t("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},i.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,i,n){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,i,n){function s(C,R,_){var A,k=o.getTypeOf(R),I=o.extend(_||{},f);I.date=I.date||new Date,I.compression!==null&&(I.compression=I.compression.toUpperCase()),typeof I.unixPermissions=="string"&&(I.unixPermissions=parseInt(I.unixPermissions,8)),I.unixPermissions&&16384&I.unixPermissions&&(I.dir=!0),I.dosPermissions&&16&I.dosPermissions&&(I.dir=!0),I.dir&&(C=x(C)),I.createFolders&&(A=g(C))&&y.call(this,A,!0);var N=k==="string"&&I.binary===!1&&I.base64===!1;_&&_.binary!==void 0||(I.binary=!N),(R instanceof h&&R.uncompressedSize===0||I.dir||!R||R.length===0)&&(I.base64=!1,I.binary=!0,R="",I.compression="STORE",k="string");var S=null;S=R instanceof h||R instanceof l?R:m.isNode&&m.isStream(R)?new p(C,R):o.prepareContent(C,R,I.binary,I.optimizedBinaryString,I.base64);var W=new u(C,S,I);this.files[C]=W}var a=t("./utf8"),o=t("./utils"),l=t("./stream/GenericWorker"),c=t("./stream/StreamHelper"),f=t("./defaults"),h=t("./compressedObject"),u=t("./zipObject"),d=t("./generate"),m=t("./nodejsUtils"),p=t("./nodejs/NodejsStreamInputAdapter"),g=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var R=C.lastIndexOf("/");return 0<R?C.substring(0,R):""},x=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},y=function(C,R){return R=R!==void 0?R:f.createFolders,C=x(C),this.files[C]||s.call(this,C,null,{dir:!0,createFolders:R}),this.files[C]};function w(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var T={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var R,_,A;for(R in this.files)A=this.files[R],(_=R.slice(this.root.length,R.length))&&R.slice(0,this.root.length)===this.root&&C(_,A)},filter:function(C){var R=[];return this.forEach(function(_,A){C(_,A)&&R.push(A)}),R},file:function(C,R,_){if(arguments.length!==1)return C=this.root+C,s.call(this,C,R,_),this;if(w(C)){var A=C;return this.filter(function(I,N){return!N.dir&&A.test(I)})}var k=this.files[this.root+C];return k&&!k.dir?k:null},folder:function(C){if(!C)return this;if(w(C))return this.filter(function(k,I){return I.dir&&C.test(k)});var R=this.root+C,_=y.call(this,R),A=this.clone();return A.root=_.name,A},remove:function(C){C=this.root+C;var R=this.files[C];if(R||(C.slice(-1)!=="/"&&(C+="/"),R=this.files[C]),R&&!R.dir)delete this.files[C];else for(var _=this.filter(function(k,I){return I.name.slice(0,C.length)===C}),A=0;A<_.length;A++)delete this.files[_[A].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var R,_={};try{if((_=o.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=_.type.toLowerCase(),_.compression=_.compression.toUpperCase(),_.type==="binarystring"&&(_.type="string"),!_.type)throw new Error("No output type specified.");o.checkSupport(_.type),_.platform!=="darwin"&&_.platform!=="freebsd"&&_.platform!=="linux"&&_.platform!=="sunos"||(_.platform="UNIX"),_.platform==="win32"&&(_.platform="DOS");var A=_.comment||this.comment||"";R=d.generateWorker(this,_,A)}catch(k){(R=new l("error")).error(k)}return new c(R,_.type||"string",_.mimeType)},generateAsync:function(C,R){return this.generateInternalStream(C).accumulate(R)},generateNodeStream:function(C,R){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(R)}};i.exports=T},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,i,n){i.exports=t("stream")},{stream:void 0}],17:[function(t,i,n){var s=t("./DataReader");function a(o){s.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),f=o.charCodeAt(2),h=o.charCodeAt(3),u=this.length-4;0<=u;--u)if(this.data[u]===l&&this.data[u+1]===c&&this.data[u+2]===f&&this.data[u+3]===h)return u-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),f=o.charCodeAt(2),h=o.charCodeAt(3),u=this.readData(4);return l===u[0]&&c===u[1]&&f===u[2]&&h===u[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},i.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,i,n){var s=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},i.exports=a},{"../utils":32}],19:[function(t,i,n){var s=t("./Uint8ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},i.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,i,n){var s=t("./DataReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},i.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,i,n){var s=t("./ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},i.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,i,n){var s=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),c=t("./NodeBufferReader"),f=t("./Uint8ArrayReader");i.exports=function(h){var u=s.getTypeOf(h);return s.checkSupport(u),u!=="string"||a.uint8array?u==="nodebuffer"?new c(h):a.uint8array?new f(s.transformTo("uint8array",h)):new o(s.transformTo("array",h)):new l(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,i,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,i,n){var s=t("./GenericWorker"),a=t("../utils");function o(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,s),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,i,n){var s=t("./GenericWorker"),a=t("../crc32");function o(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,s),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},i.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,i,n){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,i,n){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(f){c.dataIsReady=!0,c.data=f,c.max=f&&f.length||0,c.type=s.getTypeOf(f),c.isPaused||c._tickAndRepeat()},function(f){c.error(f)})}s.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,i,n){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=s},{}],29:[function(t,i,n){var s=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),c=t("../support"),f=t("../external"),h=null;if(c.nodestream)try{h=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function u(m,p){return new f.Promise(function(g,x){var y=[],w=m._internalType,T=m._outputType,C=m._mimeType;m.on("data",function(R,_){y.push(R),p&&p(_)}).on("error",function(R){y=[],x(R)}).on("end",function(){try{var R=function(_,A,k){switch(_){case"blob":return s.newBlob(s.transformTo("arraybuffer",A),k);case"base64":return l.encode(A);default:return s.transformTo(_,A)}}(T,function(_,A){var k,I=0,N=null,S=0;for(k=0;k<A.length;k++)S+=A[k].length;switch(_){case"string":return A.join("");case"array":return Array.prototype.concat.apply([],A);case"uint8array":for(N=new Uint8Array(S),k=0;k<A.length;k++)N.set(A[k],I),I+=A[k].length;return N;case"nodebuffer":return Buffer.concat(A);default:throw new Error("concat : unsupported type '"+_+"'")}}(w,y),C);g(R)}catch(_){x(_)}y=[]}).resume()})}function d(m,p,g){var x=p;switch(p){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=p,this._mimeType=g,s.checkSupport(x),this._worker=m.pipe(new a(x)),m.lock()}catch(y){this._worker=new o("error"),this._worker.error(y)}}d.prototype={accumulate:function(m){return u(this,m)},on:function(m,p){var g=this;return m==="data"?this._worker.on(m,function(x){p.call(g,x.data,x.meta)}):this._worker.on(m,function(){s.delay(p,arguments,g)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},m)}},i.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var s=new ArrayBuffer(0);try{n.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),n.blob=a.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!t("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(t,i,n){for(var s=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),c=new Array(256),f=0;f<256;f++)c[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;c[254]=c[254]=1;function h(){l.call(this,"utf-8 decode"),this.leftOver=null}function u(){l.call(this,"utf-8 encode")}n.utf8encode=function(d){return a.nodebuffer?o.newBufferFrom(d,"utf-8"):function(m){var p,g,x,y,w,T=m.length,C=0;for(y=0;y<T;y++)(64512&(g=m.charCodeAt(y)))==55296&&y+1<T&&(64512&(x=m.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(x-56320),y++),C+=g<128?1:g<2048?2:g<65536?3:4;for(p=a.uint8array?new Uint8Array(C):new Array(C),y=w=0;w<C;y++)(64512&(g=m.charCodeAt(y)))==55296&&y+1<T&&(64512&(x=m.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(x-56320),y++),g<128?p[w++]=g:(g<2048?p[w++]=192|g>>>6:(g<65536?p[w++]=224|g>>>12:(p[w++]=240|g>>>18,p[w++]=128|g>>>12&63),p[w++]=128|g>>>6&63),p[w++]=128|63&g);return p}(d)},n.utf8decode=function(d){return a.nodebuffer?s.transformTo("nodebuffer",d).toString("utf-8"):function(m){var p,g,x,y,w=m.length,T=new Array(2*w);for(p=g=0;p<w;)if((x=m[p++])<128)T[g++]=x;else if(4<(y=c[x]))T[g++]=65533,p+=y-1;else{for(x&=y===2?31:y===3?15:7;1<y&&p<w;)x=x<<6|63&m[p++],y--;1<y?T[g++]=65533:x<65536?T[g++]=x:(x-=65536,T[g++]=55296|x>>10&1023,T[g++]=56320|1023&x)}return T.length!==g&&(T.subarray?T=T.subarray(0,g):T.length=g),s.applyFromCharCode(T)}(d=s.transformTo(a.uint8array?"uint8array":"array",d))},s.inherits(h,l),h.prototype.processChunk=function(d){var m=s.transformTo(a.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var p=m;(m=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),m.set(p,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var g=function(y,w){var T;for((w=w||y.length)>y.length&&(w=y.length),T=w-1;0<=T&&(192&y[T])==128;)T--;return T<0||T===0?w:T+c[y[T]]>w?T:w}(m),x=m;g!==m.length&&(a.uint8array?(x=m.subarray(0,g),this.leftOver=m.subarray(g,m.length)):(x=m.slice(0,g),this.leftOver=m.slice(g,m.length))),this.push({data:n.utf8decode(x),meta:d.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=h,s.inherits(u,l),u.prototype.processChunk=function(d){this.push({data:n.utf8encode(d.data),meta:d.meta})},n.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,i,n){var s=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");function c(p){return p}function f(p,g){for(var x=0;x<p.length;++x)g[x]=255&p.charCodeAt(x);return g}t("setimmediate"),n.newBlob=function(p,g){n.checkSupport("blob");try{return new Blob([p],{type:g})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(p),x.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(p,g,x){var y=[],w=0,T=p.length;if(T<=x)return String.fromCharCode.apply(null,p);for(;w<T;)g==="array"||g==="nodebuffer"?y.push(String.fromCharCode.apply(null,p.slice(w,Math.min(w+x,T)))):y.push(String.fromCharCode.apply(null,p.subarray(w,Math.min(w+x,T)))),w+=x;return y.join("")},stringifyByChar:function(p){for(var g="",x=0;x<p.length;x++)g+=String.fromCharCode(p[x]);return g},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function u(p){var g=65536,x=n.getTypeOf(p),y=!0;if(x==="uint8array"?y=h.applyCanBeUsed.uint8array:x==="nodebuffer"&&(y=h.applyCanBeUsed.nodebuffer),y)for(;1<g;)try{return h.stringifyByChunk(p,x,g)}catch{g=Math.floor(g/2)}return h.stringifyByChar(p)}function d(p,g){for(var x=0;x<p.length;x++)g[x]=p[x];return g}n.applyFromCharCode=u;var m={};m.string={string:c,array:function(p){return f(p,new Array(p.length))},arraybuffer:function(p){return m.string.uint8array(p).buffer},uint8array:function(p){return f(p,new Uint8Array(p.length))},nodebuffer:function(p){return f(p,o.allocBuffer(p.length))}},m.array={string:u,array:c,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return o.newBufferFrom(p)}},m.arraybuffer={string:function(p){return u(new Uint8Array(p))},array:function(p){return d(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:c,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return o.newBufferFrom(new Uint8Array(p))}},m.uint8array={string:u,array:function(p){return d(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:c,nodebuffer:function(p){return o.newBufferFrom(p)}},m.nodebuffer={string:u,array:function(p){return d(p,new Array(p.length))},arraybuffer:function(p){return m.nodebuffer.uint8array(p).buffer},uint8array:function(p){return d(p,new Uint8Array(p.length))},nodebuffer:c},n.transformTo=function(p,g){if(g=g||"",!p)return g;n.checkSupport(p);var x=n.getTypeOf(g);return m[x][p](g)},n.resolve=function(p){for(var g=p.split("/"),x=[],y=0;y<g.length;y++){var w=g[y];w==="."||w===""&&y!==0&&y!==g.length-1||(w===".."?x.pop():x.push(w))}return x.join("/")},n.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":s.nodebuffer&&o.isBuffer(p)?"nodebuffer":s.uint8array&&p instanceof Uint8Array?"uint8array":s.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(p){if(!s[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(p){var g,x,y="";for(x=0;x<(p||"").length;x++)y+="\\x"+((g=p.charCodeAt(x))<16?"0":"")+g.toString(16).toUpperCase();return y},n.delay=function(p,g,x){setImmediate(function(){p.apply(x||null,g||[])})},n.inherits=function(p,g){function x(){}x.prototype=g.prototype,p.prototype=new x},n.extend=function(){var p,g,x={};for(p=0;p<arguments.length;p++)for(g in arguments[p])Object.prototype.hasOwnProperty.call(arguments[p],g)&&x[g]===void 0&&(x[g]=arguments[p][g]);return x},n.prepareContent=function(p,g,x,y,w){return l.Promise.resolve(g).then(function(T){return s.blob&&(T instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(T))!==-1)&&typeof FileReader<"u"?new l.Promise(function(C,R){var _=new FileReader;_.onload=function(A){C(A.target.result)},_.onerror=function(A){R(A.target.error)},_.readAsArrayBuffer(T)}):T}).then(function(T){var C=n.getTypeOf(T);return C?(C==="arraybuffer"?T=n.transformTo("uint8array",T):C==="string"&&(w?T=a.decode(T):x&&y!==!0&&(T=function(R){return f(R,s.uint8array?new Uint8Array(R.length):new Array(R.length))}(T))),T):l.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,i,n){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),c=t("./support");function f(h){this.files=[],this.loadOptions=h}f.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var u=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(u)+", expected "+a.pretty(h)+")")}},isSignature:function(h,u){var d=this.reader.index;this.reader.setIndex(h);var m=this.reader.readString(4)===u;return this.reader.setIndex(d),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),u=c.uint8array?"uint8array":"array",d=a.transformTo(u,h);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,u,d,m=this.zip64EndOfCentralSize-44;0<m;)h=this.reader.readInt(2),u=this.reader.readInt(4),d=this.reader.readData(u),this.zip64ExtensibleData[h]={id:h,length:u,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,u;for(h=0;h<this.files.length;h++)u=this.files[h],this.reader.setIndex(u.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),u.readLocalPart(this.reader),u.handleUTF8(),u.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(h=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var u=h;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var m=u-d;if(0<m)this.isSignature(u,o.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(h){this.reader=s(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=f},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,i,n){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),c=t("./utf8"),f=t("./compressions"),h=t("./support");function u(d,m){this.options=d,this.loadOptions=m}u.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var m,p;if(d.skip(22),this.fileNameLength=d.readInt(2),p=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=function(g){for(var x in f)if(Object.prototype.hasOwnProperty.call(f,x)&&f[x].magic===g)return f[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,m,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var m=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(m),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var m,p,g,x=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<x;)m=d.readInt(2),p=d.readInt(2),g=d.readData(p),this.extraFields[m]={id:m,length:p,value:g};d.setIndex(x)},handleUTF8:function(){var d=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var p=a.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var x=a.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var m=s(d.value);return m.readInt(1)!==1||l(this.fileName)!==m.readInt(4)?null:c.utf8decode(m.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var m=s(d.value);return m.readInt(1)!==1||l(this.fileComment)!==m.readInt(4)?null:c.utf8decode(m.readData(d.length-5))}return null}},i.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,i,n){function s(m,p,g){this.name=m,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=p,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var a=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),l=t("./utf8"),c=t("./compressedObject"),f=t("./stream/GenericWorker");s.prototype={internalStream:function(m){var p=null,g="string";try{if(!m)throw new Error("No output type specified.");var x=(g=m.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),p=this._decompressWorker();var y=!this._dataBinary;y&&!x&&(p=p.pipe(new l.Utf8EncodeWorker)),!y&&x&&(p=p.pipe(new l.Utf8DecodeWorker))}catch(w){(p=new f("error")).error(w)}return new a(p,g,"")},async:function(m,p){return this.internalStream(m).accumulate(p)},nodeStream:function(m,p){return this.internalStream(m||"nodebuffer").toNodejsStream(p)},_compressWorker:function(m,p){if(this._data instanceof c&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(g,m,p)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof f?this._data:new o(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<h.length;d++)s.prototype[h[d]]=u;i.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,i,n){(function(s){var a,o,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var c=0,f=new l(m),h=s.document.createTextNode("");f.observe(h,{characterData:!0}),a=function(){h.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var p=s.document.createElement("script");p.onreadystatechange=function(){m(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},s.document.documentElement.appendChild(p)}:function(){setTimeout(m,0)};else{var u=new s.MessageChannel;u.port1.onmessage=m,a=function(){u.port2.postMessage(0)}}var d=[];function m(){var p,g;o=!0;for(var x=d.length;x;){for(g=d,d=[],p=-1;++p<x;)g[p]();x=d.length}o=!1}i.exports=function(p){d.push(p)!==1||o||a()}}).call(this,typeof Ai<"u"?Ai:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,i,n){var s=t("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],f=["PENDING"];function h(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,x!==a&&p(this,x)}function u(x,y,w){this.promise=x,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}function d(x,y,w){s(function(){var T;try{T=y(w)}catch(C){return o.reject(x,C)}T===x?o.reject(x,new TypeError("Cannot resolve promise with itself")):o.resolve(x,T)})}function m(x){var y=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof y=="function")return function(){y.apply(x,arguments)}}function p(x,y){var w=!1;function T(_){w||(w=!0,o.reject(x,_))}function C(_){w||(w=!0,o.resolve(x,_))}var R=g(function(){y(C,T)});R.status==="error"&&T(R.value)}function g(x,y){var w={};try{w.value=x(y),w.status="success"}catch(T){w.status="error",w.value=T}return w}(i.exports=h).prototype.finally=function(x){if(typeof x!="function")return this;var y=this.constructor;return this.then(function(w){return y.resolve(x()).then(function(){return w})},function(w){return y.resolve(x()).then(function(){throw w})})},h.prototype.catch=function(x){return this.then(null,x)},h.prototype.then=function(x,y){if(typeof x!="function"&&this.state===c||typeof y!="function"&&this.state===l)return this;var w=new this.constructor(a);return this.state!==f?d(w,this.state===c?x:y,this.outcome):this.queue.push(new u(w,x,y)),w},u.prototype.callFulfilled=function(x){o.resolve(this.promise,x)},u.prototype.otherCallFulfilled=function(x){d(this.promise,this.onFulfilled,x)},u.prototype.callRejected=function(x){o.reject(this.promise,x)},u.prototype.otherCallRejected=function(x){d(this.promise,this.onRejected,x)},o.resolve=function(x,y){var w=g(m,y);if(w.status==="error")return o.reject(x,w.value);var T=w.value;if(T)p(x,T);else{x.state=c,x.outcome=y;for(var C=-1,R=x.queue.length;++C<R;)x.queue[C].callFulfilled(y)}return x},o.reject=function(x,y){x.state=l,x.outcome=y;for(var w=-1,T=x.queue.length;++w<T;)x.queue[w].callRejected(y);return x},h.resolve=function(x){return x instanceof this?x:o.resolve(new this(a),x)},h.reject=function(x){var y=new this(a);return o.reject(y,x)},h.all=function(x){var y=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=x.length,T=!1;if(!w)return this.resolve([]);for(var C=new Array(w),R=0,_=-1,A=new this(a);++_<w;)k(x[_],_);return A;function k(I,N){y.resolve(I).then(function(S){C[N]=S,++R!==w||T||(T=!0,o.resolve(A,C))},function(S){T||(T=!0,o.reject(A,S))})}},h.race=function(x){var y=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=x.length,T=!1;if(!w)return this.resolve([]);for(var C=-1,R=new this(a);++C<w;)_=x[C],y.resolve(_).then(function(A){T||(T=!0,o.resolve(R,A))},function(A){T||(T=!0,o.reject(R,A))});var _;return R}},{immediate:36}],38:[function(t,i,n){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),i.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,i,n){var s=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),c=t("./zlib/zstream"),f=Object.prototype.toString,h=0,u=-1,d=0,m=8;function p(x){if(!(this instanceof p))return new p(x);this.options=a.assign({level:u,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},x||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var w=s.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(w!==h)throw new Error(l[w]);if(y.header&&s.deflateSetHeader(this.strm,y.header),y.dictionary){var T;if(T=typeof y.dictionary=="string"?o.string2buf(y.dictionary):f.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(w=s.deflateSetDictionary(this.strm,T))!==h)throw new Error(l[w]);this._dict_set=!0}}function g(x,y){var w=new p(y);if(w.push(x,!0),w.err)throw w.msg||l[w.err];return w.result}p.prototype.push=function(x,y){var w,T,C=this.strm,R=this.options.chunkSize;if(this.ended)return!1;T=y===~~y?y:y===!0?4:0,typeof x=="string"?C.input=o.string2buf(x):f.call(x)==="[object ArrayBuffer]"?C.input=new Uint8Array(x):C.input=x,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(R),C.next_out=0,C.avail_out=R),(w=s.deflate(C,T))!==1&&w!==h)return this.onEnd(w),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||T!==4&&T!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(C.output,C.next_out))):this.onData(a.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&w!==1);return T===4?(w=s.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===h):T!==2||(this.onEnd(h),!(C.avail_out=0))},p.prototype.onData=function(x){this.chunks.push(x)},p.prototype.onEnd=function(x){x===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},n.Deflate=p,n.deflate=g,n.deflateRaw=function(x,y){return(y=y||{}).raw=!0,g(x,y)},n.gzip=function(x,y){return(y=y||{}).gzip=!0,g(x,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,i,n){var s=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),c=t("./zlib/messages"),f=t("./zlib/zstream"),h=t("./zlib/gzheader"),u=Object.prototype.toString;function d(p){if(!(this instanceof d))return new d(p);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},p||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||p&&p.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&!(15&g.windowBits)&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var x=s.inflateInit2(this.strm,g.windowBits);if(x!==l.Z_OK)throw new Error(c[x]);this.header=new h,s.inflateGetHeader(this.strm,this.header)}function m(p,g){var x=new d(g);if(x.push(p,!0),x.err)throw x.msg||c[x.err];return x.result}d.prototype.push=function(p,g){var x,y,w,T,C,R,_=this.strm,A=this.options.chunkSize,k=this.options.dictionary,I=!1;if(this.ended)return!1;y=g===~~g?g:g===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof p=="string"?_.input=o.binstring2buf(p):u.call(p)==="[object ArrayBuffer]"?_.input=new Uint8Array(p):_.input=p,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new a.Buf8(A),_.next_out=0,_.avail_out=A),(x=s.inflate(_,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&k&&(R=typeof k=="string"?o.string2buf(k):u.call(k)==="[object ArrayBuffer]"?new Uint8Array(k):k,x=s.inflateSetDictionary(this.strm,R)),x===l.Z_BUF_ERROR&&I===!0&&(x=l.Z_OK,I=!1),x!==l.Z_STREAM_END&&x!==l.Z_OK)return this.onEnd(x),!(this.ended=!0);_.next_out&&(_.avail_out!==0&&x!==l.Z_STREAM_END&&(_.avail_in!==0||y!==l.Z_FINISH&&y!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(w=o.utf8border(_.output,_.next_out),T=_.next_out-w,C=o.buf2string(_.output,w),_.next_out=T,_.avail_out=A-T,T&&a.arraySet(_.output,_.output,w,T,0),this.onData(C)):this.onData(a.shrinkBuf(_.output,_.next_out)))),_.avail_in===0&&_.avail_out===0&&(I=!0)}while((0<_.avail_in||_.avail_out===0)&&x!==l.Z_STREAM_END);return x===l.Z_STREAM_END&&(y=l.Z_FINISH),y===l.Z_FINISH?(x=s.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===l.Z_OK):y!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(_.avail_out=0))},d.prototype.onData=function(p){this.chunks.push(p)},d.prototype.onEnd=function(p){p===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},n.Inflate=d,n.inflate=m,n.inflateRaw=function(p,g){return(g=g||{}).raw=!0,m(p,g)},n.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,i,n){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var f=c.shift();if(f){if(typeof f!="object")throw new TypeError(f+"must be non-object");for(var h in f)f.hasOwnProperty(h)&&(l[h]=f[h])}}return l},n.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,f,h,u){if(c.subarray&&l.subarray)l.set(c.subarray(f,f+h),u);else for(var d=0;d<h;d++)l[u+d]=c[f+d]},flattenChunks:function(l){var c,f,h,u,d,m;for(c=h=0,f=l.length;c<f;c++)h+=l[c].length;for(m=new Uint8Array(h),c=u=0,f=l.length;c<f;c++)d=l[c],m.set(d,u),u+=d.length;return m}},o={arraySet:function(l,c,f,h,u){for(var d=0;d<h;d++)l[u+d]=c[f+d]},flattenChunks:function(l){return[].concat.apply([],l)}};n.setTyped=function(l){l?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,a)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(s)},{}],42:[function(t,i,n){var s=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function f(h,u){if(u<65537&&(h.subarray&&o||!h.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(h,u));for(var d="",m=0;m<u;m++)d+=String.fromCharCode(h[m]);return d}l[254]=l[254]=1,n.string2buf=function(h){var u,d,m,p,g,x=h.length,y=0;for(p=0;p<x;p++)(64512&(d=h.charCodeAt(p)))==55296&&p+1<x&&(64512&(m=h.charCodeAt(p+1)))==56320&&(d=65536+(d-55296<<10)+(m-56320),p++),y+=d<128?1:d<2048?2:d<65536?3:4;for(u=new s.Buf8(y),p=g=0;g<y;p++)(64512&(d=h.charCodeAt(p)))==55296&&p+1<x&&(64512&(m=h.charCodeAt(p+1)))==56320&&(d=65536+(d-55296<<10)+(m-56320),p++),d<128?u[g++]=d:(d<2048?u[g++]=192|d>>>6:(d<65536?u[g++]=224|d>>>12:(u[g++]=240|d>>>18,u[g++]=128|d>>>12&63),u[g++]=128|d>>>6&63),u[g++]=128|63&d);return u},n.buf2binstring=function(h){return f(h,h.length)},n.binstring2buf=function(h){for(var u=new s.Buf8(h.length),d=0,m=u.length;d<m;d++)u[d]=h.charCodeAt(d);return u},n.buf2string=function(h,u){var d,m,p,g,x=u||h.length,y=new Array(2*x);for(d=m=0;d<x;)if((p=h[d++])<128)y[m++]=p;else if(4<(g=l[p]))y[m++]=65533,d+=g-1;else{for(p&=g===2?31:g===3?15:7;1<g&&d<x;)p=p<<6|63&h[d++],g--;1<g?y[m++]=65533:p<65536?y[m++]=p:(p-=65536,y[m++]=55296|p>>10&1023,y[m++]=56320|1023&p)}return f(y,m)},n.utf8border=function(h,u){var d;for((u=u||h.length)>h.length&&(u=h.length),d=u-1;0<=d&&(192&h[d])==128;)d--;return d<0||d===0?u:d+l[h[d]]>u?d:u}},{"./common":41}],43:[function(t,i,n){i.exports=function(s,a,o,l){for(var c=65535&s|0,f=s>>>16&65535|0,h=0;o!==0;){for(o-=h=2e3<o?2e3:o;f=f+(c=c+a[l++]|0)|0,--h;);c%=65521,f%=65521}return c|f<<16|0}},{}],44:[function(t,i,n){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,i,n){var s=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();i.exports=function(a,o,l,c){var f=s,h=c+l;a^=-1;for(var u=c;u<h;u++)a=a>>>8^f[255&(a^o[u])];return-1^a}},{}],46:[function(t,i,n){var s,a=t("../utils/common"),o=t("./trees"),l=t("./adler32"),c=t("./crc32"),f=t("./messages"),h=0,u=4,d=0,m=-2,p=-1,g=4,x=2,y=8,w=9,T=286,C=30,R=19,_=2*T+1,A=15,k=3,I=258,N=I+k+1,S=42,W=113,E=1,Q=2,ae=3,Z=4;function xe(v,K){return v.msg=f[K],K}function L(v){return(v<<1)-(4<v?9:0)}function ge(v){for(var K=v.length;0<=--K;)v[K]=0}function Y(v){var K=v.state,P=K.pending;P>v.avail_out&&(P=v.avail_out),P!==0&&(a.arraySet(v.output,K.pending_buf,K.pending_out,P,v.next_out),v.next_out+=P,K.pending_out+=P,v.total_out+=P,v.avail_out-=P,K.pending-=P,K.pending===0&&(K.pending_out=0))}function O(v,K){o._tr_flush_block(v,0<=v.block_start?v.block_start:-1,v.strstart-v.block_start,K),v.block_start=v.strstart,Y(v.strm)}function j(v,K){v.pending_buf[v.pending++]=K}function V(v,K){v.pending_buf[v.pending++]=K>>>8&255,v.pending_buf[v.pending++]=255&K}function H(v,K){var P,F,D=v.max_chain_length,U=v.strstart,te=v.prev_length,re=v.nice_match,ee=v.strstart>v.w_size-N?v.strstart-(v.w_size-N):0,ie=v.window,le=v.w_mask,ce=v.prev,we=v.strstart+I,Ae=ie[U+te-1],Se=ie[U+te];v.prev_length>=v.good_match&&(D>>=2),re>v.lookahead&&(re=v.lookahead);do if(ie[(P=K)+te]===Se&&ie[P+te-1]===Ae&&ie[P]===ie[U]&&ie[++P]===ie[U+1]){U+=2,P++;do;while(ie[++U]===ie[++P]&&ie[++U]===ie[++P]&&ie[++U]===ie[++P]&&ie[++U]===ie[++P]&&ie[++U]===ie[++P]&&ie[++U]===ie[++P]&&ie[++U]===ie[++P]&&ie[++U]===ie[++P]&&U<we);if(F=I-(we-U),U=we-I,te<F){if(v.match_start=K,re<=(te=F))break;Ae=ie[U+te-1],Se=ie[U+te]}}while((K=ce[K&le])>ee&&--D!=0);return te<=v.lookahead?te:v.lookahead}function ne(v){var K,P,F,D,U,te,re,ee,ie,le,ce=v.w_size;do{if(D=v.window_size-v.lookahead-v.strstart,v.strstart>=ce+(ce-N)){for(a.arraySet(v.window,v.window,ce,ce,0),v.match_start-=ce,v.strstart-=ce,v.block_start-=ce,K=P=v.hash_size;F=v.head[--K],v.head[K]=ce<=F?F-ce:0,--P;);for(K=P=ce;F=v.prev[--K],v.prev[K]=ce<=F?F-ce:0,--P;);D+=ce}if(v.strm.avail_in===0)break;if(te=v.strm,re=v.window,ee=v.strstart+v.lookahead,ie=D,le=void 0,le=te.avail_in,ie<le&&(le=ie),P=le===0?0:(te.avail_in-=le,a.arraySet(re,te.input,te.next_in,le,ee),te.state.wrap===1?te.adler=l(te.adler,re,le,ee):te.state.wrap===2&&(te.adler=c(te.adler,re,le,ee)),te.next_in+=le,te.total_in+=le,le),v.lookahead+=P,v.lookahead+v.insert>=k)for(U=v.strstart-v.insert,v.ins_h=v.window[U],v.ins_h=(v.ins_h<<v.hash_shift^v.window[U+1])&v.hash_mask;v.insert&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[U+k-1])&v.hash_mask,v.prev[U&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=U,U++,v.insert--,!(v.lookahead+v.insert<k)););}while(v.lookahead<N&&v.strm.avail_in!==0)}function ye(v,K){for(var P,F;;){if(v.lookahead<N){if(ne(v),v.lookahead<N&&K===h)return E;if(v.lookahead===0)break}if(P=0,v.lookahead>=k&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+k-1])&v.hash_mask,P=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),P!==0&&v.strstart-P<=v.w_size-N&&(v.match_length=H(v,P)),v.match_length>=k)if(F=o._tr_tally(v,v.strstart-v.match_start,v.match_length-k),v.lookahead-=v.match_length,v.match_length<=v.max_lazy_match&&v.lookahead>=k){for(v.match_length--;v.strstart++,v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+k-1])&v.hash_mask,P=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart,--v.match_length!=0;);v.strstart++}else v.strstart+=v.match_length,v.match_length=0,v.ins_h=v.window[v.strstart],v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+1])&v.hash_mask;else F=o._tr_tally(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++;if(F&&(O(v,!1),v.strm.avail_out===0))return E}return v.insert=v.strstart<k-1?v.strstart:k-1,K===u?(O(v,!0),v.strm.avail_out===0?ae:Z):v.last_lit&&(O(v,!1),v.strm.avail_out===0)?E:Q}function de(v,K){for(var P,F,D;;){if(v.lookahead<N){if(ne(v),v.lookahead<N&&K===h)return E;if(v.lookahead===0)break}if(P=0,v.lookahead>=k&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+k-1])&v.hash_mask,P=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),v.prev_length=v.match_length,v.prev_match=v.match_start,v.match_length=k-1,P!==0&&v.prev_length<v.max_lazy_match&&v.strstart-P<=v.w_size-N&&(v.match_length=H(v,P),v.match_length<=5&&(v.strategy===1||v.match_length===k&&4096<v.strstart-v.match_start)&&(v.match_length=k-1)),v.prev_length>=k&&v.match_length<=v.prev_length){for(D=v.strstart+v.lookahead-k,F=o._tr_tally(v,v.strstart-1-v.prev_match,v.prev_length-k),v.lookahead-=v.prev_length-1,v.prev_length-=2;++v.strstart<=D&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+k-1])&v.hash_mask,P=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),--v.prev_length!=0;);if(v.match_available=0,v.match_length=k-1,v.strstart++,F&&(O(v,!1),v.strm.avail_out===0))return E}else if(v.match_available){if((F=o._tr_tally(v,0,v.window[v.strstart-1]))&&O(v,!1),v.strstart++,v.lookahead--,v.strm.avail_out===0)return E}else v.match_available=1,v.strstart++,v.lookahead--}return v.match_available&&(F=o._tr_tally(v,0,v.window[v.strstart-1]),v.match_available=0),v.insert=v.strstart<k-1?v.strstart:k-1,K===u?(O(v,!0),v.strm.avail_out===0?ae:Z):v.last_lit&&(O(v,!1),v.strm.avail_out===0)?E:Q}function ue(v,K,P,F,D){this.good_length=v,this.max_lazy=K,this.nice_length=P,this.max_chain=F,this.func=D}function pe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*_),this.dyn_dtree=new a.Buf16(2*(2*C+1)),this.bl_tree=new a.Buf16(2*(2*R+1)),ge(this.dyn_ltree),ge(this.dyn_dtree),ge(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(A+1),this.heap=new a.Buf16(2*T+1),ge(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*T+1),ge(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function be(v){var K;return v&&v.state?(v.total_in=v.total_out=0,v.data_type=x,(K=v.state).pending=0,K.pending_out=0,K.wrap<0&&(K.wrap=-K.wrap),K.status=K.wrap?S:W,v.adler=K.wrap===2?0:1,K.last_flush=h,o._tr_init(K),d):xe(v,m)}function b(v){var K=be(v);return K===d&&function(P){P.window_size=2*P.w_size,ge(P.head),P.max_lazy_match=s[P.level].max_lazy,P.good_match=s[P.level].good_length,P.nice_match=s[P.level].nice_length,P.max_chain_length=s[P.level].max_chain,P.strstart=0,P.block_start=0,P.lookahead=0,P.insert=0,P.match_length=P.prev_length=k-1,P.match_available=0,P.ins_h=0}(v.state),K}function J(v,K,P,F,D,U){if(!v)return m;var te=1;if(K===p&&(K=6),F<0?(te=0,F=-F):15<F&&(te=2,F-=16),D<1||w<D||P!==y||F<8||15<F||K<0||9<K||U<0||g<U)return xe(v,m);F===8&&(F=9);var re=new pe;return(v.state=re).strm=v,re.wrap=te,re.gzhead=null,re.w_bits=F,re.w_size=1<<re.w_bits,re.w_mask=re.w_size-1,re.hash_bits=D+7,re.hash_size=1<<re.hash_bits,re.hash_mask=re.hash_size-1,re.hash_shift=~~((re.hash_bits+k-1)/k),re.window=new a.Buf8(2*re.w_size),re.head=new a.Buf16(re.hash_size),re.prev=new a.Buf16(re.w_size),re.lit_bufsize=1<<D+6,re.pending_buf_size=4*re.lit_bufsize,re.pending_buf=new a.Buf8(re.pending_buf_size),re.d_buf=1*re.lit_bufsize,re.l_buf=3*re.lit_bufsize,re.level=K,re.strategy=U,re.method=P,b(v)}s=[new ue(0,0,0,0,function(v,K){var P=65535;for(P>v.pending_buf_size-5&&(P=v.pending_buf_size-5);;){if(v.lookahead<=1){if(ne(v),v.lookahead===0&&K===h)return E;if(v.lookahead===0)break}v.strstart+=v.lookahead,v.lookahead=0;var F=v.block_start+P;if((v.strstart===0||v.strstart>=F)&&(v.lookahead=v.strstart-F,v.strstart=F,O(v,!1),v.strm.avail_out===0)||v.strstart-v.block_start>=v.w_size-N&&(O(v,!1),v.strm.avail_out===0))return E}return v.insert=0,K===u?(O(v,!0),v.strm.avail_out===0?ae:Z):(v.strstart>v.block_start&&(O(v,!1),v.strm.avail_out),E)}),new ue(4,4,8,4,ye),new ue(4,5,16,8,ye),new ue(4,6,32,32,ye),new ue(4,4,16,16,de),new ue(8,16,32,32,de),new ue(8,16,128,128,de),new ue(8,32,128,256,de),new ue(32,128,258,1024,de),new ue(32,258,258,4096,de)],n.deflateInit=function(v,K){return J(v,K,y,15,8,0)},n.deflateInit2=J,n.deflateReset=b,n.deflateResetKeep=be,n.deflateSetHeader=function(v,K){return v&&v.state?v.state.wrap!==2?m:(v.state.gzhead=K,d):m},n.deflate=function(v,K){var P,F,D,U;if(!v||!v.state||5<K||K<0)return v?xe(v,m):m;if(F=v.state,!v.output||!v.input&&v.avail_in!==0||F.status===666&&K!==u)return xe(v,v.avail_out===0?-5:m);if(F.strm=v,P=F.last_flush,F.last_flush=K,F.status===S)if(F.wrap===2)v.adler=0,j(F,31),j(F,139),j(F,8),F.gzhead?(j(F,(F.gzhead.text?1:0)+(F.gzhead.hcrc?2:0)+(F.gzhead.extra?4:0)+(F.gzhead.name?8:0)+(F.gzhead.comment?16:0)),j(F,255&F.gzhead.time),j(F,F.gzhead.time>>8&255),j(F,F.gzhead.time>>16&255),j(F,F.gzhead.time>>24&255),j(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),j(F,255&F.gzhead.os),F.gzhead.extra&&F.gzhead.extra.length&&(j(F,255&F.gzhead.extra.length),j(F,F.gzhead.extra.length>>8&255)),F.gzhead.hcrc&&(v.adler=c(v.adler,F.pending_buf,F.pending,0)),F.gzindex=0,F.status=69):(j(F,0),j(F,0),j(F,0),j(F,0),j(F,0),j(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),j(F,3),F.status=W);else{var te=y+(F.w_bits-8<<4)<<8;te|=(2<=F.strategy||F.level<2?0:F.level<6?1:F.level===6?2:3)<<6,F.strstart!==0&&(te|=32),te+=31-te%31,F.status=W,V(F,te),F.strstart!==0&&(V(F,v.adler>>>16),V(F,65535&v.adler)),v.adler=1}if(F.status===69)if(F.gzhead.extra){for(D=F.pending;F.gzindex<(65535&F.gzhead.extra.length)&&(F.pending!==F.pending_buf_size||(F.gzhead.hcrc&&F.pending>D&&(v.adler=c(v.adler,F.pending_buf,F.pending-D,D)),Y(v),D=F.pending,F.pending!==F.pending_buf_size));)j(F,255&F.gzhead.extra[F.gzindex]),F.gzindex++;F.gzhead.hcrc&&F.pending>D&&(v.adler=c(v.adler,F.pending_buf,F.pending-D,D)),F.gzindex===F.gzhead.extra.length&&(F.gzindex=0,F.status=73)}else F.status=73;if(F.status===73)if(F.gzhead.name){D=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>D&&(v.adler=c(v.adler,F.pending_buf,F.pending-D,D)),Y(v),D=F.pending,F.pending===F.pending_buf_size)){U=1;break}U=F.gzindex<F.gzhead.name.length?255&F.gzhead.name.charCodeAt(F.gzindex++):0,j(F,U)}while(U!==0);F.gzhead.hcrc&&F.pending>D&&(v.adler=c(v.adler,F.pending_buf,F.pending-D,D)),U===0&&(F.gzindex=0,F.status=91)}else F.status=91;if(F.status===91)if(F.gzhead.comment){D=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>D&&(v.adler=c(v.adler,F.pending_buf,F.pending-D,D)),Y(v),D=F.pending,F.pending===F.pending_buf_size)){U=1;break}U=F.gzindex<F.gzhead.comment.length?255&F.gzhead.comment.charCodeAt(F.gzindex++):0,j(F,U)}while(U!==0);F.gzhead.hcrc&&F.pending>D&&(v.adler=c(v.adler,F.pending_buf,F.pending-D,D)),U===0&&(F.status=103)}else F.status=103;if(F.status===103&&(F.gzhead.hcrc?(F.pending+2>F.pending_buf_size&&Y(v),F.pending+2<=F.pending_buf_size&&(j(F,255&v.adler),j(F,v.adler>>8&255),v.adler=0,F.status=W)):F.status=W),F.pending!==0){if(Y(v),v.avail_out===0)return F.last_flush=-1,d}else if(v.avail_in===0&&L(K)<=L(P)&&K!==u)return xe(v,-5);if(F.status===666&&v.avail_in!==0)return xe(v,-5);if(v.avail_in!==0||F.lookahead!==0||K!==h&&F.status!==666){var re=F.strategy===2?function(ee,ie){for(var le;;){if(ee.lookahead===0&&(ne(ee),ee.lookahead===0)){if(ie===h)return E;break}if(ee.match_length=0,le=o._tr_tally(ee,0,ee.window[ee.strstart]),ee.lookahead--,ee.strstart++,le&&(O(ee,!1),ee.strm.avail_out===0))return E}return ee.insert=0,ie===u?(O(ee,!0),ee.strm.avail_out===0?ae:Z):ee.last_lit&&(O(ee,!1),ee.strm.avail_out===0)?E:Q}(F,K):F.strategy===3?function(ee,ie){for(var le,ce,we,Ae,Se=ee.window;;){if(ee.lookahead<=I){if(ne(ee),ee.lookahead<=I&&ie===h)return E;if(ee.lookahead===0)break}if(ee.match_length=0,ee.lookahead>=k&&0<ee.strstart&&(ce=Se[we=ee.strstart-1])===Se[++we]&&ce===Se[++we]&&ce===Se[++we]){Ae=ee.strstart+I;do;while(ce===Se[++we]&&ce===Se[++we]&&ce===Se[++we]&&ce===Se[++we]&&ce===Se[++we]&&ce===Se[++we]&&ce===Se[++we]&&ce===Se[++we]&&we<Ae);ee.match_length=I-(Ae-we),ee.match_length>ee.lookahead&&(ee.match_length=ee.lookahead)}if(ee.match_length>=k?(le=o._tr_tally(ee,1,ee.match_length-k),ee.lookahead-=ee.match_length,ee.strstart+=ee.match_length,ee.match_length=0):(le=o._tr_tally(ee,0,ee.window[ee.strstart]),ee.lookahead--,ee.strstart++),le&&(O(ee,!1),ee.strm.avail_out===0))return E}return ee.insert=0,ie===u?(O(ee,!0),ee.strm.avail_out===0?ae:Z):ee.last_lit&&(O(ee,!1),ee.strm.avail_out===0)?E:Q}(F,K):s[F.level].func(F,K);if(re!==ae&&re!==Z||(F.status=666),re===E||re===ae)return v.avail_out===0&&(F.last_flush=-1),d;if(re===Q&&(K===1?o._tr_align(F):K!==5&&(o._tr_stored_block(F,0,0,!1),K===3&&(ge(F.head),F.lookahead===0&&(F.strstart=0,F.block_start=0,F.insert=0))),Y(v),v.avail_out===0))return F.last_flush=-1,d}return K!==u?d:F.wrap<=0?1:(F.wrap===2?(j(F,255&v.adler),j(F,v.adler>>8&255),j(F,v.adler>>16&255),j(F,v.adler>>24&255),j(F,255&v.total_in),j(F,v.total_in>>8&255),j(F,v.total_in>>16&255),j(F,v.total_in>>24&255)):(V(F,v.adler>>>16),V(F,65535&v.adler)),Y(v),0<F.wrap&&(F.wrap=-F.wrap),F.pending!==0?d:1)},n.deflateEnd=function(v){var K;return v&&v.state?(K=v.state.status)!==S&&K!==69&&K!==73&&K!==91&&K!==103&&K!==W&&K!==666?xe(v,m):(v.state=null,K===W?xe(v,-3):d):m},n.deflateSetDictionary=function(v,K){var P,F,D,U,te,re,ee,ie,le=K.length;if(!v||!v.state||(U=(P=v.state).wrap)===2||U===1&&P.status!==S||P.lookahead)return m;for(U===1&&(v.adler=l(v.adler,K,le,0)),P.wrap=0,le>=P.w_size&&(U===0&&(ge(P.head),P.strstart=0,P.block_start=0,P.insert=0),ie=new a.Buf8(P.w_size),a.arraySet(ie,K,le-P.w_size,P.w_size,0),K=ie,le=P.w_size),te=v.avail_in,re=v.next_in,ee=v.input,v.avail_in=le,v.next_in=0,v.input=K,ne(P);P.lookahead>=k;){for(F=P.strstart,D=P.lookahead-(k-1);P.ins_h=(P.ins_h<<P.hash_shift^P.window[F+k-1])&P.hash_mask,P.prev[F&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=F,F++,--D;);P.strstart=F,P.lookahead=k-1,ne(P)}return P.strstart+=P.lookahead,P.block_start=P.strstart,P.insert=P.lookahead,P.lookahead=0,P.match_length=P.prev_length=k-1,P.match_available=0,v.next_in=re,v.input=ee,v.avail_in=te,P.wrap=U,d},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,i,n){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,i,n){i.exports=function(s,a){var o,l,c,f,h,u,d,m,p,g,x,y,w,T,C,R,_,A,k,I,N,S,W,E,Q;o=s.state,l=s.next_in,E=s.input,c=l+(s.avail_in-5),f=s.next_out,Q=s.output,h=f-(a-s.avail_out),u=f+(s.avail_out-257),d=o.dmax,m=o.wsize,p=o.whave,g=o.wnext,x=o.window,y=o.hold,w=o.bits,T=o.lencode,C=o.distcode,R=(1<<o.lenbits)-1,_=(1<<o.distbits)-1;e:do{w<15&&(y+=E[l++]<<w,w+=8,y+=E[l++]<<w,w+=8),A=T[y&R];t:for(;;){if(y>>>=k=A>>>24,w-=k,(k=A>>>16&255)===0)Q[f++]=65535&A;else{if(!(16&k)){if(!(64&k)){A=T[(65535&A)+(y&(1<<k)-1)];continue t}if(32&k){o.mode=12;break e}s.msg="invalid literal/length code",o.mode=30;break e}I=65535&A,(k&=15)&&(w<k&&(y+=E[l++]<<w,w+=8),I+=y&(1<<k)-1,y>>>=k,w-=k),w<15&&(y+=E[l++]<<w,w+=8,y+=E[l++]<<w,w+=8),A=C[y&_];r:for(;;){if(y>>>=k=A>>>24,w-=k,!(16&(k=A>>>16&255))){if(!(64&k)){A=C[(65535&A)+(y&(1<<k)-1)];continue r}s.msg="invalid distance code",o.mode=30;break e}if(N=65535&A,w<(k&=15)&&(y+=E[l++]<<w,(w+=8)<k&&(y+=E[l++]<<w,w+=8)),d<(N+=y&(1<<k)-1)){s.msg="invalid distance too far back",o.mode=30;break e}if(y>>>=k,w-=k,(k=f-h)<N){if(p<(k=N-k)&&o.sane){s.msg="invalid distance too far back",o.mode=30;break e}if(W=x,(S=0)===g){if(S+=m-k,k<I){for(I-=k;Q[f++]=x[S++],--k;);S=f-N,W=Q}}else if(g<k){if(S+=m+g-k,(k-=g)<I){for(I-=k;Q[f++]=x[S++],--k;);if(S=0,g<I){for(I-=k=g;Q[f++]=x[S++],--k;);S=f-N,W=Q}}}else if(S+=g-k,k<I){for(I-=k;Q[f++]=x[S++],--k;);S=f-N,W=Q}for(;2<I;)Q[f++]=W[S++],Q[f++]=W[S++],Q[f++]=W[S++],I-=3;I&&(Q[f++]=W[S++],1<I&&(Q[f++]=W[S++]))}else{for(S=f-N;Q[f++]=Q[S++],Q[f++]=Q[S++],Q[f++]=Q[S++],2<(I-=3););I&&(Q[f++]=Q[S++],1<I&&(Q[f++]=Q[S++]))}break}}break}}while(l<c&&f<u);l-=I=w>>3,y&=(1<<(w-=I<<3))-1,s.next_in=l,s.next_out=f,s.avail_in=l<c?c-l+5:5-(l-c),s.avail_out=f<u?u-f+257:257-(f-u),o.hold=y,o.bits=w}},{}],49:[function(t,i,n){var s=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),c=t("./inftrees"),f=1,h=2,u=0,d=-2,m=1,p=852,g=592;function x(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function w(S){var W;return S&&S.state?(W=S.state,S.total_in=S.total_out=W.total=0,S.msg="",W.wrap&&(S.adler=1&W.wrap),W.mode=m,W.last=0,W.havedict=0,W.dmax=32768,W.head=null,W.hold=0,W.bits=0,W.lencode=W.lendyn=new s.Buf32(p),W.distcode=W.distdyn=new s.Buf32(g),W.sane=1,W.back=-1,u):d}function T(S){var W;return S&&S.state?((W=S.state).wsize=0,W.whave=0,W.wnext=0,w(S)):d}function C(S,W){var E,Q;return S&&S.state?(Q=S.state,W<0?(E=0,W=-W):(E=1+(W>>4),W<48&&(W&=15)),W&&(W<8||15<W)?d:(Q.window!==null&&Q.wbits!==W&&(Q.window=null),Q.wrap=E,Q.wbits=W,T(S))):d}function R(S,W){var E,Q;return S?(Q=new y,(S.state=Q).window=null,(E=C(S,W))!==u&&(S.state=null),E):d}var _,A,k=!0;function I(S){if(k){var W;for(_=new s.Buf32(512),A=new s.Buf32(32),W=0;W<144;)S.lens[W++]=8;for(;W<256;)S.lens[W++]=9;for(;W<280;)S.lens[W++]=7;for(;W<288;)S.lens[W++]=8;for(c(f,S.lens,0,288,_,0,S.work,{bits:9}),W=0;W<32;)S.lens[W++]=5;c(h,S.lens,0,32,A,0,S.work,{bits:5}),k=!1}S.lencode=_,S.lenbits=9,S.distcode=A,S.distbits=5}function N(S,W,E,Q){var ae,Z=S.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new s.Buf8(Z.wsize)),Q>=Z.wsize?(s.arraySet(Z.window,W,E-Z.wsize,Z.wsize,0),Z.wnext=0,Z.whave=Z.wsize):(Q<(ae=Z.wsize-Z.wnext)&&(ae=Q),s.arraySet(Z.window,W,E-Q,ae,Z.wnext),(Q-=ae)?(s.arraySet(Z.window,W,E-Q,Q,0),Z.wnext=Q,Z.whave=Z.wsize):(Z.wnext+=ae,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=ae))),0}n.inflateReset=T,n.inflateReset2=C,n.inflateResetKeep=w,n.inflateInit=function(S){return R(S,15)},n.inflateInit2=R,n.inflate=function(S,W){var E,Q,ae,Z,xe,L,ge,Y,O,j,V,H,ne,ye,de,ue,pe,be,b,J,v,K,P,F,D=0,U=new s.Buf8(4),te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return d;(E=S.state).mode===12&&(E.mode=13),xe=S.next_out,ae=S.output,ge=S.avail_out,Z=S.next_in,Q=S.input,L=S.avail_in,Y=E.hold,O=E.bits,j=L,V=ge,K=u;e:for(;;)switch(E.mode){case m:if(E.wrap===0){E.mode=13;break}for(;O<16;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}if(2&E.wrap&&Y===35615){U[E.check=0]=255&Y,U[1]=Y>>>8&255,E.check=o(E.check,U,2,0),O=Y=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&Y)<<8)+(Y>>8))%31){S.msg="incorrect header check",E.mode=30;break}if((15&Y)!=8){S.msg="unknown compression method",E.mode=30;break}if(O-=4,v=8+(15&(Y>>>=4)),E.wbits===0)E.wbits=v;else if(v>E.wbits){S.msg="invalid window size",E.mode=30;break}E.dmax=1<<v,S.adler=E.check=1,E.mode=512&Y?10:12,O=Y=0;break;case 2:for(;O<16;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}if(E.flags=Y,(255&E.flags)!=8){S.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){S.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=Y>>8&1),512&E.flags&&(U[0]=255&Y,U[1]=Y>>>8&255,E.check=o(E.check,U,2,0)),O=Y=0,E.mode=3;case 3:for(;O<32;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}E.head&&(E.head.time=Y),512&E.flags&&(U[0]=255&Y,U[1]=Y>>>8&255,U[2]=Y>>>16&255,U[3]=Y>>>24&255,E.check=o(E.check,U,4,0)),O=Y=0,E.mode=4;case 4:for(;O<16;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}E.head&&(E.head.xflags=255&Y,E.head.os=Y>>8),512&E.flags&&(U[0]=255&Y,U[1]=Y>>>8&255,E.check=o(E.check,U,2,0)),O=Y=0,E.mode=5;case 5:if(1024&E.flags){for(;O<16;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}E.length=Y,E.head&&(E.head.extra_len=Y),512&E.flags&&(U[0]=255&Y,U[1]=Y>>>8&255,E.check=o(E.check,U,2,0)),O=Y=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(L<(H=E.length)&&(H=L),H&&(E.head&&(v=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),s.arraySet(E.head.extra,Q,Z,H,v)),512&E.flags&&(E.check=o(E.check,Q,H,Z)),L-=H,Z+=H,E.length-=H),E.length))break e;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(L===0)break e;for(H=0;v=Q[Z+H++],E.head&&v&&E.length<65536&&(E.head.name+=String.fromCharCode(v)),v&&H<L;);if(512&E.flags&&(E.check=o(E.check,Q,H,Z)),L-=H,Z+=H,v)break e}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(L===0)break e;for(H=0;v=Q[Z+H++],E.head&&v&&E.length<65536&&(E.head.comment+=String.fromCharCode(v)),v&&H<L;);if(512&E.flags&&(E.check=o(E.check,Q,H,Z)),L-=H,Z+=H,v)break e}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;O<16;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}if(Y!==(65535&E.check)){S.msg="header crc mismatch",E.mode=30;break}O=Y=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),S.adler=E.check=0,E.mode=12;break;case 10:for(;O<32;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}S.adler=E.check=x(Y),O=Y=0,E.mode=11;case 11:if(E.havedict===0)return S.next_out=xe,S.avail_out=ge,S.next_in=Z,S.avail_in=L,E.hold=Y,E.bits=O,2;S.adler=E.check=1,E.mode=12;case 12:if(W===5||W===6)break e;case 13:if(E.last){Y>>>=7&O,O-=7&O,E.mode=27;break}for(;O<3;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}switch(E.last=1&Y,O-=1,3&(Y>>>=1)){case 0:E.mode=14;break;case 1:if(I(E),E.mode=20,W!==6)break;Y>>>=2,O-=2;break e;case 2:E.mode=17;break;case 3:S.msg="invalid block type",E.mode=30}Y>>>=2,O-=2;break;case 14:for(Y>>>=7&O,O-=7&O;O<32;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}if((65535&Y)!=(Y>>>16^65535)){S.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&Y,O=Y=0,E.mode=15,W===6)break e;case 15:E.mode=16;case 16:if(H=E.length){if(L<H&&(H=L),ge<H&&(H=ge),H===0)break e;s.arraySet(ae,Q,Z,H,xe),L-=H,Z+=H,ge-=H,xe+=H,E.length-=H;break}E.mode=12;break;case 17:for(;O<14;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}if(E.nlen=257+(31&Y),Y>>>=5,O-=5,E.ndist=1+(31&Y),Y>>>=5,O-=5,E.ncode=4+(15&Y),Y>>>=4,O-=4,286<E.nlen||30<E.ndist){S.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;O<3;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}E.lens[te[E.have++]]=7&Y,Y>>>=3,O-=3}for(;E.have<19;)E.lens[te[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,P={bits:E.lenbits},K=c(0,E.lens,0,19,E.lencode,0,E.work,P),E.lenbits=P.bits,K){S.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;ue=(D=E.lencode[Y&(1<<E.lenbits)-1])>>>16&255,pe=65535&D,!((de=D>>>24)<=O);){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}if(pe<16)Y>>>=de,O-=de,E.lens[E.have++]=pe;else{if(pe===16){for(F=de+2;O<F;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}if(Y>>>=de,O-=de,E.have===0){S.msg="invalid bit length repeat",E.mode=30;break}v=E.lens[E.have-1],H=3+(3&Y),Y>>>=2,O-=2}else if(pe===17){for(F=de+3;O<F;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}O-=de,v=0,H=3+(7&(Y>>>=de)),Y>>>=3,O-=3}else{for(F=de+7;O<F;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}O-=de,v=0,H=11+(127&(Y>>>=de)),Y>>>=7,O-=7}if(E.have+H>E.nlen+E.ndist){S.msg="invalid bit length repeat",E.mode=30;break}for(;H--;)E.lens[E.have++]=v}}if(E.mode===30)break;if(E.lens[256]===0){S.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,P={bits:E.lenbits},K=c(f,E.lens,0,E.nlen,E.lencode,0,E.work,P),E.lenbits=P.bits,K){S.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,P={bits:E.distbits},K=c(h,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,P),E.distbits=P.bits,K){S.msg="invalid distances set",E.mode=30;break}if(E.mode=20,W===6)break e;case 20:E.mode=21;case 21:if(6<=L&&258<=ge){S.next_out=xe,S.avail_out=ge,S.next_in=Z,S.avail_in=L,E.hold=Y,E.bits=O,l(S,V),xe=S.next_out,ae=S.output,ge=S.avail_out,Z=S.next_in,Q=S.input,L=S.avail_in,Y=E.hold,O=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;ue=(D=E.lencode[Y&(1<<E.lenbits)-1])>>>16&255,pe=65535&D,!((de=D>>>24)<=O);){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}if(ue&&!(240&ue)){for(be=de,b=ue,J=pe;ue=(D=E.lencode[J+((Y&(1<<be+b)-1)>>be)])>>>16&255,pe=65535&D,!(be+(de=D>>>24)<=O);){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}Y>>>=be,O-=be,E.back+=be}if(Y>>>=de,O-=de,E.back+=de,E.length=pe,ue===0){E.mode=26;break}if(32&ue){E.back=-1,E.mode=12;break}if(64&ue){S.msg="invalid literal/length code",E.mode=30;break}E.extra=15&ue,E.mode=22;case 22:if(E.extra){for(F=E.extra;O<F;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}E.length+=Y&(1<<E.extra)-1,Y>>>=E.extra,O-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;ue=(D=E.distcode[Y&(1<<E.distbits)-1])>>>16&255,pe=65535&D,!((de=D>>>24)<=O);){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}if(!(240&ue)){for(be=de,b=ue,J=pe;ue=(D=E.distcode[J+((Y&(1<<be+b)-1)>>be)])>>>16&255,pe=65535&D,!(be+(de=D>>>24)<=O);){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}Y>>>=be,O-=be,E.back+=be}if(Y>>>=de,O-=de,E.back+=de,64&ue){S.msg="invalid distance code",E.mode=30;break}E.offset=pe,E.extra=15&ue,E.mode=24;case 24:if(E.extra){for(F=E.extra;O<F;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}E.offset+=Y&(1<<E.extra)-1,Y>>>=E.extra,O-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){S.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if(ge===0)break e;if(H=V-ge,E.offset>H){if((H=E.offset-H)>E.whave&&E.sane){S.msg="invalid distance too far back",E.mode=30;break}ne=H>E.wnext?(H-=E.wnext,E.wsize-H):E.wnext-H,H>E.length&&(H=E.length),ye=E.window}else ye=ae,ne=xe-E.offset,H=E.length;for(ge<H&&(H=ge),ge-=H,E.length-=H;ae[xe++]=ye[ne++],--H;);E.length===0&&(E.mode=21);break;case 26:if(ge===0)break e;ae[xe++]=E.length,ge--,E.mode=21;break;case 27:if(E.wrap){for(;O<32;){if(L===0)break e;L--,Y|=Q[Z++]<<O,O+=8}if(V-=ge,S.total_out+=V,E.total+=V,V&&(S.adler=E.check=E.flags?o(E.check,ae,V,xe-V):a(E.check,ae,V,xe-V)),V=ge,(E.flags?Y:x(Y))!==E.check){S.msg="incorrect data check",E.mode=30;break}O=Y=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;O<32;){if(L===0)break e;L--,Y+=Q[Z++]<<O,O+=8}if(Y!==(4294967295&E.total)){S.msg="incorrect length check",E.mode=30;break}O=Y=0}E.mode=29;case 29:K=1;break e;case 30:K=-3;break e;case 31:return-4;case 32:default:return d}return S.next_out=xe,S.avail_out=ge,S.next_in=Z,S.avail_in=L,E.hold=Y,E.bits=O,(E.wsize||V!==S.avail_out&&E.mode<30&&(E.mode<27||W!==4))&&N(S,S.output,S.next_out,V-S.avail_out)?(E.mode=31,-4):(j-=S.avail_in,V-=S.avail_out,S.total_in+=j,S.total_out+=V,E.total+=V,E.wrap&&V&&(S.adler=E.check=E.flags?o(E.check,ae,V,S.next_out-V):a(E.check,ae,V,S.next_out-V)),S.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(j==0&&V===0||W===4)&&K===u&&(K=-5),K)},n.inflateEnd=function(S){if(!S||!S.state)return d;var W=S.state;return W.window&&(W.window=null),S.state=null,u},n.inflateGetHeader=function(S,W){var E;return S&&S.state&&2&(E=S.state).wrap?((E.head=W).done=!1,u):d},n.inflateSetDictionary=function(S,W){var E,Q=W.length;return S&&S.state?(E=S.state).wrap!==0&&E.mode!==11?d:E.mode===11&&a(1,W,Q,0)!==E.check?-3:N(S,W,Q,Q)?(E.mode=31,-4):(E.havedict=1,u):d},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,i,n){var s=t("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(f,h,u,d,m,p,g,x){var y,w,T,C,R,_,A,k,I,N=x.bits,S=0,W=0,E=0,Q=0,ae=0,Z=0,xe=0,L=0,ge=0,Y=0,O=null,j=0,V=new s.Buf16(16),H=new s.Buf16(16),ne=null,ye=0;for(S=0;S<=15;S++)V[S]=0;for(W=0;W<d;W++)V[h[u+W]]++;for(ae=N,Q=15;1<=Q&&V[Q]===0;Q--);if(Q<ae&&(ae=Q),Q===0)return m[p++]=20971520,m[p++]=20971520,x.bits=1,0;for(E=1;E<Q&&V[E]===0;E++);for(ae<E&&(ae=E),S=L=1;S<=15;S++)if(L<<=1,(L-=V[S])<0)return-1;if(0<L&&(f===0||Q!==1))return-1;for(H[1]=0,S=1;S<15;S++)H[S+1]=H[S]+V[S];for(W=0;W<d;W++)h[u+W]!==0&&(g[H[h[u+W]]++]=W);if(_=f===0?(O=ne=g,19):f===1?(O=a,j-=257,ne=o,ye-=257,256):(O=l,ne=c,-1),S=E,R=p,xe=W=Y=0,T=-1,C=(ge=1<<(Z=ae))-1,f===1&&852<ge||f===2&&592<ge)return 1;for(;;){for(A=S-xe,I=g[W]<_?(k=0,g[W]):g[W]>_?(k=ne[ye+g[W]],O[j+g[W]]):(k=96,0),y=1<<S-xe,E=w=1<<Z;m[R+(Y>>xe)+(w-=y)]=A<<24|k<<16|I|0,w!==0;);for(y=1<<S-1;Y&y;)y>>=1;if(y!==0?(Y&=y-1,Y+=y):Y=0,W++,--V[S]==0){if(S===Q)break;S=h[u+g[W]]}if(ae<S&&(Y&C)!==T){for(xe===0&&(xe=ae),R+=E,L=1<<(Z=S-xe);Z+xe<Q&&!((L-=V[Z+xe])<=0);)Z++,L<<=1;if(ge+=1<<Z,f===1&&852<ge||f===2&&592<ge)return 1;m[T=Y&C]=ae<<24|Z<<16|R-p|0}}return Y!==0&&(m[R+Y]=S-xe<<24|64<<16|0),x.bits=ae,0}},{"../utils/common":41}],51:[function(t,i,n){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,i,n){var s=t("../utils/common"),a=0,o=1;function l(D){for(var U=D.length;0<=--U;)D[U]=0}var c=0,f=29,h=256,u=h+1+f,d=30,m=19,p=2*u+1,g=15,x=16,y=7,w=256,T=16,C=17,R=18,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],A=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],N=new Array(2*(u+2));l(N);var S=new Array(2*d);l(S);var W=new Array(512);l(W);var E=new Array(256);l(E);var Q=new Array(f);l(Q);var ae,Z,xe,L=new Array(d);function ge(D,U,te,re,ee){this.static_tree=D,this.extra_bits=U,this.extra_base=te,this.elems=re,this.max_length=ee,this.has_stree=D&&D.length}function Y(D,U){this.dyn_tree=D,this.max_code=0,this.stat_desc=U}function O(D){return D<256?W[D]:W[256+(D>>>7)]}function j(D,U){D.pending_buf[D.pending++]=255&U,D.pending_buf[D.pending++]=U>>>8&255}function V(D,U,te){D.bi_valid>x-te?(D.bi_buf|=U<<D.bi_valid&65535,j(D,D.bi_buf),D.bi_buf=U>>x-D.bi_valid,D.bi_valid+=te-x):(D.bi_buf|=U<<D.bi_valid&65535,D.bi_valid+=te)}function H(D,U,te){V(D,te[2*U],te[2*U+1])}function ne(D,U){for(var te=0;te|=1&D,D>>>=1,te<<=1,0<--U;);return te>>>1}function ye(D,U,te){var re,ee,ie=new Array(g+1),le=0;for(re=1;re<=g;re++)ie[re]=le=le+te[re-1]<<1;for(ee=0;ee<=U;ee++){var ce=D[2*ee+1];ce!==0&&(D[2*ee]=ne(ie[ce]++,ce))}}function de(D){var U;for(U=0;U<u;U++)D.dyn_ltree[2*U]=0;for(U=0;U<d;U++)D.dyn_dtree[2*U]=0;for(U=0;U<m;U++)D.bl_tree[2*U]=0;D.dyn_ltree[2*w]=1,D.opt_len=D.static_len=0,D.last_lit=D.matches=0}function ue(D){8<D.bi_valid?j(D,D.bi_buf):0<D.bi_valid&&(D.pending_buf[D.pending++]=D.bi_buf),D.bi_buf=0,D.bi_valid=0}function pe(D,U,te,re){var ee=2*U,ie=2*te;return D[ee]<D[ie]||D[ee]===D[ie]&&re[U]<=re[te]}function be(D,U,te){for(var re=D.heap[te],ee=te<<1;ee<=D.heap_len&&(ee<D.heap_len&&pe(U,D.heap[ee+1],D.heap[ee],D.depth)&&ee++,!pe(U,re,D.heap[ee],D.depth));)D.heap[te]=D.heap[ee],te=ee,ee<<=1;D.heap[te]=re}function b(D,U,te){var re,ee,ie,le,ce=0;if(D.last_lit!==0)for(;re=D.pending_buf[D.d_buf+2*ce]<<8|D.pending_buf[D.d_buf+2*ce+1],ee=D.pending_buf[D.l_buf+ce],ce++,re===0?H(D,ee,U):(H(D,(ie=E[ee])+h+1,U),(le=_[ie])!==0&&V(D,ee-=Q[ie],le),H(D,ie=O(--re),te),(le=A[ie])!==0&&V(D,re-=L[ie],le)),ce<D.last_lit;);H(D,w,U)}function J(D,U){var te,re,ee,ie=U.dyn_tree,le=U.stat_desc.static_tree,ce=U.stat_desc.has_stree,we=U.stat_desc.elems,Ae=-1;for(D.heap_len=0,D.heap_max=p,te=0;te<we;te++)ie[2*te]!==0?(D.heap[++D.heap_len]=Ae=te,D.depth[te]=0):ie[2*te+1]=0;for(;D.heap_len<2;)ie[2*(ee=D.heap[++D.heap_len]=Ae<2?++Ae:0)]=1,D.depth[ee]=0,D.opt_len--,ce&&(D.static_len-=le[2*ee+1]);for(U.max_code=Ae,te=D.heap_len>>1;1<=te;te--)be(D,ie,te);for(ee=we;te=D.heap[1],D.heap[1]=D.heap[D.heap_len--],be(D,ie,1),re=D.heap[1],D.heap[--D.heap_max]=te,D.heap[--D.heap_max]=re,ie[2*ee]=ie[2*te]+ie[2*re],D.depth[ee]=(D.depth[te]>=D.depth[re]?D.depth[te]:D.depth[re])+1,ie[2*te+1]=ie[2*re+1]=ee,D.heap[1]=ee++,be(D,ie,1),2<=D.heap_len;);D.heap[--D.heap_max]=D.heap[1],function(Se,$e){var Ie,Ne,qe,Le,Nt,Tt,yt=$e.dyn_tree,zn=$e.max_code,Wn=$e.stat_desc.static_tree,nl=$e.stat_desc.has_stree,sl=$e.stat_desc.extra_bits,al=$e.stat_desc.extra_base,Vn=$e.stat_desc.max_length,Vi=0;for(Le=0;Le<=g;Le++)Se.bl_count[Le]=0;for(yt[2*Se.heap[Se.heap_max]+1]=0,Ie=Se.heap_max+1;Ie<p;Ie++)Vn<(Le=yt[2*yt[2*(Ne=Se.heap[Ie])+1]+1]+1)&&(Le=Vn,Vi++),yt[2*Ne+1]=Le,zn<Ne||(Se.bl_count[Le]++,Nt=0,al<=Ne&&(Nt=sl[Ne-al]),Tt=yt[2*Ne],Se.opt_len+=Tt*(Le+Nt),nl&&(Se.static_len+=Tt*(Wn[2*Ne+1]+Nt)));if(Vi!==0){do{for(Le=Vn-1;Se.bl_count[Le]===0;)Le--;Se.bl_count[Le]--,Se.bl_count[Le+1]+=2,Se.bl_count[Vn]--,Vi-=2}while(0<Vi);for(Le=Vn;Le!==0;Le--)for(Ne=Se.bl_count[Le];Ne!==0;)zn<(qe=Se.heap[--Ie])||(yt[2*qe+1]!==Le&&(Se.opt_len+=(Le-yt[2*qe+1])*yt[2*qe],yt[2*qe+1]=Le),Ne--)}}(D,U),ye(ie,Ae,D.bl_count)}function v(D,U,te){var re,ee,ie=-1,le=U[1],ce=0,we=7,Ae=4;for(le===0&&(we=138,Ae=3),U[2*(te+1)+1]=65535,re=0;re<=te;re++)ee=le,le=U[2*(re+1)+1],++ce<we&&ee===le||(ce<Ae?D.bl_tree[2*ee]+=ce:ee!==0?(ee!==ie&&D.bl_tree[2*ee]++,D.bl_tree[2*T]++):ce<=10?D.bl_tree[2*C]++:D.bl_tree[2*R]++,ie=ee,Ae=(ce=0)===le?(we=138,3):ee===le?(we=6,3):(we=7,4))}function K(D,U,te){var re,ee,ie=-1,le=U[1],ce=0,we=7,Ae=4;for(le===0&&(we=138,Ae=3),re=0;re<=te;re++)if(ee=le,le=U[2*(re+1)+1],!(++ce<we&&ee===le)){if(ce<Ae)for(;H(D,ee,D.bl_tree),--ce!=0;);else ee!==0?(ee!==ie&&(H(D,ee,D.bl_tree),ce--),H(D,T,D.bl_tree),V(D,ce-3,2)):ce<=10?(H(D,C,D.bl_tree),V(D,ce-3,3)):(H(D,R,D.bl_tree),V(D,ce-11,7));ie=ee,Ae=(ce=0)===le?(we=138,3):ee===le?(we=6,3):(we=7,4)}}l(L);var P=!1;function F(D,U,te,re){V(D,(c<<1)+(re?1:0),3),function(ee,ie,le,ce){ue(ee),j(ee,le),j(ee,~le),s.arraySet(ee.pending_buf,ee.window,ie,le,ee.pending),ee.pending+=le}(D,U,te)}n._tr_init=function(D){P||(function(){var U,te,re,ee,ie,le=new Array(g+1);for(ee=re=0;ee<f-1;ee++)for(Q[ee]=re,U=0;U<1<<_[ee];U++)E[re++]=ee;for(E[re-1]=ee,ee=ie=0;ee<16;ee++)for(L[ee]=ie,U=0;U<1<<A[ee];U++)W[ie++]=ee;for(ie>>=7;ee<d;ee++)for(L[ee]=ie<<7,U=0;U<1<<A[ee]-7;U++)W[256+ie++]=ee;for(te=0;te<=g;te++)le[te]=0;for(U=0;U<=143;)N[2*U+1]=8,U++,le[8]++;for(;U<=255;)N[2*U+1]=9,U++,le[9]++;for(;U<=279;)N[2*U+1]=7,U++,le[7]++;for(;U<=287;)N[2*U+1]=8,U++,le[8]++;for(ye(N,u+1,le),U=0;U<d;U++)S[2*U+1]=5,S[2*U]=ne(U,5);ae=new ge(N,_,h+1,u,g),Z=new ge(S,A,0,d,g),xe=new ge(new Array(0),k,0,m,y)}(),P=!0),D.l_desc=new Y(D.dyn_ltree,ae),D.d_desc=new Y(D.dyn_dtree,Z),D.bl_desc=new Y(D.bl_tree,xe),D.bi_buf=0,D.bi_valid=0,de(D)},n._tr_stored_block=F,n._tr_flush_block=function(D,U,te,re){var ee,ie,le=0;0<D.level?(D.strm.data_type===2&&(D.strm.data_type=function(ce){var we,Ae=4093624447;for(we=0;we<=31;we++,Ae>>>=1)if(1&Ae&&ce.dyn_ltree[2*we]!==0)return a;if(ce.dyn_ltree[18]!==0||ce.dyn_ltree[20]!==0||ce.dyn_ltree[26]!==0)return o;for(we=32;we<h;we++)if(ce.dyn_ltree[2*we]!==0)return o;return a}(D)),J(D,D.l_desc),J(D,D.d_desc),le=function(ce){var we;for(v(ce,ce.dyn_ltree,ce.l_desc.max_code),v(ce,ce.dyn_dtree,ce.d_desc.max_code),J(ce,ce.bl_desc),we=m-1;3<=we&&ce.bl_tree[2*I[we]+1]===0;we--);return ce.opt_len+=3*(we+1)+5+5+4,we}(D),ee=D.opt_len+3+7>>>3,(ie=D.static_len+3+7>>>3)<=ee&&(ee=ie)):ee=ie=te+5,te+4<=ee&&U!==-1?F(D,U,te,re):D.strategy===4||ie===ee?(V(D,2+(re?1:0),3),b(D,N,S)):(V(D,4+(re?1:0),3),function(ce,we,Ae,Se){var $e;for(V(ce,we-257,5),V(ce,Ae-1,5),V(ce,Se-4,4),$e=0;$e<Se;$e++)V(ce,ce.bl_tree[2*I[$e]+1],3);K(ce,ce.dyn_ltree,we-1),K(ce,ce.dyn_dtree,Ae-1)}(D,D.l_desc.max_code+1,D.d_desc.max_code+1,le+1),b(D,D.dyn_ltree,D.dyn_dtree)),de(D),re&&ue(D)},n._tr_tally=function(D,U,te){return D.pending_buf[D.d_buf+2*D.last_lit]=U>>>8&255,D.pending_buf[D.d_buf+2*D.last_lit+1]=255&U,D.pending_buf[D.l_buf+D.last_lit]=255&te,D.last_lit++,U===0?D.dyn_ltree[2*te]++:(D.matches++,U--,D.dyn_ltree[2*(E[te]+h+1)]++,D.dyn_dtree[2*O(U)]++),D.last_lit===D.lit_bufsize-1},n._tr_align=function(D){V(D,2,3),H(D,w,N),function(U){U.bi_valid===16?(j(U,U.bi_buf),U.bi_buf=0,U.bi_valid=0):8<=U.bi_valid&&(U.pending_buf[U.pending++]=255&U.bi_buf,U.bi_buf>>=8,U.bi_valid-=8)}(D)}},{"../utils/common":41}],53:[function(t,i,n){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,i,n){(function(s){(function(a,o){if(!a.setImmediate){var l,c,f,h,u=1,d={},m=!1,p=a.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(a);g=g&&g.setTimeout?g:a,l={}.toString.call(a.process)==="[object process]"?function(T){process.nextTick(function(){y(T)})}:function(){if(a.postMessage&&!a.importScripts){var T=!0,C=a.onmessage;return a.onmessage=function(){T=!1},a.postMessage("","*"),a.onmessage=C,T}}()?(h="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",w,!1):a.attachEvent("onmessage",w),function(T){a.postMessage(h+T,"*")}):a.MessageChannel?((f=new MessageChannel).port1.onmessage=function(T){y(T.data)},function(T){f.port2.postMessage(T)}):p&&"onreadystatechange"in p.createElement("script")?(c=p.documentElement,function(T){var C=p.createElement("script");C.onreadystatechange=function(){y(T),C.onreadystatechange=null,c.removeChild(C),C=null},c.appendChild(C)}):function(T){setTimeout(y,0,T)},g.setImmediate=function(T){typeof T!="function"&&(T=new Function(""+T));for(var C=new Array(arguments.length-1),R=0;R<C.length;R++)C[R]=arguments[R+1];var _={callback:T,args:C};return d[u]=_,l(u),u++},g.clearImmediate=x}function x(T){delete d[T]}function y(T){if(m)setTimeout(y,0,T);else{var C=d[T];if(C){m=!0;try{(function(R){var _=R.callback,A=R.args;switch(A.length){case 0:_();break;case 1:_(A[0]);break;case 2:_(A[0],A[1]);break;case 3:_(A[0],A[1],A[2]);break;default:_.apply(o,A)}})(C)}finally{x(T),m=!1}}}}function w(T){T.source===a&&typeof T.data=="string"&&T.data.indexOf(h)===0&&y(+T.data.slice(h.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Ai<"u"?Ai:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Uw);var TP=Uw.exports;const EP=rx(TP);var Hw={exports:{}};(function(r,e){(function(t,i){i()})(Ai,function(){function t(c,f){return typeof f>"u"?f={autoBom:!1}:typeof f!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),f={autoBom:!f}),f.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function i(c,f,h){var u=new XMLHttpRequest;u.open("GET",c),u.responseType="blob",u.onload=function(){l(u.response,f,h)},u.onerror=function(){console.error("could not download file")},u.send()}function n(c){var f=new XMLHttpRequest;f.open("HEAD",c,!1);try{f.send()}catch{}return 200<=f.status&&299>=f.status}function s(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(f)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Ai=="object"&&Ai.global===Ai?Ai:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(c,f,h){var u=a.URL||a.webkitURL,d=document.createElement("a");f=f||c.name||"download",d.download=f,d.rel="noopener",typeof c=="string"?(d.href=c,d.origin===location.origin?s(d):n(d.href)?i(c,f,h):s(d,d.target="_blank")):(d.href=u.createObjectURL(c),setTimeout(function(){u.revokeObjectURL(d.href)},4e4),setTimeout(function(){s(d)},0))}:"msSaveOrOpenBlob"in navigator?function(c,f,h){if(f=f||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(t(c,h),f);else if(n(c))i(c,f,h);else{var u=document.createElement("a");u.href=c,u.target="_blank",setTimeout(function(){s(u)})}}:function(c,f,h,u){if(u=u||open("","_blank"),u&&(u.document.title=u.document.body.innerText="downloading..."),typeof c=="string")return i(c,f,h);var d=c.type==="application/octet-stream",m=/constructor/i.test(a.HTMLElement)||a.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||d&&m||o)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var w=g.result;w=p?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=w:location=w,u=null},g.readAsDataURL(c)}else{var x=a.URL||a.webkitURL,y=x.createObjectURL(c);u?u.location=y:location.href=y,u=null,setTimeout(function(){x.revokeObjectURL(y)},4e4)}});a.saveAs=l.saveAs=l,r.exports=l})})(Hw);var CP=Hw.exports;const AP=_1({name:"CSVWClientParser",components:{Codemirror:eP},props:{csvFiles:{type:Array,default:()=>[]},initialContext:{type:Object,default:()=>({"@context":{}})}},data(){return{localTables:[],serverUrl:"http://localhost:8000/convert/",metadataText:JSON.stringify(this.initialContext,null,2),jsonldOut:null,ttl:"",error:null,running:!1,validating:!1,tripleCount:null,cmExtensions:[dP(),SP],activeIndex:0,relationships:{}}},created(){this.localTables=(this.csvFiles||[]).slice()},computed:{prettyJsonld(){try{return JSON.stringify(this.jsonldOut,null,2)||""}catch{return""}},currentFile(){return this.csvFiles&&this.csvFiles[this.activeIndex]?this.csvFiles[this.activeIndex]:null},otherTables(){return this.currentFile?this.csvFiles.filter(r=>r.url!==this.currentFile.url):[]}},watch:{csvFiles:{handler(r){this.localTables=(r||[]).slice();for(const e of r)this.relationships[e.url]||(this.relationships[e.url]={target:"",sourceField:""});Object.keys(this.relationships).forEach(e=>{r.find(t=>t.url===e)||delete this.relationships[e]})},immediate:!0}},methods:{filenameLabel(r,e){try{const t=r.split("/");let i=t[t.length-1]||r;return i||(i=`file${e+1}`),i}catch{return`file${e+1}`}},async validateMetadata(){this.validating=!0,this.error=null;try{JSON.parse(this.metadataText)}catch(r){this.error="Invalid JSON: "+r.message}finally{this.validating=!1}},extractHeaders(){try{const r=this.csvFiles||[];if(!r.length){this.error="No CSV files added.";return}const e=a=>{let o=0,l=0,c=0;for(const f of a){const h=f==null?"":String(f).trim();if(h==="")continue;c++;const u=Number(h);if(!Number.isNaN(u)&&isFinite(u)){o++;continue}const d=Date.parse(h);if(!Number.isNaN(d)){l++;continue}}return c===0?"string":o/c>=.8?"number":l/c>=.8?"date":"string"},t={name:"schema:name",title:"schema:name",description:"schema:description",id:"schema:identifier",identifier:"schema:identifier",uuid:"schema:identifier",email:"schema:email",url:"schema:url",link:"schema:url",date:"schema:date",created:"schema:dateCreated",updated:"schema:dateModified",value:"schema:value"},i=[];for(const a of r){const o=a.headers||[],l=(a.rows||[]).slice(0,5),c=(a.rows||[]).slice(0,200),f=o.map(y=>{const w=l.map(k=>k&&Object.prototype.hasOwnProperty.call(k,y)?k[y]:""),T=e(w);let C;T==="number"&&(C="decimal"),T==="date"&&(C="dateTime");const R=String(y).toLowerCase(),_=t[R]||"schema:value",A={titles:y,name:y,"dcterms:description":y,propertyUrl:_};return C&&(A.datatype=C),A}),h=o.map(y=>{let w=0;const T=new Set;for(const _ of c){const A=_&&Object.prototype.hasOwnProperty.call(_,y)?_[y]:"",k=A==null?"":String(A).trim();k!==""&&(w++,T.add(k))}const C=T.size,R=w>0?C/w:0;return{header:y,nonEmpty:w,distinct:C,uniqRatio:R}}),u=h.filter(y=>y.nonEmpty>=3&&y.uniqRatio>=.98),d=h.filter(y=>y.nonEmpty>=3&&y.uniqRatio>=.8),m=y=>{const w=["id","uuid","code","key","identifier"];for(const T of w){const C=y.find(R=>R.header.toLowerCase().includes(T));if(C)return C.header}return null};let p=null;if(u.length===1)p=u[0].header;else if(u.length>1)p=m(u)||u.sort((y,w)=>w.uniqRatio-y.uniqRatio)[0].header;else if(d.length>=1)p=m(d)||d.sort((y,w)=>w.uniqRatio-y.uniqRatio)[0].header;else{const y=h.filter(w=>w.nonEmpty>=3&&w.distinct===w.nonEmpty);y.length&&(p=m(y)||y[0].header)}const g={url:a.url||"data.csv",tableSchema:{columns:f}};p&&(g.tableSchema.primaryKey=p,g.tableSchema.aboutUrl=(a.url||"data.csv")+"/{"+p+"}");const x=this.relationships[a.url];x&&x.target&&x.sourceField&&(g.tableSchema.foreignKeys=[{columns:[x.sourceField],reference:{resource:x.target,columnReference:void 0}}]),i.push(g)}const n=[],s={"@context":["https://www.w3.org/ns/csvw.jsonld"],tables:i};this.metadataText=JSON.stringify(s,null,2),this.error=null}catch(r){this.error="Extract headers failed: "+(r&&r.message?r.message:String(r))}},async postMetadata(){this.running=!0,this.error=null,this.jsonldOut=null,this.ttl="",this.tripleCount=null;let r;try{r=JSON.parse(this.metadataText)}catch(e){this.error="Metadata is not valid JSON: "+e.message,this.running=!1;return}try{const e=await fetch(this.serverUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({MetadataContent:r})});if(!e.ok){const n=await e.text();throw new Error(`Server returned ${e.status}: ${n}`)}const t=await e.json(),i=typeof t=="string"?JSON.parse(t):t;this.jsonldOut=i||null}catch(e){this.error=e.message||String(e)}finally{this.running=!1}},downloadJSONLD(){try{if(!this.metadataText)return;const r=new Blob([JSON.stringify(this.jsonldOut,null,2)],{type:"application/ld+json"}),e=URL.createObjectURL(r),t=document.createElement("a"),i=this.downloadFilename("csvw","jsonld");t.href=e,t.download=i,document.body.appendChild(t),t.click(),t.remove(),URL.revokeObjectURL(e)}catch(r){this.error="Download failed: "+(r&&r.message?r.message:String(r))}},downloadFilename(r,e){try{const t=this.csvFiles&&this.csvFiles[0]&&this.csvFiles[0].url?this.csvFiles[0].url.split("/").pop():null;return`${t?t.replace(/\.[^/.]+$/,""):r}.${e}`}catch{return`${r}.${e}`}},async downloadPackage(){try{const r=new EP;let e=this.metadataText||"";try{const a=JSON.parse(e);e=JSON.stringify(a,null,2)}catch{}r.file("metadata.jsonld",e);const t=this.csvFiles||[],i=new Set;for(const a of t){let o="table.csv";try{if(a.url){const f=String(a.url).split("/");let h=f[f.length-1]||a.url;h||(h="table"),o=h}else a.filename&&(o=a.filename)}catch{o="table.csv"}o=o.replace(/[:#?<>|\\\/]+/g,"_"),/\.csv$/i.test(o)||(o=o+".csv");let l=o,c=1;for(;i.has(l);)l=o.replace(/(\.csv)$/i,`_${c}$1`),c++;if(i.add(l),a.text&&typeof a.text=="string"&&a.text.trim().length>0)r.file(l,a.text);else{const f=a.headers||(a.table&&a.table.tableSchema&&a.table.tableSchema.columns?a.table.tableSchema.columns.map(m=>typeof m=="string"?m:m.name||(Array.isArray(m.titles)?m.titles[0]:m.titles||"")):[]),h=a.rows||[],u=m=>{if(m==null)return"";const p=String(m);return p.includes('"')||p.includes(",")||p.includes(`
`)||p.includes("\r")?'"'+p.replace(/"/g,'""')+'"':p},d=[];if(f&&f.length){d.push(f.map(u).join(","));for(const m of h){const p=f.map(g=>u(m&&Object.prototype.hasOwnProperty.call(m,g)?m[g]:"")).join(",");d.push(p)}}else if(h&&h.length)if(Array.isArray(h[0]))for(const m of h)d.push(m.map(u).join(","));else{const m=new Set;h.forEach(g=>Object.keys(g||{}).forEach(x=>m.add(x)));const p=Array.from(m);d.push(p.map(u).join(","));for(const g of h)d.push(p.map(x=>u(g&&g[x]!=null?g[x]:"")).join(","))}else d.push("");r.file(l,d.join(`
`))}}const n=await r.generateAsync({type:"blob"}),s=this.packageFilename();CP.saveAs(n,s)}catch(r){this.error="Package download failed: "+(r&&r.message?r.message:String(r))}},packageFilename(){try{const r=this.csvFiles&&this.csvFiles[0]&&this.csvFiles[0].url?this.csvFiles[0].url.split("/").pop():null;return`${r?r.replace(/\.[^/.]+$/,""):"csvw_package"}.zip`}catch{return"csvw_package.zip"}}}}),OP={class:"d-flex gap-2 mb-3 align-items-center"},FP={key:0,class:"ms-2 text-danger"},DP={class:"row g-3"},RP={class:"col-md-6"},MP={class:"border rounded p-3"},IP=["disabled"],PP={key:0,class:"text-muted"},LP={key:1,class:"nav nav-tabs mb-3",role:"tablist"},BP=["onClick"],NP={key:2,class:"tab-content"},UP={class:"tab-pane active"},HP={key:0},zP={class:"d-flex justify-content-between align-items-center mb-2"},WP={class:"text-end"},VP={class:"d-flex gap-1"},jP=["disabled"],$P=["value"],GP=["value"],KP={key:0},XP={class:"table table-striped table-bordered table-sm"},qP={class:"table-dark"},YP={key:1,class:"text-muted"},JP={class:"col-md-6"},ZP={class:"border rounded p-3"},QP=["disabled"],eL={key:0,class:"ms-2 text-muted float-end"},tL={class:"row mt-3"},rL={class:"col-12"},iL={class:"mb-3"},nL={class:"bg-light p-2 border rounded small",style:{"max-height":"220px",overflow:"auto"}},sL={key:0,class:"mt-2 text-muted"};function aL(r,e,t,i,n,s){const a=Oh("Codemirror");return ze(),Ge("div",null,[Pe("div",OP,[Ua(Pe("input",{type:"hidden","onUpdate:modelValue":e[0]||(e[0]=o=>r.serverUrl=o),class:"form-control form-control-sm me-2",style:{"max-width":"480px"}},null,512),[[ex,r.serverUrl]]),r.error?(ze(),Ge("div",FP,Qt(r.error),1)):Ar("",!0)]),Pe("div",DP,[Pe("div",RP,[Pe("div",MP,[Pe("h4",null,[e[8]||(e[8]=zs(" Tables ",-1)),Pe("button",{class:"btn btn-outline-secondary btn-sm float-end",onClick:e[1]||(e[1]=(...o)=>r.extractHeaders&&r.extractHeaders(...o)),disabled:!r.csvFiles||!r.csvFiles.length},"Extract metadata",8,IP)]),r.csvFiles.length?Ar("",!0):(ze(),Ge("div",PP,"No tables added.")),r.csvFiles.length?(ze(),Ge("ul",LP,[(ze(!0),Ge(It,null,Ei(r.csvFiles,(o,l)=>(ze(),Ge("li",{class:"nav-item",key:o.url},[Pe("button",{class:nf(["nav-link",{active:r.activeIndex===l}]),onClick:c=>r.activeIndex=l,type:"button"},Qt(r.filenameLabel(o.url,l)),11,BP)]))),128))])):Ar("",!0),r.csvFiles.length?(ze(),Ge("div",NP,[Pe("div",UP,[r.currentFile?(ze(),Ge("div",HP,[Pe("div",zP,[Pe("div",WP,[e[11]||(e[11]=Pe("label",{class:"form-label small mb-0"},"Link to another table (optional)",-1)),Pe("div",VP,[Ua(Pe("select",{class:"form-select form-select-sm","onUpdate:modelValue":e[2]||(e[2]=o=>r.relationships[r.currentFile.url].target=o),disabled:r.otherTables.length===0},[e[9]||(e[9]=Pe("option",{value:""},"(none)",-1)),(ze(!0),Ge(It,null,Ei(r.otherTables,o=>(ze(),Ge("option",{key:o.url,value:o.url},Qt(r.filenameLabel(o.url)),9,$P))),128))],8,jP),[[Vd,r.relationships[r.currentFile.url].target]]),Ua(Pe("select",{class:"form-select form-select-sm","onUpdate:modelValue":e[3]||(e[3]=o=>r.relationships[r.currentFile.url].sourceField=o)},[e[10]||(e[10]=Pe("option",{value:""},"(select field)",-1)),(ze(!0),Ge(It,null,Ei(r.currentFile.headers,o=>(ze(),Ge("option",{key:o,value:o},Qt(o),9,GP))),128))],512),[[Vd,r.relationships[r.currentFile.url].sourceField]])])])]),r.currentFile.headers.length?(ze(),Ge("div",KP,[Pe("table",XP,[Pe("thead",qP,[Pe("tr",null,[(ze(!0),Ge(It,null,Ei(r.currentFile.headers,o=>(ze(),Ge("th",{key:o},Qt(o),1))),128))])]),Pe("tbody",null,[(ze(!0),Ge(It,null,Ei(r.currentFile.rows.slice(0,10),(o,l)=>(ze(),Ge("tr",{key:l},[(ze(!0),Ge(It,null,Ei(r.currentFile.headers,c=>(ze(),Ge("td",{key:c},Qt(o[c]),1))),128))]))),128))])]),e[12]||(e[12]=Pe("small",{class:"text-muted"},"Showing first 10 rows",-1))])):(ze(),Ge("div",YP,"No headers detected in this file."))])):Ar("",!0)])])):Ar("",!0)])]),Pe("div",JP,[Pe("div",ZP,[Pe("h4",null,[e[13]||(e[13]=zs(" Table metadata ",-1)),Pe("button",{class:"btn btn-primary btn-sm float-end",onClick:e[4]||(e[4]=(...o)=>r.postMetadata&&r.postMetadata(...o)),disabled:r.running},"Process CSV",8,QP),Pe("button",{class:"btn btn-sm btn-outline-secondary float-end",onClick:e[5]||(e[5]=(...o)=>r.downloadPackage&&r.downloadPackage(...o))},"Download package"),r.running?(ze(),Ge("div",eL," Sending...")):Ar("",!0)]),wr(a,{modelValue:r.metadataText,"onUpdate:modelValue":e[6]||(e[6]=o=>r.metadataText=o),extensions:r.cmExtensions,class:"border rounded",style:{height:"420px"}},null,8,["modelValue","extensions"])])])]),Pe("div",tL,[Pe("div",rL,[Pe("h4",null,[e[14]||(e[14]=zs("Graph ",-1)),Pe("button",{class:"btn btn-sm btn-outline-secondary float-end",onClick:e[7]||(e[7]=(...o)=>r.downloadJSONLD&&r.downloadJSONLD(...o))},"Download graph")]),Pe("div",iL,[Pe("pre",nL,Qt(r.prettyJsonld),1)])])]),r.tripleCount!==null?(ze(),Ge("div",sL,"Triples returned: "+Qt(r.tripleCount),1)):Ar("",!0)])}const oL=I0(AP,[["render",aL],["__scopeId","data-v-1b714606"]]),lL={name:"App",components:{CSVUploader:qF,CSVWClientParser:oL},data(){return{csvFiles:[]}},methods:{onCsvsChanged(r){if(!r){this.csvFiles=[];return}Array.isArray(r)?this.csvFiles=r.slice():r&&r.url?this.csvFiles=this.csvFiles.concat([r]):this.csvFiles=[]}}},cL={class:"container py-4"},fL={class:"border rounded m-3 p-3"};function hL(r,e,t,i,n,s){const a=Oh("CSVUploader"),o=Oh("CSVWClientParser");return ze(),Ge("div",cL,[Pe("div",fL,[e[0]||(e[0]=Pe("h2",{class:"mb-3"},"CSVW editor",-1)),e[1]||(e[1]=Pe("p",null,[zs("Select one or more CSV files, which are published on the web. Mind that the remote webserver should support "),Pe("a",{href:"https://en.wikipedia.org/wiki/Cross-origin_resource_sharing"},"CORS"),zs(". Then run the `extract headers` command to extract metadata from the CSV's. Then update the metadata to your needs and run `process CSV` to generate RDF (as json-ld, other serialisations are supported by the API)")],-1)),wr(a,{onCsvsChanged:s.onCsvsChanged},null,8,["onCsvsChanged"]),n.csvFiles.length?(ze(),X1(o,{key:0,csvFiles:n.csvFiles},null,8,["csvFiles"])):Ar("",!0)])])}const uL=I0(lL,[["render",hL]]);w_(uL).mount("#app");
